!function (e) { function t(a) { if (n[a]) return n[a].exports; var i = n[a] = { i: a, l: !1, exports: {} }; return e[a].call(i.exports, i, i.exports, t), i.l = !0, i.exports } var n = {}; t.m = e, t.c = n, t.d = function (e, n, a) { t.o(e, n) || Object.defineProperty(e, n, { configurable: !1, enumerable: !0, get: a }) }, t.n = function (e) { var n = e && e.__esModule ? function () { return e.default } : function () { return e }; return t.d(n, "a", n), n }, t.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, t.p = "//m1.bdp.cn/dist/", t(t.s = 749) }([function (e, t) { var n = e.exports = { version: "2.5.1" }; "number" == typeof __e && (__e = n) }, function (e, t, n) { var a = n(72)("wks"), i = n(47), r = n(5).Symbol, o = "function" == typeof r; (e.exports = function (e) { return a[e] || (a[e] = o && r[e] || (o ? r : i)("Symbol." + e)) }).store = a }, function (e, t, n) { e.exports = { default: n(107), __esModule: !0 } }, function (e, t) { var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); "number" == typeof __g && (__g = n) }, function (e, t, n) { var a = n(58)("wks"), i = n(36), r = n(3).Symbol, o = "function" == typeof r; (e.exports = function (e) { return a[e] || (a[e] = o && r[e] || (o ? r : i)("Symbol." + e)) }).store = a }, function (e, t) { var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); "number" == typeof __g && (__g = n) }, function (e, t, n) { "use strict"; t.__esModule = !0, t.default = function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } }, function (e, t, n) { "use strict"; t.__esModule = !0; var a = n(95), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); t.default = function () { function e(e, t) { for (var n = 0; n < t.length; n++) { var a = t[n]; a.enumerable = a.enumerable || !1, a.configurable = !0, "value" in a && (a.writable = !0), (0, i.default)(e, a.key, a) } } return function (t, n, a) { return n && e(t.prototype, n), a && e(t, a), t } }() }, function (e, t, n) { var a = n(10), i = n(84), r = n(56), o = Object.defineProperty; t.f = n(11) ? Object.defineProperty : function (e, t, n) { if (a(e), t = r(t, !0), a(n), i) try { return o(e, t, n) } catch (e) { } if ("get" in n || "set" in n) throw TypeError("Accessors not supported!"); return "value" in n && (e[t] = n.value), e } }, function (e, t, n) { var a = n(3), i = n(0), r = n(28), o = n(14), s = function (e, t, n) { var l, c, d, u = e & s.F, f = e & s.G, p = e & s.S, h = e & s.P, g = e & s.B, m = e & s.W, v = f ? i : i[t] || (i[t] = {}), y = v.prototype, _ = f ? a : p ? a[t] : (a[t] || {}).prototype; f && (n = t); for (l in n) (c = !u && _ && void 0 !== _[l]) && l in v || (d = c ? _[l] : n[l], v[l] = f && "function" != typeof _[l] ? n[l] : g && c ? r(d, a) : m && _[l] == d ? function (e) { var t = function (t, n, a) { if (this instanceof e) { switch (arguments.length) { case 0: return new e; case 1: return new e(t); case 2: return new e(t, n) }return new e(t, n, a) } return e.apply(this, arguments) }; return t.prototype = e.prototype, t }(d) : h && "function" == typeof d ? r(Function.call, d) : d, h && ((v.virtual || (v.virtual = {}))[l] = d, e & s.R && y && !y[l] && o(y, l, d))) }; s.F = 1, s.G = 2, s.S = 4, s.P = 8, s.B = 16, s.W = 32, s.U = 64, s.R = 128, e.exports = s }, function (e, t, n) { var a = n(17); e.exports = function (e) { if (!a(e)) throw TypeError(e + " is not an object!"); return e } }, function (e, t, n) { e.exports = !n(18)(function () { return 7 != Object.defineProperty({}, "a", { get: function () { return 7 } }).a }) }, function (e, t, n) { var a = n(20); e.exports = function (e) { if (!a(e)) throw TypeError(e + " is not an object!"); return e } }, function (e, t) { var n = {}.hasOwnProperty; e.exports = function (e, t) { return n.call(e, t) } }, function (e, t, n) { var a = n(8), i = n(25); e.exports = n(11) ? function (e, t, n) { return a.f(e, t, i(1, n)) } : function (e, t, n) { return e[t] = n, e } }, function (e, t, n) { var a = n(100), i = n(55); e.exports = function (e) { return a(i(e)) } }, function (e, t, n) { var a = n(33), i = n(74); e.exports = n(21) ? function (e, t, n) { return a.f(e, t, i(1, n)) } : function (e, t, n) { return e[t] = n, e } }, function (e, t) { e.exports = function (e) { return "object" == typeof e ? null !== e : "function" == typeof e } }, function (e, t) { e.exports = function (e) { try { return !!e() } catch (e) { return !0 } } }, function (e, t, n) { var a = n(5), i = n(16), r = n(22), o = n(47)("src"), s = Function.toString, l = ("" + s).split("toString"); n(23).inspectSource = function (e) { return s.call(e) }, (e.exports = function (e, t, n, s) { var c = "function" == typeof n; c && (r(n, "name") || i(n, "name", t)), e[t] !== n && (c && (r(n, o) || i(n, o, e[t] ? "" + e[t] : l.join(String(t)))), e === a ? e[t] = n : s ? e[t] ? e[t] = n : i(e, t, n) : (delete e[t], i(e, t, n))) })(Function.prototype, "toString", function () { return "function" == typeof this && this[o] || s.call(this) }) }, function (e, t) { e.exports = function (e) { return "object" == typeof e ? null !== e : "function" == typeof e } }, function (e, t, n) { e.exports = !n(73)(function () { return 7 != Object.defineProperty({}, "a", { get: function () { return 7 } }).a }) }, function (e, t) { var n = {}.hasOwnProperty; e.exports = function (e, t) { return n.call(e, t) } }, function (e, t) { var n = e.exports = { version: "2.5.1" }; "number" == typeof __e && (__e = n) }, function (e, t) { e.exports = {} }, function (e, t) { e.exports = function (e, t) { return { enumerable: !(1 & e), configurable: !(2 & e), writable: !(4 & e), value: t } } }, function (e, t) { e.exports = {} }, function (e, t, n) { "use strict"; function a() { return 1 === window.usedThemeId ? "dark" : (window.usedThemeId, "light") } function i(e, t) { for (var n in t) void 0 === e[n] ? e[n] = t[n] : _.isObject(e[n]) && i(e[n], t[n]) } function r(e, t) { for (var n = a(), r = e[n], o = [], s = 0, l = r.length; s < l; s++) { var c = r[s]; c.value = void 0 === c.value ? s : c.value, o.push(c), c.style = c.style || {}, i(c.style, t) } return { skinList: o } } function o(e, t) { var n = []; if ("string" == typeof t) e.forEach(function (e) { var a = _.cloneDeep(e); a.value == t ? (a.isDefault = !0, a.active = !0) : (a.isDefault = !1, a.active = !1), n.push(a) }); else { ["dark", "light"].forEach(function (a) { for (var r = t[a], o = e[a], s = 0, l = o.length; s < l; s++) { var c = o[s]; n.push(c), c.theme = a, c.style = c.style || {}, i(c.style, r) } }) } return n } Object.defineProperty(t, "__esModule", { value: !0 }), t.getTheme = a, t.meregeSkin = i, t.getSkinInfo = r, t.getSkinList = o }, function (e, t, n) { var a = n(44); e.exports = function (e, t, n) { if (a(e), void 0 === t) return e; switch (n) { case 1: return function (n) { return e.call(t, n) }; case 2: return function (n, a) { return e.call(t, n, a) }; case 3: return function (n, a, i) { return e.call(t, n, a, i) } }return function () { return e.apply(t, arguments) } } }, function (e, t, n) { var a = n(86), i = n(59); e.exports = Object.keys || function (e) { return a(e, i) } }, function (e, t) { var n = {}.toString; e.exports = function (e) { return n.call(e).slice(8, -1) } }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } t.__esModule = !0; var i = n(158), r = a(i), o = n(160), s = a(o), l = "function" == typeof s.default && "symbol" == typeof r.default ? function (e) { return typeof e } : function (e) { return e && "function" == typeof s.default && e.constructor === s.default && e !== s.default.prototype ? "symbol" : typeof e }; t.default = "function" == typeof s.default && "symbol" === l(r.default) ? function (e) { return void 0 === e ? "undefined" : l(e) } : function (e) { return e && "function" == typeof s.default && e.constructor === s.default && e !== s.default.prototype ? "symbol" : void 0 === e ? "undefined" : l(e) } }, function (e, t) { var n = {}.toString; e.exports = function (e) { return n.call(e).slice(8, -1) } }, function (e, t, n) { var a = n(12), i = n(120), r = n(121), o = Object.defineProperty; t.f = n(21) ? Object.defineProperty : function (e, t, n) { if (a(e), t = r(t, !0), a(n), i) try { return o(e, t, n) } catch (e) { } if ("get" in n || "set" in n) throw TypeError("Accessors not supported!"); return "value" in n && (e[t] = n.value), e } }, function (e, t, n) { var a = n(35); e.exports = function (e, t, n) { if (a(e), void 0 === t) return e; switch (n) { case 1: return function (n) { return e.call(t, n) }; case 2: return function (n, a) { return e.call(t, n, a) }; case 3: return function (n, a, i) { return e.call(t, n, a, i) } }return function () { return e.apply(t, arguments) } } }, function (e, t) { e.exports = function (e) { if ("function" != typeof e) throw TypeError(e + " is not a function!"); return e } }, function (e, t) { var n = 0, a = Math.random(); e.exports = function (e) { return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++n + a).toString(36)) } }, function (e, t, n) { var a = n(8).f, i = n(13), r = n(4)("toStringTag"); e.exports = function (e, t, n) { e && !i(e = n ? e : e.prototype, r) && a(e, r, { configurable: !0, value: t }) } }, function (e, t) { e.exports = !0 }, function (e, t, n) { var a = n(55); e.exports = function (e) { return Object(a(e)) } }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = { instant: function (e) { return window.bdpI18N ? bdpI18N[e] : e } }; t.default = a }, function (e, t, n) { "use strict"; function a(e) { return (e.slice(0, 1).toLocaleLowerCase() + e.slice(1)).replace("Component", "").replace("Directive", "") } function i(e) { var t = angular.module(e.name, e.dependence); e.service && _.forEach(e.service, function (e, n) { return t.service(a(n), e) }), e.controller && _.forEach(e.controller, function (e, n) { return t.controller(a(n), e) }), e.directive && _.forEach(e.directive, function (e, n) { return t.directive(a(n), e.directiveConstructor) }) } function r(e) { var t = angular.module(e.name); e.service && _.forEach(e.service, function (e, n) { return t.service(a(n), e) }), e.controller && _.forEach(e.controller, function (e, n) { return t.controller(a(n), e) }), e.directive && _.forEach(e.directive, function (e, n) { return t.directive(a(n), e.directiveConstructor) }) } function o(e) { return function (t) { t.directiveConstructor = e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.creatNgModule = i, t.extendNgModule = r, t.ngComponent = o; t.ngDirective = o }, function (e, t) { t.f = {}.propertyIsEnumerable }, function (e, t, n) { e.exports = { default: n(175), __esModule: !0 } }, function (e, t) { e.exports = function (e) { if ("function" != typeof e) throw TypeError(e + " is not a function!"); return e } }, function (e, t, n) { "use strict"; var a = n(151)(!0); n(71)(String, "String", function (e) { this._t = String(e), this._i = 0 }, function () { var e, t = this._t, n = this._i; return n >= t.length ? { value: void 0, done: !0 } : (e = a(t, n), this._i += e.length, { value: e, done: !1 }) }) }, function (e, t, n) { var a = n(32), i = n(1)("toStringTag"), r = "Arguments" == a(function () { return arguments }()), o = function (e, t) { try { return e[t] } catch (e) { } }; e.exports = function (e) { var t, n, s; return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof (n = o(t = Object(e), i)) ? n : r ? a(t) : "Object" == (s = a(t)) && "function" == typeof t.callee ? "Arguments" : s } }, function (e, t) { var n = 0, a = Math.random(); e.exports = function (e) { return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++n + a).toString(36)) } }, function (e, t, n) { var a = n(20), i = n(5).document, r = a(i) && a(i.createElement); e.exports = function (e) { return r ? i.createElement(e) : {} } }, function (e, t) { var n = Math.ceil, a = Math.floor; e.exports = function (e) { return isNaN(e = +e) ? 0 : (e > 0 ? a : n)(e) } }, function (e, t) { e.exports = function (e) { if (void 0 == e) throw TypeError("Can't call method on  " + e); return e } }, function (e, t, n) { var a = n(128), i = n(50); e.exports = function (e) { return a(i(e)) } }, function (e, t, n) { var a = n(72)("keys"), i = n(47); e.exports = function (e) { return a[e] || (a[e] = i(e)) } }, function (e, t, n) { var a = n(33).f, i = n(22), r = n(1)("toStringTag"); e.exports = function (e, t, n) { e && !i(e = n ? e : e.prototype, r) && a(e, r, { configurable: !0, value: t }) } }, function (e, t) { var n = Math.ceil, a = Math.floor; e.exports = function (e) { return isNaN(e = +e) ? 0 : (e > 0 ? a : n)(e) } }, function (e, t) { e.exports = function (e) { if (void 0 == e) throw TypeError("Can't call method on  " + e); return e } }, function (e, t, n) { var a = n(17); e.exports = function (e, t) { if (!a(e)) return e; var n, i; if (t && "function" == typeof (n = e.toString) && !a(i = n.call(e))) return i; if ("function" == typeof (n = e.valueOf) && !a(i = n.call(e))) return i; if (!t && "function" == typeof (n = e.toString) && !a(i = n.call(e))) return i; throw TypeError("Can't convert object to primitive value") } }, function (e, t, n) { var a = n(58)("keys"), i = n(36); e.exports = function (e) { return a[e] || (a[e] = i(e)) } }, function (e, t, n) { var a = n(3), i = a["__core-js_shared__"] || (a["__core-js_shared__"] = {}); e.exports = function (e) { return i[e] || (i[e] = {}) } }, function (e, t) { e.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",") }, function (e, t, n) { t.f = n(4) }, function (e, t, n) { var a = n(3), i = n(0), r = n(38), o = n(60), s = n(8).f; e.exports = function (e) { var t = i.Symbol || (i.Symbol = r ? {} : a.Symbol || {}); "_" == e.charAt(0) || e in t || s(t, e, { value: o.f(e) }) } }, function (e, t, n) { var a = n(17), i = n(3).document, r = a(i) && a(i.createElement); e.exports = function (e) { return r ? i.createElement(e) : {} } }, function (e, t, n) { var a = n(54), i = Math.min; e.exports = function (e) { return e > 0 ? i(a(e), 9007199254740991) : 0 } }, function (e, t, n) { var a = n(10), i = n(153), r = n(59), o = n(57)("IE_PROTO"), s = function () { }, l = function () { var e, t = n(62)("iframe"), a = r.length; for (t.style.display = "none", n(94).appendChild(t), t.src = "javascript:", e = t.contentWindow.document, e.open(), e.write("<script>document.F=Object</script>"), e.close(), l = e.F; a--;)delete l.prototype[r[a]]; return l() }; e.exports = Object.create || function (e, t) { var n; return null !== e ? (s.prototype = a(e), n = new s, s.prototype = null, n[o] = e) : n = l(), void 0 === t ? n : i(n, t) } }, function (e, t) { t.f = Object.getOwnPropertySymbols }, function (e, t, n) { n(156); for (var a = n(3), i = n(14), r = n(26), o = n(4)("toStringTag"), s = "CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","), l = 0; l < s.length; l++) { var c = s[l], d = a[c], u = d && d.prototype; u && !u[o] && i(u, o, c), r[c] = r.Array } }, , , function (e, t, n) { e.exports = n(207) }, function (e, t, n) { "use strict"; t.__esModule = !0; var a = n(91), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); t.default = function (e) { return function () { var t = e.apply(this, arguments); return new i.default(function (e, n) { function a(r, o) { try { var s = t[r](o), l = s.value } catch (e) { return void n(e) } if (!s.done) return i.default.resolve(l).then(function (e) { a("next", e) }, function (e) { a("throw", e) }); e(l) } return a("next") }) } } }, function (e, t, n) { "use strict"; var a = n(38), i = n(9), r = n(85), o = n(14), s = n(13), l = n(26), c = n(152), d = n(37), u = n(102), f = n(4)("iterator"), p = !([].keys && "next" in [].keys()), h = function () { return this }; e.exports = function (e, t, n, g, m, v, y) { c(n, t, g); var _, b, w, C = function (e) { if (!p && e in D) return D[e]; switch (e) { case "keys": case "values": return function () { return new n(this, e) } }return function () { return new n(this, e) } }, S = t + " Iterator", k = "values" == m, x = !1, D = e.prototype, T = D[f] || D["@@iterator"] || m && D[m], E = T || C(m), L = m ? k ? C("entries") : E : void 0, A = "Array" == t ? D.entries || T : T; if (A && (w = u(A.call(new e))) !== Object.prototype && w.next && (d(w, S, !0), a || s(w, f) || o(w, f, h)), k && T && "values" !== T.name && (x = !0, E = function () { return T.call(this) }), a && !y || !p && !x && D[f] || o(D, f, E), l[t] = E, l[S] = h, m) if (_ = { values: k ? E : C("values"), keys: v ? E : C("keys"), entries: L }, y) for (b in _) b in D || r(D, b, _[b]); else i(i.P + i.F * (p || x), t, _); return _ } }, function (e, t, n) { var a = n(5), i = a["__core-js_shared__"] || (a["__core-js_shared__"] = {}); e.exports = function (e) { return i[e] || (i[e] = {}) } }, function (e, t) { e.exports = function (e) { try { return !!e() } catch (e) { return !0 } } }, function (e, t) { e.exports = function (e, t) { return { enumerable: !(1 & e), configurable: !(2 & e), writable: !(4 & e), value: t } } }, function (e, t, n) { "use strict"; var a = n(76), i = n(77), r = n(19), o = n(16), s = n(22), l = n(24), c = n(124), d = n(53), u = n(131), f = n(1)("iterator"), p = !([].keys && "next" in [].keys()), h = function () { return this }; e.exports = function (e, t, n, g, m, v, y) { c(n, t, g); var _, b, w, C = function (e) { if (!p && e in D) return D[e]; switch (e) { case "keys": case "values": return function () { return new n(this, e) } }return function () { return new n(this, e) } }, S = t + " Iterator", k = "values" == m, x = !1, D = e.prototype, T = D[f] || D["@@iterator"] || m && D[m], E = T || C(m), L = m ? k ? C("entries") : E : void 0, A = "Array" == t ? D.entries || T : T; if (A && (w = u(A.call(new e))) !== Object.prototype && w.next && (d(w, S, !0), a || s(w, f) || o(w, f, h)), k && T && "values" !== T.name && (x = !0, E = function () { return T.call(this) }), a && !y || !p && !x && D[f] || o(D, f, E), l[t] = E, l[S] = h, m) if (_ = { values: k ? E : C("values"), keys: v ? E : C("keys"), entries: L }, y) for (b in _) b in D || r(D, b, _[b]); else i(i.P + i.F * (p || x), t, _); return _ } }, function (e, t) { e.exports = !1 }, function (e, t, n) { var a = n(5), i = n(23), r = n(16), o = n(19), s = n(34), l = function (e, t, n) { var c, d, u, f, p = e & l.F, h = e & l.G, g = e & l.S, m = e & l.P, v = e & l.B, y = h ? a : g ? a[t] || (a[t] = {}) : (a[t] || {}).prototype, _ = h ? i : i[t] || (i[t] = {}), b = _.prototype || (_.prototype = {}); h && (n = t); for (c in n) d = !p && y && void 0 !== y[c], u = (d ? y : n)[c], f = v && d ? s(u, a) : m && "function" == typeof u ? s(Function.call, u) : u, y && o(y, c, u, e & l.U), _[c] != u && r(_, c, f), m && b[c] != u && (b[c] = u) }; a.core = i, l.F = 1, l.G = 2, l.S = 4, l.P = 8, l.B = 16, l.W = 32, l.U = 64, l.R = 128, e.exports = l }, function (e, t, n) { var a = n(127), i = n(80); e.exports = Object.keys || function (e) { return a(e, i) } }, function (e, t, n) { var a = n(49), i = Math.min; e.exports = function (e) { return e > 0 ? i(a(e), 9007199254740991) : 0 } }, function (e, t) { e.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",") }, function (e, t, n) { var a = n(5).document; e.exports = a && a.documentElement }, function (e, t, n) { var a, i, r, o = n(34), s = n(144), l = n(81), c = n(48), d = n(5), u = d.process, f = d.setImmediate, p = d.clearImmediate, h = d.MessageChannel, g = d.Dispatch, m = 0, v = {}, y = function () { var e = +this; if (v.hasOwnProperty(e)) { var t = v[e]; delete v[e], t() } }, _ = function (e) { y.call(e.data) }; f && p || (f = function (e) { for (var t = [], n = 1; arguments.length > n;)t.push(arguments[n++]); return v[++m] = function () { s("function" == typeof e ? e : Function(e), t) }, a(m), m }, p = function (e) { delete v[e] }, "process" == n(32)(u) ? a = function (e) { u.nextTick(o(y, e, 1)) } : g && g.now ? a = function (e) { g.now(o(y, e, 1)) } : h ? (i = new h, r = i.port2, i.port1.onmessage = _, a = o(r.postMessage, r, 1)) : d.addEventListener && "function" == typeof postMessage && !d.importScripts ? (a = function (e) { d.postMessage(e + "", "*") }, d.addEventListener("message", _, !1)) : a = "onreadystatechange" in c("script") ? function (e) { l.appendChild(c("script")).onreadystatechange = function () { l.removeChild(this), y.call(e) } } : function (e) { setTimeout(o(y, e, 1), 0) }), e.exports = { set: f, clear: p } }, function (e, t, n) { "use strict"; function a(e) { var t, n; this.promise = new e(function (e, a) { if (void 0 !== t || void 0 !== n) throw TypeError("Bad Promise constructor"); t = e, n = a }), this.resolve = i(t), this.reject = i(n) } var i = n(35); e.exports.f = function (e) { return new a(e) } }, function (e, t, n) { e.exports = !n(11) && !n(18)(function () { return 7 != Object.defineProperty(n(62)("div"), "a", { get: function () { return 7 } }).a }) }, function (e, t, n) { e.exports = n(14) }, function (e, t, n) { var a = n(13), i = n(15), r = n(154)(!1), o = n(57)("IE_PROTO"); e.exports = function (e, t) { var n, s = i(e), l = 0, c = []; for (n in s) n != o && a(s, n) && c.push(n); for (; t.length > l;)a(s, n = t[l++]) && (~r(c, n) || c.push(n)); return c } }, function (e, t, n) { var a = n(86), i = n(59).concat("length", "prototype"); t.f = Object.getOwnPropertyNames || function (e) { return a(e, i) } }, , function (e, t, n) { var a = n(101), i = n(4)("iterator"), r = n(26); e.exports = n(0).getIteratorMethod = function (e) { if (void 0 != e) return e[i] || e["@@iterator"] || r[a(e)] } }, function (e, t, n) { "use strict"; function a(e) { var t, n; this.promise = new e(function (e, a) { if (void 0 !== t || void 0 !== n) throw TypeError("Bad Promise constructor"); t = e, n = a }), this.resolve = i(t), this.reject = i(n) } var i = n(44); e.exports.f = function (e) { return new a(e) } }, function (e, t, n) { e.exports = { default: n(191), __esModule: !0 } }, function (e, t) { }, , function (e, t, n) { var a = n(3).document; e.exports = a && a.documentElement }, function (e, t, n) { e.exports = { default: n(169), __esModule: !0 } }, , , , function (e, t, n) { var a = n(42), i = n(25), r = n(15), o = n(56), s = n(13), l = n(84), c = Object.getOwnPropertyDescriptor; t.f = n(11) ? c : function (e, t) { if (e = r(e), t = o(t, !0), l) try { return c(e, t) } catch (e) { } if (s(e, t)) return i(!a.f.call(e, t), e[t]) } }, function (e, t, n) { var a = n(30); e.exports = Object("z").propertyIsEnumerable(0) ? Object : function (e) { return "String" == a(e) ? e.split("") : Object(e) } }, function (e, t, n) { var a = n(30), i = n(4)("toStringTag"), r = "Arguments" == a(function () { return arguments }()), o = function (e, t) { try { return e[t] } catch (e) { } }; e.exports = function (e) { var t, n, s; return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof (n = o(t = Object(e), i)) ? n : r ? a(t) : "Object" == (s = a(t)) && "function" == typeof t.callee ? "Arguments" : s } }, function (e, t, n) { var a = n(13), i = n(39), r = n(57)("IE_PROTO"), o = Object.prototype; e.exports = Object.getPrototypeOf || function (e) { return e = i(e), a(e, r) ? e[r] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? o : null } }, function (e, t, n) { var a = n(10); e.exports = function (e, t, n, i) { try { return i ? t(a(n)[0], n[1]) : t(n) } catch (t) { var r = e.return; throw void 0 !== r && a(r.call(e)), t } } }, function (e, t, n) { var a = n(26), i = n(4)("iterator"), r = Array.prototype; e.exports = function (e) { return void 0 !== e && (a.Array === e || r[i] === e) } }, function (e, t, n) { var a = n(4)("iterator"), i = !1; try { var r = [7][a](); r.return = function () { i = !0 }, Array.from(r, function () { throw 2 }) } catch (e) { } e.exports = function (e, t) { if (!t && !i) return !1; var n = !1; try { var r = [7], o = r[a](); o.next = function () { return { done: n = !0 } }, r[a] = function () { return o }, e(r) } catch (e) { } return n } }, function (e, t, n) { "use strict"; t.__esModule = !0; var a = n(117), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); t.default = function (e) { if (Array.isArray(e)) { for (var t = 0, n = Array(e.length); t < e.length; t++)n[t] = e[t]; return n } return (0, i.default)(e) } }, function (e, t, n) { var a = n(0), i = a.JSON || (a.JSON = { stringify: JSON.stringify }); e.exports = function (e) { return i.stringify.apply(i, arguments) } }, function (e, t, n) { var a = n(9), i = n(0), r = n(18); e.exports = function (e, t) { var n = (i.Object || {})[e] || Object[e], o = {}; o[e] = t(n), a(a.S + a.F * r(function () { n(1) }), "Object", o) } }, function (e, t, n) { var a = n(10), i = n(44), r = n(4)("species"); e.exports = function (e, t) { var n, o = a(e).constructor; return void 0 === o || void 0 == (n = a(o)[r]) ? t : i(n) } }, function (e, t, n) { var a, i, r, o = n(28), s = n(193), l = n(94), c = n(62), d = n(3), u = d.process, f = d.setImmediate, p = d.clearImmediate, h = d.MessageChannel, g = d.Dispatch, m = 0, v = {}, y = function () { var e = +this; if (v.hasOwnProperty(e)) { var t = v[e]; delete v[e], t() } }, _ = function (e) { y.call(e.data) }; f && p || (f = function (e) { for (var t = [], n = 1; arguments.length > n;)t.push(arguments[n++]); return v[++m] = function () { s("function" == typeof e ? e : Function(e), t) }, a(m), m }, p = function (e) { delete v[e] }, "process" == n(30)(u) ? a = function (e) { u.nextTick(o(y, e, 1)) } : g && g.now ? a = function (e) { g.now(o(y, e, 1)) } : h ? (i = new h, r = i.port2, i.port1.onmessage = _, a = o(r.postMessage, r, 1)) : d.addEventListener && "function" == typeof postMessage && !d.importScripts ? (a = function (e) { d.postMessage(e + "", "*") }, d.addEventListener("message", _, !1)) : a = "onreadystatechange" in c("script") ? function (e) { l.appendChild(c("script")).onreadystatechange = function () { l.removeChild(this), y.call(e) } } : function (e) { setTimeout(o(y, e, 1), 0) }), e.exports = { set: f, clear: p } }, function (e, t) { e.exports = function (e) { try { return { e: !1, v: e() } } catch (e) { return { e: !0, v: e } } } }, function (e, t, n) { var a = n(10), i = n(17), r = n(90); e.exports = function (e, t) { if (a(e), i(t) && t.constructor === e) return t; var n = r.f(e); return (0, n.resolve)(t), n.promise } }, function (e, t, n) { "use strict"; function a(e, t) { if (1 === arguments.length) { for (var n = e[0], i = 1; i < e.length; i++)n = a(n, e[i]); return n } for (var r in t) if ("class" === r) { var o = e[r] || []; e[r] = (Array.isArray(o) ? o : [o]).concat(t[r] || []) } else if ("style" === r) { var o = s(e[r]), l = s(t[r]); e[r] = o + l } else e[r] = t[r]; return e } function i(e, t) { for (var n, a = "", i = "", r = Array.isArray(t), s = 0; s < e.length; s++)(n = o(e[s])) && (r && t[s] && (n = d(n)), a = a + i + n, i = " "); return a } function r(e) { var t = "", n = ""; for (var a in e) a && e[a] && f.call(e, a) && (t = t + n + a, n = " "); return t } function o(e, t) { return Array.isArray(e) ? i(e, t) : e && "object" == typeof e ? r(e) : e || "" } function s(e) { if (!e) return ""; if ("object" == typeof e) { var t = ""; for (var n in e) f.call(e, n) && (t = t + n + ":" + e[n] + ";"); return t } return e += "", ";" !== e[e.length - 1] ? e + ";" : e } function l(e, t, n, a) { return t !== !1 && null != t && (t || "class" !== e && "style" !== e) ? t === !0 ? " " + (a ? e : e + '="' + e + '"') : ("function" == typeof t.toJSON && (t = t.toJSON()), "string" == typeof t || (t = JSON.stringify(t), n || t.indexOf('"') === -1) ? (n && (t = d(t)), " " + e + '="' + t + '"') : " " + e + "='" + t.replace(/'/g, "&#39;") + "'") : "" } function c(e, t) { var n = ""; for (var a in e) if (f.call(e, a)) { var i = e[a]; if ("class" === a) { i = o(i), n = l(a, i, !1, t) + n; continue } "style" === a && (i = s(i)), n += l(a, i, !1, t) } return n } function d(e) { var t = "" + e, n = p.exec(t); if (!n) return e; var a, i, r, o = ""; for (a = n.index, i = 0; a < t.length; a++) { switch (t.charCodeAt(a)) { case 34: r = "&quot;"; break; case 38: r = "&amp;"; break; case 60: r = "&lt;"; break; case 62: r = "&gt;"; break; default: continue }i !== a && (o += t.substring(i, a)), i = a + 1, o += r } return i !== a ? o + t.substring(i, a) : o } function u(e, t, a, i) { if (!(e instanceof Error)) throw e; if (!("undefined" == typeof window && t || i)) throw e.message += " on line " + a, e; try { i = i || n(181).readFileSync(t, "utf8") } catch (t) { u(e, null, a) } var r = 3, o = i.split("\n"), s = Math.max(a - r, 0), l = Math.min(o.length, a + r), r = o.slice(s, l).map(function (e, t) { var n = t + s + 1; return (n == a ? "  > " : "    ") + n + "| " + e }).join("\n"); throw e.path = t, e.message = (t || "Pug") + ":" + a + "\n" + r + "\n\n" + e.message, e } var f = Object.prototype.hasOwnProperty; t.merge = a, t.classes = o, t.style = s, t.attr = l, t.attrs = c; var p = /["&<>]/; t.escape = d, t.rethrow = u }, function (e, t, n) { var a = n(36)("meta"), i = n(17), r = n(13), o = n(8).f, s = 0, l = Object.isExtensible || function () { return !0 }, c = !n(18)(function () { return l(Object.preventExtensions({})) }), d = function (e) { o(e, a, { value: { i: "O" + ++s, w: {} } }) }, u = function (e, t) { if (!i(e)) return "symbol" == typeof e ? e : ("string" == typeof e ? "S" : "P") + e; if (!r(e, a)) { if (!l(e)) return "F"; if (!t) return "E"; d(e) } return e[a].i }, f = function (e, t) { if (!r(e, a)) { if (!l(e)) return !0; if (!t) return !1; d(e) } return e[a].w }, p = function (e) { return c && h.NEED && l(e) && !r(e, a) && d(e), e }, h = e.exports = { KEY: a, NEED: !1, fastKey: u, getWeak: f, onFreeze: p } }, function (e, t) { e.exports = function (e, t) { return { value: t, done: !!e } } }, function (e, t, n) { var a = n(30); e.exports = Array.isArray || function (e) { return "Array" == a(e) } }, function (e, t, n) { e.exports = { default: n(171), __esModule: !0 } }, function (e, t, n) { n(119), n(122), n(133), n(137), e.exports = n(23).Promise }, function (e, t, n) { "use strict"; var a = n(46), i = {}; i[n(1)("toStringTag")] = "z", i + "" != "[object z]" && n(19)(Object.prototype, "toString", function () { return "[object " + a(this) + "]" }, !0) }, function (e, t, n) { e.exports = !n(21) && !n(73)(function () { return 7 != Object.defineProperty(n(48)("div"), "a", { get: function () { return 7 } }).a }) }, function (e, t, n) { var a = n(20); e.exports = function (e, t) { if (!a(e)) return e; var n, i; if (t && "function" == typeof (n = e.toString) && !a(i = n.call(e))) return i; if ("function" == typeof (n = e.valueOf) && !a(i = n.call(e))) return i; if (!t && "function" == typeof (n = e.toString) && !a(i = n.call(e))) return i; throw TypeError("Can't convert object to primitive value") } }, function (e, t, n) { "use strict"; var a = n(123)(!0); n(75)(String, "String", function (e) { this._t = String(e), this._i = 0 }, function () { var e, t = this._t, n = this._i; return n >= t.length ? { value: void 0, done: !0 } : (e = a(t, n), this._i += e.length, { value: e, done: !1 }) }) }, function (e, t, n) { var a = n(49), i = n(50); e.exports = function (e) { return function (t, n) { var r, o, s = String(i(t)), l = a(n), c = s.length; return l < 0 || l >= c ? e ? "" : void 0 : (r = s.charCodeAt(l), r < 55296 || r > 56319 || l + 1 === c || (o = s.charCodeAt(l + 1)) < 56320 || o > 57343 ? e ? s.charAt(l) : r : e ? s.slice(l, l + 2) : o - 56320 + (r - 55296 << 10) + 65536) } } }, function (e, t, n) { "use strict"; var a = n(125), i = n(74), r = n(53), o = {}; n(16)(o, n(1)("iterator"), function () { return this }), e.exports = function (e, t, n) { e.prototype = a(o, { next: i(1, n) }), r(e, t + " Iterator") } }, function (e, t, n) { var a = n(12), i = n(126), r = n(80), o = n(52)("IE_PROTO"), s = function () { }, l = function () { var e, t = n(48)("iframe"), a = r.length; for (t.style.display = "none", n(81).appendChild(t), t.src = "javascript:", e = t.contentWindow.document, e.open(), e.write("<script>document.F=Object</script>"), e.close(), l = e.F; a--;)delete l.prototype[r[a]]; return l() }; e.exports = Object.create || function (e, t) { var n; return null !== e ? (s.prototype = a(e), n = new s, s.prototype = null, n[o] = e) : n = l(), void 0 === t ? n : i(n, t) } }, function (e, t, n) { var a = n(33), i = n(12), r = n(78); e.exports = n(21) ? Object.defineProperties : function (e, t) { i(e); for (var n, o = r(t), s = o.length, l = 0; s > l;)a.f(e, n = o[l++], t[n]); return e } }, function (e, t, n) { var a = n(22), i = n(51), r = n(129)(!1), o = n(52)("IE_PROTO"); e.exports = function (e, t) { var n, s = i(e), l = 0, c = []; for (n in s) n != o && a(s, n) && c.push(n); for (; t.length > l;)a(s, n = t[l++]) && (~r(c, n) || c.push(n)); return c } }, function (e, t, n) { var a = n(32); e.exports = Object("z").propertyIsEnumerable(0) ? Object : function (e) { return "String" == a(e) ? e.split("") : Object(e) } }, function (e, t, n) { var a = n(51), i = n(79), r = n(130); e.exports = function (e) { return function (t, n, o) { var s, l = a(t), c = i(l.length), d = r(o, c); if (e && n != n) { for (; c > d;)if ((s = l[d++]) != s) return !0 } else for (; c > d; d++)if ((e || d in l) && l[d] === n) return e || d || 0; return !e && -1 } } }, function (e, t, n) { var a = n(49), i = Math.max, r = Math.min; e.exports = function (e, t) { return e = a(e), e < 0 ? i(e + t, 0) : r(e, t) } }, function (e, t, n) { var a = n(22), i = n(132), r = n(52)("IE_PROTO"), o = Object.prototype; e.exports = Object.getPrototypeOf || function (e) { return e = i(e), a(e, r) ? e[r] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? o : null } }, function (e, t, n) { var a = n(50); e.exports = function (e) { return Object(a(e)) } }, function (e, t, n) { for (var a = n(134), i = n(78), r = n(19), o = n(5), s = n(16), l = n(24), c = n(1), d = c("iterator"), u = c("toStringTag"), f = l.Array, p = { CSSRuleList: !0, CSSStyleDeclaration: !1, CSSValueList: !1, ClientRectList: !1, DOMRectList: !1, DOMStringList: !1, DOMTokenList: !0, DataTransferItemList: !1, FileList: !1, HTMLAllCollection: !1, HTMLCollection: !1, HTMLFormElement: !1, HTMLSelectElement: !1, MediaList: !0, MimeTypeArray: !1, NamedNodeMap: !1, NodeList: !0, PaintRequestList: !1, Plugin: !1, PluginArray: !1, SVGLengthList: !1, SVGNumberList: !1, SVGPathSegList: !1, SVGPointList: !1, SVGStringList: !1, SVGTransformList: !1, SourceBufferList: !1, StyleSheetList: !0, TextTrackCueList: !1, TextTrackList: !1, TouchList: !1 }, h = i(p), g = 0; g < h.length; g++) { var m, v = h[g], y = p[v], _ = o[v], b = _ && _.prototype; if (b && (b[d] || s(b, d, f), b[u] || s(b, u, v), l[v] = f, y)) for (m in a) b[m] || r(b, m, a[m], !0) } }, function (e, t, n) { "use strict"; var a = n(135), i = n(136), r = n(24), o = n(51); e.exports = n(75)(Array, "Array", function (e, t) { this._t = o(e), this._i = 0, this._k = t }, function () { var e = this._t, t = this._k, n = this._i++; return !e || n >= e.length ? (this._t = void 0, i(1)) : "keys" == t ? i(0, n) : "values" == t ? i(0, e[n]) : i(0, [n, e[n]]) }, "values"), r.Arguments = r.Array, a("keys"), a("values"), a("entries") }, function (e, t, n) { var a = n(1)("unscopables"), i = Array.prototype; void 0 == i[a] && n(16)(i, a, {}), e.exports = function (e) { i[a][e] = !0 } }, function (e, t) { e.exports = function (e, t) { return { value: t, done: !!e } } }, function (e, t, n) {
  "use strict"; var a, i, r, o, s = n(76), l = n(5), c = n(34), d = n(46), u = n(77), f = n(20), p = n(35), h = n(138), g = n(139), m = n(143), v = n(82).set, y = n(145)(), _ = n(83), b = n(146), w = n(147), C = l.TypeError, S = l.process, k = l.Promise, x = "process" == d(S), D = function () { }, T = i = _.f, E = !!function () { try { var e = k.resolve(1), t = (e.constructor = {})[n(1)("species")] = function (e) { e(D, D) }; return (x || "function" == typeof PromiseRejectionEvent) && e.then(D) instanceof t } catch (e) { } }(), L = function (e) { var t; return !(!f(e) || "function" != typeof (t = e.then)) && t }, A = function (e, t) { if (!e._n) { e._n = !0; var n = e._c; y(function () { for (var a = e._v, i = 1 == e._s, r = 0; n.length > r;)!function (t) { var n, r, o = i ? t.ok : t.fail, s = t.resolve, l = t.reject, c = t.domain; try { o ? (i || (2 == e._h && O(e), e._h = 1), o === !0 ? n = a : (c && c.enter(), n = o(a), c && c.exit()), n === t.promise ? l(C("Promise-chain cycle")) : (r = L(n)) ? r.call(n, s, l) : s(n)) : l(a) } catch (e) { l(e) } }(n[r++]); e._c = [], e._n = !1, t && !e._h && $(e) }) } }, $ = function (e) { v.call(l, function () { var t, n, a, i = e._v, r = I(e); if (r && (t = b(function () { x ? S.emit("unhandledRejection", i, e) : (n = l.onunhandledrejection) ? n({ promise: e, reason: i }) : (a = l.console) && a.error && a.error("Unhandled promise rejection", i) }), e._h = x || I(e) ? 2 : 1), e._a = void 0, r && t.e) throw t.v }) }, I = function (e) { if (1 == e._h) return !1; for (var t, n = e._a || e._c, a = 0; n.length > a;)if (t = n[a++], t.fail || !I(t.promise)) return !1; return !0 }, O = function (e) { v.call(l, function () { var t; x ? S.emit("rejectionHandled", e) : (t = l.onrejectionhandled) && t({ promise: e, reason: e._v }) }) }, F = function (e) { var t = this; t._d || (t._d = !0, t = t._w || t, t._v = e, t._s = 2, t._a || (t._a = t._c.slice()), A(t, !0)) }, M = function (e) { var t, n = this; if (!n._d) { n._d = !0, n = n._w || n; try { if (n === e) throw C("Promise can't be resolved itself"); (t = L(e)) ? y(function () { var a = { _w: n, _d: !1 }; try { t.call(e, c(M, a, 1), c(F, a, 1)) } catch (e) { F.call(a, e) } }) : (n._v = e, n._s = 1, A(n, !1)) } catch (e) { F.call({ _w: n, _d: !1 }, e) } } }; E || (k = function (e) { h(this, k, "Promise", "_h"), p(e), a.call(this); try { e(c(M, this, 1), c(F, this, 1)) } catch (e) { F.call(this, e) } }, a = function (e) { this._c = [], this._a = void 0, this._s = 0, this._d = !1, this._v = void 0, this._h = 0, this._n = !1 }, a.prototype = n(148)(k.prototype, { then: function (e, t) { var n = T(m(this, k)); return n.ok = "function" != typeof e || e, n.fail = "function" == typeof t && t, n.domain = x ? S.domain : void 0, this._c.push(n), this._a && this._a.push(n), this._s && A(this, !1), n.promise }, catch: function (e) { return this.then(void 0, e) } }), r = function () { var e = new a; this.promise = e, this.resolve = c(M, e, 1), this.reject = c(F, e, 1) }, _.f = T = function (e) { return e === k || e === o ? new r(e) : i(e) }), u(u.G + u.W + u.F * !E, { Promise: k }), n(53)(k, "Promise"), n(149)("Promise"), o = n(23).Promise, u(u.S + u.F * !E, "Promise", { reject: function (e) { var t = T(this); return (0, t.reject)(e), t.promise } }), u(u.S + u.F * (s || !E), "Promise", { resolve: function (e) { return w(s && this === o ? k : this, e) } }),
    u(u.S + u.F * !(E && n(150)(function (e) { k.all(e).catch(D) })), "Promise", { all: function (e) { var t = this, n = T(t), a = n.resolve, i = n.reject, r = b(function () { var n = [], r = 0, o = 1; g(e, !1, function (e) { var s = r++, l = !1; n.push(void 0), o++, t.resolve(e).then(function (e) { l || (l = !0, n[s] = e, --o || a(n)) }, i) }), --o || a(n) }); return r.e && i(r.v), n.promise }, race: function (e) { var t = this, n = T(t), a = n.reject, i = b(function () { g(e, !1, function (e) { t.resolve(e).then(n.resolve, a) }) }); return i.e && a(i.v), n.promise } })
}, function (e, t) { e.exports = function (e, t, n, a) { if (!(e instanceof t) || void 0 !== a && a in e) throw TypeError(n + ": incorrect invocation!"); return e } }, function (e, t, n) { var a = n(34), i = n(140), r = n(141), o = n(12), s = n(79), l = n(142), c = {}, d = {}, t = e.exports = function (e, t, n, u, f) { var p, h, g, m, v = f ? function () { return e } : l(e), y = a(n, u, t ? 2 : 1), _ = 0; if ("function" != typeof v) throw TypeError(e + " is not iterable!"); if (r(v)) { for (p = s(e.length); p > _; _++)if ((m = t ? y(o(h = e[_])[0], h[1]) : y(e[_])) === c || m === d) return m } else for (g = v.call(e); !(h = g.next()).done;)if ((m = i(g, y, h.value, t)) === c || m === d) return m }; t.BREAK = c, t.RETURN = d }, function (e, t, n) { var a = n(12); e.exports = function (e, t, n, i) { try { return i ? t(a(n)[0], n[1]) : t(n) } catch (t) { var r = e.return; throw void 0 !== r && a(r.call(e)), t } } }, function (e, t, n) { var a = n(24), i = n(1)("iterator"), r = Array.prototype; e.exports = function (e) { return void 0 !== e && (a.Array === e || r[i] === e) } }, function (e, t, n) { var a = n(46), i = n(1)("iterator"), r = n(24); e.exports = n(23).getIteratorMethod = function (e) { if (void 0 != e) return e[i] || e["@@iterator"] || r[a(e)] } }, function (e, t, n) { var a = n(12), i = n(35), r = n(1)("species"); e.exports = function (e, t) { var n, o = a(e).constructor; return void 0 === o || void 0 == (n = a(o)[r]) ? t : i(n) } }, function (e, t) { e.exports = function (e, t, n) { var a = void 0 === n; switch (t.length) { case 0: return a ? e() : e.call(n); case 1: return a ? e(t[0]) : e.call(n, t[0]); case 2: return a ? e(t[0], t[1]) : e.call(n, t[0], t[1]); case 3: return a ? e(t[0], t[1], t[2]) : e.call(n, t[0], t[1], t[2]); case 4: return a ? e(t[0], t[1], t[2], t[3]) : e.call(n, t[0], t[1], t[2], t[3]) }return e.apply(n, t) } }, function (e, t, n) { var a = n(5), i = n(82).set, r = a.MutationObserver || a.WebKitMutationObserver, o = a.process, s = a.Promise, l = "process" == n(32)(o); e.exports = function () { var e, t, n, c = function () { var a, i; for (l && (a = o.domain) && a.exit(); e;) { i = e.fn, e = e.next; try { i() } catch (a) { throw e ? n() : t = void 0, a } } t = void 0, a && a.enter() }; if (l) n = function () { o.nextTick(c) }; else if (r) { var d = !0, u = document.createTextNode(""); new r(c).observe(u, { characterData: !0 }), n = function () { u.data = d = !d } } else if (s && s.resolve) { var f = s.resolve(); n = function () { f.then(c) } } else n = function () { i.call(a, c) }; return function (a) { var i = { fn: a, next: void 0 }; t && (t.next = i), e || (e = i, n()), t = i } } }, function (e, t) { e.exports = function (e) { try { return { e: !1, v: e() } } catch (e) { return { e: !0, v: e } } } }, function (e, t, n) { var a = n(12), i = n(20), r = n(83); e.exports = function (e, t) { if (a(e), i(t) && t.constructor === e) return t; var n = r.f(e); return (0, n.resolve)(t), n.promise } }, function (e, t, n) { var a = n(19); e.exports = function (e, t, n) { for (var i in t) a(e, i, t[i], n); return e } }, function (e, t, n) { "use strict"; var a = n(5), i = n(33), r = n(21), o = n(1)("species"); e.exports = function (e) { var t = a[e]; r && t && !t[o] && i.f(t, o, { configurable: !0, get: function () { return this } }) } }, function (e, t, n) { var a = n(1)("iterator"), i = !1; try { var r = [7][a](); r.return = function () { i = !0 }, Array.from(r, function () { throw 2 }) } catch (e) { } e.exports = function (e, t) { if (!t && !i) return !1; var n = !1; try { var r = [7], o = r[a](); o.next = function () { return { done: n = !0 } }, r[a] = function () { return o }, e(r) } catch (e) { } return n } }, function (e, t, n) { var a = n(54), i = n(55); e.exports = function (e) { return function (t, n) { var r, o, s = String(i(t)), l = a(n), c = s.length; return l < 0 || l >= c ? e ? "" : void 0 : (r = s.charCodeAt(l), r < 55296 || r > 56319 || l + 1 === c || (o = s.charCodeAt(l + 1)) < 56320 || o > 57343 ? e ? s.charAt(l) : r : e ? s.slice(l, l + 2) : o - 56320 + (r - 55296 << 10) + 65536) } } }, function (e, t, n) { "use strict"; var a = n(64), i = n(25), r = n(37), o = {}; n(14)(o, n(4)("iterator"), function () { return this }), e.exports = function (e, t, n) { e.prototype = a(o, { next: i(1, n) }), r(e, t + " Iterator") } }, function (e, t, n) { var a = n(8), i = n(10), r = n(29); e.exports = n(11) ? Object.defineProperties : function (e, t) { i(e); for (var n, o = r(t), s = o.length, l = 0; s > l;)a.f(e, n = o[l++], t[n]); return e } }, function (e, t, n) { var a = n(15), i = n(63), r = n(155); e.exports = function (e) { return function (t, n, o) { var s, l = a(t), c = i(l.length), d = r(o, c); if (e && n != n) { for (; c > d;)if ((s = l[d++]) != s) return !0 } else for (; c > d; d++)if ((e || d in l) && l[d] === n) return e || d || 0; return !e && -1 } } }, function (e, t, n) { var a = n(54), i = Math.max, r = Math.min; e.exports = function (e, t) { return e = a(e), e < 0 ? i(e + t, 0) : r(e, t) } }, function (e, t, n) { "use strict"; var a = n(157), i = n(115), r = n(26), o = n(15); e.exports = n(71)(Array, "Array", function (e, t) { this._t = o(e), this._i = 0, this._k = t }, function () { var e = this._t, t = this._k, n = this._i++; return !e || n >= e.length ? (this._t = void 0, i(1)) : "keys" == t ? i(0, n) : "values" == t ? i(0, e[n]) : i(0, [n, e[n]]) }, "values"), r.Arguments = r.Array, a("keys"), a("values"), a("entries") }, function (e, t) { e.exports = function () { } }, function (e, t, n) { e.exports = { default: n(159), __esModule: !0 } }, function (e, t, n) { n(45), n(66), e.exports = n(60).f("iterator") }, function (e, t, n) { e.exports = { default: n(161), __esModule: !0 } }, function (e, t, n) { n(162), n(92), n(165), n(166), e.exports = n(0).Symbol }, function (e, t, n) { "use strict"; var a = n(3), i = n(13), r = n(11), o = n(9), s = n(85), l = n(114).KEY, c = n(18), d = n(58), u = n(37), f = n(36), p = n(4), h = n(60), g = n(61), m = n(163), v = n(116), y = n(10), _ = n(15), b = n(56), w = n(25), C = n(64), S = n(164), k = n(99), x = n(8), D = n(29), T = k.f, E = x.f, L = S.f, A = a.Symbol, $ = a.JSON, I = $ && $.stringify, O = p("_hidden"), F = p("toPrimitive"), M = {}.propertyIsEnumerable, N = d("symbol-registry"), R = d("symbols"), P = d("op-symbols"), B = Object.prototype, j = "function" == typeof A, z = a.QObject, q = !z || !z.prototype || !z.prototype.findChild, H = r && c(function () { return 7 != C(E({}, "a", { get: function () { return E(this, "a", { value: 7 }).a } })).a }) ? function (e, t, n) { var a = T(B, t); a && delete B[t], E(e, t, n), a && e !== B && E(B, t, a) } : E, V = function (e) { var t = R[e] = C(A.prototype); return t._k = e, t }, W = j && "symbol" == typeof A.iterator ? function (e) { return "symbol" == typeof e } : function (e) { return e instanceof A }, U = function (e, t, n) { return e === B && U(P, t, n), y(e), t = b(t, !0), y(n), i(R, t) ? (n.enumerable ? (i(e, O) && e[O][t] && (e[O][t] = !1), n = C(n, { enumerable: w(0, !1) })) : (i(e, O) || E(e, O, w(1, {})), e[O][t] = !0), H(e, t, n)) : E(e, t, n) }, G = function (e, t) { y(e); for (var n, a = m(t = _(t)), i = 0, r = a.length; r > i;)U(e, n = a[i++], t[n]); return e }, J = function (e, t) { return void 0 === t ? C(e) : G(C(e), t) }, X = function (e) { var t = M.call(this, e = b(e, !0)); return !(this === B && i(R, e) && !i(P, e)) && (!(t || !i(this, e) || !i(R, e) || i(this, O) && this[O][e]) || t) }, Y = function (e, t) { if (e = _(e), t = b(t, !0), e !== B || !i(R, t) || i(P, t)) { var n = T(e, t); return !n || !i(R, t) || i(e, O) && e[O][t] || (n.enumerable = !0), n } }, K = function (e) { for (var t, n = L(_(e)), a = [], r = 0; n.length > r;)i(R, t = n[r++]) || t == O || t == l || a.push(t); return a }, Q = function (e) { for (var t, n = e === B, a = L(n ? P : _(e)), r = [], o = 0; a.length > o;)!i(R, t = a[o++]) || n && !i(B, t) || r.push(R[t]); return r }; j || (A = function () { if (this instanceof A) throw TypeError("Symbol is not a constructor!"); var e = f(arguments.length > 0 ? arguments[0] : void 0), t = function (n) { this === B && t.call(P, n), i(this, O) && i(this[O], e) && (this[O][e] = !1), H(this, e, w(1, n)) }; return r && q && H(B, e, { configurable: !0, set: t }), V(e) }, s(A.prototype, "toString", function () { return this._k }), k.f = Y, x.f = U, n(87).f = S.f = K, n(42).f = X, n(65).f = Q, r && !n(38) && s(B, "propertyIsEnumerable", X, !0), h.f = function (e) { return V(p(e)) }), o(o.G + o.W + o.F * !j, { Symbol: A }); for (var Z = "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","), ee = 0; Z.length > ee;)p(Z[ee++]); for (var te = D(p.store), ne = 0; te.length > ne;)g(te[ne++]); o(o.S + o.F * !j, "Symbol", { for: function (e) { return i(N, e += "") ? N[e] : N[e] = A(e) }, keyFor: function (e) { if (!W(e)) throw TypeError(e + " is not a symbol!"); for (var t in N) if (N[t] === e) return t }, useSetter: function () { q = !0 }, useSimple: function () { q = !1 } }), o(o.S + o.F * !j, "Object", { create: J, defineProperty: U, defineProperties: G, getOwnPropertyDescriptor: Y, getOwnPropertyNames: K, getOwnPropertySymbols: Q }), $ && o(o.S + o.F * (!j || c(function () { var e = A(); return "[null]" != I([e]) || "{}" != I({ a: e }) || "{}" != I(Object(e)) })), "JSON", { stringify: function (e) { if (void 0 !== e && !W(e)) { for (var t, n, a = [e], i = 1; arguments.length > i;)a.push(arguments[i++]); return t = a[1], "function" == typeof t && (n = t), !n && v(t) || (t = function (e, t) { if (n && (t = n.call(this, e, t)), !W(t)) return t }), a[1] = t, I.apply($, a) } } }), A.prototype[F] || n(14)(A.prototype, F, A.prototype.valueOf), u(A, "Symbol"), u(Math, "Math", !0), u(a.JSON, "JSON", !0) }, function (e, t, n) { var a = n(29), i = n(65), r = n(42); e.exports = function (e) { var t = a(e), n = i.f; if (n) for (var o, s = n(e), l = r.f, c = 0; s.length > c;)l.call(e, o = s[c++]) && t.push(o); return t } }, function (e, t, n) { var a = n(15), i = n(87).f, r = {}.toString, o = "object" == typeof window && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) : [], s = function (e) { try { return i(e) } catch (e) { return o.slice() } }; e.exports.f = function (e) { return o && "[object Window]" == r.call(e) ? s(e) : i(a(e)) } }, function (e, t, n) { n(61)("asyncIterator") }, function (e, t, n) { n(61)("observable") }, , , function (e, t, n) { n(170); var a = n(0).Object; e.exports = function (e, t, n) { return a.defineProperty(e, t, n) } }, function (e, t, n) { var a = n(9); a(a.S + a.F * !n(11), "Object", { defineProperty: n(8).f }) }, function (e, t, n) { n(45), n(172), e.exports = n(0).Array.from }, function (e, t, n) { "use strict"; var a = n(28), i = n(9), r = n(39), o = n(103), s = n(104), l = n(63), c = n(173), d = n(89); i(i.S + i.F * !n(105)(function (e) { Array.from(e) }), "Array", { from: function (e) { var t, n, i, u, f = r(e), p = "function" == typeof this ? this : Array, h = arguments.length, g = h > 1 ? arguments[1] : void 0, m = void 0 !== g, v = 0, y = d(f); if (m && (g = a(g, h > 2 ? arguments[2] : void 0, 2)), void 0 == y || p == Array && s(y)) for (t = l(f.length), n = new p(t); t > v; v++)c(n, v, m ? g(f[v], v) : f[v]); else for (u = y.call(f), n = new p; !(i = u.next()).done; v++)c(n, v, m ? o(u, g, [i.value, v], !0) : i.value); return n.length = v, n } }) }, function (e, t, n) { "use strict"; var a = n(8), i = n(25); e.exports = function (e, t, n) { t in e ? a.f(e, t, i(0, n)) : e[t] = n } }, function (e, t, n) { "use strict"; !function () { angular.module("BC.common").directive("selectSearchList", ["$rootScope", "$timeout", "$jsTipTranslate", "chooseAdminService", function (e, t, n, a) { return { restrict: "A", templateUrl: "/static/common/tpl/selectSearchList.html", replace: !0, scope: { selectData: "=", searchList: "=", noSearch: "=", defaultPlaceHolder: "=", valChange: "&", selectClick: "&", showListLoading: "=", workSheetFlag: "=", selectDataObj: "=", ordinaryUser: "=" }, link: function (e, i, r) { function o() { var t = e.viewData.modeType; switch (e.viewData.originalList = angular.copy(e.searchList), e.viewData.searchList = angular.copy(e.searchList), t) { case "tableFilter": case "ruleFilterField": c = "fid", d = "name"; break; case "joinSelect": c = "fid", d = "original_nick_name"; break; case "mlModelSelector": c = "ml_id", d = "name"; break; case "queryAccount": c = "userid", d = "name"; break; case "projManager": case "dashManager": case "queryManager": c = "userid", d = "name"; break; case "opLog": c = "id", d = "name"; break; case "schemeList": c = "scheme_id", d = "name"; break; case "ruleCreator": c = "user_id", d = "creator"; break; case "ruleFilterTb": c = "tb_id", d = "name"; break; case "ruleFilterOpt": case "warnFilterOpt": c = "value", d = "name"; break; case "paramType": c = "key", d = "name"; break; case "warnFilterField": c = "fidUniqId", d = "name"; break; default: c = "key", d = "value" }e.viewData.displayKey = d } function s(e, t) { return e.toLowerCase().indexOf(t.toLowerCase()) >= 0 } var l = $.cookie("locale") || "zh", c = "", d = "", u = "en" == l ? "Select" : "请选择"; !function () { e.viewData = { defaultPlaceHolder: e.defaultPlaceHolder || u, selectedText: "", selectedVal: "", searchList: [], originalList: [], searchQuery: "", showList: !1, displayKey: "", modeType: r.modeType, queryBoxShow: !e.noSearch && "false" != r.queryBoxShow, hitQueryNum: 0, showListLoading: !1, requestListFlag: !!r.requestList, mode: r.mode, needAsync: r.needAsync, position: r.position, dataSourcePlaceHolder: "全部数据源", dataSourceList: [], showDataSource: !1, dataTypePlaceHolder: "全部工作表类型", dataTypeList: [], showDataType: !1 }, e.viewData.dataSourceList = [{ dataSource: "全部数据来源", num: 0 }, { dataSource: "非授权数据", num: 1 }, { dataSource: "授权数据", num: 2 }], e.viewData.dataTypeList = [{ dataType: "全部工作表类型", type: 0 }, { dataType: "基础表", type: 1 }, { dataType: "合表", type: 2 }, { dataType: "excel、csv上传", type: 3 }], e.selectDataObj && e.workSheetFlag && (e.selectDataObj = { user_id: "all", data_source: 0, data_type: 0 }), e.workSheetFlag ? e.viewData.ordinaryUserFlag = !!e.ordinaryUser : e.viewData.ordinaryUserFlag = !0 }(), e.viewData.requestListFlag ? o() : e.$watch(function () { return e.searchList }, function (e) { e && o() }), e.$watch(function () { return e.selectData }, function (t) { if (e.viewData.selectedVal = "", e.viewData.selectedText = "", e.viewData.needAsync && 0 == e.viewData.searchList.length) return void (e.viewData.selectedText = t); for (var n = e.viewData.searchList || [], a = 0, i = n.length; a < i; a++)switch (e.viewData.modeType) { case "tableFilter": e.selectData.field && e.selectData.field.fid == n[a][c] && (e.viewData.selectedVal = n[a][c], e.viewData.selectedText = n[a][d]); break; case "mlModelSelector": e.selectData == n[a][c] && (e.viewData.selectedVal = n[a][c], e.viewData.selectedText = n[a][d], e.viewData.iconClass = n[a].iconClass, e.viewData.iconId = n[a].iconId); break; default: e.selectData == n[a][c] && (e.viewData.selectedVal = n[a][c], e.viewData.selectedText = n[a][d]) } }), e.toggleList = function (n) { function i() { e.viewData.searchQuery = "", angular.forEach(e.viewData.searchList, function (e) { e.selectHit = !0 }), e.viewData.hitQueryNum = e.viewData.searchList.length } if ("disabled" != e.viewData.mode) { var r = angular.element(n.target); r = r.hasClass("bdp-icon") ? r.parents(".select-search-value:first") : r; var o = r.parents(".select-search-value:first"); o = 0 == o.length ? r : o; var s = r.offset(), l = o.next(".search-list-box"); if (e.viewData.showList = !e.viewData.showList, "relative" !== e.viewData.position) if (e.viewData.showList) { var c = s.top + r.closest(".select-search-list-wrap").height(); l.css({ position: "fixed", top: c, left: s.left, width: o.width() + 16 }), t(function () { var e = document.documentElement.clientHeight || document.body.clientHeight, t = l[0].getBoundingClientRect().height; t + s.top > e && l.css("top", s.top - t) }) } else l.css({ top: "-9999px", left: "-9999px" }); var d = e.viewData.modeType; if (e.viewData.showList && e.viewData.requestListFlag && ["projManager", "dashManager", "queryManager"].indexOf(d) >= 0) if (a.getUserListCache()) { var u = a.getUserListCache(); e.viewData.originalList = angular.copy(u), e.viewData.searchList = u, e.viewData.showListLoading = !1 } else { e.viewData.showListLoading = !0; var f = ["dashManager", "queryManager"].indexOf(d) >= 0; a.getUserList(f).then(function (t) { e.viewData.originalList = t.originWholeList, e.viewData.searchList = t.wholeList, i() }).finally(function () { e.viewData.showListLoading = !1 }) } else i(); e.selectClick && e.selectClick() } }, e.doQuery = function () { var t = 0; angular.forEach(e.viewData.searchList, function (n) { e.viewData.searchQuery ? (n.selectHit = s(n[d], e.viewData.searchQuery), n.selectHit && t++) : (n.selectHit = !0, t++) }), e.viewData.hitQueryNum = t }, e.formatSelectDataByType = function (t) { switch (e.viewData.modeType) { case "tableFilter": e.selectData.field ? e.selectData.field.fid = t : e.selectData.field = { fid: t }, d = "name"; break; default: e.selectData = t } }, e.selectItem = function (n) { e.viewData.selectedVal = n[c], e.viewData.selectedText = n[d], e.viewData.iconClass = n.iconClass, e.viewData.iconId = n.iconId, e.viewData.showList = !1, e.workSheetFlag ? e.selectDataObj.user_id = e.viewData.selectedVal : e.formatSelectDataByType(e.viewData.selectedVal), e.valChange && !e.workSheetFlag && t(function () { e.valChange({ field: e.selectData }) }, 0) }, e.$on("broadcastHideSelectList", function (n, a) { a && t(function () { e.viewData.showList = !1 }, 0) }), e.$on("broadcastReloadSelectList", function (n, a) { a && t(function () { e.viewData.originalList = angular.copy(a), e.viewData.searchList = angular.copy(a) }, 0) }), e.dataSourceSelect = function (t) { e.viewData.dataSourcePlaceHolder = t.dataSource, e.viewData.showDataSource = !1, e.selectDataObj.data_source = t.num }, e.dataTypeSelect = function (t) { e.viewData.dataTypePlaceHolder = t.dataType, e.viewData.showDataType = !1, e.selectDataObj.data_type = t.type }, e.findWorkSheet = function () { e.valChange() }, n(["wb.selectField"], e) } } }]) }() }, function (e, t, n) { n(176), e.exports = n(0).Object.keys }, function (e, t, n) { var a = n(39), i = n(29); n(108)("keys", function () { return function (e) { return i(a(e)) } }) }, function (e, t, n) { e.exports = n(178) }, function (e, t, n) {
  var a, i; !function (r, o) { a = r, void 0 !== (i = "function" == typeof a ? a.call(t, n, t, e) : a) && (e.exports = i) }(function () {
    function e(e, t) { var n = typeof e[t]; return n == b || !(n != _ || !e[t]) || "unknown" == n } function t(e, t) { return !(typeof e[t] != _ || !e[t]) } function n(e, t) { return typeof e[t] != w } function a(e) { return function (t, n) { for (var a = n.length; a--;)if (!e(t, n[a])) return !1; return !0 } } function i(e) { return e && D(e, x) && E(e, k) } function r(e) { return t(e, "body") ? e.body : e.getElementsByTagName("body")[0] } function o(t) { typeof console != w && e(console, "log") && console.log(t) } function s(e, t) { $ && t ? alert(e) : o(e) } function l(e) { O.initialized = !0, O.supported = !1, s("Rangy is not supported in this environment. Reason: " + e, O.config.alertOnFail) } function c(e) { s("Rangy warning: " + e, O.config.alertOnWarn) } function d(e) { return e.message || e.description || String(e) } function u() { if ($ && !O.initialized) { var t, n = !1, a = !1; e(document, "createRange") && (t = document.createRange(), D(t, S) && E(t, C) && (n = !0)); var s = r(document); if (!s || "body" != s.nodeName.toLowerCase()) return void l("No body element found"); if (s && e(s, "createTextRange") && (t = s.createTextRange(), i(t) && (a = !0)), !n && !a) return void l("Neither Range nor TextRange are available"); O.initialized = !0, O.features = { implementsDomRange: n, implementsTextRange: a }; var c, u; for (var f in A) (c = A[f]) instanceof g && c.init(c, O); for (var p = 0, h = N.length; p < h; ++p)try { N[p](O) } catch (e) { u = "Rangy init listener threw an exception. Continuing. Detail: " + d(e), o(u) } } } function f(e, t, n) { n && (e += " in module " + n.name), O.warn("DEPRECATED: " + e + " is deprecated. Please use " + t + " instead.") } function p(e, t, n, a) { e[t] = function () { return f(t, n, a), e[n].apply(e, I.toArray(arguments)) } } function h(e) { e = e || window, u(); for (var t = 0, n = R.length; t < n; ++t)R[t](e) } function g(e, t, n) { this.name = e, this.dependencies = t, this.initialized = !1, this.supported = !1, this.initializer = n } function m(e, t, n) { var a = new g(e, t, function (t) { if (!t.initialized) { t.initialized = !0; try { n(O, t), t.supported = !0 } catch (t) { var a = "Module '" + e + "' failed to load: " + d(t); o(a), t.stack && o(t.stack) } } }); return A[e] = a, a } function v() { } function y() { } var _ = "object", b = "function", w = "undefined", C = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], S = ["setStart", "setStartBefore", "setStartAfter", "setEnd", "setEndBefore", "setEndAfter", "collapse", "selectNode", "selectNodeContents", "compareBoundaryPoints", "deleteContents", "extractContents", "cloneContents", "insertNode", "surroundContents", "cloneRange", "toString", "detach"], k = ["boundingHeight", "boundingLeft", "boundingTop", "boundingWidth", "htmlText", "text"], x = ["collapse", "compareEndPoints", "duplicate", "moveToElementText", "parentElement", "select", "setEndPoint", "getBoundingClientRect"], D = a(e), T = a(t), E = a(n), L = [].forEach ? function (e, t) { e.forEach(t) } : function (e, t) { for (var n = 0, a = e.length; n < a; ++n)t(e[n], n) }, A = {}, $ = typeof window != w && typeof document != w, I = { isHostMethod: e, isHostObject: t, isHostProperty: n, areHostMethods: D, areHostObjects: T, areHostProperties: E, isTextRange: i, getBody: r, forEach: L }, O = { version: "1.3.0", initialized: !1, isBrowser: $, supported: !0, util: I, features: {}, modules: A, config: { alertOnFail: !1, alertOnWarn: !1, preferTextRange: !1, autoInitialize: typeof rangyAutoInitialize == w || rangyAutoInitialize } }; O.fail = l, O.warn = c; var F; !{}.hasOwnProperty ? l("hasOwnProperty not supported") : (I.extend = F = function (e, t, n) { var a, i; for (var r in t) t.hasOwnProperty(r) && (a = e[r], i = t[r], n && null !== a && "object" == typeof a && null !== i && "object" == typeof i && F(a, i, !0), e[r] = i); return t.hasOwnProperty("toString") && (e.toString = t.toString), e }, I.createOptions = function (e, t) { var n = {}; return F(n, t), e && F(n, e), n }), $ || l("Rangy can only run in a browser"), function () { var e; if ($) { var t = document.createElement("div"); t.appendChild(document.createElement("span")); var n = [].slice; try { 1 == n.call(t.childNodes, 0)[0].nodeType && (e = function (e) { return n.call(e, 0) }) } catch (e) { } } e || (e = function (e) { for (var t = [], n = 0, a = e.length; n < a; ++n)t[n] = e[n]; return t }), I.toArray = e }(); var M; $ && (e(document, "addEventListener") ? M = function (e, t, n) { e.addEventListener(t, n, !1) } : e(document, "attachEvent") ? M = function (e, t, n) { e.attachEvent("on" + t, n) } : l("Document does not have required addEventListener or attachEvent method"), I.addListener = M); var N = []; I.deprecationNotice = f, I.createAliasForDeprecatedMethod = p, O.init = u, O.addInitListener = function (e) { O.initialized ? e(O) : N.push(e) }; var R = []; O.addShimListener = function (e) { R.push(e) }, $ && (O.shim = O.createMissingNativeApi = h, p(O, "createMissingNativeApi", "shim")), g.prototype = { init: function () { for (var e, t, n = this.dependencies || [], a = 0, i = n.length; a < i; ++a) { if (t = n[a], !((e = A[t]) && e instanceof g)) throw new Error("required module '" + t + "' not found"); if (e.init(), !e.supported) throw new Error("required module '" + t + "' not supported") } this.initializer(this) }, fail: function (e) { throw this.initialized = !0, this.supported = !1, new Error(e) }, warn: function (e) { O.warn("Module " + this.name + ": " + e) }, deprecationNotice: function (e, t) { O.warn("DEPRECATED: " + e + " in module " + this.name + " is deprecated. Please use " + t + " instead") }, createError: function (e) { return new Error("Error in Rangy " + this.name + " module: " + e) } }, O.createModule = function (e) { var t, n; 2 == arguments.length ? (t = arguments[1], n = []) : (t = arguments[2], n = arguments[1]); var a = m(e, n, t); O.initialized && O.supported && a.init() }, O.createCoreModule = function (e, t, n) { m(e, t, n) }, O.RangePrototype = v, O.rangePrototype = new v, O.selectionPrototype = new y, O.createCoreModule("DomUtil", [], function (e, t) { function n(e) { var t; return typeof e.namespaceURI == $ || null === (t = e.namespaceURI) || "http://www.w3.org/1999/xhtml" == t } function a(e) { var t = e.parentNode; return 1 == t.nodeType ? t : null } function i(e) { for (var t = 0; e = e.previousSibling;)++t; return t } function r(e) { switch (e.nodeType) { case 7: case 10: return 0; case 3: case 8: return e.length; default: return e.childNodes.length } } function o(e, t) { var n, a = []; for (n = e; n; n = n.parentNode)a.push(n); for (n = t; n; n = n.parentNode)if (N(a, n)) return n; return null } function s(e, t, n) { for (var a = n ? t : t.parentNode; a;) { if (a === e) return !0; a = a.parentNode } return !1 } function l(e, t) { return s(e, t, !0) } function c(e, t, n) { for (var a, i = n ? e : e.parentNode; i;) { if ((a = i.parentNode) === t) return i; i = a } return null } function d(e) { var t = e.nodeType; return 3 == t || 4 == t || 8 == t } function u(e) { if (!e) return !1; var t = e.nodeType; return 3 == t || 8 == t } function f(e, t) { var n = t.nextSibling, a = t.parentNode; return n ? a.insertBefore(e, n) : a.appendChild(e), e } function p(e, t, n) { var a = e.cloneNode(!1); if (a.deleteData(0, t), e.deleteData(t, e.length - t), f(a, e), n) for (var r, o = 0; r = n[o++];)r.node == e && r.offset > t ? (r.node = a, r.offset -= t) : r.node == e.parentNode && r.offset > i(e) && ++r.offset; return a } function h(e) { if (9 == e.nodeType) return e; if (typeof e.ownerDocument != $) return e.ownerDocument; if (typeof e.document != $) return e.document; if (e.parentNode) return h(e.parentNode); throw t.createError("getDocument: no document found for node") } function g(e) { var n = h(e); if (typeof n.defaultView != $) return n.defaultView; if (typeof n.parentWindow != $) return n.parentWindow; throw t.createError("Cannot get a window object for node") } function m(e) { if (typeof e.contentDocument != $) return e.contentDocument; if (typeof e.contentWindow != $) return e.contentWindow.document; throw t.createError("getIframeDocument: No Document object found for iframe element") } function v(e) { if (typeof e.contentWindow != $) return e.contentWindow; if (typeof e.contentDocument != $) return e.contentDocument.defaultView; throw t.createError("getIframeWindow: No Window object found for iframe element") } function y(e) { return e && I.isHostMethod(e, "setTimeout") && I.isHostObject(e, "document") } function _(e, t, n) { var a; if (e ? I.isHostProperty(e, "nodeType") ? a = 1 == e.nodeType && "iframe" == e.tagName.toLowerCase() ? m(e) : h(e) : y(e) && (a = e.document) : a = document, !a) throw t.createError(n + "(): Parameter must be a Window object or DOM node"); return a } function b(e) { for (var t; t = e.parentNode;)e = t; return e } function w(e, n, a, r) { var s, l, d, u, f; if (e == a) return n === r ? 0 : n < r ? -1 : 1; if (s = c(a, e, !0)) return n <= i(s) ? -1 : 1; if (s = c(e, a, !0)) return i(s) < r ? -1 : 1; if (!(l = o(e, a))) throw new Error("comparePoints error: nodes have no common ancestor"); if (d = e === l ? l : c(e, l, !0), u = a === l ? l : c(a, l, !0), d === u) throw t.createError("comparePoints got to case 4 and childA and childB are the same!"); for (f = l.firstChild; f;) { if (f === d) return -1; if (f === u) return 1; f = f.nextSibling } } function C(e) { try { return e.parentNode, !1 } catch (e) { return !0 } } function S(e) { if (!e) return "[No node]"; if (R && C(e)) return "[Broken node]"; if (d(e)) return '"' + e.data + '"'; if (1 == e.nodeType) { var t = e.id ? ' id="' + e.id + '"' : ""; return "<" + e.nodeName + t + ">[index:" + i(e) + ",length:" + e.childNodes.length + "][" + (e.innerHTML || "[innerHTML not supported]").slice(0, 25) + "]" } return e.nodeName } function k(e) { for (var t, n = h(e).createDocumentFragment(); t = e.firstChild;)n.appendChild(t); return n } function x(e, t, n) { var a = O(e), i = e.createElement("div"); i.contentEditable = "" + !!n, t && (i.innerHTML = t); var r = a.firstChild; return r ? a.insertBefore(i, r) : a.appendChild(i), i } function D(e) { return e.parentNode.removeChild(e) } function T(e) { this.root = e, this._next = e } function E(e) { return new T(e) } function L(e, t) { this.node = e, this.offset = t } function A(e) { this.code = this[e], this.codeName = e, this.message = "DOMException: " + this.codeName } var $ = "undefined", I = e.util, O = I.getBody; I.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || t.fail("document missing a Node creation method"), I.isHostMethod(document, "getElementsByTagName") || t.fail("document missing getElementsByTagName method"); var F = document.createElement("div"); I.areHostMethods(F, ["insertBefore", "appendChild", "cloneNode"] || !I.areHostObjects(F, ["previousSibling", "nextSibling", "childNodes", "parentNode"])) || t.fail("Incomplete Element implementation"), I.isHostProperty(F, "innerHTML") || t.fail("Element is missing innerHTML property"); var M = document.createTextNode("test"); I.areHostMethods(M, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"] || !I.areHostObjects(F, ["previousSibling", "nextSibling", "childNodes", "parentNode"]) || !I.areHostProperties(M, ["data"])) || t.fail("Incomplete Text Node implementation"); var N = function (e, t) { for (var n = e.length; n--;)if (e[n] === t) return !0; return !1 }, R = !1; !function () { var t = document.createElement("b"); t.innerHTML = "1"; var n = t.firstChild; t.innerHTML = "<br />", R = C(n), e.features.crashyTextNodes = R }(); var P; typeof window.getComputedStyle != $ ? P = function (e, t) { return g(e).getComputedStyle(e, null)[t] } : typeof document.documentElement.currentStyle != $ ? P = function (e, t) { return e.currentStyle ? e.currentStyle[t] : "" } : t.fail("No means of obtaining computed style properties found"), T.prototype = { _current: null, hasNext: function () { return !!this._next }, next: function () { var e, t, n = this._current = this._next; if (this._current) if (e = n.firstChild) this._next = e; else { for (t = null; n !== this.root && !(t = n.nextSibling);)n = n.parentNode; this._next = t } return this._current }, detach: function () { this._current = this._next = this.root = null } }, L.prototype = { equals: function (e) { return !!e && this.node === e.node && this.offset == e.offset }, inspect: function () { return "[DomPosition(" + S(this.node) + ":" + this.offset + ")]" }, toString: function () { return this.inspect() } }, A.prototype = { INDEX_SIZE_ERR: 1, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INVALID_STATE_ERR: 11, INVALID_NODE_TYPE_ERR: 24 }, A.prototype.toString = function () { return this.message }, e.dom = { arrayContains: N, isHtmlNamespace: n, parentElement: a, getNodeIndex: i, getNodeLength: r, getCommonAncestor: o, isAncestorOf: s, isOrIsAncestorOf: l, getClosestAncestorIn: c, isCharacterDataNode: d, isTextOrCommentNode: u, insertAfter: f, splitDataNode: p, getDocument: h, getWindow: g, getIframeWindow: v, getIframeDocument: m, getBody: O, isWindow: y, getContentDocument: _, getRootContainer: b, comparePoints: w, isBrokenNode: C, inspectNode: S, getComputedStyleProperty: P, createTestElement: x, removeNode: D, fragmentFromNodeChildren: k, createIterator: E, DomPosition: L }, e.DOMException = A }), O.createCoreModule("DomRange", ["DomUtil"], function (e, t) {
      function n(e, t) { return 3 != e.nodeType && (z(e, t.startContainer) || z(e, t.endContainer)) } function a(e) { return e.document || q(e.startContainer) } function i(e) { return J(e.startContainer) } function r(e) { return new R(e.parentNode, j(e)) } function o(e) { return new R(e.parentNode, j(e) + 1) } function s(e, t, n) { var a = 11 == e.nodeType ? e.firstChild : e; return B(t) ? n == t.length ? M.insertAfter(e, t) : t.parentNode.insertBefore(e, 0 == n ? t : V(t, n)) : n >= t.childNodes.length ? t.appendChild(e) : t.insertBefore(e, t.childNodes[n]), a } function l(e, t, n) { if (x(e), x(t), a(t) != a(e)) throw new P("WRONG_DOCUMENT_ERR"); var i = H(e.startContainer, e.startOffset, t.endContainer, t.endOffset), r = H(e.endContainer, e.endOffset, t.startContainer, t.startOffset); return n ? i <= 0 && r >= 0 : i < 0 && r > 0 } function c(e) { for (var t, n, i, r = a(e.range).createDocumentFragment(); n = e.next();) { if (t = e.isPartiallySelectedSubtree(), n = n.cloneNode(!t), t && (i = e.getSubtreeIterator(), n.appendChild(c(i)), i.detach()), 10 == n.nodeType) throw new P("HIERARCHY_REQUEST_ERR"); r.appendChild(n) } return r } function d(e, t, n) { var a, i; n = n || { stop: !1 }; for (var r, o; r = e.next();)if (e.isPartiallySelectedSubtree()) { if (t(r) === !1) return void (n.stop = !0); if (o = e.getSubtreeIterator(), d(o, t, n), o.detach(), n.stop) return } else for (a = M.createIterator(r); i = a.next();)if (t(i) === !1) return void (n.stop = !0) } function u(e) { for (var t; e.next();)e.isPartiallySelectedSubtree() ? (t = e.getSubtreeIterator(), u(t), t.detach()) : e.remove() } function f(e) { for (var t, n, i = a(e.range).createDocumentFragment(); t = e.next();) { if (e.isPartiallySelectedSubtree() ? (t = t.cloneNode(!1), n = e.getSubtreeIterator(), t.appendChild(f(n)), n.detach()) : e.remove(), 10 == t.nodeType) throw new P("HIERARCHY_REQUEST_ERR"); i.appendChild(t) } return i } function p(e, t, n) { var a, i = !(!t || !t.length), r = !!n; i && (a = new RegExp("^(" + t.join("|") + ")$")); var o = []; return d(new g(e, !1), function (t) { if ((!i || a.test(t.nodeType)) && (!r || n(t))) { var s = e.startContainer; if (t != s || !B(s) || e.startOffset != s.length) { var l = e.endContainer; t == l && B(l) && 0 == e.endOffset || o.push(t) } } }), o } function h(e) { return "[" + (void 0 === e.getName ? "Range" : e.getName()) + "(" + M.inspectNode(e.startContainer) + ":" + e.startOffset + ", " + M.inspectNode(e.endContainer) + ":" + e.endOffset + ")]" } function g(e, t) { if (this.range = e, this.clonePartiallySelectedTextNodes = t, !e.collapsed) { this.sc = e.startContainer, this.so = e.startOffset, this.ec = e.endContainer, this.eo = e.endOffset; var n = e.commonAncestorContainer; this.sc === this.ec && B(this.sc) ? (this.isSingleCharacterDataNode = !0, this._first = this._last = this._next = this.sc) : (this._first = this._next = this.sc !== n || B(this.sc) ? W(this.sc, n, !0) : this.sc.childNodes[this.so], this._last = this.ec !== n || B(this.ec) ? W(this.ec, n, !0) : this.ec.childNodes[this.eo - 1]) } } function m(e) { return function (t, n) { for (var a, i = n ? t : t.parentNode; i;) { if (a = i.nodeType, G(e, a)) return i; i = i.parentNode } return null } } function v(e, t) { if (ie(e, t)) throw new P("INVALID_NODE_TYPE_ERR") } function y(e, t) { if (!G(t, e.nodeType)) throw new P("INVALID_NODE_TYPE_ERR") } function _(e, t) { if (t < 0 || t > (B(e) ? e.length : e.childNodes.length)) throw new P("INDEX_SIZE_ERR") } function b(e, t) { if (ne(e, !0) !== ne(t, !0)) throw new P("WRONG_DOCUMENT_ERR") } function w(e) { if (ae(e, !0)) throw new P("NO_MODIFICATION_ALLOWED_ERR") } function C(e, t) { if (!e) throw new P(t) } function S(e, t) { return t <= (B(e) ? e.length : e.childNodes.length) } function k(e) { return !!e.startContainer && !!e.endContainer && !(X && (M.isBrokenNode(e.startContainer) || M.isBrokenNode(e.endContainer))) && J(e.startContainer) == J(e.endContainer) && S(e.startContainer, e.startOffset) && S(e.endContainer, e.endOffset) } function x(e) { if (!k(e)) throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: (" + e.inspect() + ")") } function D(e, t) { x(e); var n = e.startContainer, a = e.startOffset, i = e.endContainer, r = e.endOffset, o = n === i; B(i) && r > 0 && r < i.length && V(i, r, t), B(n) && a > 0 && a < n.length && (n = V(n, a, t), o ? (r -= a, i = n) : i == n.parentNode && r >= j(n) && r++, a = 0), e.setStartAndEnd(n, a, i, r) } function T(e) { x(e); var t = e.commonAncestorContainer.parentNode.cloneNode(!1); return t.appendChild(e.cloneContents()), t.innerHTML } function E(e) { e.START_TO_START = ce, e.START_TO_END = de, e.END_TO_END = ue, e.END_TO_START = fe, e.NODE_BEFORE = pe, e.NODE_AFTER = he, e.NODE_BEFORE_AND_AFTER = ge, e.NODE_INSIDE = me } function L(e) { E(e), E(e.prototype) } function A(e, t) { return function () { x(this); var n, a, i = this.startContainer, r = this.startOffset, s = this.commonAncestorContainer, l = new g(this, !0); i !== s && (n = W(i, s, !0), a = o(n), i = a.node, r = a.offset), d(l, w), l.reset(); var c = e(l); return l.detach(), t(this, i, r, i, r), c } } function $(t, a) {
        function i(e, t) { return function (n) { y(n, K), y(J(n), Q); var a = (e ? r : o)(n); (t ? s : l)(this, a.node, a.offset) } } function s(e, t, n) { var i = e.endContainer, r = e.endOffset; t === e.startContainer && n === e.startOffset || (J(t) == J(i) && 1 != H(t, n, i, r) || (i = t, r = n), a(e, t, n, i, r)) } function l(e, t, n) { var i = e.startContainer, r = e.startOffset; t === e.endContainer && n === e.endOffset || (J(t) == J(i) && H(t, n, i, r) != -1 || (i = t, r = n), a(e, i, r, t, n)) } var c = function () { }; c.prototype = e.rangePrototype, t.prototype = new c, N.extend(t.prototype, { setStart: function (e, t) { v(e, !0), _(e, t), s(this, e, t) }, setEnd: function (e, t) { v(e, !0), _(e, t), l(this, e, t) }, setStartAndEnd: function () { var e = arguments, t = e[0], n = e[1], i = t, r = n; switch (e.length) { case 3: r = e[2]; break; case 4: i = e[2], r = e[3] }a(this, t, n, i, r) }, setBoundary: function (e, t, n) { this["set" + (n ? "Start" : "End")](e, t) }, setStartBefore: i(!0, !0), setStartAfter: i(!1, !0), setEndBefore: i(!0, !1), setEndAfter: i(!1, !1), collapse: function (e) { x(this), e ? a(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : a(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset) }, selectNodeContents: function (e) { v(e, !0), a(this, e, 0, e, U(e)) }, selectNode: function (e) { v(e, !1), y(e, K); var t = r(e), n = o(e); a(this, t.node, t.offset, n.node, n.offset) }, extractContents: A(f, a), deleteContents: A(u, a), canSurroundContents: function () { x(this), w(this.startContainer), w(this.endContainer); var e = new g(this, !0), t = e._first && n(e._first, this) || e._last && n(e._last, this); return e.detach(), !t }, splitBoundaries: function () { D(this) }, splitBoundariesPreservingPositions: function (e) { D(this, e) }, normalizeBoundaries: function () { x(this); var e, t = this.startContainer, n = this.startOffset, i = this.endContainer, r = this.endOffset, o = function (e) { var t = e.nextSibling; t && t.nodeType == e.nodeType && (i = e, r = e.length, e.appendData(t.data), Y(t)) }, s = function (e) { var a = e.previousSibling; if (a && a.nodeType == e.nodeType) { t = e; var o = e.length; if (n = a.length, e.insertData(0, a.data), Y(a), t == i) r += n, i = t; else if (i == e.parentNode) { var s = j(e); r == s ? (i = e, r = o) : r > s && r-- } } }, l = !0; if (B(i)) r == i.length ? o(i) : 0 == r && (e = i.previousSibling) && e.nodeType == i.nodeType && (r = e.length, t == i && (l = !1), e.appendData(i.data), Y(i), i = e); else { if (r > 0) { var c = i.childNodes[r - 1]; c && B(c) && o(c) } l = !this.collapsed } if (l) { if (B(t)) 0 == n ? s(t) : n == t.length && (e = t.nextSibling) && e.nodeType == t.nodeType && (i == e && (i = t, r += t.length), t.appendData(e.data), Y(e)); else if (n < t.childNodes.length) { var d = t.childNodes[n]; d && B(d) && s(d) } } else t = i, n = r; a(this, t, n, i, r) }, collapseToPoint: function (e, t) { v(e, !0), _(e, t), this.setStartAndEnd(e, t) } }), L(t)
      } function I(e) { e.collapsed = e.startContainer === e.endContainer && e.startOffset === e.endOffset, e.commonAncestorContainer = e.collapsed ? e.startContainer : M.getCommonAncestor(e.startContainer, e.endContainer) } function O(e, t, n, a, i) { e.startContainer = t, e.startOffset = n, e.endContainer = a, e.endOffset = i, e.document = M.getDocument(t), I(e) } function F(e) { this.startContainer = e, this.startOffset = 0, this.endContainer = e, this.endOffset = 0, this.document = e, I(this) } var M = e.dom, N = e.util, R = M.DomPosition, P = e.DOMException, B = M.isCharacterDataNode, j = M.getNodeIndex, z = M.isOrIsAncestorOf, q = M.getDocument, H = M.comparePoints, V = M.splitDataNode, W = M.getClosestAncestorIn, U = M.getNodeLength, G = M.arrayContains, J = M.getRootContainer, X = e.features.crashyTextNodes, Y = M.removeNode; g.prototype = { _current: null, _next: null, _first: null, _last: null, isSingleCharacterDataNode: !1, reset: function () { this._current = null, this._next = this._first }, hasNext: function () { return !!this._next }, next: function () { var e = this._current = this._next; return e && (this._next = e !== this._last ? e.nextSibling : null, B(e) && this.clonePartiallySelectedTextNodes && (e === this.ec && (e = e.cloneNode(!0)).deleteData(this.eo, e.length - this.eo), this._current === this.sc && (e = e.cloneNode(!0)).deleteData(0, this.so))), e }, remove: function () { var e, t, n = this._current; !B(n) || n !== this.sc && n !== this.ec ? n.parentNode && Y(n) : (e = n === this.sc ? this.so : 0, t = n === this.ec ? this.eo : n.length, e != t && n.deleteData(e, t - e)) }, isPartiallySelectedSubtree: function () { return n(this._current, this.range) }, getSubtreeIterator: function () { var e; if (this.isSingleCharacterDataNode) e = this.range.cloneRange(), e.collapse(!1); else { e = new F(a(this.range)); var t = this._current, n = t, i = 0, r = t, o = U(t); z(t, this.sc) && (n = this.sc, i = this.so), z(t, this.ec) && (r = this.ec, o = this.eo), O(e, n, i, r, o) } return new g(e, this.clonePartiallySelectedTextNodes) }, detach: function () { this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null } }; var K = [1, 3, 4, 5, 7, 8, 10], Q = [2, 9, 11], Z = [5, 6, 10, 12], ee = [1, 3, 4, 5, 7, 8, 10, 11], te = [1, 3, 4, 5, 7, 8], ne = m([9, 11]), ae = m(Z), ie = m([6, 10, 12]), re = document.createElement("style"), oe = !1; try { re.innerHTML = "<b>x</b>", oe = 3 == re.firstChild.nodeType } catch (e) { } e.features.htmlParsingConforms = oe; var se = oe ? function (e) { var t = this.startContainer, n = q(t); if (!t) throw new P("INVALID_STATE_ERR"); var a = null; return 1 == t.nodeType ? a = t : B(t) && (a = M.parentElement(t)), a = null === a || "HTML" == a.nodeName && M.isHtmlNamespace(q(a).documentElement) && M.isHtmlNamespace(a) ? n.createElement("body") : a.cloneNode(!1), a.innerHTML = e, M.fragmentFromNodeChildren(a) } : function (e) { var t = a(this), n = t.createElement("body"); return n.innerHTML = e, M.fragmentFromNodeChildren(n) }, le = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], ce = 0, de = 1, ue = 2, fe = 3, pe = 0, he = 1, ge = 2, me = 3; N.extend(e.rangePrototype, { compareBoundaryPoints: function (e, t) { x(this), b(this.startContainer, t.startContainer); var n, a, i, r, o = e == fe || e == ce ? "start" : "end", s = e == de || e == ce ? "start" : "end"; return n = this[o + "Container"], a = this[o + "Offset"], i = t[s + "Container"], r = t[s + "Offset"], H(n, a, i, r) }, insertNode: function (e) { if (x(this), y(e, ee), w(this.startContainer), z(e, this.startContainer)) throw new P("HIERARCHY_REQUEST_ERR"); var t = s(e, this.startContainer, this.startOffset); this.setStartBefore(t) }, cloneContents: function () { x(this); var e, t; if (this.collapsed) return a(this).createDocumentFragment(); if (this.startContainer === this.endContainer && B(this.startContainer)) return e = this.startContainer.cloneNode(!0), e.data = e.data.slice(this.startOffset, this.endOffset), t = a(this).createDocumentFragment(), t.appendChild(e), t; var n = new g(this, !0); return e = c(n), n.detach(), e }, canSurroundContents: function () { x(this), w(this.startContainer), w(this.endContainer); var e = new g(this, !0), t = e._first && n(e._first, this) || e._last && n(e._last, this); return e.detach(), !t }, surroundContents: function (e) { if (y(e, te), !this.canSurroundContents()) throw new P("INVALID_STATE_ERR"); var t = this.extractContents(); if (e.hasChildNodes()) for (; e.lastChild;)e.removeChild(e.lastChild); s(e, this.startContainer, this.startOffset), e.appendChild(t), this.selectNode(e) }, cloneRange: function () { x(this); for (var e, t = new F(a(this)), n = le.length; n--;)e = le[n], t[e] = this[e]; return t }, toString: function () { x(this); var e = this.startContainer; if (e === this.endContainer && B(e)) return 3 == e.nodeType || 4 == e.nodeType ? e.data.slice(this.startOffset, this.endOffset) : ""; var t = [], n = new g(this, !0); return d(n, function (e) { 3 != e.nodeType && 4 != e.nodeType || t.push(e.data) }), n.detach(), t.join("") }, compareNode: function (e) { x(this); var t = e.parentNode, n = j(e); if (!t) throw new P("NOT_FOUND_ERR"); var a = this.comparePoint(t, n), i = this.comparePoint(t, n + 1); return a < 0 ? i > 0 ? ge : pe : i > 0 ? he : me }, comparePoint: function (e, t) { return x(this), C(e, "HIERARCHY_REQUEST_ERR"), b(e, this.startContainer), H(e, t, this.startContainer, this.startOffset) < 0 ? -1 : H(e, t, this.endContainer, this.endOffset) > 0 ? 1 : 0 }, createContextualFragment: se, toHtml: function () { return T(this) }, intersectsNode: function (e, t) { if (x(this), J(e) != i(this)) return !1; var n = e.parentNode, a = j(e); if (!n) return !0; var r = H(n, a, this.endContainer, this.endOffset), o = H(n, a + 1, this.startContainer, this.startOffset); return t ? r <= 0 && o >= 0 : r < 0 && o > 0 }, isPointInRange: function (e, t) { return x(this), C(e, "HIERARCHY_REQUEST_ERR"), b(e, this.startContainer), H(e, t, this.startContainer, this.startOffset) >= 0 && H(e, t, this.endContainer, this.endOffset) <= 0 }, intersectsRange: function (e) { return l(this, e, !1) }, intersectsOrTouchesRange: function (e) { return l(this, e, !0) }, intersection: function (e) { if (this.intersectsRange(e)) { var t = H(this.startContainer, this.startOffset, e.startContainer, e.startOffset), n = H(this.endContainer, this.endOffset, e.endContainer, e.endOffset), a = this.cloneRange(); return t == -1 && a.setStart(e.startContainer, e.startOffset), 1 == n && a.setEnd(e.endContainer, e.endOffset), a } return null }, union: function (e) { if (this.intersectsOrTouchesRange(e)) { var t = this.cloneRange(); return H(e.startContainer, e.startOffset, this.startContainer, this.startOffset) == -1 && t.setStart(e.startContainer, e.startOffset), 1 == H(e.endContainer, e.endOffset, this.endContainer, this.endOffset) && t.setEnd(e.endContainer, e.endOffset), t } throw new P("Ranges do not intersect") }, containsNode: function (e, t) { return t ? this.intersectsNode(e, !1) : this.compareNode(e) == me }, containsNodeContents: function (e) { return this.comparePoint(e, 0) >= 0 && this.comparePoint(e, U(e)) <= 0 }, containsRange: function (e) { var t = this.intersection(e); return null !== t && e.equals(t) }, containsNodeText: function (e) { var t = this.cloneRange(); t.selectNode(e); var n = t.getNodes([3]); if (n.length > 0) { t.setStart(n[0], 0); var a = n.pop(); return t.setEnd(a, a.length), this.containsRange(t) } return this.containsNodeContents(e) }, getNodes: function (e, t) { return x(this), p(this, e, t) }, getDocument: function () { return a(this) }, collapseBefore: function (e) { this.setEndBefore(e), this.collapse(!1) }, collapseAfter: function (e) { this.setStartAfter(e), this.collapse(!0) }, getBookmark: function (t) { var n = a(this), i = e.createRange(n); t = t || M.getBody(n), i.selectNodeContents(t); var r = this.intersection(i), o = 0, s = 0; return r && (i.setEnd(r.startContainer, r.startOffset), o = i.toString().length, s = o + r.toString().length), { start: o, end: s, containerNode: t } }, moveToBookmark: function (e) { var t = e.containerNode, n = 0; this.setStart(t, 0), this.collapse(!0); for (var a, i, r, o, s = [t], l = !1, c = !1; !c && (a = s.pop());)if (3 == a.nodeType) i = n + a.length, !l && e.start >= n && e.start <= i && (this.setStart(a, e.start - n), l = !0), l && e.end >= n && e.end <= i && (this.setEnd(a, e.end - n), c = !0), n = i; else for (o = a.childNodes, r = o.length; r--;)s.push(o[r]) }, getName: function () { return "DomRange" }, equals: function (e) { return F.rangesEqual(this, e) }, isValid: function () { return k(this) }, inspect: function () { return h(this) }, detach: function () { } }), $(F, O), N.extend(F, { rangeProperties: le, RangeIterator: g, copyComparisonConstants: L, createPrototypeRange: $, inspect: h, toHtml: T, getRangeDocument: a, rangesEqual: function (e, t) { return e.startContainer === t.startContainer && e.startOffset === t.startOffset && e.endContainer === t.endContainer && e.endOffset === t.endOffset } }), e.DomRange = F
    }), O.createCoreModule("WrappedRange", ["DomRange"], function (e, t) { var n, a, i = e.dom, r = e.util, o = i.DomPosition, s = e.DomRange, l = i.getBody, c = i.getContentDocument, d = i.isCharacterDataNode; if (e.features.implementsDomRange && function () { function a(e) { for (var t, n = f.length; n--;)t = f[n], e[t] = e.nativeRange[t]; e.collapsed = e.startContainer === e.endContainer && e.startOffset === e.endOffset } function o(e, t, n, a, i) { var r = e.startContainer !== t || e.startOffset != n, o = e.endContainer !== a || e.endOffset != i, s = !e.equals(e.nativeRange); (r || o || s) && (e.setEnd(a, i), e.setStart(t, n)) } var d, u, f = s.rangeProperties; n = function (e) { if (!e) throw t.createError("WrappedRange: Range must be specified"); this.nativeRange = e, a(this) }, s.createPrototypeRange(n, o), d = n.prototype, d.selectNode = function (e) { this.nativeRange.selectNode(e), a(this) }, d.cloneContents = function () { return this.nativeRange.cloneContents() }, d.surroundContents = function (e) { this.nativeRange.surroundContents(e), a(this) }, d.collapse = function (e) { this.nativeRange.collapse(e), a(this) }, d.cloneRange = function () { return new n(this.nativeRange.cloneRange()) }, d.refresh = function () { a(this) }, d.toString = function () { return this.nativeRange.toString() }; var p = document.createTextNode("test"); l(document).appendChild(p); var h = document.createRange(); h.setStart(p, 0), h.setEnd(p, 0); try { h.setStart(p, 1), d.setStart = function (e, t) { this.nativeRange.setStart(e, t), a(this) }, d.setEnd = function (e, t) { this.nativeRange.setEnd(e, t), a(this) }, u = function (e) { return function (t) { this.nativeRange[e](t), a(this) } } } catch (e) { d.setStart = function (e, t) { try { this.nativeRange.setStart(e, t) } catch (e) { this.nativeRange.setEnd(e, t), this.nativeRange.setStart(e, t) } a(this) }, d.setEnd = function (e, t) { try { this.nativeRange.setEnd(e, t) } catch (e) { this.nativeRange.setStart(e, t), this.nativeRange.setEnd(e, t) } a(this) }, u = function (e, t) { return function (n) { try { this.nativeRange[e](n) } catch (e) { this.nativeRange[t](n), this.nativeRange[e](n) } a(this) } } } d.setStartBefore = u("setStartBefore", "setEndBefore"), d.setStartAfter = u("setStartAfter", "setEndAfter"), d.setEndBefore = u("setEndBefore", "setStartBefore"), d.setEndAfter = u("setEndAfter", "setStartAfter"), d.selectNodeContents = function (e) { this.setStartAndEnd(e, 0, i.getNodeLength(e)) }, h.selectNodeContents(p), h.setEnd(p, 3); var g = document.createRange(); g.selectNodeContents(p), g.setEnd(p, 4), g.setStart(p, 2), h.compareBoundaryPoints(h.START_TO_END, g) == -1 && 1 == h.compareBoundaryPoints(h.END_TO_START, g) ? d.compareBoundaryPoints = function (e, t) { return t = t.nativeRange || t, e == t.START_TO_END ? e = t.END_TO_START : e == t.END_TO_START && (e = t.START_TO_END), this.nativeRange.compareBoundaryPoints(e, t) } : d.compareBoundaryPoints = function (e, t) { return this.nativeRange.compareBoundaryPoints(e, t.nativeRange || t) }; var m = document.createElement("div"); m.innerHTML = "123"; var v = m.firstChild, y = l(document); y.appendChild(m), h.setStart(v, 1), h.setEnd(v, 2), h.deleteContents(), "13" == v.data && (d.deleteContents = function () { this.nativeRange.deleteContents(), a(this) }, d.extractContents = function () { var e = this.nativeRange.extractContents(); return a(this), e }), y.removeChild(m), y = null, r.isHostMethod(h, "createContextualFragment") && (d.createContextualFragment = function (e) { return this.nativeRange.createContextualFragment(e) }), l(document).removeChild(p), d.getName = function () { return "WrappedRange" }, e.WrappedRange = n, e.createNativeRange = function (e) { return e = c(e, t, "createNativeRange"), e.createRange() } }(), e.features.implementsTextRange) { var u = function (e) { var t = e.parentElement(), n = e.duplicate(); n.collapse(!0); var a = n.parentElement(); n = e.duplicate(), n.collapse(!1); var r = n.parentElement(), o = a == r ? a : i.getCommonAncestor(a, r); return o == t ? o : i.getCommonAncestor(t, o) }, f = function (e) { return 0 == e.compareEndPoints("StartToEnd", e) }, p = function (e, t, n, a, r) { var s = e.duplicate(); s.collapse(n); var l = s.parentElement(); if (i.isOrIsAncestorOf(t, l) || (l = t), !l.canHaveHTML) { var c = new o(l.parentNode, i.getNodeIndex(l)); return { boundaryPosition: c, nodeInfo: { nodeIndex: c.offset, containerElement: c.node } } } var u = i.getDocument(l).createElement("span"); u.parentNode && i.removeNode(u); for (var f, p, h, g, m, v = n ? "StartToStart" : "StartToEnd", y = r && r.containerElement == l ? r.nodeIndex : 0, _ = l.childNodes.length, b = _, w = b; ;) { if (w == _ ? l.appendChild(u) : l.insertBefore(u, l.childNodes[w]), s.moveToElementText(u), 0 == (f = s.compareEndPoints(v, e)) || y == b) break; if (f == -1) { if (b == y + 1) break; y = w } else b = b == y + 1 ? y : w; w = Math.floor((y + b) / 2), l.removeChild(u) } if (m = u.nextSibling, f == -1 && m && d(m)) { s.setEndPoint(n ? "EndToStart" : "EndToEnd", e); var C; if (/[\r\n]/.test(m.data)) { var S = s.duplicate(), k = S.text.replace(/\r\n/g, "\r").length; for (C = S.moveStart("character", k); (f = S.compareEndPoints("StartToEnd", S)) == -1;)C++, S.moveStart("character", 1) } else C = s.text.length; g = new o(m, C) } else p = (a || !n) && u.previousSibling, h = (a || n) && u.nextSibling, g = h && d(h) ? new o(h, 0) : p && d(p) ? new o(p, p.data.length) : new o(l, i.getNodeIndex(u)); return i.removeNode(u), { boundaryPosition: g, nodeInfo: { nodeIndex: w, containerElement: l } } }, h = function (e, t) { var n, a, r, o, s = e.offset, c = i.getDocument(e.node), u = l(c).createTextRange(), f = d(e.node); return f ? (n = e.node, a = n.parentNode) : (o = e.node.childNodes, n = s < o.length ? o[s] : null, a = e.node), r = c.createElement("span"), r.innerHTML = "&#feff;", n ? a.insertBefore(r, n) : a.appendChild(r), u.moveToElementText(r), u.collapse(!t), a.removeChild(r), f && u[t ? "moveStart" : "moveEnd"]("character", s), u }; a = function (e) { this.textRange = e, this.refresh() }, a.prototype = new s(document), a.prototype.refresh = function () { var e, t, n, a = u(this.textRange); f(this.textRange) ? t = e = p(this.textRange, a, !0, !0).boundaryPosition : (n = p(this.textRange, a, !0, !1), e = n.boundaryPosition, t = p(this.textRange, a, !1, !1, n.nodeInfo).boundaryPosition), this.setStart(e.node, e.offset), this.setEnd(t.node, t.offset) }, a.prototype.getName = function () { return "WrappedTextRange" }, s.copyComparisonConstants(a); var g = function (e) { if (e.collapsed) return h(new o(e.startContainer, e.startOffset), !0); var t = h(new o(e.startContainer, e.startOffset), !0), n = h(new o(e.endContainer, e.endOffset), !1), a = l(s.getRangeDocument(e)).createTextRange(); return a.setEndPoint("StartToStart", t), a.setEndPoint("EndToEnd", n), a }; if (a.rangeToTextRange = g, a.prototype.toTextRange = function () { return g(this) }, e.WrappedTextRange = a, !e.features.implementsDomRange || e.config.preferTextRange) { var m = function (e) { return e("return this;")() }(Function); void 0 === m.Range && (m.Range = a), e.createNativeRange = function (e) { return e = c(e, t, "createNativeRange"), l(e).createTextRange() }, e.WrappedRange = a } } e.createRange = function (n) { return n = c(n, t, "createRange"), new e.WrappedRange(e.createNativeRange(n)) }, e.createRangyRange = function (e) { return e = c(e, t, "createRangyRange"), new s(e) }, r.createAliasForDeprecatedMethod(e, "createIframeRange", "createRange"), r.createAliasForDeprecatedMethod(e, "createIframeRangyRange", "createRangyRange"), e.addShimListener(function (t) { var n = t.document; void 0 === n.createRange && (n.createRange = function () { return e.createRange(n) }), n = t = null }) }), O.createCoreModule("WrappedSelection", ["DomRange", "WrappedRange"], function (e, t) { function n(e) { return "string" == typeof e ? /^backward(s)?$/i.test(e) : !!e } function a(e, n) { if (e) { if (D.isWindow(e)) return e; if (e instanceof v) return e.win; var a = D.getContentDocument(e, t, n); return D.getWindow(a) } return window } function i(e) { return a(e, "getWinSelection").getSelection() } function r(e) { return a(e, "getDocSelection").document.selection } function o(e) { var t = !1; return e.anchorNode && (t = 1 == D.comparePoints(e.anchorNode, e.anchorOffset, e.focusNode, e.focusOffset)), t } function s(e, t, n) { var a = n ? "end" : "start", i = n ? "start" : "end"; e.anchorNode = t[a + "Container"], e.anchorOffset = t[a + "Offset"], e.focusNode = t[i + "Container"], e.focusOffset = t[i + "Offset"] } function l(e) { var t = e.nativeSelection; e.anchorNode = t.anchorNode, e.anchorOffset = t.anchorOffset, e.focusNode = t.focusNode, e.focusOffset = t.focusOffset } function c(e) { e.anchorNode = e.focusNode = null, e.anchorOffset = e.focusOffset = 0, e.rangeCount = 0, e.isCollapsed = !0, e._ranges.length = 0 } function d(t) { var n; return t instanceof L ? (n = e.createNativeRange(t.getDocument()), n.setEnd(t.endContainer, t.endOffset), n.setStart(t.startContainer, t.startOffset)) : t instanceof A ? n = t.nativeRange : O.implementsDomRange && t instanceof D.getWindow(t.startContainer).Range && (n = t), n } function u(e) { if (!e.length || 1 != e[0].nodeType) return !1; for (var t = 1, n = e.length; t < n; ++t)if (!D.isAncestorOf(e[0], e[t])) return !1; return !0 } function f(e) { var n = e.getNodes(); if (!u(n)) throw t.createError("getSingleElementFromRange: range " + e.inspect() + " did not consist of a single element"); return n[0] } function p(e) { return !!e && void 0 !== e.text } function h(e, t) { var n = new A(t); e._ranges = [n], s(e, n, !1), e.rangeCount = 1, e.isCollapsed = n.collapsed } function g(t) { if (t._ranges.length = 0, "None" == t.docSelection.type) c(t); else { var n = t.docSelection.createRange(); if (p(n)) h(t, n); else { t.rangeCount = n.length; for (var a, i = F(n.item(0)), r = 0; r < t.rangeCount; ++r)a = e.createRange(i), a.selectNode(n.item(r)), t._ranges.push(a); t.isCollapsed = 1 == t.rangeCount && t._ranges[0].collapsed, s(t, t._ranges[t.rangeCount - 1], !1) } } } function m(e, n) { for (var a = e.docSelection.createRange(), i = f(n), r = F(a.item(0)), o = M(r).createControlRange(), s = 0, l = a.length; s < l; ++s)o.add(a.item(s)); try { o.add(i) } catch (e) { throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)") } o.select(), g(e) } function v(e, t, n) { this.nativeSelection = e, this.docSelection = t, this._ranges = [], this.win = n, this.refresh() } function y(e) { e.win = e.anchorNode = e.focusNode = e._ranges = null, e.rangeCount = e.anchorOffset = e.focusOffset = 0, e.detached = !0 } function _(e, t) { for (var n, a, i = Q.length; i--;)if (n = Q[i], a = n.selection, "deleteAll" == t) y(a); else if (n.win == e) return "delete" == t ? (Q.splice(i, 1), !0) : a; return "deleteAll" == t && (Q.length = 0), null } function b(e, n) { for (var a, i = F(n[0].startContainer), r = M(i).createControlRange(), o = 0, s = n.length; o < s; ++o) { a = f(n[o]); try { r.add(a) } catch (e) { throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)") } } r.select(), g(e) } function w(e, t) { if (e.win.document != F(t)) throw new $("WRONG_DOCUMENT_ERR") } function C(t) { return function (n, a) { var i; this.rangeCount ? (i = this.getRangeAt(0), i["set" + (t ? "Start" : "End")](n, a)) : (i = e.createRange(this.win.document), i.setStartAndEnd(n, a)), this.setSingleRange(i, this.isBackward()) } } function S(e) { var t = [], n = new I(e.anchorNode, e.anchorOffset), a = new I(e.focusNode, e.focusOffset), i = "function" == typeof e.getName ? e.getName() : "Selection"; if (void 0 !== e.rangeCount) for (var r = 0, o = e.rangeCount; r < o; ++r)t[r] = L.inspect(e.getRangeAt(r)); return "[" + i + "(Ranges: " + t.join(", ") + ")(anchor: " + n.inspect() + ", focus: " + a.inspect() + "]" } e.config.checkSelectionRanges = !0; var k, x, D = e.dom, T = e.util, E = T.isHostMethod, L = e.DomRange, A = e.WrappedRange, $ = e.DOMException, I = D.DomPosition, O = e.features, F = D.getDocument, M = D.getBody, N = L.rangesEqual, R = E(window, "getSelection"), P = T.isHostObject(document, "selection"); O.implementsWinGetSelection = R, O.implementsDocSelection = P; var B = P && (!R || e.config.preferTextRange); if (B) k = r, e.isSelectionValid = function (e) { var t = a(e, "isSelectionValid").document, n = t.selection; return "None" != n.type || F(n.createRange().parentElement()) == t }; else { if (!R) return t.fail("Neither document.selection or window.getSelection() detected."), !1; k = i, e.isSelectionValid = function () { return !0 } } e.getNativeSelection = k; var j = k(); if (!j) return t.fail("Native selection was null (possibly issue 138?)"), !1; var z = e.createNativeRange(document), q = M(document), H = T.areHostProperties(j, ["anchorNode", "focusNode", "anchorOffset", "focusOffset"]); O.selectionHasAnchorAndFocus = H; var V = E(j, "extend"); O.selectionHasExtend = V; var W = "number" == typeof j.rangeCount; O.selectionHasRangeCount = W; var U = !1, G = !0, J = V ? function (t, n) { var a = L.getRangeDocument(n), i = e.createRange(a); i.collapseToPoint(n.endContainer, n.endOffset), t.addRange(d(i)), t.extend(n.startContainer, n.startOffset) } : null; T.areHostMethods(j, ["addRange", "getRangeAt", "removeAllRanges"]) && "number" == typeof j.rangeCount && O.implementsDomRange && function () { var t = window.getSelection(); if (t) { for (var n = t.rangeCount, a = n > 1, i = [], r = o(t), s = 0; s < n; ++s)i[s] = t.getRangeAt(s); var l = D.createTestElement(document, "", !1), c = l.appendChild(document.createTextNode("   ")), d = document.createRange(); if (d.setStart(c, 1), d.collapse(!0), t.removeAllRanges(), t.addRange(d), G = 1 == t.rangeCount, t.removeAllRanges(), !a) { var u = window.navigator.appVersion.match(/Chrome\/(.*?) /); if (u && parseInt(u[1]) >= 36) U = !1; else { var f = d.cloneRange(); d.setStart(c, 0), f.setEnd(c, 3), f.setStart(c, 2), t.addRange(d), t.addRange(f), U = 2 == t.rangeCount } } for (D.removeNode(l), t.removeAllRanges(), s = 0; s < n; ++s)0 == s && r ? J ? J(t, i[s]) : (e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"), t.addRange(i[s])) : t.addRange(i[s]) } }(), O.selectionSupportsMultipleRanges = U, O.collapsedNonEditableSelectionsSupported = G; var X, Y = !1; q && E(q, "createControlRange") && (X = q.createControlRange(), T.areHostProperties(X, ["item", "add"]) && (Y = !0)), O.implementsControlRange = Y, x = H ? function (e) { return e.anchorNode === e.focusNode && e.anchorOffset === e.focusOffset } : function (e) { return !!e.rangeCount && e.getRangeAt(e.rangeCount - 1).collapsed }; var K; E(j, "getRangeAt") ? K = function (e, t) { try { return e.getRangeAt(t) } catch (e) { return null } } : H && (K = function (t) { var n = F(t.anchorNode), a = e.createRange(n); return a.setStartAndEnd(t.anchorNode, t.anchorOffset, t.focusNode, t.focusOffset), a.collapsed !== this.isCollapsed && a.setStartAndEnd(t.focusNode, t.focusOffset, t.anchorNode, t.anchorOffset), a }), v.prototype = e.selectionPrototype; var Q = [], Z = function (e) { if (e && e instanceof v) return e.refresh(), e; e = a(e, "getNativeSelection"); var t = _(e), n = k(e), i = P ? r(e) : null; return t ? (t.nativeSelection = n, t.docSelection = i, t.refresh()) : (t = new v(n, i, e), Q.push({ win: e, selection: t })), t }; e.getSelection = Z, T.createAliasForDeprecatedMethod(e, "getIframeSelection", "getSelection"); var ee = v.prototype; if (!B && H && T.areHostMethods(j, ["removeAllRanges", "addRange"])) { ee.removeAllRanges = function () { this.nativeSelection.removeAllRanges(), c(this) }; var te = function (e, t) { J(e.nativeSelection, t), e.refresh() }; ee.addRange = W ? function (t, a) { if (Y && P && "Control" == this.docSelection.type) m(this, t); else if (n(a) && V) te(this, t); else { var i; U ? i = this.rangeCount : (this.removeAllRanges(), i = 0); var r = d(t).cloneRange(); try { this.nativeSelection.addRange(r) } catch (e) { } if (this.rangeCount = this.nativeSelection.rangeCount, this.rangeCount == i + 1) { if (e.config.checkSelectionRanges) { var o = K(this.nativeSelection, this.rangeCount - 1); o && !N(o, t) && (t = new A(o)) } this._ranges[this.rangeCount - 1] = t, s(this, t, ie(this.nativeSelection)), this.isCollapsed = x(this) } else this.refresh() } } : function (e, t) { n(t) && V ? te(this, e) : (this.nativeSelection.addRange(d(e)), this.refresh()) }, ee.setRanges = function (e) { if (Y && P && e.length > 1) b(this, e); else { this.removeAllRanges(); for (var t = 0, n = e.length; t < n; ++t)this.addRange(e[t]) } } } else { if (!(E(j, "empty") && E(z, "select") && Y && B)) return t.fail("No means of selecting a Range or TextRange was found"), !1; ee.removeAllRanges = function () { try { if (this.docSelection.empty(), "None" != this.docSelection.type) { var e; if (this.anchorNode) e = F(this.anchorNode); else if ("Control" == this.docSelection.type) { var t = this.docSelection.createRange(); t.length && (e = F(t.item(0))) } if (e) { M(e).createTextRange().select(), this.docSelection.empty() } } } catch (e) { } c(this) }, ee.addRange = function (t) { "Control" == this.docSelection.type ? m(this, t) : (e.WrappedTextRange.rangeToTextRange(t).select(), this._ranges[0] = t, this.rangeCount = 1, this.isCollapsed = this._ranges[0].collapsed, s(this, t, !1)) }, ee.setRanges = function (e) { this.removeAllRanges(); var t = e.length; t > 1 ? b(this, e) : t && this.addRange(e[0]) } } ee.getRangeAt = function (e) { if (e < 0 || e >= this.rangeCount) throw new $("INDEX_SIZE_ERR"); return this._ranges[e].cloneRange() }; var ne; if (B) ne = function (t) { var n; e.isSelectionValid(t.win) ? n = t.docSelection.createRange() : (n = M(t.win.document).createTextRange(), n.collapse(!0)), "Control" == t.docSelection.type ? g(t) : p(n) ? h(t, n) : c(t) }; else if (E(j, "getRangeAt") && "number" == typeof j.rangeCount) ne = function (t) { if (Y && P && "Control" == t.docSelection.type) g(t); else if (t._ranges.length = t.rangeCount = t.nativeSelection.rangeCount, t.rangeCount) { for (var n = 0, a = t.rangeCount; n < a; ++n)t._ranges[n] = new e.WrappedRange(t.nativeSelection.getRangeAt(n)); s(t, t._ranges[t.rangeCount - 1], ie(t.nativeSelection)), t.isCollapsed = x(t) } else c(t) }; else { if (!H || "boolean" != typeof j.isCollapsed || "boolean" != typeof z.collapsed || !O.implementsDomRange) return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"), !1; ne = function (e) { var t, n = e.nativeSelection; n.anchorNode ? (t = K(n, 0), e._ranges = [t], e.rangeCount = 1, l(e), e.isCollapsed = x(e)) : c(e) } } ee.refresh = function (e) { var t = e ? this._ranges.slice(0) : null, n = this.anchorNode, a = this.anchorOffset; if (ne(this), e) { var i = t.length; if (i != this._ranges.length) return !0; if (this.anchorNode != n || this.anchorOffset != a) return !0; for (; i--;)if (!N(t[i], this._ranges[i])) return !0; return !1 } }; var ae = function (e, t) { var n = e.getAllRanges(); e.removeAllRanges(); for (var a = 0, i = n.length; a < i; ++a)N(t, n[a]) || e.addRange(n[a]); e.rangeCount || c(e) }; ee.removeRange = Y && P ? function (e) { if ("Control" == this.docSelection.type) { for (var t, n = this.docSelection.createRange(), a = f(e), i = F(n.item(0)), r = M(i).createControlRange(), o = !1, s = 0, l = n.length; s < l; ++s)t = n.item(s), t !== a || o ? r.add(n.item(s)) : o = !0; r.select(), g(this) } else ae(this, e) } : function (e) { ae(this, e) }; var ie; !B && H && O.implementsDomRange ? (ie = o, ee.isBackward = function () { return ie(this) }) : ie = ee.isBackward = function () { return !1 }, ee.isBackwards = ee.isBackward, ee.toString = function () { for (var e = [], t = 0, n = this.rangeCount; t < n; ++t)e[t] = "" + this._ranges[t]; return e.join("") }, ee.collapse = function (t, n) { w(this, t); var a = e.createRange(t); a.collapseToPoint(t, n), this.setSingleRange(a), this.isCollapsed = !0 }, ee.collapseToStart = function () { if (!this.rangeCount) throw new $("INVALID_STATE_ERR"); var e = this._ranges[0]; this.collapse(e.startContainer, e.startOffset) }, ee.collapseToEnd = function () { if (!this.rangeCount) throw new $("INVALID_STATE_ERR"); var e = this._ranges[this.rangeCount - 1]; this.collapse(e.endContainer, e.endOffset) }, ee.selectAllChildren = function (t) { w(this, t); var n = e.createRange(t); n.selectNodeContents(t), this.setSingleRange(n) }, ee.deleteFromDocument = function () { if (Y && P && "Control" == this.docSelection.type) { for (var e, t = this.docSelection.createRange(); t.length;)e = t.item(0), t.remove(e), D.removeNode(e); this.refresh() } else if (this.rangeCount) { var n = this.getAllRanges(); if (n.length) { this.removeAllRanges(); for (var a = 0, i = n.length; a < i; ++a)n[a].deleteContents(); this.addRange(n[i - 1]) } } }, ee.eachRange = function (e, t) { for (var n = 0, a = this._ranges.length; n < a; ++n)if (e(this.getRangeAt(n))) return t }, ee.getAllRanges = function () { var e = []; return this.eachRange(function (t) { e.push(t) }), e }, ee.setSingleRange = function (e, t) { this.removeAllRanges(), this.addRange(e, t) }, ee.callMethodOnEachRange = function (e, t) { var n = []; return this.eachRange(function (a) { n.push(a[e].apply(a, t || [])) }), n }, ee.setStart = C(!0), ee.setEnd = C(!1), e.rangePrototype.select = function (e) { Z(this.getDocument()).setSingleRange(this, e) }, ee.changeEachRange = function (e) { var t = [], n = this.isBackward(); this.eachRange(function (n) { e(n), t.push(n) }), this.removeAllRanges(), n && 1 == t.length ? this.addRange(t[0], "backward") : this.setRanges(t) }, ee.containsNode = function (e, t) { return this.eachRange(function (n) { return n.containsNode(e, t) }, !0) || !1 }, ee.getBookmark = function (e) { return { backward: this.isBackward(), rangeBookmarks: this.callMethodOnEachRange("getBookmark", [e]) } }, ee.moveToBookmark = function (t) { for (var n, a, i = [], r = 0; n = t.rangeBookmarks[r++];)a = e.createRange(this.win), a.moveToBookmark(n), i.push(a); t.backward ? this.setSingleRange(i[0], "backward") : this.setRanges(i) }, ee.saveRanges = function () { return { backward: this.isBackward(), ranges: this.callMethodOnEachRange("cloneRange") } }, ee.restoreRanges = function (e) { this.removeAllRanges(); for (var t, n = 0; t = e.ranges[n]; ++n)this.addRange(t, e.backward && 0 == n) }, ee.toHtml = function () { var e = []; return this.eachRange(function (t) { e.push(L.toHtml(t)) }), e.join("") }, O.implementsTextRange && (ee.getNativeTextRange = function () { var n; if (n = this.docSelection) { var a = n.createRange(); if (p(a)) return a; throw t.createError("getNativeTextRange: selection is a control selection") } if (this.rangeCount > 0) return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0)); throw t.createError("getNativeTextRange: selection contains no range") }), ee.getName = function () { return "WrappedSelection" }, ee.inspect = function () { return S(this) }, ee.detach = function () { _(this.win, "delete"), y(this) }, v.detachAll = function () { _(null, "deleteAll") }, v.inspect = S, v.isDirectionBackward = n, e.Selection = v, e.selectionPrototype = ee, e.addShimListener(function (e) { void 0 === e.getSelection && (e.getSelection = function () { return Z(e) }), e = null }) }); var P = !1, B = function (e) { P || (P = !0, !O.initialized && O.config.autoInitialize && u()) }; return $ && ("complete" == document.readyState ? B() : (e(document, "addEventListener") && document.addEventListener("DOMContentLoaded", B, !1), M(window, "load", B))), O
  })
}, function (e, t, n) {
  "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(180), i = ["year", "quarter", "month", "week", "day", "hour", "minute", "second"], r = {}, o = {
    objs: {
      init: function () { }, getHint: function (e) { switch (e) { case "drill": return "zh" == bdpChart.language ? "请选择下钻维度" : "Select dimension to drill-down"; case "toggle": return "zh" == bdpChart.language ? "请选择切换维度" : "Select dimension to toggle"; case "link": return "zh" == bdpChart.language ? "请选择联动字段" : "Select field to Interactive" } }, getText: function (e) { return bdpChart.language = bdpChart.language || "zh", { hint: o.objs.getHint(e.type), dataMap: "zh" == bdpChart.language ? { year: "按年", quarter: "按季", month: "按月", week: "按周", day: "按日", hour: "按时", minute: "按分", second: "按秒" } : { year: "by Year", quarter: "by Quarter", month: "by Month", week: "by Week", day: "by Day", hour: "by Hour", minute: "by Minute", second: "by Second" }, nodataText: "zh" == bdpChart.language ? "无维度可用" : "No available field" } },
      handleData: function (e) { if (e.isAllField) return o.objs.handleAllData(e.fields); var t = e.chart.info, n = t.free_drill_fields.slice(0) || [], a = o.objs.getText(e).dataMap, r = !1; return n.forEach(function (e, t) { e.subDate = [], "date" == e.data_type && i.forEach(function (t) { e.subDate.push({ key: t, name: a[t] }), r = !0 }) }), { availableDrillFields: n, hasDateField: r, isAllField: !1 } }, handleAllData: function (e) { if ($.isArray(e) < 0) throw "you should give an array as param."; return { availableDrillFields: e, hasDateField: !0, isAllField: !0 } }, getOuter: function () { return $(".J-drill-fields-wrap") }, show: function (e) { var t = e.objs, n = o.objs.handleData(e), i = o.objs.getText(e), r = i.hint, s = i.nodataText, l = a({ hint: r, nodataText: s, fieldList: n.availableDrillFields, hasDateField: n.hasDateField, isAllField: n.isAllField }), c = null; return (e.container || $("body")).append(l), c = o.objs.getOuter(), t && t.handleThemeStyleClass ? t.handleThemeStyleClass(c, e.chart) : o.objs.handleGlobalThemeStyle(c, 2 === window.usedThemeId ? "default" : "dark"), o.bindDomFuns($.extend({}, e, n)), o.objs.setPos(e.hook, c, { isRight: e.isRight, position: e.isNotAbs ? "" : "absolute" }), c }, setPos: function (e, t, n) { var a = e.offset(), t = o.objs.getOuter(); t.find(".J-drilll-fields-list"); t.css({ position: n.position, left: a.left, top: a.top + e.height() - 42 }) }, handleGlobalThemeStyle: function (e, t) { return e.removeClass("chart-theme-dark chart-theme-default").addClass("chart-theme-" + t), e.removeClass("display-theme-dark display-theme-light").addClass("display-theme-" + ("default" == t ? "light" : "dark")), e.removeClass("display-device-pc display-device-projector display-device-tv").addClass("display-device-pc"), e }, remove: function () { o.objs.getOuter().remove() }, destroy: function (e) { e && ("display" == $(e.target).attr("action-type") || $(e.target).hasClass("J-int-text") || $(e.target).hasClass("J-add-field")) || o.objs.remove() }, isShow: function () { var e = o.objs.getOuter(); return e.length > 0 && "none" != e[0].style.display }
    }, eventFuns: { handleDrill: function (e, t) { var n = "", a = $(e.target), i = a.parents(".J-field-drill-item"); switch (n = a.attr("action-type"), n || (a = i.length > 0 ? i : a, n = a.attr("action-type")), n) { case "fieldItem": var r = 1 * a.attr("data-index"), s = angular.copy(t.availableDrillFields[r]), l = a.attr("data-granularity"); "date" == s.data_type && (s.granularity = l || "day"), t.callback && t.callback(s), delete s.subDate, o.objs.remove(); break; case "subFieldItem": var c = a.attr("parent-index"), d = (a.attr("data-index"), a.attr("data-granularity")), u = angular.copy(t.availableDrillFields[c]); "date" == u.data_type && (u.granularity = d || "day"), delete u.subDate, t.callback && t.callback(u), o.objs.remove(); break; case "display": var f = (i.find(".J-sub-item-wrap"), i.find(".J-sub-icon")); i.toggleClass("show-sub-list"), i.hasClass("show-sub-list") ? (f.removeClass("ico-triangle-right"), f.addClass("ico-triangle-down")) : (f.removeClass("ico-triangle-down"), f.addClass("ico-triangle-right")) }return e.preventDefault(), !1 } }, bindDomFuns: function (e) { var t = o.objs.getOuter(), n = t.find(".J-query-search"); t.off("click.drillDownLayer").on("click.drillDownLayer", function (t) { o.eventFuns.handleDrill(t, e) }), n.change(function (e) { var n = $(this).val(); if (n) { var a = t.find(".item-content-wrap:not(.sub-item):not(:contains(" + n + "))").parent(); a = a.find("li"); var i = t.find(".J-item-content-wrap:contains(" + n + ")").parent(); a.hide(), i.show() } else t.find(".field-item").show() }).keyup($.debounce(100, function () { $(this).change() })).click(function (e) { return !1 }) }
  }; !function () { o.objs.init() }(), r.show = o.objs.show, r.remove = o.objs.remove, r.destroy = o.objs.destroy, r.isShow = o.objs.isShow, t.default = r
}, function (e, t, n) { function a(e) { var t, n = "", a = e || {}; return function (e, a, r, o, s) { var l = a ? " need-more-pl" : " "; n = n + '<div class="drill-fields-wrap J-drill-fields-wrap selected-tooltip"><div class="toolbar" style="cursor: pointer;"><div' + i.attr("class", i.classes(["dropdown-list", "J-dropdown-list", l], [!1, !1, !0]), !1, !0) + ">", n = e.length > 5 ? n + '<div class="query-text-wrap"><i class="bdp-icon ico-search"></i><input class="query-text J-query-search" type="text"' + i.attr("placeholder", r, !0, !0) + ' action-type="search"></div>' : 0 == e.length ? n + '<div class="nodata-text nowrap J-int-text">' + i.escape(null == (t = s) ? "" : t) + "</div>" : n + '<div class="hint nowrap J-int-text">' + i.escape(null == (t = r) ? "" : t) + "</div>", n += '<ul class="list-bd J-drilll-fields-list">', function () { var a = e; if ("number" == typeof a.length) for (var r = 0, s = a.length; r < s; r++) { var l = a[r]; n = n + '<li class="field-item item-content-wrap J-field-drill-item"' + i.attr("title", l.name, !0, !0) + i.attr("data-index", r, !0, !0) + ' action-type="fieldItem"' + i.attr("data-granularity", l.granularity, !0, !0) + ">", "date" !== l.data_type || o ? n = n + '<div class="nowrap J-item-content-wrap">' + i.escape(null == (t = l.name) ? "" : t) + "</div>" : (n = n + '<div class="item-content-wrap nowrap J-item-content-wrap"><i class="bdp-icon ico-triangle-right J-sub-icon" action-type="display"></i>' + i.escape(null == (t = l.name) ? "" : t) + '</div><div class="sub-item-list nowrap J-sub-item-wrap">', function () { var e = l.subDate; if ("number" == typeof e.length) for (var a = 0, o = e.length; a < o; a++) { var s = e[a]; n = n + '<div class="field-item sub-item item-content-wrap nowrap"' + i.attr("title", s.name, !0, !0) + i.attr("data-granularity", s.key, !0, !0) + i.attr("data-index", a, !0, !0) + i.attr("parent-index", r, !0, !0) + ' action-type="subFieldItem">' + i.escape(null == (t = s.name) ? "" : t) + "</div>" } else { var o = 0; for (var a in e) { o++; var s = e[a]; n = n + '<div class="field-item sub-item item-content-wrap nowrap"' + i.attr("title", s.name, !0, !0) + i.attr("data-granularity", s.key, !0, !0) + i.attr("data-index", a, !0, !0) + i.attr("parent-index", r, !0, !0) + ' action-type="subFieldItem">' + i.escape(null == (t = s.name) ? "" : t) + "</div>" } } }.call(this), n += "</div>"), n += "</li>" } else { var s = 0; for (var r in a) { s++; var l = a[r]; n = n + '<li class="field-item item-content-wrap J-field-drill-item"' + i.attr("title", l.name, !0, !0) + i.attr("data-index", r, !0, !0) + ' action-type="fieldItem"' + i.attr("data-granularity", l.granularity, !0, !0) + ">", "date" !== l.data_type || o ? n = n + '<div class="nowrap J-item-content-wrap">' + i.escape(null == (t = l.name) ? "" : t) + "</div>" : (n = n + '<div class="item-content-wrap nowrap J-item-content-wrap"><i class="bdp-icon ico-triangle-right J-sub-icon" action-type="display"></i>' + i.escape(null == (t = l.name) ? "" : t) + '</div><div class="sub-item-list nowrap J-sub-item-wrap">', function () { var e = l.subDate; if ("number" == typeof e.length) for (var a = 0, o = e.length; a < o; a++) { var s = e[a]; n = n + '<div class="field-item sub-item item-content-wrap nowrap"' + i.attr("title", s.name, !0, !0) + i.attr("data-granularity", s.key, !0, !0) + i.attr("data-index", a, !0, !0) + i.attr("parent-index", r, !0, !0) + ' action-type="subFieldItem">' + i.escape(null == (t = s.name) ? "" : t) + "</div>" } else { var o = 0; for (var a in e) { o++; var s = e[a]; n = n + '<div class="field-item sub-item item-content-wrap nowrap"' + i.attr("title", s.name, !0, !0) + i.attr("data-granularity", s.key, !0, !0) + i.attr("data-index", a, !0, !0) + i.attr("parent-index", r, !0, !0) + ' action-type="subFieldItem">' + i.escape(null == (t = s.name) ? "" : t) + "</div>" } } }.call(this), n += "</div>"), n += "</li>" } } }.call(this), n += "</ul></div></div></div>" }.call(this, "fieldList" in a ? a.fieldList : "undefined" != typeof fieldList ? fieldList : void 0, "hasDateField" in a ? a.hasDateField : "undefined" != typeof hasDateField ? hasDateField : void 0, "hint" in a ? a.hint : "undefined" != typeof hint ? hint : void 0, "isAllField" in a ? a.isAllField : "undefined" != typeof isAllField ? isAllField : void 0, "nodataText" in a ? a.nodataText : "undefined" != typeof nodataText ? nodataText : void 0), n } var i = n(113); e.exports = a }, function (e, t) { }, , , , , function (e, t, n) { var a = n(28), i = n(103), r = n(104), o = n(10), s = n(63), l = n(89), c = {}, d = {}, t = e.exports = function (e, t, n, u, f) { var p, h, g, m, v = f ? function () { return e } : l(e), y = a(n, u, t ? 2 : 1), _ = 0; if ("function" != typeof v) throw TypeError(e + " is not iterable!"); if (r(v)) { for (p = s(e.length); p > _; _++)if ((m = t ? y(o(h = e[_])[0], h[1]) : y(e[_])) === c || m === d) return m } else for (g = v.call(e); !(h = g.next()).done;)if ((m = i(g, y, h.value, t)) === c || m === d) return m }; t.BREAK = c, t.RETURN = d }, function (e, t) { e.exports = function (e, t, n, a) { if (!(e instanceof t) || void 0 !== a && a in e) throw TypeError(n + ": incorrect invocation!"); return e } }, function (e, t, n) { var a = n(14); e.exports = function (e, t, n) { for (var i in t) n && e[i] ? e[i] = t[i] : a(e, i, t[i]); return e } }, , function (e, t, n) { "use strict"; var a = n(3), i = n(0), r = n(8), o = n(11), s = n(4)("species"); e.exports = function (e) { var t = "function" == typeof i[e] ? i[e] : a[e]; o && t && !t[s] && r.f(t, s, { configurable: !0, get: function () { return this } }) } }, function (e, t, n) { n(92), n(45), n(66), n(192), n(195), n(196), e.exports = n(0).Promise }, function (e, t, n) { "use strict"; var a, i, r, o, s = n(38), l = n(3), c = n(28), d = n(101), u = n(9), f = n(17), p = n(44), h = n(187), g = n(186), m = n(109), v = n(110).set, y = n(194)(), _ = n(90), b = n(111), w = n(112), C = l.TypeError, S = l.process, k = l.Promise, x = "process" == d(S), D = function () { }, T = i = _.f, E = !!function () { try { var e = k.resolve(1), t = (e.constructor = {})[n(4)("species")] = function (e) { e(D, D) }; return (x || "function" == typeof PromiseRejectionEvent) && e.then(D) instanceof t } catch (e) { } }(), L = function (e) { var t; return !(!f(e) || "function" != typeof (t = e.then)) && t }, A = function (e, t) { if (!e._n) { e._n = !0; var n = e._c; y(function () { for (var a = e._v, i = 1 == e._s, r = 0; n.length > r;)!function (t) { var n, r, o = i ? t.ok : t.fail, s = t.resolve, l = t.reject, c = t.domain; try { o ? (i || (2 == e._h && O(e), e._h = 1), o === !0 ? n = a : (c && c.enter(), n = o(a), c && c.exit()), n === t.promise ? l(C("Promise-chain cycle")) : (r = L(n)) ? r.call(n, s, l) : s(n)) : l(a) } catch (e) { l(e) } }(n[r++]); e._c = [], e._n = !1, t && !e._h && $(e) }) } }, $ = function (e) { v.call(l, function () { var t, n, a, i = e._v, r = I(e); if (r && (t = b(function () { x ? S.emit("unhandledRejection", i, e) : (n = l.onunhandledrejection) ? n({ promise: e, reason: i }) : (a = l.console) && a.error && a.error("Unhandled promise rejection", i) }), e._h = x || I(e) ? 2 : 1), e._a = void 0, r && t.e) throw t.v }) }, I = function (e) { if (1 == e._h) return !1; for (var t, n = e._a || e._c, a = 0; n.length > a;)if (t = n[a++], t.fail || !I(t.promise)) return !1; return !0 }, O = function (e) { v.call(l, function () { var t; x ? S.emit("rejectionHandled", e) : (t = l.onrejectionhandled) && t({ promise: e, reason: e._v }) }) }, F = function (e) { var t = this; t._d || (t._d = !0, t = t._w || t, t._v = e, t._s = 2, t._a || (t._a = t._c.slice()), A(t, !0)) }, M = function (e) { var t, n = this; if (!n._d) { n._d = !0, n = n._w || n; try { if (n === e) throw C("Promise can't be resolved itself"); (t = L(e)) ? y(function () { var a = { _w: n, _d: !1 }; try { t.call(e, c(M, a, 1), c(F, a, 1)) } catch (e) { F.call(a, e) } }) : (n._v = e, n._s = 1, A(n, !1)) } catch (e) { F.call({ _w: n, _d: !1 }, e) } } }; E || (k = function (e) { h(this, k, "Promise", "_h"), p(e), a.call(this); try { e(c(M, this, 1), c(F, this, 1)) } catch (e) { F.call(this, e) } }, a = function (e) { this._c = [], this._a = void 0, this._s = 0, this._d = !1, this._v = void 0, this._h = 0, this._n = !1 }, a.prototype = n(188)(k.prototype, { then: function (e, t) { var n = T(m(this, k)); return n.ok = "function" != typeof e || e, n.fail = "function" == typeof t && t, n.domain = x ? S.domain : void 0, this._c.push(n), this._a && this._a.push(n), this._s && A(this, !1), n.promise }, catch: function (e) { return this.then(void 0, e) } }), r = function () { var e = new a; this.promise = e, this.resolve = c(M, e, 1), this.reject = c(F, e, 1) }, _.f = T = function (e) { return e === k || e === o ? new r(e) : i(e) }), u(u.G + u.W + u.F * !E, { Promise: k }), n(37)(k, "Promise"), n(190)("Promise"), o = n(0).Promise, u(u.S + u.F * !E, "Promise", { reject: function (e) { var t = T(this); return (0, t.reject)(e), t.promise } }), u(u.S + u.F * (s || !E), "Promise", { resolve: function (e) { return w(s && this === o ? k : this, e) } }), u(u.S + u.F * !(E && n(105)(function (e) { k.all(e).catch(D) })), "Promise", { all: function (e) { var t = this, n = T(t), a = n.resolve, i = n.reject, r = b(function () { var n = [], r = 0, o = 1; g(e, !1, function (e) { var s = r++, l = !1; n.push(void 0), o++, t.resolve(e).then(function (e) { l || (l = !0, n[s] = e, --o || a(n)) }, i) }), --o || a(n) }); return r.e && i(r.v), n.promise }, race: function (e) { var t = this, n = T(t), a = n.reject, i = b(function () { g(e, !1, function (e) { t.resolve(e).then(n.resolve, a) }) }); return i.e && a(i.v), n.promise } }) }, function (e, t) { e.exports = function (e, t, n) { var a = void 0 === n; switch (t.length) { case 0: return a ? e() : e.call(n); case 1: return a ? e(t[0]) : e.call(n, t[0]); case 2: return a ? e(t[0], t[1]) : e.call(n, t[0], t[1]); case 3: return a ? e(t[0], t[1], t[2]) : e.call(n, t[0], t[1], t[2]); case 4: return a ? e(t[0], t[1], t[2], t[3]) : e.call(n, t[0], t[1], t[2], t[3]) }return e.apply(n, t) } }, function (e, t, n) { var a = n(3), i = n(110).set, r = a.MutationObserver || a.WebKitMutationObserver, o = a.process, s = a.Promise, l = "process" == n(30)(o); e.exports = function () { var e, t, n, c = function () { var a, i; for (l && (a = o.domain) && a.exit(); e;) { i = e.fn, e = e.next; try { i() } catch (a) { throw e ? n() : t = void 0, a } } t = void 0, a && a.enter() }; if (l) n = function () { o.nextTick(c) }; else if (r) { var d = !0, u = document.createTextNode(""); new r(c).observe(u, { characterData: !0 }), n = function () { u.data = d = !d } } else if (s && s.resolve) { var f = s.resolve(); n = function () { f.then(c) } } else n = function () { i.call(a, c) }; return function (a) { var i = { fn: a, next: void 0 }; t && (t.next = i), e || (e = i, n()), t = i } } }, function (e, t, n) { "use strict"; var a = n(9), i = n(0), r = n(3), o = n(109), s = n(112); a(a.P + a.R, "Promise", { finally: function (e) { var t = o(this, i.Promise || r.Promise), n = "function" == typeof e; return this.then(n ? function (n) { return s(t, e()).then(function () { return n }) } : e, n ? function (n) { return s(t, e()).then(function () { throw n }) } : e) } }) }, function (e, t, n) { "use strict"; var a = n(9), i = n(90), r = n(111); a(a.S, "Promise", { try: function (e) { var t = i.f(this), n = r(e); return (n.e ? t.reject : t.resolve)(n.v), t.promise } }) }, function (e, t, n) { "use strict"; !function () { angular.module("BC.markPoint", []).directive("markPoint", function () { return { link: function (e) { e.addMarkPoint = function () { e.checkYAxisUniqId().then(function () { e.inAddingMarkPoint = !0, setTimeout(function () { $(document).on("click.cancelMarkPoint", function () { e.endAddMarkPoint(), e.$$phase || e.$apply() }); var t = $(".chart-args").height(), n = $(".chart-left").width() + $(".chart-left-side").width() + 10; $(".add-point-mask .mask-top").css({ height: t, lineHeight: t + "px" }), $(".add-point-mask .mask-left").css({ width: n }) }, 0) }) }, e.endAddMarkPoint = function () { e.inAddingMarkPoint = !1, $(document).off("click.cancelMarkPoint") } }, controller: ["$scope", "$q", "commonService", "ngDialog", function (e, t, n, a) { var i = !1; e.checkYAxisUniqId = function () { var n = t.defer(); if (i) n.resolve(); else { var a = e.chart_ops.meta.level[e.drill_level], r = a.y[0] || a.y_optional[0]; if (r && !r.uniq_id) { var o = +new Date; angular.forEach(a.y, function (e) { e.uniq_id = o++ }), angular.forEach(a.y_optional, function (e) { e.uniq_id = o++ }), e.saveChartImmediate().then(n.resolve, n.reject) } else n.resolve() } return i = !0, n.promise }, e.editMarkPoint = function (t, n, i) { i && i.stopPropagation(), a.open({ template: "/static/chart-edit/mark-point/mark-point-modal.html", className: "ngdialog-theme-default ngdialog-small", scope: e, data: { point: angular.extend({}, t, { ct_id: n }), type: "modify" }, controller: "EditMarkPointCtrl" }) }, e.removeMarkPoint = function (t, a) { return n.fieldComment.del(t, a.fc_id).then(function () { e.saveChartImmediate() }) }, e.removeMarkPointById = function (t, a, i) { return i.stopPropagation(), n.fieldComment.del(t, a).then(function () { e.saveChartImmediate() }) }, e.markPoint_conf = [], e.show_makePoint_model = function (t) { e.$broadcast("displayMarkPointModel", t) } }] } }).directive("chartMarkPoints", function () { return { replace: !0, templateUrl: "/static/chart-edit/mark-point/mark-point-tooltip.html", link: function (e) { e.setTooltipPos = function (t, n) { n.show = !0, n.popover = {}, n.pos.top < 15 || "edit" === e.mode && n.pos.top < 40 ? n.popover.pos = "bottom" : n.popover.pos = "top" } } } }) }() }, function (e, t, n) {
  "use strict"; angular.module("BC.common").service("pendingRequests", [function () { var e = []; this.get = function () { return e }, this.add = function (t) { e.push(t) }, this.remove = function (t) { var n = e.indexOf(t); n > -1 && e.splice(n, 1) }, this.cancelAll = function () { angular.forEach(e, function (e) { e.canceller.resolve() }), e.length = 0 }, this.cancelOne = function (t) { if (t && e) for (var n = 0, a = e.length; n < a; n++)if (e[n].url == t) { e[n].canceller.resolve(), this.remove(e[n]); break } } }]).config(["$httpProvider", function (e) { e.defaults.headers.post["Content-Type"] = "application/x-www-form-urlencoded;charset=utf-8", e.defaults.headers.common.Accept = "application/json"; var t = function e(t) { var n, a, i, r, o, s, l, c = ""; for (n in t) if ((a = t[n]) instanceof Array) for (l = 0; l < a.length; ++l)o = a[l], i = n + "[" + l + "]", s = {}, s[i] = o, c += e(s) + "&"; else if (a instanceof Object) for (r in a) o = a[r], i = n + "[" + r + "]", s = {}, s[i] = o, c += e(s) + "&"; else void 0 !== a && null !== a && (c += encodeURIComponent(n) + "=" + encodeURIComponent(a) + "&"); return c.length ? c.substr(0, c.length - 1) : c }, n = function (e) { var t, n = new RegExp("(^| )" + e + "=([^;]*)(;|$)"); return (t = document.cookie.match(n)) ? unescape(t[2]) : void 0 }("locale") || "zh"; e.defaults.transformRequest = function (e) { if (angular.isObject(e) && String(e)) { var n = {}; return angular.copy(e, n), t(n) } return e }, e.interceptors.push(["$templateCache", function (e) { return { request: function (t) { return "GET" === t.method && void 0 === e.get(t.url) && t.url.match(/\.html$/) && (t.url = t.url + "?lang=" + n), t } } }]) }]).factory("chartType", ["$rootScope", "$translate", function (e, t) { var n = [{ cate: "C20", type: "C200", name: "表格", status: !1 }, { cate: "C31", type: "C310", name: "指标卡", status: !1 }, { cate: "C26", type: "C261", name: "计量图", status: !1 }, { cate: "C22", type: "C220", name: "折线图", status: !1 }, { cate: "C21", type: "C210", name: "簇状柱形图", status: !1 }, { cate: "C21", type: "C211", name: "堆积柱形图", status: !1 }, { cate: "C21", type: "C212", name: "百分比堆积柱形图", status: !1 }, { cate: "C32", type: "C320", name: "瀑布图", status: !1 }, { cate: "C24", type: "C240", name: "条形图", status: !1 }, { cate: "C24", type: "C241", name: "堆积条形图", status: !1 }, { cate: "C24", type: "C242", name: "百分比堆积条形图", status: !1 }, { cate: "C24", type: "C243", name: "对比条形图", status: !1 }, { cate: "C35", type: "C350", name: "面积图", status: !1 }, { cate: "C35", type: "C351", name: "堆积面积图", status: !1 }, { cate: "C35", type: "C352", name: "百分比堆积面积图", status: !1 }, { cate: "C28", type: "C280", name: "散点图", status: !1 }, { cate: "C23", type: "C230", name: "普通饼图", status: !1 }, { cate: "C36", type: "C360", name: "旭日图", status: !1 }, { cate: "C37", type: "C370", name: "树图", status: !1 }, { cate: "C33", type: "C330", name: "漏斗图", status: !1 }, { cate: "C27", type: "C271", name: "地图", status: !1 }, { cate: "C25", type: "C250", name: "双轴", status: !1 }, { cate: "C340", type: "C340", name: "词云", status: !1 }, { cate: "C30", type: "C301", name: "平行集图", status: !1 }, { cate: "C29", type: "C290", name: "雷达图", status: !1 }, { cate: "C28", type: "C281", name: "箱线图", status: !1 }, { cate: "C38", type: "C381", name: "3d行政地图", status: !1 }, { cate: "C38", type: "C382", name: "3d世界地图", status: !1 }, { cate: "C383", type: "C383", name: "3d球形地图", status: !1 }, { cate: "C21", type: "C213", name: "3d柱形图", status: !1 }, { cate: "C28", type: "C282", name: "3d散点图", status: !1 }, { cate: "C390", type: "C390", name: "南丁格尔玫瑰图", status: !1 }, { cate: "C22", type: "C221", name: "3d折线图", status: !1 }]; return n.forEach(function (e) { e.name = t.instant(e.type) }), n }]).factory("chartTypeTip", ["$rootScope", "$translate", function (e, t) { var n = [{ type: "C200", name: "表格", dimension: "0orMore", metric: "0orMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C310", name: "指标卡", dimension: "only0", metric: "OneOrTwo", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C261", name: "计量图", dimension: "only0", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C220", name: "折线图", dimension: "OneOrTwo", metric: "OneorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C221", name: "3d折线图", dimension: "onlyTwo", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C210", name: "簇状柱形图", dimension: "NoMoreThanTwo", metric: "OneorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C211", name: "堆积柱形图", dimension: "OneOrTwo", metric: "TwoorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C212", name: "百分比堆积柱形图", dimension: "OneOrTwo", metric: "TwoorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C213", name: "3d柱形图", dimension: "onlyTwo", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C390", name: "南丁格尔玫瑰图", dimension: "onlyOne", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C320", name: "瀑布图", dimension: "", metric: "", combination: ["OneOrTwoDOneV", "0DMoreV"], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C240", name: "条形图", dimension: "NoMoreThanTwo", metric: "OneorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C241", name: "堆积条形图", dimension: "OneOrTwo", metric: "TwoorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C242", name: "百分比堆积条形图", dimension: "OneOrTwo", metric: "TwoorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C243", name: "对比条形图", dimension: "", metric: "", combination: ["OneDTwoV", "OneDOneCOneV"], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C282", name: "3d散点图", dimension: "onlyThree", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C300", name: "桑基图", dimension: "onlyTwo", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C301", name: "平行集图", dimension: "TwotoTwenty", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C230", name: "普通饼图", dimension: "", metric: "", combination: ["OneDOneV", "0DMoreV"], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C271", name: "地图", dimension: "onlyOne", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C272", name: "地图(气泡)", dimension: "onlyOne", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C273", name: "地图(标签云)", dimension: "onlyOne", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C290", name: "雷达图", dimension: "", metric: "", combination: ["OneDMoreV", "0andMoreC3andMoreV"], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C250", name: "双轴", dimension: "NoMoreThanTwo", metric: "onlyMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C280", name: "散点图", dimension: "0orMore", metric: "onlyTwo", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C281", name: "箱线图", dimension: "OneOrTwo", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C330", name: "漏斗图", dimension: "", metric: "", combination: ["OneDOneV", "0DMoreV"], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C340", name: "词云", dimension: "onlyOne", metric: "only0", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C350", name: "面积图", dimension: "0orOne", metric: "OneorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C351", name: "堆积面积图", dimension: "onlyOne", metric: "TwoorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C352", name: "百分比堆积面积图", dimension: "onlyOne", metric: "TwoorMore", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !0 }, { type: "C360", name: "旭日图", dimension: "TwoorMore", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C370", name: "树图", dimension: "OneorMore", metric: "0orOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C381", name: "3d地图", dimension: "onlyOne", metric: "onlyOne", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C382", name: "3d世界地图", dimension: "", metric: "", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }, { type: "C383", name: "3d球形地图", dimension: "", metric: "", combination: [], showDimension: "", showMetric: "", showCombination: [], needComparison: !1 }]; return n.forEach(function (e) { e.name = t.instant(e.type), 0 == e.combination.length ? (e.showDimension = t.instant(e.dimension), e.showMetric = t.instant(e.metric)) : (e.showCombination[0] = t.instant(e.combination[0]), e.showCombination[1] = t.instant(e.combination[1])) }), n }]).factory("doubleYaxisChartTypes", [function () { return ["C220", "C210", "C211", "C212"] }]).factory("operatorHelpLink", ["$rootScope", "$translate", function (e, t) { var n = ""; return function (e) { switch (e) { case "globalFilter": n = "https://help.bdp.cn/index.php?title=%E5%85%A8%E5%B1%80%E7%AD%9B%E9%80%89%E5%99%A8"; break; case "tableFormatting": n = "https://help.bdp.cn/index.php?title=%E9%A2%9C%E8%89%B2%E4%B8%8E%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F#.E8.A1.A8.E6.A0.BC"; break; case "plotLine": n = "https://help.bdp.cn/index.php?title=%E9%A2%84%E8%AD%A6%E4%B8%8E%E8%BE%85%E5%8A%A9%E7%BA%BF#.E8.BE.85.E5.8A.A9.E7.BA.BF"; break; case "chartWarn": n = "https://help.bdp.cn/index.php?title=%E9%A2%84%E8%AD%A6%E4%B8%8E%E8%BE%85%E5%8A%A9%E7%BA%BF#.E9.A2.84.E8.AD.A6"; break; case "dateYoy": n = "https://help.bdp.cn/index.php?title=%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97#.E7.BB.B4.E5.BA.A6.E4.B8.BA.E9.9D.9E.E6.97.A5.E6.9C.9F.E5.AD.97.E6.AE.B5"; break; case "customYoy": n = "https://help.bdp.cn/index.php?title=%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97#.E7.BB.B4.E5.BA.A6.E4.B8.BA.E6.97.A5.E6.9C.9F.E5.AD.97.E6.AE.B5"; break; case "advanceDateFilter": n = "https://help.bdp.cn/index.php?title=%E7%AD%9B%E9%80%89%E5%99%A8#.E6.97.A5.E6.9C.9F.E5.AD.97.E6.AE.B5"; break; case "innerFilter": n = "https://help.bdp.cn/index.php?title=%E7%AD%9B%E9%80%89%E5%99%A8#.E5.9B.BE.E5.86.85.E7.AD.9B.E9.80.89.E5.99.A8"; break; case "colorSettingByNum": n = "https://help.bdp.cn/index.php?title=%E9%A2%9C%E8%89%B2%E4%B8%8E%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F#.E6.B8.90.E5.8F.98.E9.A2.9C.E8.89.B2"; break; case "colorSettingByField": n = "https://help.bdp.cn/index.php?title=%E9%A2%9C%E8%89%B2%E4%B8%8E%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F#.E6.9E.9A.E4.B8.BE.E9.A2.9C.E8.89.B2"; break; case "resultFilter": n = "https://help.bdp.cn/index.php?title=%E7%AD%9B%E9%80%89%E5%99%A8#.E7.BB.93.E6.9E.9C.E7.AD.9B.E9.80.89.E5.99.A8"; break; case "chartChain": n = "https://help.bdp.cn/index.php?title=%E5%9B%BE%E8%A1%A8%E8%81%94%E5%8A%A8"; break; case "chartMoveCalc": n = "https://help.bdp.cn/index.php?title=%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97#.E7.A7.BB.E5.8A.A8.E8.AE.A1.E7.AE.97"; break; case "chartRepetition": n = "https://help.bdp.cn/index.php?title=%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97#.E9.87.8D.E5.A4.8D.E7.8E.87"; break; case "chartRetention": n = "https://help.bdp.cn/index.php?title=%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97#.E7.95.99.E5.AD.98.E7.8E.87"; break; case "chartRunning": n = "https://help.bdp.cn/index.php?title=%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97#.E7.B4.AF.E8.AE.A1.E8.AE.A1.E7.AE.97"; break; case "chartActivity": n = "https://help.bdp.cn/index.php?title=%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97#.E6.B4.BB.E8.B7.83.E7.8E.87"; break; case "csv": n = "https://help.bdp.cn/index.php?title=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0#.E4.B8.8A.E4.BC.A0CSV.E6.96.87.E4.BB.B6"; break; case "fileUpload": n = "https://help.bdp.cn/index.php?title=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0#.E4.B8.8A.E4.BC.A0Excel.E6.96.87.E4.BB.B6"; break; case "fileAppend": n = "https://help.bdp.cn/index.php?title=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0#.E8.BF.BD.E5.8A.A0.E6.95.B0.E6.8D.AE"; break; case "fileReplace": n = "https://help.bdp.cn/index.php?title=%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0#.E6.9B.BF.E6.8D.A2.E6.95.B0.E6.8D.AE"; break; case "chartArgs": n = "https://help.bdp.cn/index.php?title=%E5%8F%82%E6%95%B0"; break; default: n = "" }n && window.open(n) } }]).factory("formula", ["$rootScope", "$translate", function (e, t) { var n = [{ name: "求和", type: "SUM", show: "number" }, { name: "平均值", type: "AVERAGE", show: "number" }, { name: "计数", type: "COUNT", show: "all" }, { name: "去重计数", type: "COUNT_DISTINCT", show: "all" }, { name: "更多计数方式", type: "more", show: "number", list: [{ name: "最大值", type: "MAX", show: "number" }, { name: "最小值", type: "MIN", show: "number" }, { name: "中位数", type: "MED", show: "number" }, { name: "百分位", type: "PERCENTILE", show: "number", list: [{ name: "5", type: "PERCENT_5", show: "number", percent: .05 }, { name: "10", type: "PERCENT_10", show: "number", percent: .1 }, { name: "25", type: "PERCENT_25", show: "number", percent: .25 }, { name: "50", type: "PERCENT_50", show: "number", percent: .5 }, { name: "75", type: "PERCENT_75", show: "number", percent: .75 }, { name: "90", type: "PERCENT_90", show: "number", percent: .9 }, { name: "95", type: "PERCENT_95", show: "number", percent: .95 }] }] }]; return n.forEach(function (e) { e.list ? (e.name = t.instant("more"), e.list.forEach(function (e) { e.list ? (e.name = t.instant("PERCENTILE"), e.list.forEach(function (e) { e.name = t.instant(e.type) })) : e.name = t.instant(e.type) })) : e.name = t.instant(e.type) }), n }]).factory("formulaFunc", function () { return [{ name: "求和", type: "SUM", show: "number" }, { name: "平均值", type: "AVG", show: "number" }, { name: "最大值", type: "MAX", show: "number" }, { name: "最小值", type: "MIN", show: "number" }, { name: "计数", type: "COUNT", show: "all" }, { name: "去重计数", type: "COUNT(DISTINCT())", show: "all" }] }).factory("verifyTbName", ["$translate", function (e) { return function (e) { return !0 } }]).factory("dateTimeByHalfHour", ["$rootScope", function (e) { return [{ value: "00:00:00", label: "00:00" }, { value: "01:00:00", label: "01:00" }, { value: "02:00:00", label: "02:00" }, { value: "03:00:00", label: "03:00" }, { value: "04:00:00", label: "04:00" }, { value: "05:00:00", label: "05:00" }, { value: "06:00:00", label: "06:00" }, { value: "07:00:00", label: "07:00" }, { value: "08:00:00", label: "08:00" }, { value: "09:00:00", label: "09:00" }, { value: "10:00:00", label: "10:00" }, { value: "11:00:00", label: "11:00" }, { value: "12:00:00", label: "12:00" }, { value: "13:00:00", label: "13:00" }, { value: "14:00:00", label: "14:00" }, { value: "15:00:00", label: "15:00" }, { value: "16:00:00", label: "16:00" }, { value: "17:00:00", label: "17:00" }, { value: "18:00:00", label: "18:00" }, { value: "19:00:00", label: "19:00" }, { value: "20:00:00", label: "20:00" }, { value: "21:00:00", label: "21:00" }, { value: "22:00:00", label: "22:00" }, { value: "23:00:00", label: "23:00" }] }]).factory("capacityHint", ["ngDialog", "$rootScope", function (e, t) { return function () { e.closeAll(), t.maxSize = t.personalInfo.capacity_info.capacity, e.open({ template: "/static/partials/dialogTemplates/capacityHint.html", className: "ngdialog-theme-default ngDialog-width-330", scope: t }) } }]).factory("upgradeLevelTip", ["ngDialog", function (e) { return function (t) { var n = { title: "API同步提示", vipLevel0Text: "目前您最多可接入3个第三方API，您可自定义设置需要同步的API，其他API将停止同步，升级会员可同步更多API哦~", vipLevel1Text: "目前您最多可接入8个第三方API，您可自定义设置需要同步的API，其他API将停止同步，升级金钻可同步更多API哦~", vipLevel2Text: "如需更多，请联系BDP商务热线400-063-9966" }; angular.extend(n, t), e.open({ template: "/static/partials/dialogTemplates/upgrade_level_tip.html", className: "ngdialog-theme-default ngDialog-width-330", data: n }) } }]).factory("redirectLogin", ["$http", "$window", function (e, t) { var n = t.location.hostname; n = n.split(".")[0]; var a = 0; return function () { if (/^w{3}$|^me$/.test(n)) t.location.href = bdp.bdpLogin.checkPartnerLogin(); else { if (a) return; a = 1, e.get("/api/domain/idp_logout", { params: { domain: n } }).success(function (e) { a = 0, 0 == e.status && e.result.idp_logout ? t.location.href = bdp.bdpLogin.checkPartnerLogin(e.result.idp_logout) : t.location.href = bdp.bdpLogin.checkPartnerLogin() }) } } }]).factory("errHint", ["redirectLogin", "$rootScope", "$timeout", "$location", "$translate", function (e, t, n, a, i) {
    var r = 0, o = null, s = !1; return function (a, l) {
      var c, d = t.language; l = l || {}, window.isThirdIframe || (window.isThirdIframe = t.isThirdIframe = !1); var u = !1; if ("number" != typeof a && isNaN(Number(a))) c = a; else {
        switch (1 * a) {
          case 1: $.cookie("token", ""), $.cookie("token_invalid", 1, { path: "/" }), s || (s = !0, e()); break; case 2: c = i.instant("error.API"); break; case 3: return 0 == r && (c = i.instant("error.noExistOrAccess"), alert(c), r += 1), void (window.location.href = "/"); case 4: c = i.instant("error.unManager"); break; case 10: c = i.instant("error.serverFail"); break; case 11: c = i.instant("error.paramError"); break; case 12: c = i.instant("error.internetOutRange"), setTimeout(function () { e() }, 1e3); break; case 13: 0 == r && (c = i.instant("error.haveLogin"), alert(c), r += 1), $.cookie("token", ""), $.cookie("token_invalid", 1, { path: "/" }), e(); break; case 14: e(); break; case 15: 0 == r && (c = i.instant("error.noPermission"), alert(c), r += 1), e(); break; case 18: c = i.instant("error.noBind"), c = ""; break; case 19: c = i.instant("error.confirmed"), e(), c = ""; break; case 20: c = "", $.cookie("password_changed", 1, { path: "/" }), e(); break; case 21: c = i.instant("error.noChartOrnoAccess"); break; case 22: c = i.instant("error.dashMetaTooLarge"); break; case 102: c = i.instant("error.datasourceNotExist"); break; case 103: c = i.instant("error.noDelete"); break; case 104: c = i.instant("ds.connectFail"); break; case 126: c = i.instant("error.apiTimesLimit"); break; case 106: c = i.instant("error.saveSuccessAndSync"); break; case 110: c = i.instant("error.dsRepeat"); break; case 111:
            c = i.instant("error.captchaSendError"); break; case 112: c = i.instant("error.captchaError"); break; case 113: c = i.instant("error.captchaOutOfLimit"); break; case 114: c = i.instant("error.kstRepeat"); break; case 115: c = i.instant("error.kstError"); break; case 116: c = i.instant("error.jinyiweiConnFail"); break; case 117: c = i.instant("error.loginInfoErrorOrUserLock"); break; case 118: c = i.instant("error.dsConfigError"); break; case 119: c = i.instant("error.loginFrequently"); break; case 120: c = i.instant("error.phoneVerifyFail"); break; case 121: c = i.instant("error.serviceException"); break; case 122: c = i.instant("error.accountFail"); break; case 124: c = i.instant("error.passworkWrong"); break; case 125: c = i.instant("error.usernameWrong"); break; case 128: c = i.instant("ds.baiduTaskExist"); break; case 129: c = i.instant("error.tokenWrong"); break; case 201: c = i.instant("wb.isUpdatingThen"); break; case 1001: c = i.instant("error.userForbidden"); break; case 1002: c = i.instant("error.password"); break; case 1004: c = i.instant("error.noAuthorizationInfo"); break; case 1009: c = i.instant("error.noUser"); break; case 1012: c = i.instant("error.limitNumber"); break; case 1014: c = "", $.cookie("password_reset", 1, { path: "/" }), e(); break; case 1015: c = i.instant("error.accountActived"); break; case 1016: c = i.instant("error.accoutLimit"); break; case 1018: c = i.instant("error.codeError"); break; case 1023: c = i.instant("error.mobileExisted"); break; case 3003: c = i.instant("error.noId"); break; case 3005: c = i.instant("error.needCtId"); break; case 3008: c = i.instant("error.needId"); break; case 3009: c = i.instant("error.missId"); break; case 3011: c = i.instant("error.fidId"); break; case 3204: c = i.instant("error.dashboardOccupied"); break; case 3210: c = i.instant("error.dashboardNotbelong"); break; case 3211: c = i.instant("error.noChart"); break; case 3212: c = i.instant("error.noFolder"); break; case 3216: c = i.instant("error.infoErrorInTable"); break; case 3219: c = i.instant("error.tplNotExist"); break; case 3220: c = i.instant("error.noDashboard"); break; case 3221: c = i.instant("error.noBelong"); break; case 3222: c = i.instant("error.chartsNumMismatch"); break; case 3223: c = i.instant("error.noSelect"); break; case 3224: c = i.instant("error.noLinkage"); break; case 3231: c = i.instant("error.needConfigList"); break; case 3232: c = i.instant("error.infoErrorInTable"); break; case 7001: c = i.instant("error.needFormula"); break; case 7024: c = i.instant("error.stringAbove"); break; case 7200: c = i.instant("error.errorFormula"); break; case 7300: c = i.instant("error.unknow"); break; case 7400: c = i.instant("error.fieldNull"); break; case 7500: c = i.instant("error.fieldRepeat"); break; case 7590: c = i.instant("error.fieldUsing"); break; case 7601: c = i.instant("error.dataNameRepeat"); break; case 7700: c = i.instant("error.errorFormula"); break; case 8003: c = i.instant("error.accoutRepeat"); break; case 9003: c = i.instant("error.info"); break; case 10004: c = i.instant("error.datasourceSyncing"); break; case 10005: c = i.instant("error.dsAmountOutOfLimit"); break; case 10006: c = l.warn_msg; break; case 10007: c = i.instant("error.noDelete"); break; case 10100: c = i.instant("error.noDianJingAccess"); break; case 10115: c = i.instant("error.startDateError"); break; case 10116: c = i.instant("error.endDateError"); break; case 10117: c = i.instant("ds.baiduTaskDomainExit"); break; case 10118: c = i.instant("ds.baiduTaskDomainNotExit"); break; case 10119: c = i.instant("ds.baiduTaskCompanyError"); break; case 10120: c = i.instant("ds.baiduTaskDomainError"); break; case 10121: case 10122: case 10123: c = l.warn_msg; break; case 10124: c = i.instant("ds.baiduTaskWeekError"); break; case 10625: case 10626: c = i.instant("error.changeFileEncode"); break; case 12002: c = i.instant("error.groupRepeat"); break; case 12008: c = i.instant("error.contactManager"); break; case 12010: c = i.instant("error.noActivateCode"); break; case 12011: c = i.instant("error.errorActivateCode"); break; case 12111: c = l.warn_msg, setTimeout(function () { $.cookie("token", ""), $.cookie("token_invalid", 1, { path: "/" }), e() }, 1e3); break; case 13001: c = i.instant("error.noSelectId"); break; case 13004: c = i.instant("error.selectRepeat"); break; case 16004: c = i.instant("error.noPermissionToPreview"); break; case 16005: c = i.instant("error.replacingExcelFailed"); break; case 16006: c = i.instant("error.exceptionInExcel"); break; case 16007: c = i.instant("error.excelNotExist"); break; case 16008: c = i.instant("error.excelIsUpdating"); break; case 16009: c = i.instant("error.deletingExcelFailed"); break; case 16010: c = i.instant("error.excelCanNotBeEmpty"); break; case 16011: c = i.instant("error.appendingExcelFailed"); break; case 16012: c = i.instant("error.fieldsInExcelMismatch"); break; case 16013: c = i.instant("error.sameFieldsWhileAppending"); break; case 16014: c = i.instant("error.fieldsNotInTable"); break; case 16015: c = i.instant("error.sheetNotExist"); break; case 16016: c = i.instant("error.sheetCanNotBeIgnored"); break; case 16017: c = i.instant("error.uploadingExcelFailed"); break; case 16018: case 16019: c = i.instant("error.fieldsInExcelMismatch"); break; case 16025: c = i.instant("error.csvEncodeNotSupport"); break; case 16026: c = i.instant("error.changeFileEncode"); break; case 19001: c = i.instant("error.selectRely"); break; case 19002: c = i.instant("wb.noWorksheets"); break; case 19005: c = "聚类字段名称不能为空"; break; case 21007: c = i.instant("error.dbCannotBeDeleted"); break; case 22001: c = i.instant("error.aggregationsRepeat"); break; case 22002: c = i.instant("error.aggregationsNull"); break; case 23023: c = i.instant("error.accoutExisted"); break; case 23002: c = i.instant("error.captchaError"); break; case 23003: c = i.instant("error.personalAccountNotExist"); break; case 23008: c = i.instant("error.nicknameExisted"); break; case 23009: c = i.instant("error.emailError"); break; case 23010: c = i.instant("error.captchaCounts"); break; case 23013: c = i.instant("error.formatError"); break; case 23014: c = i.instant("error.oneHourLater"); break; case 23016: c = i.instant("error.twentyFourHourLater"); break; case 23019: c = i.instant("error.emailExisted"); break; case 23020: c = i.instant("error.phoneExisted"); break; case 23023: c = i.instant("error.personalUserExisted"); break; case 23030: c = i.instant("error.sensitiveWord"); break; case 24007: c = i.instant("error.chartUnremove"); break; case 24008: c = i.instant("error.userLimit"); break; case 24009: c = i.instant("error.haveDeleted"); break; case 24010: c = i.instant("error.haveRule"); break; case 24011: c = i.instant("error.haveChart"); break; case 25001: c = i.instant("error.folderExisted"); break; case 25004: c = i.instant("wb.cannotMoveToSubFolder"); break; case 25005: c = i.instant("wb.cannotMoveTwoLevelsToSubFolder"); break; case 26003: c = i.instant("error.nameExisted"); break; case 26007: c = i.instant("error.exceedTasks"); break; case 26008: c = "分享表暂不支持聚类模型"; break; case 29e3: c = l.warn_msg; break; case 30001: c = i.instant("error.tableIsBeingUsed"); break; case 30003: c = l.warn_msg; break; case 30004: c = i.instant("error.tableMustBeBasetable"); break; case 30007: c = i.instant("error.fieldsInExcelMismatch"); break; case 30009: c = i.instant("error.sameTitleExistInExcel"); break; case 31e3: c = i.instant("error.existRely"); break; case 31005: case 31006: c = l.warn_msg; break; case 31007: c = i.instant("error.viewGeneratorRuleNotExist"); break; case 31008: c = i.instant("error.canNotModifyThisViewType"); break; case 31009: c = i.instant("error.viewGeneratorTypeNotExist"); break; case 32001: c = i.instant("error.openDsTokenError"); break; case 32002: c = i.instant("error.ipNotInWhiteList"); break; case 40001: c = i.instant("error.noPermissionToDelete"); break; case 40005: c = l.warn_msg; break; case 40007: c = i.instant("error.dataTooLong"); break; case 40008: c = i.instant("error.changeToAggregatorFunc"); break; case 40009: c = i.instant("error.titleHasInvalidCharacter"); break; case 40010: c = i.instant("error.contentHasInvalidCharacter"); break; case 40011: c = i.instant("error.functionNeedBrackets"); break; case 40012: c = i.instant("error.mapCanNotBeEmpty"); break; case 41001: c = i.instant("error.LdapTokenIsError"); break; case 41002: c = i.instant("error.LdapTokenIsDestroyed"); break; case 41003: c = i.instant("error.LdapUserNotExist"); break; case 70001: c = i.instant("ds.auxiliaryFieldHasExist"); break; case 70002: c = i.instant("error.fieldNameUsing"); break; case 81001: var f = ""; l.warn_msg && (f = "：" + l.warn_msg), c = i.instant("error.illegalFilter") + f; break; case 81002: var f = ""; l.warn_msg && (f = "：" + l.warn_msg), c = i.instant("error.illegalSortField") + f; break; case 9e4: c = i.instant("error.partitionExceed"); break; case 90001: c = i.instant("error.partitionNotEnough"); break; case 90002: c = i.instant("error.intermediateTableNoPartition"); break; case 90003: c = i.instant("error.unionTableNoPartition"); break; case 90006: c = i.instant("error.childTbBeingCreated"); break; case 90100: l.result && l.result.map && (c = l.result.map(function (e) { return e.name }).join()), c = i.instant("chartTemplate.tplUnusable") + "[" + c + "]"; break; case 90007: c = i.instant("error.tableTypeNotSupportOpt"); break; case 90008: c = i.instant("error.updateModeNotChanged"); break; case 90009: c = i.instant("error.canNotChangeToRealTimeUpdateMode"); break; case 90010: c = i.instant("error.canNotSetPartitionField"); break; case 90011: c = i.instant("error.canNotMergeThisTable"); break; case 90012: c = i.instant("error.updatedSoFrequentlyPleaseWait"); break; case 100001: c = i.instant("error.failedGetOperatorInfo"); break; case 100002: c = i.instant("error.authorizationExpired"); break; case 100003: c = i.instant("error.authorizationRecordNotExist"); break; case 100004: c = i.instant("error.failedAddOperator"); break; case 100005: c = i.instant("error.failedCreateAuthorization"); break; case 100006: c = i.instant("error.failedUpdateLdapToken"); break; case 100007: c = i.instant("error.failedCreateLdapToken"); break; case 100008: c = i.instant("error.failedDeleteLdapToken"); break; case 110001: c = i.instant("error.mobileOSorVersionRequired"); break; case 110002: c = i.instant("error.unknownMobileOS"); break; case 110003: c = i.instant("error.mobileVersionFormatError"); break; case 120001: c = i.instant("error.srcDashIdRequiredWhenMovingChart"); break; case 120002: c = i.instant("error.targetDashIdRequiredWhenMovingChart"); break; case 120003: c = i.instant("error.dashFolderIdRequiredWhenMovingChart"); break; case 120004: c = i.instant("error.forbiddenMovingChart"); break; case 120005: c = i.instant("error.movedChartExist"); break; default: c = l && l.warn_msg ? l.warn_msg : "en" == d ? "Something Wrong~" : "出错啦", u = !0
        }
      } return l.dialog ? t.global.dialog_hint = c : 1 == Number(c) && 20 == Number(c) && 1014 == Number(c) || (t.global.hint = c, t.$$phase || t.$digest()), l.always_show || (o && (n.cancel(o.$$timeoutId), o = null), o = n(function () { t.global.dialog_hint = "", t.global.hint = "" }, l.delay_time || 5e3)), u
    }
  }]).factory("tbList", ["$rootScope", "$http", "errHint", function (e, t, n) { return function () { t.get("/api/tb/list", { params: { access_token: $.cookie("token") } }).success(function (t) { if (0 == t.status) t.result ? e.tbList = t.result.self : e.tbList = []; else { var a = parseInt(t.status); n(a) } }) } }]).factory("formatFieldPercentile", ["formulaKeyMap", function (e) { return function (e) { if (!e) return e; if ("PERCENT" != e.aggregator) return e.percent = "", e; var t = new RegExp("^(\\d|[1-9]\\d|100)$"); if ("中位数" == e.aggregator_name || "Median" == e.aggregator_name) e.aggregator = "MED", e.percent = "0.5"; else if (t.test(parseInt(e.aggregator_name))) { var n = parseInt(e.aggregator_name); e.aggregator = "PERCENT_" + n, e.percent = String(n / 100) } return e } }]).factory("setAdvanceAggregatorName", ["formulaKeyMap", function (e) { function t(e) { var t = bdpChart.language || "zh", n = ""; if (e.hasOwnProperty("yoyQoqType")) { var a = e.yoyQoqType; e.hasOwnProperty("YoY") && "rate" == a && function (e) { switch (e) { case "year": n = "zh" == t ? "去年同比率" : "Compare to last year(rate)"; break; case "quarter": n = "zh" == t ? "上季同比率" : "Compare to last quarter(rate)"; break; case "month": n = "zh" == t ? "上月同比率" : "Compare to last month(rate)"; break; case "week": n = "zh" == t ? "上周同比率" : "Compare to last week(rate)"; break; case "day": n = "zh" == t ? "上日同比率" : "Compare to last day(rate)" } }(e.YoY), e.hasOwnProperty("YoY") && "value" == a && function (e) { switch (e) { case "year": n = "zh" == t ? "去年同比值" : "Compare to last year(value)"; break; case "quarter": n = "zh" == t ? "上季同比值" : "Compare to last quarter(value)"; break; case "month": n = "zh" == t ? "上月同比值" : "Compare to last month(value)"; break; case "week": n = "zh" == t ? "上周同比值" : "Compare to last week(value)"; break; case "day": n = "zh" == t ? "上日同比值" : "Compare to last day(value)" } }(e.YoY), e.hasOwnProperty("QoQ") && function (e) { switch (e) { case "rate": n = "zh" == t ? "环比增长率" : "Day on Day(rate)"; break; case "value": n = "zh" == t ? "环比增长值" : "Day on Day(value)" } }(a) } if (e.hasOwnProperty("yoyQoqSetting")) { var i = e.yoyQoqSetting; "qoq" == i.type ? function (e) { switch (e) { case "year": n = "zh" == t ? "按年环比增长" : "Year on Year"; break; case "quarter": n = "zh" == t ? "按季环比增长" : "Quarter on Quarter"; break; case "month": n = "zh" == t ? "按月环比增长" : "Month on Month"; break; case "week": n = "zh" == t ? "按周环比增长" : "Week on Week"; break; case "day": n = "zh" == t ? "按日环比增长" : "Day on Day" } }(i.date_field_type) : "filter" == i.type ? function (e) { if (1 == e.aggregator || 2 == e.aggregator) { if (0 == e.compare_method) "filter_yoy_month" == e.filter_type ? n = "zh" == t ? "同比上月增长值" : "Compare to last month year on year increase value" : "filter_yoy_year" == e.filter_type ? n = "zh" == t ? "同比去年增长值" : "Compare to last year year on year increase value" : "filter_yoy_week" == e.filter_type && (n = "zh" == t ? "同比上周增长值" : "Compare to last week year on year increase value"); else if (1 == e.compare_method) n = "zh" == t ? "环比增长值" : "Month on month increase value"; else if (2 == e.compare_method) if ("zh" == t) { switch (n = "对比" + (0 == e.relative_type ? "前移" : "后移") + e.relative_value, e.date_field_type) { case "year": n += "年"; break; case "quarter": n += "季"; break; case "month": n += "月"; break; case "week": n += "周"; break; case "day": n += "天" }n += "增长值" } else n = "Compare to " + (0 == e.relative_type ? "Move forward " : "Backward shift ") + e.relative_value + " " + e.date_field_type; else 3 == e.compare_method && (n = "zh" == t ? "对比自定义日期增长值" : "Compare custom date increase value"); 2 == e.aggregator && (n = n.replace(/值/g, "率").replace(/value/gi, "rate")) } else if (3 == e.aggregator) if (0 == e.compare_method) "filter_yoy_month" == e.filter_type ? n = "zh" == t ? "上月同期值" : "Last month same period value" : "filter_yoy_year" == e.filter_type ? n = "zh" == t ? "去年同期值" : "Last year same period value" : "filter_yoy_week" == e.filter_type && (n = "zh" == t ? "上周同期值" : "Last week same period value"); else if (1 == e.compare_method) n = "zh" == t ? "环比对比日期值" : "Month on month compare date value"; else if (2 == e.compare_method) if ("zh" == t) { switch (n = (0 == e.relative_type ? "前移 " : "后移 ") + e.relative_value, e.date_field_type) { case "year": n += "年"; break; case "quarter": n += "季"; break; case "month": n += "月"; break; case "week": n += "周"; break; case "day": n += "天" }n += "值" } else n = (0 == e.relative_type ? "Move forward" : "Backward shift") + e.relative_value + e.date_field_type; else 3 == e.compare_method && (n = "zh" == t ? "自定义日期值" : "Custom date value") }(i) : function (e) { switch (e) { case "yoy_week": n = "zh" == t ? "上周同比" : "Compare to last week"; break; case "yoy_month": n = "zh" == t ? "上月同比" : "Compare to last month"; break; case "yoy_quarter": n = "zh" == t ? "上季同比" : "Compare to last quarter"; break; case "yoy_year": n = "zh" == t ? "去年同比" : "Compare to last year"; break; case "custom": case "nodate_custom": n = "zh" == t ? "自定义对比" : "Custom Comparison" } }(i.type) } return n } function n(e) { var t = bdpChart.language || "zh", n = "1", a = ""; if (e.hasOwnProperty("advance_aggregator")) { var i = e.advance_aggregator.type; "percentage" == i ? (a = "zh" == t ? "百分比" : "Percentage", n = "1") : "retention" == i ? (a = "zh" == t ? "留存率" : "Retention", n = "0") : "activity" == i ? (a = "zh" == t ? "活跃率" : "Active Rate", n = "0") : "repetition" == i ? (a = "zh" == t ? "重复率" : "Repetition", n = "0") : "running" == i ? (a = "zh" == t ? "累计计算" : "Cumulative Calculation", n = "1") : "moving" == i && (a = "zh" == t ? "移动计算" : "Moving Calculation", n = "1") } var r = []; return r.push(n), r.push(a), r } return function (a, i) { var r = bdpChart.language || "zh", o = "", s = "", l = "", c = []; if (a.hasOwnProperty("aggregator")) { if (o = e[a.aggregator], Number(a.aggregator_name) <= 100 && Number(a.aggregator_name) > 0) if ("zh" == r) o = "百分位" + parseInt(a.aggregator_name); else { var d = ""; d = parseInt(a.aggregator_name) % 10 == 1 && 11 != parseInt(a.aggregator_name) ? "st percentile" : parseInt(a.aggregator_name) % 10 == 2 && 12 != parseInt(a.aggregator_name) ? "nd percentile" : parseInt(a.aggregator_name) % 10 == 3 && 13 != parseInt(a.aggregator_name) ? "rd percentile" : "th percentile", o = parseInt(a.aggregator_name) + d } 1 == a.is_build_aggregated && (o = "") } a.hasOwnProperty("advance_aggregator") && (c = n(a), s = c[1], "0" == c[0] && (o = "")); var u = t(a); return u && (s = u), i ? l = s : o ? (l += "(" + o, s && (l += " - " + s), l += ")") : s && (l += "(", l += s, l += ")"), l } }]).factory("getFunctionList", ["$rootScope", "commonService", function (e, t) { var n = { base: [], all: [] }; t.getFunctionList().then(function (t) { if (0 == t.status) { var a = t.result.classification, i = {}; angular.forEach(a, function (e, t) { i[t] = [], angular.forEach(a[t], function (e, n) { i[t].push({ usage: e.usage, description: e.desc, example: e.demo, type: e.name }) }) }), n.base = i[2].concat(i[3]).concat(i[4]).concat(i[5]).concat(i[6]), e.global.funcList = n } }) }]).service("commonHttp", ["$http", "$rootScope", "errHint", "pendingRequests", "$q", function (e, t, n, a, i) { function r(e, t) { return o = {}, o._t = (new Date).getTime(), angular.extend(o, e), s.errHint = !0, t ? angular.extend(s, t) : t = {}, o._xsrf = bdp.utils.getCookie("_xsrf"), o } var o = {}, s = { errHint: !0 }, l = function (e) { if (e = e.data, "0" == e.status) return e; if (s.errHint) { var t = parseInt(e.status), a = null; e.errstr && (a = { warn_msg: e.errstr, result: e.result }), n(t || e.errstr, a) } return e }, c = ["/api/warn/amount"], d = /^\//; return { get: function (t, n, s) { var u = i.defer(); o = r(n, s); var f = { url: t, canceller: u }; d.test(t) || (t = "/" + t), $.inArray(t, c) < 0 && a.add(f); var p = e.get(t, { params: o, timeout: u.promise }).then(l); return p.finally(function () { a.remove(f) }), p.success = function (e) { p.then(e) }, p.error = function (e) { p.then(null, e) }, p }, post: function (t, n, a) { d.test(t) || (t = "/" + t), o = r(n, a); var s = i.when(e.post(t, o), l); return s.success = function (e) { s.then(e) }, s.error = function (e) { s.then(null, e) }, s } } }]).factory("webSocket", [function () { function e() { return !i && o > 0 } var t = {}, n = null, a = null, i = !1, r = location.protocol, o = 30, s = 0, l = 0, c = !1, d = { timeout: 12e4, timeoutObj: null, reset: function (e, t) { clearTimeout(this.timeoutObj), this.start(e, t) }, start: function (e, n) { this.timeoutObj = setTimeout(function () { c = !0, o = 30, t.reConnect(e, n), BDPLogger.log("feStatistics", { category: "websocket", action: "reconnect", opt_label: "heartbeat", opt_value: 1 }) }, this.timeout) } }; if (!SockJS) throw "Please add socketjs to your app."; return t.connect = function (a, u) { u = u || {}; var f = ["opened", "received", "closed"], p = $.cookie("token"); return /^http(s)?:\/\//.test(a) || (a = r + "//" + location.host + a), n = new SockJS(a + "?token=" + p), d.reset(a, u), n.addEventListener("heartbeat", function (e) { d.reset(a, u) }), n.onopen = function () { u.onOpen && u.onOpen({ status: f[0] }) }, n.onmessage = function (e) { if ("HeartBeat" != e.data) { var t = "string" == typeof e.data ? $.parseJSON(e.data) : e.data; if (0 == t.state && (i = !0, o < 30 && BDPLogger.log("feStatistics", { category: "websocket", action: "reconnect", opt_label: "onsuccess", opt_value: 1 }), o = 30, s > 0 && BDPLogger.log("feStatistics", { category: "websocket", action: "reconnectSuc", opt_label: s, opt_value: 1 }), s++), 0 == t.state) { if (!u.onMessage) throw "Please give the func of onMessage."; u.onMessage({ status: f[1], data: t }), c && (BDPLogger.log("feStatistics", { category: "websocket", action: "reconnect", opt_label: "heartbeatSuc", opt_value: 1 }), c = !1), d.reset(a, u) } } }, n.onclose = function (r) { new Date; i = !1, l != s && (l = s, BDPLogger.log("feStatistics", { category: "websocket", action: "reconnectSucClose", opt_label: s, opt_value: 1 })), BDPLogger.log("feStatistics", { category: "websocket", action: "connect", opt_label: "onerror", opt_value: 1 }), 0 == o && (BDPLogger.log("feStatistics", { category: "websocket", action: "reconnect", opt_label: "onfail", opt_value: 1 }), BDPLogger.log("webSocket30FailMsg", { token: p }), 0 == s && BDPLogger.log("feStatistics", { category: "websocket", action: "reconnectFirst", opt_label: "onfail", opt_value: 1 })), e() && t.reConnect(a, u), u.onClose && (u.onClose({ status: f[2] }), n = null) }, t }, t.reConnect = function (e, n) { t.disconnect(), a = setTimeout(function () { t.connect(e, n), o-- }, 2e3) }, t.disconnect = function () { null != n && (n.close(), n = null), clearTimeout(a), i = !1 }, t.send = function (e) { n && n.send(e) }, t.socket = n, t }]).factory("autoRefreshChart", ["$timeout", function (e) { var t = {}; return t.visibilityChartOptions = [], t.refresh = function (e) { var n = ["data-ctid", "data-scrolling", "data-drill-status"], a = e.drawChartUrl, i = e.type || "dashboard", r = e.scope, o = e.ret, s = "string" == typeof o.data ? $.parseJSON(o.data) : o.data, l = (o.status, o._t), c = null; if (!r) throw "Please give param scope."; if (!r.dashEditMode && !r.autoPlaying && a && (c = s.ct_id || [], c.length)) { for (var d in r.draw_chart_url) { var u = r.draw_chart_url[d].options.ct_id; if ($.inArray(u, c) > -1) { var f = $("[" + n[0] + "=" + u + "]"), p = f.attr(n[1]), h = f.attr(n[2]), g = p && "true" == p, m = h && "true" == h; if (g || m) continue; if (f.attr("data-from-websocket", "1"), window.BDP_visibilityChangeFlag && (f.attr("data-page-active", window.BDP_visibilityChangePageActive), !window.BDP_visibilityChangePageActive)) { "dashboard" == i ? t.visibilityChartOptions.push(a[d].options) : t.visibilityChartOptions.push(a.options); continue } "dashboard" == i ? a[d].options._t = l : a.options._t = l, r.draw_chart_url[d].options.read_cache = !1 } } r.$$phase || r.$digest() } }, t.refreshWaitChart = function () { var n = ["data-ctid", "data-scrolling", "data-drill-status"]; t.visibilityChartOptions.length > 0 && e(function () { for (var e = new Date, a = 0, i = t.visibilityChartOptions.length; a < i; a++) { $("[" + n[0] + "=" + t.visibilityChartOptions[a].ct_id + "]").attr("data-from-websocket", 2), t.visibilityChartOptions[a] && (t.visibilityChartOptions[a]._t = e) } t.visibilityChartOptions = [] }, 0) }, t }]).factory("projectTreeCache", ["$timeout", function (e) { return { treeCache: null, clearTreeCache: function () { this.treeCache = null }, setTreeCache: function (e) { this.treeCache = angular.copy(e) }, getTreeCache: function (e) { return this.treeCache } } }]).factory("queryTextFunc", function () { return { existText: function (e, t) { return !!e && e.toString().toLowerCase().indexOf(t.toLowerCase()) >= 0 } } }).factory("permissionWhitelist", [function () { return { customChart: ["zjhyxx", "qiyangdemo", "bdp_tpl", "yjzg", "ICBC_SH", "bdp_dev", "szsaiwei", "Weimeizi", "HNYOUA", "haizhi", "zhytest", "mcyp", "demo", "bdp_autotest", "jodo", "chunyu.me", "renrenche", "gzqixiu", "shiji", "dotcunited", "qdsj", "shiyong", "tujia", "CZHB", "HKCTSHOTELS", "uxintest", "HRXX", "ylzc", "wfnz", "qddemo", "howbuy", "datatest", "duxin_gsgz", "haizhi_test", "renrenche_test", "qa_autotest", "bdp_autotest", "baihe"], dataScreen: ["zjhyxx", "qiyangdemo", "haizhi", "demo", "shiyong", "tujia", "CZHB", "uxintest", "DFV", "ICBC_SH", "whwd", "datatest", "duxin_gsgz", "haizhi_test", "qa_autotest", "bdp_autotest"], tableImg: ["wanli", "haizhi", "demo", "hofan", "szkushang", "datatest", "duxin_gsgz", "haizhi_test", "qa_autotest", "bdp_autotest"], multiDimension: ["boldseas", "haizhi", "demo", "mcyp", "bdp_autotest", "maimaiche", "HNYOUA", "datatest", "duxin_gsgz", "haizhi_test", "qa_autotest"], newTraining: [null, "GJHJ", "kmf", "ktm", "duxin_gsgz", "duxin_gsgz2", "haizhi", "demo", "bdp_autotest", "comjia", "data center", "hofan", "CXJQAS", "tujia", "CZHB", "oBike", "uxintest", "shiyong", "ylzc", "shaks", "qddemo", "shnewl", "zxzq", "kaishu", "howbuy", "mcyp", "p2peye", "baihe", "Eaju", "datatest", "zh_gsgz", "zh_gsgz2", "haizhi_test", "qa_autotest", "aitouzi"] } }]).service("formulaService", ["$translate", "ngDialog", "commonService", "$timeout", "$q", function (e, t, n, a, i) { this.isTooLong = function (e) { return n.field.getAggregatorLen(e).then(function (e) { var t = !1; return 0 == e.status ? e.result.formula_length > 1e3 && (t = !0) : t = "error", t }) }, this.confirmModify = function (n, a) { var i; i = isObjectEmpty(a) ? e.instant("chart.calcFieldTooLongConfirm") : e.instant("chart.groupFieldTooLongConfirm"), t.openConfirm({ templateUrl: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngdialog-width-340", data: { title: e.instant("tips"), message: i, okClick: n } }) }, this.alertSuccess = function (e) { var n = t.open({ template: "/static/partials/dialogTemplates/alert-success.html", className: "ngdialog-theme-default ngDialog-width-300", data: { message: e }, preCloseCallback: function () { a.cancel(i) } }), i = a(function () { t.close(n.id) }, 3e3) } }]).service("userInfoService", ["commonService", "$q", "pendingRequests", function (e, t, n) { var a = null, i = t.defer(); this.get = function (t) { if (!t && a) i.resolve(a); else { var r = n.get(), o = !1; angular.forEach(r, function (e) { "/api/user/info" == e.url && (o = !0) }), o && !t || e.user.getUserInfo().then(function (e) { a = e, i.resolve(e) }) } return i.promise }, this.get().then(function (e) { }) }]).service("globalFilterService", ["$timeout", function (e) { var t = {}; return { setAttr: function (e, n) { t[e] = n }, getAttr: function (e) { return t.hasOwnProperty(e) ? t[e] : function () { } } } }]).service("bdpConfirm", ["ngDialog", "$translate", "$timeout", function (e, t, n) { var a = { title: t.instant("tips") }; this.default = function (t) { return e.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", data: $.extend({}, a, t) }) }, this.alert = function (t) { var a = e.open({ template: "/static/partials/dialogTemplates/alert-success.html", className: "ngdialog-theme-default ngDialog-width-300", closeByDocument: !0, data: t, preCloseCallback: function () { n.cancel(i) } }), i = n(function () { e.close(a) }, 3e3); return a } }])
}, function (e, t, n) {
  "use strict"; angular.module("BC.common").value("operatorTranslateIds", ["equal", "notEqual", "greatThan", "lessThan", "GTE", "LTE", "contain", "notContain", "isEmpty", "isNotEmpty", "selectDateRange", "isIn", "isNotIn", "beginWith", "endWith"]).factory("filterOperatorMap", ["$translate", "operatorTranslateIds", function (e, t) { var n = []; return t.forEach(function (t) { n.push(e.instant(t)) }), n }]).factory("filterOperatorMapWithType", ["$translate", "operatorTranslateIds", function (e, t) { var n = [0, 1, 6, 7, 8, 9], a = [0, 1, 2, 3, 4, 5, 8, 9], i = [0, 1, 2, 3, 4, 5, 8, 9, 10], r = { string: [], number: [], date: [] }; return n.forEach(function (n) { r.string.push({ value: n, name: e.instant(t[n]) }) }), a.forEach(function (n) { r.number.push({ value: n, name: e.instant(t[n]) }) }), i.forEach(function (n) { r.date.push({ value: n, name: e.instant(t[n]) }) }), r }]).factory("filterOperatorMapWithTypeSpecial", ["$translate", "operatorTranslateIds", function (e, t) { var n = [0, 1, 6, 7, 8, 9, 11, 12], a = [0, 1, 2, 3, 4, 5, 8, 9, 11, 12], i = [0, 1, 2, 3, 4, 5, 8, 9, 10], r = { string: [], number: [], date: [] }; return n.forEach(function (n) { r.string.push({ value: n, name: e.instant(t[n]) }) }), a.forEach(function (n) { r.number.push({ value: n, name: e.instant(t[n]) }) }), i.forEach(function (n) { r.date.push({ value: n, name: e.instant(t[n]) }) }), r }]).factory("dsStatusMap", ["$translate", function (e) { var t = ["ds.status.normal", "ds.status.disconnect", "ds.status.updating", "ds.updateStatus.fail", "ds.updateStatus.updating"], n = [t[0], t[0], t[1], t[2]], a = [t[0], t[0], t[3], t[4]], i = { statusMap: [], updateStatusMap: [] }; return n.forEach(function (t) { i.statusMap.push(e.instant(t)) }), a.forEach(function (t) { i.updateStatusMap.push(e.instant(t)) }), i }]).factory("conditionType", ["$translate", function (e) { return [{ value: 0, text: e.instant("tableFilter.andType") }, { value: 1, text: e.instant("tableFilter.orType") }] }]).factory("dataTypeList", ["$translate", function (e) { return [{ value: "string", text: e.instant("string") }, { value: "number", text: e.instant("number") }, { value: "date", text: e.instant("date") }] }]).factory("dataTypeMap", ["$translate", function (e) { return { string: e.instant("string"), number: e.instant("number"), date: e.instant("date") } }]).factory("alphaOrderType", ["$translate", function (e) { return [{ value: "ascending", text: e.instant("ascending") }, { value: "descending", text: e.instant("descending") }] }]).factory("chartLineType", ["$translate", function (e) { return [{ type: "constant", name: e.instant("chart.constantValue") }, { type: "calculate", name: e.instant("chart.calculateValue") }] }]).factory("chartMetricOpt", ["$translate", function (e) { var t = $.cookie("locale") || "zh", n = [{ unit: "", text: e.instant("auto") }, { unit: 1e3, text: "K" }, { unit: 1e6, text: "M" }, { unit: 1e9, text: "G" }], a = [{ unit: "", text: e.instant("auto") }, { unit: 1e4, text: "万" }, { unit: 1e8, text: "亿" }, { unit: 1e3, text: "K" }, { unit: 1e6, text: "M" }, { unit: 1e9, text: "G" }]; return console.log(n), "en" == t ? n : a }]).factory("$getCustomFormula", ["$rootScope", "$translate", function (e, t) { function n(e) { var n = []; return e.forEach(function (e) { n.push({ type: e, name: t.instant(e) }) }), n } return n }]).factory("formulaKeyMap", ["$translate", function (e) { var t = {}; return ["TOTAL", "SUM", "AVERAGE", "AVG", "MIN", "MAX", "COUNT", "COUNT_DISTINCT", "YoY", "QoQ", "MED", "PERCENT_5", "PERCENT_10", "PERCENT_25", "PERCENT_50", "PERCENT_75", "PERCENT_90", "PERCENT_95", "LAST"].forEach(function (n) { t[n] = e.instant(n) }), t }]).factory("dateNameMap", ["$translate", function (e) { var t = {}; return ["day", "week", "month", "quarter", "year", "hour", "minute", "second"].forEach(function (n) { t[n] = e.instant(n) }), t }]).factory("dataShowTypeMap", ["$translate", function (e) { var t = {}; return ["chart.byText", "chart.byImg"].forEach(function (n) { t[n] = e.instant(n) }), t }]).factory("granularityMap", ["$translate", function (e) { var t = {}; return ["chart.byDay", "chart.byWeek", "chart.byMonth", "chart.byQuarter", "chart.byYear", "chart.byHour", "chart.byMinute", "chart.bySecond", "normal"].forEach(function (n) { t[n] = e.instant(n) }), t }]).factory("AdvfilterOperatorMap", ["$translate", function (e) { var t = ["equal", "notEqual", "contain", "notContain", "beginWith", "endWith", "isNotEmpty", "isEmpty"], n = [], a = { 0: 0, 1: 1, 2: 6, 3: 7, 4: 10, 5: 11, 6: 9, 7: 8 }; return t.forEach(function (t, i) { n.push({ value: a[i], name: e.instant(t) }) }), n }]).factory("AdvfilterOperatorNumberMap", ["$translate", function (e) { var t = ["equal", "notEqual", "greatThan", "lessThan", "GTE", "LTE", "between", "isNotEmpty", "isEmpty"], n = [], a = { 0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 12, 7: 9, 8: 8 }; return t.forEach(function (t, i) { n.push({ value: a[i], name: e.instant(t) }) }), n }]).factory("AdvfilterOperatorList", ["$translate", function (e) { var t = ["equal", "notEqual", "greatThan", "lessThan", "GTE", "LTE", "contain", "notContain", "beginWith", "endWith", "between", "isEmpty", "isNotEmpty"], n = {}, a = { 0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 10, 9: 11, 10: 12, 11: 8, 12: 9 }; return t.forEach(function (t, i) { n[a[i]] = e.instant(t) }), n }]).factory("warnOperatorMap", ["$translate", function (e) { var t = ["equal", "notEqual", "greatThan", "GTE", "lessThan", "LTE", "between"], n = {}, a = { 0: 3, 1: 4, 2: 1, 3: 6, 4: 2, 5: 5, 6: 7 }; return t.forEach(function (t, i) { n[a[i]] = e.instant(t) }), n }]).factory("warnOperatorMapByType", ["$translate", function (e) { var t = ["equal", "notEqual", "greatThan", "lessThan", "GTE", "LTE", "contain", "notContain", "isEmpty", "isNotEmpty", "beginWith", "endWith", "between"], n = [0, 1, 6, 7, 10, 11, 8, 9], a = [0, 1, 2, 3, 4, 5, 8, 9, 12], i = { string: [], number: [] }; return n.forEach(function (n) { i.string.push({ value: n, name: e.instant(t[n]) }) }), a.forEach(function (n) { i.number.push({ value: n, name: e.instant(t[n]) }) }), angular.copy(i) }]).factory("warnFieldFormulaList", ["$translate", function (e) { var t = [{ name: "求和", type: "SUM", show: "number" }, { name: "平均值", type: "AVERAGE", show: "number" }, { name: "最大值", type: "MAX", show: "number" }, { name: "最小值", type: "MIN", show: "number" }, { name: "中位数", type: "MED", show: "number" }, { name: "计数", type: "COUNT", show: "all" }, { name: "去重计数", type: "COUNT_DISTINCT", show: "all" }]; return t.forEach(function (t) { t.name = e.instant(t.type) }), t }]).factory("dayOfWeekList", ["$rootScope", function (e) { for (var t = e.language, n = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"], a = ["星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"], i = [], r = 0; r <= 6;)i.push({ name: "en" === t ? n[r] : a[r], value: ++r }); return i }]).factory("dateOfMonthList", ["$rootScope", function (e) { for (var t = e.language, n = 0, a = []; n < 31;)n++, a.push({ name: n + ("en" === t ? "" : "日"), value: n }); return a.push({ name: "en" === t ? "Last Day" : "最后一天", value: -1 }), a }]).factory("numberInnerFilterMap", ["$translate", function (e) { var t = ["all", "equal", "notEqual", "greatThan", "GTE", "lessThan", "LTE", "between", "isEmpty", "isNotEmpty"], n = [], a = { 0: -1, 1: 0, 2: 1, 3: 2, 4: 4, 5: 3, 6: 5, 7: 12, 8: 8, 9: 9 }; return t.forEach(function (t, i) { n.push({ value: a[i], text: e.instant(t) }) }), n }]).factory("conditionTypeVal", ["$translate", function (e) { return function (t) { return 0 == t ? e.instant("template.all") : e.instant("template.any") } }]).factory("dbTypeMap", ["$rootScope", function (e) { return { 1: "MySQL", 2: "Oracle", 3: "MSSQL", 4: "OpenDS", 5: "Baidu Sem", 7: "Sogou Sem", 8: "en" == e.language ? "4D Pocket" : "四次元空间袋", 10: "Umeng", 11: "360 Sem", 12: "Shenma Sem", 13: "Shopex", 15: "53KF", 16: "快商通", 18: "en" == e.language ? "Baidu ads ranking" : "百度推广实况", 19: "JinYiWei", 21: "百度网盟", 22: "SEM数据管理系统", 23: "Live800" } }]).factory("databaseType", ["$translate", function (e) {
    var t = [{ dbType: 1, typeName: "MySQL", dbLabel: "ds", category: "ds" }, { dbType: 2, typeName: "Oracle", dbLabel: "ds", category: "ds" }, { dbType: 3, typeName: "MSSQL", dbLabel: "ds", category: "ds" }, { dbType: 4, typeName: "OpenDS", dbLabel: "opends", category: "opends" }, { dbType: 8, typeName: e.instant("dsType.4dPocket"), dbLabel: "public", category: "public", translateName: "dsType.4dPocket" }, { dbType: 13, typeName: "Shopex", dbLabel: "shopex" }, { dbType: 18, typeName: e.instant("dsType.baiduAdsRank"), dbLabel: "baiduAds", translateName: "dsType.baiduAdsRank" }, { dbType: 22, typeName: "SEM数据管理系统", dbLabel: "sem", category: "sem" }, { dbType: 5, typeName: e.instant("dsType.baiduSem"), dbLabel: "api", category: "api_0", translateName: "dsType.baiduSem" }, {
      dbType: 11,
      typeName: e.instant("dsType.360Sem"), dbLabel: "api", category: "api_1", translateName: "dsType.360Sem"
    }, { dbType: 7, typeName: e.instant("dsType.sougouSem"), dbLabel: "api", category: "api_0", translateName: "dsType.sougouSem" }, { dbType: 39, typeName: e.instant("dsType.sougouSmall"), dbLabel: "api", category: "api_1", tip: "ds.sougouSmallTip", translateName: "dsType.sougouSmall" }, { dbType: 12, typeName: e.instant("dsType.shenmaSem"), dbLabel: "api", category: "api_1", tip: "ds.ShenmaTip", translateName: "dsType.shenmaSem" }, { dbType: 21, typeName: e.instant("dsType.baiduUnion"), dbLabel: "api", category: "api_0", tip: "ds.WMTip", translateName: "dsType.baiduUnion" }, { dbType: 30, typeName: e.instant("dsType.sougouUnion"), dbLabel: "api", category: "api_0", tip: "", translateName: "dsType.sougouUnion" }, { dbType: 27, typeName: e.instant("dsType.youdaoSpread"), dbLabel: "api", category: "api_1", translateName: "dsType.youdaoSpread" }, { dbType: 31, typeName: e.instant("dsType.weiboSpread"), dbLabel: "api", category: "api_1", tip: "", translateName: "dsType.weiboSpread" }, { dbType: 29, typeName: e.instant("dsType.tencentSpread"), dbLabel: "api", category: "api_1", tip: "ds.tencentSpreadTip", syncTip: !0, translateName: "dsType.tencentSpread" }, { dbType: 36, typeName: e.instant("dsType.tencentgdt"), dbLabel: "api", category: "api_1", tip: "ds.tencentgdtTip", translateName: "dsType.tencentgdt" }, { dbType: 33, typeName: e.instant("dsType.sinaFuyi"), dbLabel: "api", category: "api_1", tip: "", translateName: "dsType.sinaFuyi" }, { dbType: 25, typeName: e.instant("dsType.toutiaoAds"), dbLabel: "api", category: "api_1", translateName: "dsType.toutiaoAds" }, { dbType: 37, typeName: e.instant("dsType.youkuDSP"), dbLabel: "api", category: "api_1", translateName: "dsType.youkuDSP" }, { dbType: 9, typeName: e.instant("dsType.baiduAnalytics"), dbLabel: "api", category: "api_5", tip: "ds.baiduStatisticsTip", syncTip: !0, translateName: "dsType.baiduAnalytics" }, { dbType: 24, typeName: e.instant("dsType.cnzz"), dbLabel: "api", category: "api_1", tip: "ds.cnzzTip", syncTip: !0, translateName: "dsType.cnzz" }, { dbType: 10, typeName: e.instant("dsType.umeng"), dbLabel: "api", category: "api_1", tip: "ds.umengTip", translateName: "dsType.umeng" }, { dbType: 17, typeName: e.instant("dsType.baiduBridge"), dbLabel: "api", category: "api_1", tip: "ds.baiduBridgeTip", translateName: "dsType.baiduBridge" }, { dbType: 20, typeName: e.instant("dsType.tq"), dbLabel: "api", category: "api_1", tip: "ds.TQTip", translateName: "dsType.tq" }, { dbType: 15, typeName: e.instant("dsType.53kf"), dbLabel: "api", category: "api_1", translateName: "dsType.53kf" }, { dbType: 23, typeName: e.instant("dsType.live800"), dbLabel: "api", category: "api_0", tip: "ds.live800Tip", syncTip: !0, translateName: "dsType.live800" }, { dbType: 32, typeName: e.instant("dsType.shangwutong"), dbLabel: "api", category: "api_1", tip: "ds.shangwutongTip", translateName: "dsType.shangwutong" }, { dbType: 28, typeName: e.instant("dsType.chengxintong"), dbLabel: "api", category: "api_1", translateName: "dsType.chengxintong" }, { dbType: 19, typeName: e.instant("dsType.jinyiwei"), dbLabel: "api", category: "api_3", translateName: "dsType.jinyiwei" }, { dbType: 16, typeName: e.instant("dsType.kuaishangtong"), dbLabel: "api", category: "api_2", translateName: "dsType.kuaishangtong" }, { dbType: 34, typeName: e.instant("dsType.jinshuju"), dbLabel: "api", category: "api_1", translateName: "dsType.jinshuju" }, { dbType: 35, typeName: e.instant("dsType.EC"), dbLabel: "api", category: "api_0", tip: "ds.ECTip", translateName: "dsType.EC" }, { dbType: 38, typeName: e.instant("dsType.md"), dbLabel: "api", category: "api_1", tip: "ds.mdTip", syncTip: !0, translateName: "dsType.md" }, { dbType: 41, typeName: e.instant("dsType.CM"), dbLabel: "api", category: "api_1", tip: "ds.CMTip", translateName: "dsType.CM" }, { dbType: 26, typeName: e.instant("ba.bdpAnalysis"), dbLabel: "ba", category: "", translateName: "ba.bdpAnalysis" }]; return t.forEach(function (t) { t.typeName = t.translateName ? e.instant(t.translateName) : t.typeName }), t
  }]).factory("databaseSyncTime", [function () { return { hourOptions: ["00", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23"], minuteOptions: ["00", "05", "10", "15", "20", "25", "30", "35", "40", "45", "50", "55"] } }]).factory("dateTimesMap", [function () { return [{ name: "00", value: "00" }, { name: "01", value: "01" }, { name: "02", value: "02" }, { name: "03", value: "03" }, { name: "04", value: "04" }, { name: "05", value: "05" }, { name: "06", value: "06" }, { name: "07", value: "07" }, { name: "08", value: "08" }, { name: "09", value: "09" }, { name: "10", value: "10" }, { name: "11", value: "11" }, { name: "12", value: "12" }, { name: "13", value: "13" }, { name: "14", value: "14" }, { name: "15", value: "15" }, { name: "16", value: "16" }, { name: "17", value: "17" }, { name: "18", value: "18" }, { name: "19", value: "19" }, { name: "20", value: "20" }, { name: "21", value: "21" }, { name: "22", value: "22" }, { name: "23", value: "23" }, { name: "24", value: "24" }] }]).factory("databaseParamTip", [function () { return { 1: { connect: [{ key: "host", name: "服务器", desc: "数据库的公网访问地址，如IP、域名等。" }, { key: "port", name: "端口", desc: "数据库的公网访问端口号。" }, { key: "username", name: "用户名", desc: "数据库的公网访问用户名" }, { key: "password", name: "密码", desc: "数据库的公网访问密码" }, { key: "database", name: "数据库", desc: "目标数据库名称" }] } } }]).constant("formulaDocument", { SUM: { usage: "SUM(表达式/数值字段)", description: "返回表达式或数值字段所有值的合计，只适用于数值字段，空值不会计算", example: 'SUM(销售额)，返回"销售额"字段对应的所有非空值的总和', type: "SUM", aggregate: 1 }, AVG: { usage: "AVG(表达式/数值字段)", description: "返回表达式或数值字段所有值的平均值，只适用于数值字段，空值不会计算", example: 'AVG(销售额)，返回"销售额"字段对应的所有非空值的平均值', type: "AVG", aggregate: 1 }, MAX: { usage: "MAX(表达式/数值字段)", description: "返回表达式或数值字段中的最大值，只适用于数值字段", example: 'MAX(销售额)，返回"销售额"字段对应值的最大值', type: "MAX", aggregate: 1 }, MIN: { usage: "MIN(表达式/数值字段)", description: "返回表达式或数值字段中的最小值，只适用于数值字段", example: 'MIN(销售额)，返回"销售额"字段对应值的最小值', type: "MIN", aggregate: 1 }, COUNT: { usage: "COUNT(表达式/字段)", description: "返回表达式所有有效字段的数据条目数，空值不会计算", example: 'COUNT(销售额)，返回"销售额"字段对应的所有非空值的数据条目数', type: "COUNT", aggregate: 1 }, COUNT_DISTINCT: { usage: "COUNT(DISTINCT(表达式/字段))", description: "去重计数，返回表达式所有有效字段的不同数据条目数，空值不会计算", example: 'COUNT(DISTINCT(销售额))，返回"销售额"字段对应的所有非空值的不同数据条目数', type: "COUNT_DISTINCT", aggregate: 1 }, ROUND: { usage: "ROUND(表达式／数值字段,自然数)", description: "按指定的位数对数值进行四舍五入", example: "ROUND([销售额],1) 将销售额四舍五入至小数点后一位", type: "ROUND", aggregate: 0 }, FLOOR: { usage: "FLOOR(表达式／数值字段)", description: "对指定数值向下取整数", example: "FLOOR([销售额]) 将销售额向下取整数", type: "FLOOR", aggregate: 0 }, CEIL: { usage: "CEIL(表达式／数值字段)", description: "对指定数值向上取整数", example: "CEIL([销售额]) 将销售额向下取整数", type: "CEIL", aggregate: 0 }, ABS: { usage: "ABS（表达式／数值字段）", description: "对指定数值取绝对值", example: "ABS(利润)取利润的绝对值", type: "ABS", aggregate: 0 }, PMOD: { usage: "PMOD(表达式1／数值字段1,表达式2／数值字段2)", description: "取数值1除数值2的余数的绝对值", example: "PMOD([销售额],[员工数])取销售额除员工数的的余数的绝对值", type: "PMOD", aggregate: 0 }, UNIX_TIMESTAMP: { usage: "UNIX_TIMESTAMP(日期字段)", description: "返回‘1970-01-01 00:00:00’到日期字段的秒数", example: "UNIX_TIMESTAMP([数据获取日期])，返回‘1970-01-01 00:00:00’到[数据获取日期]的秒数", type: "UNIX_TIMESTAMP", aggregate: 0 }, ROW_MAX: { usage: "ROW_MAX(表达式1/字段1,表达式2/字段2……)", description: "对比同行中各列的值，返回值最大的，可传入2～8个数值型参数", example: "ROW_MAX([部门1销售额],[部门2销售额])，返回该行中部门1销售额与部门1销售额两个字段中的最大值", type: "ROW_MAX", aggregate: 0 }, ROW_MIN: { usage: "ROW_MIN(表达式1/字段1,表达式2/字段2……)", description: "对比同行中各列的值，返回值最小的，可传入2～8个数值型参数", example: "ROW_MIN([部门1销售额],[部门2销售额],345)，返回该行中部门1销售额、部门1销售额两个字段以及值345中的最大值", type: "ROW_MIN", aggregate: 0 }, MAX_DATE: { type: "MAX_DATE", usage: "MAX_DATE(日期字段)", description: "返回该字段所有日期数据中最大值", example: "MAX_DATE([登陆时间])，返回该字段中最大的日期", aggregate: 1 }, MIN_DATE: { type: "MIN_DATE", usage: "MIN_DATE(日期字段)", description: "返回该字段所有日期数据中最小值", example: "MIN_DATE([登陆时间])，返回该字段中离当前时间最远的日期", aggregate: 1 }, HOUR_DIFF: { type: "HOUR_DIFF", usage: "HOUR_DIFF(日期字段1，日期字段2)", description: "返回两个日期相差的小时数，只允许传入日期型字段", example: "HOUR_DIFF([登陆时间],[离线时间] )，返回同一行上“登陆时间”至“离线时间”间隔小时数", aggregate: 0 }, MINUTE_DIFF: { type: "MINUTE_DIFF", usage: "MINUTE_DIFF(日期字段1，日期字段2)", description: "返回两个日期相差的分钟数，只允许传入日期型字段", example: "MINUTE_DIFF([登陆时间],[离线时间] )，返回同一行上“登陆时间”至“离线时间”间隔分钟数", aggregate: 0 }, SECOND_DIFF: { type: "SECOND_DIFF", usage: "SECOND_DIFF(日期字段1，日期字段2)", description: "返回两个日期相差的秒钟数，只允许传入日期型字段", example: "SECOND_DIFF([登陆时间],[离线时间] )，返回同一行上“登陆时间”至“离线时间”间隔秒钟数", aggregate: 0 }, DAY_DIFF: { usage: "DAY_DIFF(日期字段1,日期字段2)", description: "返回两个日期相差的天数，只允许传入日期型字段", example: 'DAY_DIFF([离职日期],[入职日期] )，返回同一行上"离职日期"至"入职日期"间隔天数', type: "DAY_DIFF", aggregate: 0 }, MONTH_DIFF: { usage: "MONTH_DIFF(日期字段1,日期字段2)", description: "返回两个日期相差的月数，只允许传入日期型字段", example: 'MONTH_DIFF([离职日期],[入职日期] )，返回同一行上"离职日期"至"入职日期"间隔月数', type: "MONTH_DIFF", aggregate: 0 }, YEAR_DIFF: { usage: "YEAR_DIFF(日期字段1,日期字段2)", description: "返回两个日期相差的年数，只允许传入日期型字段", example: 'YEAR_DIFF([离职日期],[入职日期] )，返回同一行上"离职日期"至"入职日期"间隔年数', type: "YEAR_DIFF", aggregate: 0 }, WEEK: { usage: "WEEK(日期字段)", description: "返回该日期在当年的第几周，只允许传入日期型字段", example: "WEEK([入职日期])，返回入职日期为该年的第几周", type: "WEEK", aggregate: 0 }, QUARTER: { usage: "QUARTER(日期字段)", description: "返回该日期在当年的第几个季度，只允许传入日期型字段", example: "QUARTER([入职日期])，返回入职日期为该年的第几个季度", type: "QUARTER", aggregate: 0 }, NOW: { usage: "NOW()", description: "返回当前系统时间，无需参数", type: "NOW", aggregate: 0 }, FIRST_DAY_OF_MONTH: { usage: "FIRST_DAY_OF_MONTH(表达式1/字段1,表达式2/字段2)", description: "返回某月第一天，函数参数为数值型字段，依次代表年，月", example: 'FIRST_DAY_OF_MONTH(2015,1)，返回"2015年1月1日 00:00:00"', type: "FIRST_DAY_OF_MONTH", aggregate: 0 }, LAST_DAY_OF_MONTH: { usage: "LAST_DAY_OF_MONTH(表达式1/字段1,表达式2/字段2)", description: "返回某月最后一天，函数参数为数值型字段，依次代表年，月", example: 'LAST_DAY_OF_MONTH(2015,1)，返回"2015年1月31日 00:00:00"', type: "LAST_DAY_OF_MONTH", aggregate: 0 }, WORK_DAY_OF_MONTH: { usage: "WORK_DAY_OF_MONTH(表达式1/字段1,表达式2/字段2)", description: "返回某月工作天数，函数参数为数值型字段，依次代表年，月", example: "WORK_DAY_OF_MONTH(2015,1)，返回2015年1月工作日天数", type: "WORK_DAY_OF_MONTH" }, DAY_OF_WEEK: { usage: "DAY_OF_WEEK(日期字段)", description: "返回该日期对应该周的天数", example: "DAY_OF_WEEK([下单时间])", type: "DAY_OF_WEEK", aggregate: 0 }, IF: { usage: "IF(表达式，结果1，结果2)", description: 'IF为判断函数，表达式为比较型或计算型语句。若表达式的计算结果正确，则返回"结果1"，否则，返回"结果2"', example: 'IF([订单数]  > 500, "合格", "不合格")。结果为若该行"订单数"字段对应值大于500，则返回"合格"，否则返回"不合格"', type: "IF", aggregate: 0 }, YEAR: { usage: "YEAR(日期字段)", description: "返回该日期对应的年份。只允许传入日期型字段", example: 'YEAR([下单时间])，返回该行"下单时间"字段对应的年份', type: "YEAR", aggregate: 0 }, MONTH: { usage: "MONTH(日期字段)", description: "返回该日期对应的月份。只允许传入日期型字段", example: 'MONTH([下单时间])，返回该行"下单时间"字段对应的年份', type: "MONTH", aggregate: 0 }, DAY: { usage: "DAY(日期字段)", description: "返回该日期对应的日的值。只允许传入日期型字段", example: 'DAY([下单时间])，返回该行"下单时间"字段对应的日的值', type: "DAY", aggregate: 0 }, HOUR: { usage: "HOUR(日期字段)", description: "返回该日期对应的小时的值。只允许传入日期型字段", example: 'HOUR([下单时间])，返回该行"下单时间"字段对应的小时的值', type: "HOUR", aggregate: 0 }, MINUTE: { usage: "MINUTE([时间字段])", description: "返回该日期对应的分钟的值。只允许传入日期型字段", example: "MINUTE([下单时间])，返回该行下单时间字段对应的分钟的值", type: "MINUTE", aggregate: 0 }, SECOND: { usage: "SECOND([时间字段])", description: "返回该日期对应的秒的值。只允许传入日期型字段", example: "SECOND([下单时间])，返回该行下单时间字段对应的秒的值", type: "SECOND", aggregate: 0 }, TO_DATE: { type: "TO_DATE", usage: "TO_DATE(日期字段)", description: "返回日期字段的年月日部分", example: "TO_DATE([入库日期])，返回入库日期的年月日时间", aggregate: 0 }, DATE_ADD: { type: "DATE_ADD", usage: "DATE_ADD(起始日期, 数值字段)", description: "返回从起始日期算起，数值字段对应天数之后的日期", example: "DATE_ADD([入库日期], 1)，返回货品入库第二天的日期", aggregate: 0 }, DATE_SUB: { type: "DATE_SUB", usage: "DATE_SUB(起始日期, 数值字段)", description: "返回从起始日期算起，数值字段对应天数之前的日期", example: "DATE_SUB([出库日期], 1)，返回货品出库前一天的日期", aggregate: 0 }, CONCAT: { type: "CONCAT", usage: "CONCAT(字段1, 字段2...)", description: "返回顺序联结各参数的字符串", example: "CONCAT([货品编号], [类型编号])，返回货品编号和类型编号联结后的字符串", aggregate: 0 }, INSTRING: { type: "INSTRING", usage: "INSTRING(字符串1, 字符串2[, 起始位置])", description: "返回字符串2在字符串1的起始位置后第一次出现时的位置，其中起始位置可选", example: 'INSTRING([名字],"尔”)，返回“尔”在名字字段中第一次出现时的位置', aggregate: 0 }, LENGTH: { type: "LENGTH", usage: "LENGTH(字符串)", description: "返回字符串的长度", example: "LENGTH([货品名])，返回货品名的长度", aggregate: 0 }, REPEAT: { type: "REPEAT", usage: "REPEAT(字符串, 数值)", description: "返回字符串重复对应数值次数后的新字符串结果", example: "REPEAT([货品名], 2)，返回货品名重复2次得到字符串", aggregate: 0 }, REVERSE: { type: "REVERSE", usage: "REVERSE(字符串)", description: "返回字符串倒转后的新字符串结果", example: "REVERSE([类型编号])，返回类型编号倒转后的字符串", aggregate: 0 }, SUBSTR: { type: "SUBSTR", usage: "SUBSTR(字符串, 起始位置[, 长度])", description: "返回从起始位置起对应长度的字符串的子字符串，长度为可选项", example: "SUBSTR([商品类型], 4)，返回商品类型的索引为4起至末尾的子字符串", aggregate: 0 }, REGEXP_EXTRACT: { type: "REGEXP_EXTRACT", usage: "REGEXP_EXTRACT(字符串, 正则表达式[, 索引])", description: "返回字符串正则表达式解析结果,需要注意的是正则表达式的\\需要使用\\进行转义，即\\\\d)，'索引'是返回结果(0表示返回全部结果，1表示返回正则表达式中第一个() 对应的结果)", example: "REGEXP_EXTRACT([货品ID],'[\\\\d+\\\\-]+', 0)，返回货品ID中的数字部分", aggregate: 0 }, REGEXP_REPLACE: { type: "REGEXP_REPLACE", usage: "REGEXP_REPLACE(字符串A, 正则表达式, 字符串B)", description: "返回将字符串A中符合正则表达式的部分替换成字符串B后的结果", example: "REGEXP_REPLACE([货品名], '[\\\\d＋]+', '')，返回将货品名中数字部分替换成空字符串后的结果", aggregate: 0 }, TIME_CONVERT: { type: "TIME_CONVERT", usage: "TIME_CONVERT(时间戳字段[, 类型])", description: "UNIX时间戳转日期，支持秒级，毫秒级，传入参数为unix时间戳，如果时间戳精确到毫秒级，第二个参数传1", example: "TIME_CONVERT([时间戳字段])；TIME_CONVERT(1441509383)；TIME_CONVERT([时间戳字段]，1)；TIME_CONVERT(1441509383000，1)", aggregate: 0 }, PERCENT: { type: "PERCENT", usage: "PERCENT([数值字段], 百分位)", description: "求数值类型字段的中位数及百分位数, 传入参数为数值字段;第二个参数范围是0<p<1,例如0.1，0.25，0.75，0.95", example: "PERCENT([数学考试分数], 0.5)，返回考试分数的中位数", aggregate: 1 }, IP_LOCATION: { type: "IP_LOCATION", usage: "IP_LOCATION([IP字段], 位置类型)", description: "返回IP对应的地理信息，第一个参数为ip字段或者具体ip，第二个参数为返回类型，0代表国家，1代表地区，2代表城市", example: 'IP_LOCATION("111.207.151.66", 2)，返回北京市', aggregate: 0 }, COALESCE: { type: "COALESCE", usage: "COALESCE([字段1], [字段2], '默认')", description: "返回参数中的第一个非空值；如果所有值都为NULL，那么返回NULL", example: "COALESCE(null, '100', '50')", aggregate: 0 }, TLD: { type: "TLD", usage: "TLD(合法的URL链接/字段)", description: "返回合法URL链接的一级域名，注意需带有协议部分，如http。对于不合法的链接均范围null", example: "TLD('https://www.bdp.cn'), 返回'bdp.cn", aggregate: 0 } })
}, function (e, t, n) {
  "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); !function () {
    angular.module("BC.common").service("commonService", ["$http", "errHint", "commonHttp", function (e, t, n) {
      var a = function (e) { if (e = e.data || e, "0" == e.status) return e.result; var n = null; return e.errstr && (n = { warn_msg: e.errstr }), t(Number(e.status), n), null }, r = { modify: function (e) { return n.post("/api/global_config/modify", { data: e }).then(a) }, themeModify: function (e) { return n.post("/api/user/modify_theme", { theme_id: e }) } }, o = { create: function (e, t, a) { return n.post("/api/project/create", { name: e, parent_id: t || "", category: a }) }, getTree: function (e) { return n.get("/api/project/tree", e).then(a) }, getTreeNoProcess: function (e) { return n.get("/api/project/tree", e) }, modify: function (e, t) { return n.get("/api/project/modify", { proj_id: e, data: { name: t } }) }, del: function (e) { return n.post("/api/project/delete", { proj_id: e }) }, move: function (e) { return n.post("/api/project/move", { sort: angular.toJson(e.sort), parent_id: e.parent_id, proj_id: e.proj_id, type: e.type, category: e.category }) } }, s = { getList: function (e) { return n.get("/api/dashboard/list", e).then(a) }, checkImport: function (e) { return n.post("/api/dashboard/import_check", e) }, getInfo: function (e) { var t = {}; return e = angular.extend(t, e), n.get("/api/dashboard/info", e) }, create: function (e) { return n.post("/api/dashboard/create", { name: e.name, proj_id: e.proj_id, label: e.label || "", comment: e.comment || "", meta: angular.toJson({ show_block: !0 }), category: e.category, resolution: e.resolution }) }, modify: function (e) { return e.access_token = $.cookie("token"), n.post("/api/dashboard/modify", e) }, del: function (e) { return n.post("/api/dashboard/delete", { dsh_id: e }) }, move: function (e) { return n.post("/api/dashboard/move", { sort: angular.toJson(e.sort), dsh_id: e.dsh_id, parent_id: e.parent_id, type: e.type, rule_id: e.rule_id, category: e.category }) }, hide: function (e) { return n.post("/api/dashboard/hide", e) }, dashDisplay: { create: function (e) { return n.post("/api/dash_display/create", e) }, delete: function (e) { return n.post("/api/dash_display/delete", e) } }, dshAssign: function (e) { return n.post("/api/dsh_assign/dsh_assign", e) }, dashLogList: function (e) { return n.post("/api/dash_log/list", e) }, dashManage: { projTree: function (e) { return n.post("/api/dash_manage/proj_tree", e) }, projInfo: function (e) { return n.post("/api/dash_manage/proj_info", e) }, projDshTree: function (e) { return n.post("/api/dash_manage/proj_dsh_tree", e) } }, getSnapshotPreviewTable: function (e) { return n.post("/api/chart/snapshot_preview", e) }, saveChartSnapshot: function (e) { return n.post("/api/chart/snapshot", e) }, networkSegment: { getList: function (e) { return n.get("/api/net_segment/list", e) }, infoModify: function (e) { return n.post("/api/net_segment/info_modify", e) }, delInfo: function (e) { return n.post("/api/net_segment/info_del", e) }, modify: function (e) { return n.post("/api/net_segment/modify", e) } } }, l = { getInfo: function (e) { var t = {}; return "string" == typeof e ? t.ct_id = e : t = angular.extend(e, t), n.post("/api/chart/info", t) }, getData: function (t) { return e.post("/api/chart/data", { _xsrf: bdp.utils.getCookie("_xsrf"), ct_id: t }) }, create: function (e) { var t = { dsh_id: e.dsh_id, category: e.category }, a = { normal: 0, gis: 1, text: 2, view: 7, custom: 8 }, i = a[e.type]; return t.ct_type = i || 0, e.ct_type && (t.ct_type = e.ct_type), t.name = e.name, "view" == e.type ? (t.parent_id = e.parent_id, t.tb_id = e.tb_id, "number" == typeof e.ct_type && (t.ct_type = e.ct_type)) : "custom" == e.type || "gis" == e.type ? t.tb_ids = angular.toJson(e.tb_id) : t.tb_id = e.tb_id, e.dsh_meta && (t.dsh_meta = angular.toJson(e.dsh_meta)), n.post("/api/chart/create", t) }, copy: function (e) { return n.get("/api/chart/copy", e) }, del: function (e) { return e.dsh_meta && (e.dsh_meta = angular.toJson(e.dsh_meta)), n.post("/api/chart/delete", e) }, modify: function (e) { return n.post("/api/chart/modify", e) }, getDbInfo: function (e) { return n.get("/api/chart/database_info", { ct_id: e }) }, modifyTb: function (e, t) { return n.get("/api/chart/modify_tb", { ct_id: e, tb_id: t }) }, search: function (e) { return n.post("/api/chart/search", e).then(a) }, getSizeGroups: function (e) { return e.drill_value = e.drill_value ? angular.toJson(e.drill_value) : void 0, n.post("/api/chart/size_groups", e).then(a) }, getGisSizeGroups: function (e, t, i) { return n.post("/api/chart/size_groups", { ct_id: e, bubble_setting: angular.toJson(t), layer_level: i }).then(a) }, addRelaTb: function (e, t) { return n.post("/api/chart/add_rela_tb", { ct_id: e, tb_id: t }) }, delRelaTb: function (e, t) { return n.post("/api/chart/del_rela_tb", { ct_id: e, tb_id: t }) }, exportExcelType: function (e) { return n.post("/api/export/get_file_type", e) }, exportLargeExcel: function (e) { return n.post("/api/export/large_file", e) }, wholeRelaChain: function (e) { return n.post("/api/chart/whole_rela_chain", { tb_id: e.tb_id }) }, tableUnion: function (e) { return n.post("/api/chart/table_union", e) }, cmpDateRange: function (e) { return n.post("/api/chart/filter_cmp_date_range", e) } }, c = { getField: function (e) { var t = { dstb_id: e }; return n.get("/api/dstb/info", t).then(a) }, del: function (e) { var t = { dstb_id: e }; return n.get("/api/dstb/delete", t) }, getList: function () { return n.get("/api/dstb/list").then(a) }, modify: function (e, t) { var i = { dstb_id: e, data: t }; return n.get("/api/dstb/modify", i).then(a) }, getUpdateRecord: function (e) { return n.get("/api/excel/list?time=" + (new Date).getTime(), e).then(a) }, deleteFile: function (e, t) { var i = { dstb_id: e, filetbname: t }; return n.get("/api/dstb/delete_file", i).then(a) }, excelCreate: function (e) { return n.post("/api/excel/create", e, { errHint: !1 }) }, excelAppend: function (e) { return n.post("/api/excel/append", e, { errHint: !1 }) }, excelReplace: function (e) { return n.post("/api/excel/replace", e, { errHint: !1 }) }, excelHistoryReplace: function (e) { return n.post("/api/excel/replace_one", e, { errHint: !1 }) }, excelDelete: function (e) { return n.get("/api/excel/delete", e) }, startTask: function (t, n) { return e.post("/api/dstb/start", { _xsrf: bdp.utils.getCookie("_xsrf"), job_id: t, sheet_name: angular.toJson(n) }) }, excelCheck: function (e) { return n.post("/api/excel/check", e, { errHint: !1 }) }, excelModify: function (e) { return n.post("/api/excel/modify", e, { errHint: !1 }) }, uploadPreview: function (e, t) { return n.post("/api/excel/preview", e, { errHint: t }) }, uploadParser: function (e) { return n.post("/api/excel/parser", e) }, getSchema: function (e) { return n.post("/api/tb/schema", { tb_id: e }) }, checkFieldDependency: function (e) { return n.post("/api/tb/check_field_dependency", e) }, adjustTable: function (e) { return n.post("/api/", e) }, previewAdjustTable: function (e) { return n.post("/api/excel/replace_preview", e) }, excelRepeatCheck: function (e) { return n.post("/api/excel/title_check", e) } }, d = { modify: function (e) { return n.post("/api/tb/modify", { data: e }) }, sortField: function (e) { return n.post("/api/field/sort", e) }, modifyFieldStatus: function (e, t) { return n.post("/api/tb/field_selected/modify", { tb_id: e, field_ids: t }) }, modifySkipFieldStatus: function (e, t) { return n.post("/api/tb/modify_url_config", { tb_id: e, url_config: t }) }, getStatusData: function (e) { return n.post("/api/tb/field_selected/query", { tb_id: e }) }, getList: function () { return n.get("/api/tb/list").then(a) }, copy: function (e) { return n.post("/api/data_union/union_copy", e) }, getInfo: function (e) { return n.get("/api/tb/info", e) }, getMultiInfo: function (e) { return n.get("/api/tb/multi_info", e) }, preview: function (e) { return n.post("/api/tb/preview", e).then(a) }, del: function (e) { return n.post("/api/tb/delete", { tb_id: e }) }, delTableWithChart: function (e, t, a) { return n.post("/api/tb/delete", { tb_id: e, session_id: t, verify_code: a }) }, getJoinInfo: function (e) { return n.get("/api/tb/join_info", { tb_id: e }).then(a) }, getJoinErrorReport: function (e) { return n.post("/api/wb/profile", e) }, getJoinProfileReport: function (e) { return n.post("/api/wb/profile_report", { tb_id: e }) }, getModelStruct: function (e) { return n.get("/api/tb/model_struct", { tb_id: e }) }, getStatus: function (e, t) { return n.get("/api/tb/status", { tb_id: e, view_status_read: t }) }, getStorageAccount: function () { return n.get("/api/tb/stat").then(a) }, modifyTag: function (e) { return n.post("/api/tb/modify_tag", { data: (0, i.default)(e) }) }, getTbsField: function (e) { return n.post("/api/dstb/infos", e) }, partitionSet: function (e) { return n.post("/api/tb/partition/set", { tb_id: e.tb_id, base_field: e.base_field, param: e.param, is_vfield: e.is_vfield }) }, partitionDel: function (e) { return n.post("/api/tb/partition/remove", { tb_id: e.tb_id }) }, wholeJoinChain: function (e) { return n.post("/api/tb/whole_join_chain", { tb_id: e.tb_id }) }, sqlTrans: function (e) { return n.post("/api/tb/sql_trans", e) }, sqlScript: function (e) { return n.post("/api/sql_script/check", e) }, sqlCheckUnique: function (e) { return n.post("/api/sql_script/checkunique", e) }, sqlFormat: function (e) { return n.post("/api/sql_script/format", e) }, tableFieldFilter: function (e) { return n.post("/api/field/filter", e) }, batchMove: function (e) { return n.post("/api/folder/change_batch", e) }, batchDeleteTables: function (e) { return n.post("/api/tb/delete_batch", e) }, checkTablesRely: function (e) { return n.post("/api/tb/list_check_rely", e) }, gisTransfer: function (e) { return n.post("/api/gis/transfer", e) }, gisModify: function (e) { return n.post("/api/gis/modify", e) }, updateModeCheck: function (e) { return n.post("/api/tb/update_mode/check", e) }, updateModeModify: function (e) { return n.post("/api/tb/update_mode/modify", e) }, getPartitionNum: function (e) { return n.post("/api/tb/partition/num", e) }, triggerFullUpdate: function (e) { return n.post("/api/tb/update", e) }, replaceCheck: function (e) { return n.post("/api/wb/replace_check", e) }, getTplExcel: function (e) { return n.get("/api/personal/tpl_excel", e) }, tplExport: function (e) { return n.get("/api/personal/export", e) }, modelCheck: function (e) { return n.get("/api/data_aggr/model_check", e) }, viewExec: function (e) { return n.get("/api/view/exec", e) }, uploadRenameFields: function (e) { return n.post("/api/field/upload_templete", e) }, exportSmallTbFile: function (e) { return n.post("/api/tb/export_tb", e) }, exportTbFile: function (e) { return n.post("/api/export/tb_file", e) }, exportTbTupu: function (e) { return n.post("/api/tb/export_to_tp", e) }, exportTbTupuTag: function (e) { return n.post("/api/tb/export_tag_to_tp", e) }, getTbCapacity: function (e) { return n.post("/api/tb/list_info", e) }, parseCode: function (e) { return n.post("/api/general/create", e) }, getFieldParseCode: function (e) { return n.get("/api/general/info", e) }, joinTbInfo: function (e) { return n.post("/api/dstb/info", e) }, getRelationList: function (e) { return n.get("/api/tb/rela_list", { tb_id: e }).then(a) }, delTbCheck: function (e) { return n.post("/api/tb/chart_check", { tb_id: e }) }, copyTbCheck: function (e) { return n.post("/api/view/check", { tb_id: e }) }, createProcessTb: function (e) { return n.post("/api/view/allcreate", e) }, modifyProcessTb: function (e) { return n.post("/api/view/allmodify", e) }, previewProcessTb: function (e, t) { return n.post("/api/view/allpreview", e, t) }, schedulerModify: function (e) { return n.post("/api/view/scheduler/modify", e) }, mergeModle: function (e) { return n.post("/api/tb/merge_mode/modify", e) }, permission: { list: function (e) { return n.post("/api/tb/permission/list", e) }, modify_batch: function (e) { return n.post("/api/tb/permission/modify_batch", e) }, delete: function (e) { return n.post("/api/tb/permission/delete", e) }, modify: function (e) { return n.post("/api/tb/permission/modify", e) }, allList: function (e) { var t = {}; return t = angular.extend(e, t), n.get("/api/tb/permission/all_list", t) }, userList: function (e) { var t = {}; return t = angular.extend(e, t), n.get("/api/tb/permission/user_list", t) } }, spaceInfo: function () { return n.post("api/space/info", {}) } }, u = { getList: function (e) { return n.get("/api/tb/info", e) }, getEditableSchema: function (e) { return n.get("/api/tb/editable_schema", { tb_id: e }) }, create: function (e) { return n.post("/api/field/create", e) }, modify: function (e) { return n.post("/api/field/modify", e) }, del: function (e) { return n.post("/api/field/delete", e) }, dependency: function (e) { return n.post("/api/field/dependency", e) }, getRange: function (e) { return n.post("/api/field/range", e) }, getFilteredRange: function (e, t, a, i) { return void 0 === i ? n.post("/api/enum_color/field_range", { ct_id: e, tb_id: t, field: angular.toJson(a) }) : n.post("/api/enum_color/gis_field_range", { ct_id: e, tb_id: t, field: angular.toJson(a), layer_level: i }) }, url_preview: function (e, t) { return n.post("/api/field/url_preview", { tb_id: e, field_ids: angular.toJson(t) }).then(a) }, extract_preview: function (e, t) { return n.post("/api/field/extract_preview", { tb_id: e, fields: angular.toJson(t) }).then(a) }, extract_url: function (e, t) { return n.post("/api/field/extract_url", { tb_id: e, fields: angular.toJson(t) }).then(a) }, merge: function (e, t) { return n.post("/api/field/merge", { tb_id: e, info: angular.toJson(t) }).then(a) }, getAggregatorLen: function (e) { return n.post("/api/field/get_length", e) }, tbInfoByTitle: function (e) { return n.post("/api/field/infobytitle", e) } }, f = { getList: function (e) { var t = {}; return t = angular.extend(e, t), n.get("/api/share/list", t) }, share: function (e) { var t = {}; return t = angular.extend(e, t), n.post("/api/share/commit", t) }, getUserList: function (e) { var t = {}; return t = angular.extend(e, t), n.post("/api/share/list_user", t) } }, p = {
        rename: function (e) { return n.post("/api/ds/rename", e) }, getConnStatus: function (e) { return n.post("/api/ds/conn", e) }, connNopwd: function (e) { return n.post("/api/ds/nopawd", e) }, createApi: function (e) { return n.post("/api/ds/create", e) }, getNameAndTag: function () { return n.get("/api/ds/list").then(a) }, getList: function (e) { return n.get("/api/ds/list").then(a) }, getListForDataSource: function (e) { return n.get("/api/ds/nslist", e) }, pureList: function (e) { return n.get("/api/ds/purelist", e) }, getTree: function () { return n.get("/api/ds/tree").then(a) }, info: function (e) { return n.get("/api/ds/info", e) }, modify: function (e) { return e = e || {}, n.post("/api/ds/modify", e) }, startSyncTask: function (e, t, a) { return n.get("/api/ds/sync", { ds_id: e, new_table: t, db_type: a }) }, startBaiduSyncCost: function (e) { return n.get("/api/rtapi/single_cost", { ds_id: e }) }, del: function (e) { return n.post("/api/ds/delete", { ds_id: e }) }, getInitInfo: function () { return n.get("/api/ds/all") }, getResultForSearch: function (e, t) { return n.get("api/ds/search", { stype: t, content: e }) }, getTables: function (t) { return e.get("/api/ds/mdstb", { params: { ds_id: t } }) }, getJsjTables: function (t) { return t._xsrf = bdp.utils.getCookie("_xsrf"), e.post("/api/ds/cdstb", t) }, modifytb: function (t, n, a) { return e.get("/api/ds/modifytb", { params: { ds_id: t, name: n, check_tables: angular.toJson(a) } }) }, openDataList: function () { return n.get("/api/ds/publiclist") }, create: function (e) { return n.post("/api/ds/create", e) }, conn: function (e) { return n.post("/api/ds/conn", e) }, tbList: function () { return n.get("/api/ds/tblist") }, username_verify: function (e) { return n.post("/api/ds/verify", e) }, jyw_klist: function () { return n.post("/api/jyw/klist") }, set_sync: function (e) { return n.post("/api/ds/sync", e) }, mobile_default_bind: function (e) { return n.post("/api/sms/defaultbind", e) }, mobile_unbind_all: function (e) { return n.post("/api/sms/unbindall", e) }, warn_mobile_list: function (e) { return n.post("/api/sms/list") }, warn_mobile_del: function (e) { return n.post("/api/sms/delete", { phone: e.phone }) }, warn_mobile_vcode: function (e) { return n.post("/api/sms/vcode", { phone: e.phone, new_phone: e.new_phone }) }, warn_mobile_verify: function (e) { return n.post("/api/sms/verify", { phone: e.phone, new_phone: e.new_phone, vcode: e.vcode }) }, ds_amount: function () { return n.get("/api/ds/stat") }, kstList: function (e) { return n.post("/api/kst/list", e) }, kstConn: function (e) { return n.post("/api/kst/conn", e) }, kstCreate: function (e) { return n.post("/api/kst/create", e) }, kstInfo: function (e) { return n.post("/api/kst/info", e) }, kstModify: function (e) { return n.post("/api/kst/modify", e) }, baiduRegion: function () { return n.get("/api/rtapi/city") }, baiduIndex: function () { return n.get("/api/inapi/city") }, baiduIndexCheckKeyWords: function (e) { return n.post("/api/inapi/check", e) }, modifyDbBaiduSearchTask: function (e) { return n.post("/api/rtapi/control", e) }, modifyDbBaiduIndexTask: function (e) { return n.post("/api/inapi/control", e) }, baiduSearchConfig: function (e) { return n.post("/api/rtapi/config", e) }, baiduIndexConfig: function (e) { return n.post("/api/inapi/config", e) }, modifyDbBaiduSearch: function (e) { return n.post("/api/rtapi/modify", e) }, modifyDbBaiduIndex: function (e) { return n.post("/api/inapi/modify", e) }, createDbBaiduSearch: function (e) { return n.post("/api/ds/create", e) }, createDbBaiduSearchTask: function (e) { return n.post("/api/rtapi/create", e) }, createDbBaiduIndexTask: function (e) { return n.post("/api/inapi/create", e) }, deleteDbBaiduSearchTask: function (e) { return n.post("/api/rtapi/delete", e) }, deleteDbBaiduIndexTask: function (e) { return n.post("/api/inapi/delete", e) }, getDbBaiduSearchTaskList: function (e) { return n.post("/api/rtapi/rtlist", e) }, getDbBaiduIndexTaskList: function (e) { return n.post("/api/inapi/inlist", e) }, startBaiduTaskSyncCost: function (e) { return n.get("/api/rtapi/single_cost", e) }, startBaiduIndexTaskSyncCost: function (e) { return n.get("/api/inapi/single_cost", e) }, startBaiduSyncTask: function (e) { return n.post("/api/rtapi/sync", e) }, startBaiduIndexSyncTask: function (e) { return n.post("/api/inapi/sync", e) }, baiduCompanySetting: function (e) { return n.post("/api/rtapi/field_info", e) }, modifyCompanySetting: function (e) { return n.post("/api/rtapi/field_modify", e) }, indexSync: function (e) { return n.get("/api/ds/usersyncindex", e) }, wechatDs: { createWechatIndex: function (e) { return n.post("/api/ds/create", e) }, deleteWechatTask: function (e) { return n.post("/api/wechat/delete", e) }, getTaskList: function (e) { return n.post("/api/wechat/inlist", e) }, modifyWechatTask: function (e) { return n.post("/api/wechat/modify", e) }, createWechatTask: function (e) { return n.post("/api/wechat/create", e) }, wechatIndexConfig: function (e) { return n.post("/api/wechat/config", e) }, wechatTaskSwitchControl: function (e) { return n.post("/api/wechat/control", e) } }, toutiaoDs: { createToutiaoIndex: function (e) { return n.post("/api/ds/create", e) }, deleteToutiaoTask: function (e) { return n.post("/api/toutiao/delete", e) }, getTaskList: function (e) { return n.post("/api/toutiao/inlist", e) }, modifyToutiaoTask: function (e) { return n.post("/api/toutiao/modify", e) }, createToutiaoTask: function (e) { return n.post("/api/toutiao/create", e) }, toutiaoIndexConfig: function (e) { return n.post("/api/toutiao/config", e) }, toutiaoTaskSwitchControl: function (e) { return n.post("/api/toutiao/control", e) } }, indexDs: { getUrl: function (e, t) { var n; switch (e + "_" + t) { case "70_create": n = "/api/web/create"; break; case "70_inlist": n = "/api/web/inlist"; break; case "70_control": n = "/api/web/control"; break; case "70_delete": n = "/api/web/delete"; break; case "70_config": n = "/api/web/config"; break; case "70_modify": n = "/api/web/modify" }return n }, getTaskList: function (e) { return n.post("/api/index/inlist", e) }, createTask: function (e) { return n.post("/api/index/create", e) }, switchTask: function (e) { return n.post("/api/index/control", e) }, deleteTask: function (e) { return n.post("/api/index/delete", e) }, getTaskInfo: function (e) { return n.post("/api/index/config", e) }, modifyTask: function (e) { return n.post("/api/index/modify", e) }, checkKeyWords: function (e) { return n.post("/api/index/check", e) }, areaList: function (e) { return n.get("/api/index/city", e) } }, weiboDs: {
          deleteTask: function (e) { return n.post("/api/toutiao/delete", e) }, getTaskList: function (e) { return n.post("/api/web/inlist", e) }, modifyTask: function (e) { return n.post("/api/toutiao/modify", e) }, createToutiaoTask: function (e) { return n.post("/api/toutiao/create", e) }, toutiaoIndexConfig: function (e) { return n.post("/api/toutiao/config", e) },
          toutiaoTaskSwitchControl: function (e) { return n.post("/api/toutiao/control", e) }
        }, dbTypeInfo: function (e) { return n.get("/api/ds/category", e) }, getCTableList: function (e) { return n.post("/api/ds/cdstb", e) }, getTbInfo: function (e) { return n.post("/api/ds/tbinfo", e) }, getDsSheet: function (e) { return n.post("/api/ds/sheet", e) }, getDsTask: function (e) { return n.post("/api/ds/task", e) }, delete: function (e) { return n.post("/api/ds/delete", e) }, getGaReports: function (e) { return n.get("/api/ga/dreports", e) }, getGaInfo: function (e) { return n.post("/api/ga/info", e) }, previewGa: function (e) { return n.post("/api/ga/preview", e) }, getBdpDeployCodeToken: function (e) { return n.post("/api/journal/token", e) }, pwdBatchPreview: function (e) { return n.post("/api/ds_batch/preview", e) }, pwdBatchModify: function (e) { return n.post("/api/ds_batch/modify", e) }, saveUserSync: function (e) { return n.post("/api/ds/usersync", e) }, getJumpInfo: function (e) { return n.get("/api/chart/jump_info", e) }, saveJumpInfo: function (e) { return n.post("/api/chart/jump_save", e) }, delJumpInfo: function (e) { return n.post("/api/chart/jump_delete", e) }, checkJumpInfo: function (e) { return n.get("/api/chart/jump_check", e) }, getCodeImg: function (e) { return n.get("/api/ds/specialsync", e) }, superModify: function (e) { return n.get("/api/ds/supermodify", e) }, setAllot: function (e) { return n.post("/api/ds/dsallot", e) }, getOwerList: function (e) { return n.post("/api/ds/dsadmin", e) }, jumpWorktable: function (e) { return n.get("/api/ds/dstotable", e) }
      }, h = { field_list: function (e) { return n.post("/api/ds_field/field_list", e) }, field_del: function (e) { return n.post("/api/ds_field/field_del", e) }, field_modify: function (e) { return n.post("/api/ds_field/field_modify", e) } }, g = { del: function (e) { return n.post("/api/adv_date/del", { opt_id: e }) }, global_del: function (e, t) { return n.post("/api/adv_date/del", { opt_id: e, df_id: t }) }, modify: function (e, t, a, i) { return n.post("/api/adv_date/modify", { ct_id: e, opt_id: t, scheme_id: a, data: i }) }, global_modify: function (e, t, a, i, r) { return n.post("/api/adv_date/modify", { dsh_id: e, opt_id: t, df_id: a, scheme_id: i, data: r }) }, list: function (e, t) { return n.post("/api/adv_date/list", { ct_id: e, scheme_id: t }) }, info: function (e) { return n.post("/api/adv_date/info", { opt_id: e }) }, order: function (e, t) { return n.post("/api/adv_date/order", { ct_id: e, options: t }) } }, m = { create: function (e) { return n.post("/api/adv_date_scheme/create", e) }, delete: function (e) { return n.post("/api/adv_date_scheme/delete", e) }, modify: function (e) { return n.post("/api/adv_date_scheme/modify", e) }, list: function (e) { return n.post("/api/adv_date_scheme/list", e) } }, v = { add: function (e) { return n.post("/api/warn/add", { ct_id: e.ct_id, rule_id: e.rule_id, data: angular.toJson(e.data) }) }, modify: function (e) { return n.post("/api/warn/modify", { ct_id: e.ct_id, rule_id: e.rule_id, data: angular.toJson(e.data), warn_id: e.warn_id }) }, del: function (e) { return n.post("/api/warn/delete", { ct_id: e.ct_id, rule_id: e.rule_id, warn_id: e.warn_id }) }, warnSwitch: function (e) { return n.post("/api/warn/switch", { ct_id: e.ct_id, rule_id: e.rule_id, open_warn_ids: e.open_warn_ids, off_warn_ids: e.off_warn_ids, all_switch: e.all_switch, need_all_switch: e.need_all_switch }) } }, y = { modify: function (e) { return n.post("/api/model/modify", e) }, preview: function (e) { return n.post("/api/model/train_set_preview", e) }, result: function (e) { return n.post("/api/model/result", e) }, list: function (e) { return n.post("/api/model/list", e) }, info: function (e) { return n.post("/api/model/info", e) }, del: function (e) { return n.post("/api/model/delete", e) }, saveClusterRs: function (e) { return n.post("/api/model/result_commit", e) }, fieldNullValue: function (e) { return n.get("/api/ml/field_null_value", e) } }, _ = { getList: function () { return n.post("/api/folder/list").then(a) }, getListAll: function () { return n.post("/api/tb/permission/all_tb").then(a) }, del: function (e, t) { return n.get("/api/folder/delete", { folder_id: e, mode: t }) }, modify: function (e) { return n.post("/api/folder/modify", e) }, create: function (e) { return n.post("/api/folder/create", e) }, change: function (e) { return n.post("/api/folder/change", { tb_id: e.tb_id, to_folder: e.to_folder, to_seq: e.to_seq, tb_index: e.tb_index }) }, change_batch: function (e) { return n.post("/api/folder/change_batch", { change_folders: e }) }, modify_folder_rel: function (e) { return n.post("/api/folder/modify_folder_rel", { tb_id: e.tb_id, folder_rels: e.tb_status }) }, modify_seq: function (e) { return n.post("/api/folder/modify_seq", { seq_no: e.seq_no, folder_id: e.folder_id }) }, modify_parent: function (e) { return n.post("/api/folder/modify_parent", { seq_no: e.seq_no, folder_id: e.folder_id, parent_id: e.parent_id }) }, getStructure: function () { return n.post("/api/folder/get_tree") }, getStructureWithParam: function (e) { return n.post("/api/folder/get_tree_with_tblist", e) }, getWorktable: function (e) { return n.get("/api/folder/list_only_tb", e) }, getTableSiblings: function (e) { return n.get("/api/folder/get_current_tb", e) }, getTableFolderInfo: function (e) { return n.post("/api/folder/info", e) }, searchFolderAndTable: function (e) { return n.get("/api/folder/search", e) }, filterFolderAndTable: function (e) { return n.get("/api/folder/filter", e) } }, b = { create: function (e) { return n.get("/api/field_comment/create", e) }, modify: function (e) { return n.get("/api/field_comment/modify", { ct_id: e.ct_id, fc_id: e.fc_id, comment: e.comment }) }, del: function (e, t) { return n.get("/api/field_comment/delete", { ct_id: e, fc_id: t }) } }, w = { list: function (e) { return n.post("/api/dsh_filter/list", { dsh_id: e.dash_id, rule_id: e.rule_id }) }, modify: function (e) { return n.post("/api/dsh_filter/commit", { dsh_id: e.dash_id, data: e.dash_filter_list }) }, item: function (e) { return n.post("/api/dsh_filter/item", { dsh_id: e.dash_id, sdo_id: e.sdo_id, rule_id: e.rule_id, is_tpl: e.is_tpl }) }, range: function (e) { return n.post("/api/dsh_filter/range", { dsh_id: e.dash_id, scheme_id: e.scheme_id, df_id: e.df_id, rule_id: e.rule_id, selected_tables: e.selected_tables, granularity: e.granularity, parent_range: e.range }) }, filter_range: function (e) { return n.post("/api/dsh_filter/filter_range", { keyword: e.keyword ? e.keyword : "", first_item: e.first_item ? e.first_item : 0, range_list: e.range_list ? e.range_list : [] }) } }, C = { userList: function (e) { return n.post("/api/sub/list", e) }, modifyPersonal: function (e) { return n.post("/api/user/modify_personal", e) }, checkPwd: function (e) { return n.post("/api/user/verify_pwd", e) }, checkPhoneCode: function (e) { return n.post("/api/user/verify_captcha", e) }, sendPhoneCode: function (e) { return n.post("/api/user/gen_captcha", e) }, sendModifyPwdEmail: function (e) { return n.post("/api/user/send_mod_pwd_notice", e) }, modifyInfo: function (e) { return n.post("/api/user/modify_info", e) }, groupList: function (e) { return n.post("/api/group/list", e) }, modify: function (e) { return n.post("/api/sub/modify", e) }, setFrozen: function (e) { return n.post("/api/user/set_frozen", e) }, exportFileList: function (e) { return n.post("/api/export/file_list", e) }, exportDelTask: function (e) { return n.post("/api/export/delete", e) }, hideNotification: function () { return n.post("/api/export/hide_notification") }, logout: function (e) { return n.post("/api/user/logout", e, { errHint: !1 }) }, modifyPassword: function (e) { return n.post("/api/user/modify_pwd", e) }, getUserInfo: function () { return n.get("/api/user/info") }, unreadNewFeatures: function () { return n.post("/api/log/unread") }, readNewFeatures: function () { return n.get("/api/log/read") }, getMobileCode: function (e) { return n.post("/api/user/gen_captcha", e) }, personalConpon: function () { return n.get("/api/coupon/list") }, getProduct: function (e) { return n.get("/api/ucenter/product/list", e) }, genRedirectUrl: function (e) { return n.get("/api/check/gen_redirect_url", e) }, modifyFieldSort: function (e) { return n.get("/api/user/modify_sort", e) } }, S = { getOrderInfo: function (e) { return n.get("/api/enum_order/info", { _t: (new Date).getTime(), tb_id: e.tb_id, fid: e.fid, ct_id: e.ct_id || "", query_for_ct: e.query_for_ct || void 0 }).then(a) }, updateOrder: function (e) { return n.post("/api/enum_order/update", e) }, getFilteredOrderInfo: function (e) { return n.get("/api/enum_order/filter_info", { _t: (new Date).getTime(), tb_id: e.tb_id, fid: e.fid, ct_id: e.ct_id || "", index: e.index || 0, drill_level: e.drill_level || 0, axis: e.axis || "" }).then(a) } }, k = { checkIncrease: function (e) { return n.post("/api/sql_script/check_tb_increment", e) } }, x = { ruleTbInfo: function (e) { return n.post("/api/tb/rule_tb_info", e) }, getFieldRule: function (e) { return n.post("/api/rule/search_filter", e) }, saveBatchRule: function (e) { return n.post("/api/rule/create_filter_batch", e) }, chartList: function (e) { return n.post("/api/chart/list", e) }, tplCommit: function (e) { return n.post("/api/template/commit", e) }, relaDshTb: function (e) { return n.post("/api/template/rela_dsh_tb", e) }, tplListByPage: function (e) { return n.post("/api/template/list_by_page", e) } }, D = { list: function (e) { return n.post("/api/sem/list", { ds_id: e.ds_id, ds_type: e.ds_type }) }, merge: function (e) { return n.post("/api/sem/merge", { link_list: e.link_list }) }, tbrefer: function (e) { return n.post("/api/sem/tbrefer", { ds_id: e.ds_id, tmp_ds_id: e.tmp_ds_id }) } }, T = { guideSet: function (e) { return n.post("/api/user/guide_set", e) }, getDashDemo: function () { return n.post("/api/personal/demo") } }, E = { getListByType: function (e) { return n.post("/api/message/list", e) }, setNoticeReaded: function (e) { return n.post("/api/message/read", e) }, getNoticeType: function () { return n.post("/api/message/purpose") }, setNoticeReadAll: function (e) { return n.post("/api/message/read_all", { purpose: e }) }, delNotice: function (e) { return n.post("/api/message/delete", { log_id: e }) } }; return { global_config: r, project: o, dashboard: s, chart: l, db: c, tb: d, field: u, fieldComment: b, ds: p, ds_field: h, share: f, adv_date: g, adv_date_scheme: m, warn: v, model: y, folder: _, enumField: S, tpl: x, sql_script: k, dash_global_filter: w, user: C, sem: D, guide: T, authority: { info: function (e) { return n.post("/api/auth/info", e) }, create: function (e) { return n.post("/api/auth/create", e) }, modify: function (e) { return n.post("/api/auth/modify", e) }, stop: function (e) { return n.post("/api/auth/stop", e) }, oplog: function (e) { return n.post("/api/auth/oplog", e) } }, account: { userInfo: function (e) { return n.post("/api/sub/info", e) }, userList: function (e) { return n.post("/api/sub/list_new", e) }, userCreate: function (e) { return n.post("/api/sub/create", e) }, userModify: function (e) { return n.post("/api/sub/modify", e) }, userDelete: function (e) { return n.post("/api/sub/delete", e) }, searchUsersByName: function (e) { return n.get("/api/sub/list_by_page", e) }, usersByPage: function (e) { return n.get("/api/sub/list_new", e) }, setFrozen: function (e) { return n.post("/api/user/set_frozen", e) }, resetPwd: function (e) { return n.get("/api/user/reset_pwd", e) }, sentNotice: function (e) { return n.post("/api/sub/send_notice", e) }, accountLimit: function (e) { return n.get("/api/account/limit", e) }, groupList: function (e) { return n.get("/api/group/list", e) }, groupOrder: function (e) { return n.post("/api/group/order", e) }, groupInfo: function (e) { return n.post("/api/group/info", e) }, groupCreate: function (e) { return n.post("/api/group/create", e) }, removeAdminCheck: function (e) { return n.post("/api/group/check_remove_admin", e) }, groupModify: function (e) { return n.post("/api/group/modify", e) }, groupDelete: function (e) { return n.post("/api/group/delete", e) }, securityInfo: function (e) { return n.post("/api/security/info", e) }, securityCreate: function (e) { return n.post("/api/security/create", e) }, securityDelete: function (e) { return n.post("/api/security/delete", e) }, securityList: function (e) { return n.get("/api/security/list", e) }, securityPreCheck: function (e) { return n.post("/api/security/pre_check", e) }, securityModify: function (e) { return n.post("/api/security/modify", e) }, tbShareFieldCheck: function (e) { return n.post("/api/share/cancel_fields_check", e) }, tbShareFilterCheck: function (e) { return n.post("/api/share/check", e) }, getGroupCustomFields: function (e) { return n.post("/api/group/list_fields", e) }, updateGroupCustomFields: function (e) { return n.post("/api/group/update_fields", e) }, accountAssignInfo: function (e) { return n.post("/api/sub_account/assign_info", e) }, groupMutiOpt: function (e) { return n.post("/api/group/muti_opt", e) }, userFuncModify: function (e) { return n.post("/api/sub/func_modify", e) }, groupWorktbInfo: function (e) { return n.post("/api/group/worktb_info", e) }, userWorktbInfo: function (e) { return n.post("/api/sub/worktb_info", e) }, individuationInfo: function (e) { return n.post("/api/personalization/info", e) }, individuationModify: function (e) { return n.post("/api/personalization/modify", e) } }, chart_tpl: { info: function (e) { return n.post("/api/chart_tpl/info", { tpl_id: e }) }, createChart: function (e) { var t = { dsh_id: e.dsh_id, tb_id: e.tb_id, tpl_id: e.tpl_id, used_origin_fids_map: angular.toJson(e.used_origin_fids_map), dsh_meta: angular.toJson(e.dsh_meta), category: e.category }; return n.post("/api/chart_tpl_apply/create", t) }, create: function (e) { var t = { proj_id: e.proj_id, ct_id: e.ct_id, name: e.name, type: e.type, explain: e.explain }; return angular.isArray(e.fid_explain) ? t.fid_explain = angular.toJson(e.fid_explain) : t.fid_explain = e.fid_explain, n.post("/api/chart_tpl/create", t) }, delete: function (e) { return n.post("/api/chart_tpl/delete", { tpl_id: e }) }, modify: function (e) { var t = { tpl_id: e.tpl_id, proj_id: e.proj_id, ct_id: e.ct_id, name: e.name, type: e.type, explain: e.explain }; return angular.isArray(e.fid_explain) ? t.fid_explain = angular.toJson(e.fid_explain) : t.fid_explain = e.fid_explain, n.post("/api/chart_tpl/modify", t) }, applyList: function (e) { var t = { type: e.type }; return n.post("/api/chart_tpl_apply/list", t) }, typeList: function (e) { return n.post("/api/chart_tpl/type_list", e) } }, chart_tpl_project: { getTree: function (e) { return n.post("/api/chart_tpl_proj/tree", e) }, create: function (e) { return n.post("/api/chart_tpl_proj/create", { name: e }) }, modify: function (e, t) { return n.post("/api/chart_tpl_proj/modify", { proj_id: e, name: t }) }, del: function (e) { return n.post("/api/chart_tpl_proj/delete", { proj_id: e }) }, order: function (e, t, a) { return n.post("/api/chart_template/order", { proj_id: e, type: t || 0, sort: angular.toJson(a) }) }, move: function (e, t, a, i) { return n.post("/api/chart_template/move", { dsh_id: i, proj_id: e, type: t, sort: angular.toJson(a) }) } }, chartTplRule: { info: function (e) { return n.get("/api/chart_tpl_rule/info", { rule_id: e }) }, industryList: function (e) { return n.get("/api/industry/list", e) }, domainList: function (e) { return n.get("/api/domain/list", e) }, domainSearch: function (e) { return n.get("/api/domain/search", e) }, create: function (e) { return n.post("/api/chart_tpl_rule/create", e) }, list: function (e) { return n.post("/api/chart_tpl_rule/list", e) }, delete: function (e) { return n.post("/api/chart_tpl_rule/delete", { rule_id: e }) }, modify: function (e) { return n.post("/api/chart_tpl_rule/modify", e) }, issued: function (e) { var t = { rule_id: e.rule_id, issued_status: e.issued_status }; return n.post("/api/chart_tpl_rule/issued", t) } }, pay: { personalVipInfo: function () { return n.post("/api/pay/personal_vip_info") }, personalOrderHistory: function () { return n.get("/api/pay/order_history") }, getMemberRightData: function () { return n.get("/pmresources/personal-config/member.json") }, personalInvoice: function (e) { return n.post("/api/receipt/create", e) }, personalInvoiceHistory: function () { return n.get("/api/receipt/list") } }, notice: E, view: { info: function (e) { return n.post("/api/view/info", e) } }, natural: { searchQuery: function (e) { return n.post("/api/prodigy/query", e, { errHint: !1 }) } }, editMeta: { modify: function (e) { return n.post("/api/edit_meta/modify", e) }, info: function (e) { return n.get("/api/edit_meta/info", e) } }, dsh_tpl: { publish: function (e) { return n.post("/api/dsh_tpl/publish", e) }, list: function () { return n.get("/api/dsh_tpl/list") }, delete: function (e) { return n.post("/api/dsh_tpl/delete", e) }, create: function (e) { return n.post("/api/dsh_tpl/create", e) }, replace: function (e) { return n.post("/api/dsh_tpl/replace", e) } }, getJobStatus: function (e) { return n.post("/api/job/status", { job_id: e }) }, getTaskStatus: function (e) { return n.get("/api/task/status", { task_id: e }, { errHint: !1 }) }, getFunctionList: function () { return n.get("/api/function/list") } }
    }]).service("baService", ["$http", "errHint", "commonHttp", function (e, t, n) { return { list: function (e) { return n.post("/api/sta/list", e) }, addDomain: function (e) { return n.post("/api/sta/add", e) }, delDomain: function (e) { return n.post("/api/sta/del", e) }, updateConfig: function (e) { return n.post("/api/sta/update", e) }, checkDeploy: function (e) { return n.post("/api/sta/ref", e) }, getToken: function (e) { return n.post("/api/sta/token", e) } } }])
  }()
}, function (e, t, n) { "use strict"; !function () { angular.module("BC.common").service("globalDateSchemeService", ["commonService", "$q", function (e, t) { function n(e, t) { for (var n = {}, a = 0, i = e.length; a < i; a++)if (e[a].scheme_id == t) { n = e[a]; break } return n } function a() { return e.adv_date_scheme.list().then(function (e) { return 0 == e.status ? e.result.adv_date_schs || [] : [] }) } function i(e, t) { var n = e.applySchemeId, a = e.schemeList; if (t) e.selectedScheme = a[0]; else for (var i = 0, r = a.length; i < r; i++) { var o = a[i]; if (n) { if (o.scheme_id == n) { e.selectedScheme = o; break } } else if (1 == o.is_default) { e.selectedScheme = o, e.applySchemeId = o.scheme_id; break } } if (!e.selectedScheme) for (var i = 0, r = a.length; i < r; i++) { var o = a[i]; if (1 == a[i].is_default) { e.selectedScheme = o, e.applySchemeId = o.scheme_id; break } } } function r(e) { for (var t = "", n = 0, a = e.length; n < a; n++) { var i = e[n]; if (1 == i.is_default) { t = i; break } } return t } function o(e) { var t = { name: e.name }; return e.scheme_id && (t.scheme_id = e.scheme_id), t } function s() { return localStorage ? localStorage.getItem(S) || "" : $.cookie(S) || "" } function l(e) { localStorage ? localStorage.setItem(S, e) : $.cookie(S, e) } function c() { localStorage ? localStorage.removeItem(S) : $.cookie(S, "") } function d(e) { return !!k && k[e] } function u(e, t) { k && k[e] || (k[e] = []), k[e] = t } function f() { k[ct_scheme] && delete k[ct_scheme] } function p(e) { if (k) for (var t in k) t.indexOf("_" + e) >= 0 && delete k[t] } function h(e, t) { var n = !1; return t.map(function (t) { t.name == e.name && t.scheme_id != e.scheme_id && (n = !0) }), n } function g(e) { var t = !1; for (var n in e) e[n] && (t = !0); return t } function m(e, t, n) { angular.forEach(e, function (e) { e.fid == t && "date" == e.data_type && (e.scheme_id = n) }) } function v(e, t, n, a) { function i(e, t) { angular.forEach(e, function (e) { r(e, t), e.items && e.items.length > 0 && i(e.items, t) }) } function r(e, n) { e.fid != t || "date" != e.data_type || "" != e.granularity || e.hasOwnProperty("aggregator") || (e.scheme_id = n, e.range = a || []) } if (e && !(e instanceof Array)) for (var o in e) i(e[o], n) } function y(e, t) { var n = ""; return angular.forEach(e, function (e) { e.fid == t && "date" == e.data_type && (n = e.scheme_id) }), n } function _(t, n, a) { angular.forEach(t, function (t) { var i = t.fid; a[i] && "date" == t.data_type && e.adv_date.list(n, t.scheme_id).then(function (e) { 0 == e.status && (a[i].list = e.result, u(n + "_" + t.scheme_id, e.result)) }) }) } function b(n, a, i) { var r = d(n + "_" + a); if (r && i) { var o = t.defer(), s = { result: r }; return o.resolve(s), o.promise } return e.adv_date.list(n, a).then(function (e) { return 0 == +e.status ? (u(n + "_" + a, e.result), e) : { result: [] } }) } function w(e) { var t = {}, n = []; return angular.forEach(e, function (e) { t[e.opt_id] || (n.push(e), t[e.opt_id] = !0) }), n } var C = $.cookie("user_id"), S = "BDP_globalDateScheme_" + C, k = {}; this.getSchemeObj = n, this.getSchemeList = a, this.getDefaultSchemeObj = r, this.getDefaultSchemeInList = i, this.getSchemeModifyParam = o, this.getLatestScheme = s, this.setLatestScheme = l, this.clearLatestScheme = c, this.getChartSchemeCache = d, this.setChartSchemeCache = u, this.clearChartSchemeCache = f, this.removeChartSchemeCache = p, this.checkRepeatScheme = h, this.hasEditingScheme = g, this.addSchemeToFilterList = m, this.addSchemeToFilterListInner = v, this.findSchemeInFilterList = y, this.reLoadDateFilterRangeList = _, this.getAdvDateList = b, this.advDateListUnique = w }]) }() }, function (e, t, n) {
  "use strict"; var a = n(31), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.common").filter("null_date", ["$rootScope", "$translate", function (e, t) { var n = t.instant("chart.notLimit"); return function (e) { return e || n } }]).filter("format_date", ["$rootScope", "$translate", function (e, t) { var n = t.instant("dash.allTime"), a = t.instant("chart.notLimit"), i = /^opt_[0-9a-zA-Z]{32}$/; return function (e, t, r) { if (1 == e.length && !i.test(e[0])) return e[0]; if (!e) return r || n; var o = e.length, s = "test"; switch (o) { case 0: s = r || n; break; case 1: s = i.test(e[0]) ? function () { var a = ""; return angular.forEach(t, function (t, n) { t.opt_id === e[0] && (a = t.name) }), a = a || (r || n) }() : e[0]; break; case 2: s = (e[0] ? e[0] : a) + "~" + (e[1] ? e[1] : a); break; default: s = r || n }return s } }]).filter("inner_range_date_format", function () { return function (e, t) { var n = t.granularity, a = t.granularity_name || "", i = t.month_start_day || 0; return e.length ? e.map(function (e) { return bdpChart.helper.checkGranularity(n, e, a, i) }).join(",") : e } }).filter("granularity", ["granularityMap", function (e) { return function (t) { var n = t; return t && (n = "chart.by" + t.charAt(0).toUpperCase() + t.substring(1)), e[n] || e["chart.byDay"] } }]).filter("dataShowType", ["dataShowTypeMap", function (e) { return function (t) { var n = t; return t && (n = "chart.by" + t.charAt(0).toUpperCase() + t.substring(1)), e[n] || e["chart.byText"] } }]).filter("empty", function () { return function (e) { return "NULL" == e && (e = ""), e } }).filter("query_inner", function () { return function (e, t, n, a) { if (!e || !t) return e; var i = []; if ("string" == typeof e[0]) a && "sub_date" == a.data_type && (t = parseInt(t).toString()), angular.forEach(e, function (e) { e.toLowerCase().indexOf(t.toLowerCase()) > -1 && i.push(e) }); else { var r; angular.forEach(e, function (e) { r = bdpChart.helper.checkGranularity(n, e), r.toLowerCase().indexOf(t.toLowerCase()) > -1 && i.push(e) }) } return i } }).filter("query_fields", function () { return function (e, t, n) { if (!t) return e; n = n || "fuzzy"; var a = []; return angular.forEach(e, function (e) { "number" != typeof e.name && "number" != typeof e.original_name || (e.name = e.name.toString(), e.original_name = e.original_name.toString()), e.original_name ? (e.original_name.toLowerCase().indexOf(t.toLowerCase()) > -1 || e.name.toLowerCase().indexOf(t.toLowerCase()) > -1) && a.push(e) : "fuzzy" == n && e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 ? a.push(e) : "exactly" == n && e.name.toLowerCase() == t.toLowerCase() && a.push(e) }), a } }).filter("queryFieldsAsTitle", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { "number" == typeof e.name && (e.title = e.title.toString()), e.title.toLowerCase().indexOf(t.toLowerCase()) > -1 && n.push(e) }), n } }).filter("query_tables", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { "number" == typeof e.name && (e.name = e.name.toString()), (e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 || e.label && e.label.toLowerCase().indexOf(t.toLowerCase()) > -1) && n.push(e) }), n } }).filter("categoryFilter", ["$rootScope", function (e) { return function (t, n) { if (!n) return t; for (var a = [], i = e.language, r = 0, o = t.length; r < o; r++)t[r].db_name[i].toLowerCase().indexOf(n.toLowerCase()) == -1 && t[r].category_name[i].toLowerCase().indexOf(n.toLowerCase()) == -1 || a.push(t[r]); return a } }]).filter("nameFilter", function () { return function (e, t) { if (!t) return e; for (var n = [], a = 0; a < e.length; a++)e[a].original_name ? e[a].name.toLowerCase().indexOf(t.toLowerCase()) == -1 && e[a].original_name.toLowerCase().indexOf(t.toLowerCase()) == -1 || n.push(e[a]) : e[a].name.toLowerCase().indexOf(t.toLowerCase()) != -1 && n.push(e[a]); return n } }).filter("titleFilter", function () { return function (e, t) { if (!t) return e; for (var n = [], a = 0; a < e.length; a++)e[a].title.toLowerCase().indexOf(t.toLowerCase()) != -1 && n.push(e[a]); return n } }).filter("query_models", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { "number" == typeof e.name && (e.name = e.name.toString()), e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 && n.push(e) }), n } }).filter("query_fields_nick_name", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { "number" != typeof e.nick_name && "number" != typeof e.name || (e.nick_name = e.nick_name.toString(), e.name = e.name.toString()), (e.nick_name.toLowerCase().indexOf(t.toLowerCase()) > -1 || e.name.toLowerCase().indexOf(t.toLowerCase()) > -1) && n.push(e) }), n } }).filter("query_baiduSearch", function () { return function (e, t) { var n = []; return t ? "暂未设置" === t ? (angular.forEach(e, function (e, t) { "" === e.companyName && n.push(e) }), n) : (angular.forEach(e, function (e, a) { "number" == typeof e.companyName && (e.companyName = e.companyName.toString()), (e.companyName.toLowerCase().indexOf(t.toLowerCase()) > -1 || 0 == a) && n.push(e) }), n) : e } }).filter("cutLength", function () { return function (e, t) { if (!t) return e; var n = e; return e.length > t && (n = e.slice(0, t) + "……"), n } }).filter("query_updateRecord_fileLlist", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { (e.excel_name + "-" + e.sheet_name).toLowerCase().indexOf(t.toLowerCase()) > -1 && n.push(e) }), n } }).filter("queryByTagorDstype", ["$rootScope", function (e) { return function (t, n) { function a(e) { return e.tag && e.tag.toLowerCase().indexOf(n.toLowerCase()) > -1 } function i(t) { var a = t.ds_type_name[e.language]; return a && a.toLowerCase().indexOf(n.toLowerCase()) > -1 } if (!n) return t; var r = []; return angular.forEach(t, function (e) { (a(e) || i(e)) && r.push(e) }), r } }]).filter("query_ds_names_or_tags", function () { return function (e, t) { if (!t) return e; var n = [], a = []; angular.forEach(e, function (e) { e.hasOwnProperty("tag") && null != e.tag && e.tag.toLowerCase().indexOf(t.toLowerCase()) > -1 ? n.push(e) : e.hasOwnProperty("ds_name") && null != e.ds_name && e.ds_name.toLowerCase().indexOf(t.toLowerCase()) > -1 && a.push(e) }); return n.concat(a) } }).filter("query_user", function () { return function (e, t, n) { if (!t && !n) return e; var a = []; return t && n ? angular.forEach(e, function (e) { e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 && e.username && e.username.toLowerCase().indexOf(n.toLowerCase()) > -1 && a.push(e) }) : t ? angular.forEach(e, function (e) { e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 && a.push(e) }) : angular.forEach(e, function (e) { e.username && e.username.toLowerCase().indexOf(n.toLowerCase()) > -1 && a.push(e) }), a } }).filter("query_group", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { e.group_name.toLowerCase().indexOf(t.toLowerCase()) > -1 && n.push(e) }), n } }).filter("query_parse_param", function () { return function (e, t) { if (!t) return e; var n = [], a = []; return angular.forEach(e, function (e) { a = [], angular.forEach(e.keys, function (e) { e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 && a.push(e) }), a.length > 0 && n.push({ original_field_id: e.original_field_id, original_field_name: e.original_field_name, keys: a }) }), n } }).filter("filter_compare", ["$rootScope", "$translate", function (e, t) { var n = t.instant("warn.higher"), a = t.instant("warn.lower"); return function (e) { return 1 == e ? n : a } }]).filter("warnSwitch", ["$translate", function (e) { var t = e.instant("warn.open"), n = e.instant("warn.close"); return function (e) { return 1 == e ? n : t } }]).filter("sub_date", function () { return function (e, t) { var n = t.data_type, a = t.config ? t.config.granularity : t.granularity, r = t.name; return void 0 === e || "" === e || 0 == e.length ? r : "string" == n ? "object" !== (void 0 === e ? "undefined" : (0, i.default)(e)) ? e : e.join("，") : "date" == n ? "object" !== (void 0 === e ? "undefined" : (0, i.default)(e)) ? bdpChart.helper.checkGranularity(a, e) : e.map(function (e) { return bdpChart.helper.checkGranularity(a, e) }).join("，") : (a = t.fid.split("_")[1], bdpChart.helper.subDateFormat(a, e)) } }).filter("dash_sub_date", ["$rootScope", "$translate", function (e, t) { var n = t.instant("all"); return function (e, t) { var a = t.data_type, r = t.granularity; return void 0 === e || "" === e || 0 == e.length ? n : "string" == a ? "object" !== (void 0 === e ? "undefined" : (0, i.default)(e)) ? e : e.join("，") : "date" == a ? "object" !== (void 0 === e ? "undefined" : (0, i.default)(e)) ? bdpChart.helper.checkGranularity(r, e) : e.map(function (e) { return bdpChart.helper.checkGranularity(r, e) }).join("，") : (r = t.fid.split("_")[1], "object" !== (void 0 === e ? "undefined" : (0, i.default)(e)) ? bdpChart.helper.subDateFormat(r, e) : e.map(function (e) { return bdpChart.helper.subDateFormat(r, e) }).join(",")) } }]).filter("plot_line_calc", ["formulaKeyMap", function (e) { return function (t) { return e[t] } }]).filter("adv_formula", [function () { return function (e, t) { var n = []; return angular.forEach(e, function (e) { "all" != e.show && e.show != t || n.push(e) }), n } }]).filter("date_gran_to_name", ["dateNameMap", function (e) { return function (t) { return e[t] || e.day } }]).filter("tb_type_hint", function () { return function (e, t) { var n; switch (e) { case "excel": n = "Excel"; break; case "join": n = "多表合并"; break; case "aggr": n = "数据聚合"; break; case "ds": n = "数据库表"; break; case "public": n = "公共数据表"; break; default: n = "工作表" }return n } }).filter("userStatus", ["$translate", "$rootScope", function (e, t) { var n = e.instant("user.base_info.unactive"), a = e.instant("user.base_info.pwd"); return function (e) { return 1 == e ? n : a } }]).filter("fieldType", function () { return function (e) { switch (e = Number(e)) { case 0: case 1: return "数值"; case 2: return "字符串"; case 3: return "日期" } } }).filter("granularityName", ["granularityMap", function (e) { return function (t) { var n = t; return t && (n = "chart.by" + t.charAt(0).toUpperCase() + t.substring(1)), e[n] || e.normal } }]).filter("buildAggregator", function () { return function (e) { return e ? e.filter(function (e) { return 1 !== e.is_build_aggregated }) : [] } }).filter("db_type", ["$rootScope", "databaseType", function (e, t) { return function (e) { for (var n = "", a = 0; a < t.length; a++)if (t[a].dbType == e) { n = t[a].typeName; break } return n } }]).filter("weekFormat", function () { return function (e) { "number" != typeof e && (e = new Date(e).getTime()); return Highcharts.dateFormat("%b/%e", e) + "~" + Highcharts.dateFormat("%b/%e", e + 5184e5) } }).filter("dateFormat", function () { return function (e) { return Highcharts.dateFormat("%Y-%m-%d", new Date(e)) } }).filter("workTbName", function () { return function (e) { return e || "请选择工作表" } }).filter("workFieldName", function () { return function (e) { return e || "请选择字段" } }).filter("filterOperator", ["filterOperatorMap", function (e) { return function (t) { return "" === t ? "" : e[t] || e[0] } }]).filter("conditionType", function () { return function (e) { return 0 == e ? "全部" : "任一" } }).filter("timestamp2LocaleDate", [function () { return function (e, t) { return bdpChart.helper.checkGranularity(t, e) } }]).filter("t2Date", [function () { return function (e, t) { var n = t.granularity, a = t.granularity_name || "", i = t.month_start_day || 0; return "week" === n && (i = t.week_start_day_of_week), bdpChart.helper.checkGranularity(n, e, a, i) } }]).filter("yoyTypeTranslate", ["$rootScope", "dateNameMap", function (e, t) { return function (n, a) { var i, r; return "zh" == e.language ? (i = "环比增长", r = "value" == a ? "值" : "率") : (i = t[n] + " on " + t[n], r = a ? "(" + a + ")" : ""), a ? i + r : i } }]).filter("thisCaptain", function () { return function (e) { return e.substring(0, 4) + e.charAt(4).toUpperCase() + e.substring(5) } }).filter("i18nMonth", ["$rootScope", function (e) { var t = e.language, n = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]; return function (e) { return "zh" === t ? e + "月" : "en" === t ? n[e - 1] : void 0 } }]).filter("i18nWeek", ["$rootScope", function (e) { var t = e.language, n = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"], a = ["星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"]; return function (e) { return "zh" === t ? a[e - 1] : "en" === t ? n[e - 1] : void 0 } }]).filter("i18nDay", ["$rootScope", function (e) { var t = e.language; return function (e) { if ("zh" === t) return e + "日"; if ("en" === t) switch (e) { case 1: return e + "st"; case 2: return e + "nd"; case 3: return e + "rd"; default: return e + "th" } } }]).filter("timestamp2DayInWeek", ["$rootScope", function (e) { var t = e.language, n = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"], a = ["星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"]; return function (e) { var i = new Date(e), r = i.getDay(); return r = 0 === r ? 7 : r, "zh" === t ? a[r - 1] : "en" === t ? n[r - 1] : void 0 } }]).filter("query_union_table", function () { return function (e, t) { var n = []; return t ? (angular.forEach(e, function (e) { e.hasOwnProperty("tag") && e.tag.toLowerCase().indexOf(t.toLowerCase()) > -1 ? n.push(e) : e.hasOwnProperty("name") && e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 && n.push(e) }), n) : e } }).filter("timestampToHoursFormat", ["$translate", function (e) { return function (t) { t /= 1e3; var n = Math.floor(t / 3600), a = Math.floor((t - 3600 * n) / 60), i = Math.floor(t - 3600 * n - 60 * a); return n + e.instant("author.hour") + a + e.instant("author.minute") + i + e.instant("author.second") } }]).filter("fieldFilter", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { "number" == typeof e.name && (e.name = e.name.toString()), e.name.toLowerCase().indexOf(t.toLowerCase()) > -1 && n.push(e) }), n } }).filter("ruleListQuery", function () { return function (e, t) { var n = t.creator, a = t.name; if (!t || "all" == n && !a) return e; var i = []; return angular.forEach(e, function (e) { "number" == typeof e.name && (e.name = e.name.toString()), "all" == n || a || e.user_id == n && i.push(e), "all" == n && a && e.name.toLowerCase().indexOf(a.toLowerCase()) >= 0 && i.push(e), "all" != n && a && e.name.toLowerCase().indexOf(a.toLowerCase()) >= 0 && e.user_id == n && i.push(e) }), i } }).filter("dbLogSheetStatus", function () {
    return function (e, t) {
      if (!t) return e; var n = []
        ; return angular.forEach(e, function (e) { e.status != t && "all" != t || n.push(e) }), n
    }
  }).filter("dbLogSheetQuery", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { e.title.toLowerCase().indexOf(t.toLowerCase()) > -1 && n.push(e) }), n } }).filter("dbLogTaskStatus", function () { return function (e, t) { if (!t) return e; var n = []; return angular.forEach(e, function (e) { e.status != t && "all" != t || n.push(e) }), n } }).filter("htmlFilter", ["$sce", function (e) { return function (t) { return e.trustAsHtml(t) } }]).filter("scirptFilter", ["$sce", function (e) { return function (e) { return e.replace(/\<.?script\>/g, "") } }]).filter("getFieldsByDataType", function () { return function (e, t) { var n = []; return angular.forEach(e, function (e, a) { e.data_type == t && n.push(e) }), n } }).filter("trustUrl", ["$sce", function (e) { return function (t) { return e.trustAsResourceUrl(t) } }]).filter("toSce", ["$sce", function (e) { return function (t) { return e.trustAsHtml(t) } }]).filter("handleRowSummary", function () { return function (e) { var t = bdpChart.language || "zh", n = "zh" == t ? "行总计" : "Row Summary"; return $.inArray(e.originName, ["行总计", "Row Summary"]) > -1 ? n : e.name } }).filter("formatStorageAccount", function () { return function (e) { var t = bdp.utils.formatStorageAccount(1024 * e * 1024), n = t.indexOf("."); return t.slice(0, n) + t.slice(n + 3) } }).filter("projDashSearchName", ["queryTextFunc", "multipleProService", function (e, t) { return function (n, a, i) { function r(t, a) { t.map(function (t) { t.queryHit = !1, t.queryShow = !1, "project" == t.attribute && (t.queryHit = !!e.existText(t.name, n), t.queryShow = !!t.queryHit || !!a, t.queryShow && (d.push(t), u.push(t.proj_id), c.push(t.proj_id), f++), t.queryShow && !h && (h = t)), t.subs && r(t.subs, t.queryShow) }) } function o(t) { t.map(function (t) { "project" == t.attribute && t.subs && t.subs.map(function (a) { "dashboard" == a.attribute && (a.queryHit = !!e.existText(a.name, n), "cat" == i && !a.choose && a.queryHit && (a.queryHit = !1), a.queryShow = t.queryHit || a.queryHit, a.queryShow && u.indexOf(t.proj_id) < 0 && (d.push(t), u.push(t.proj_id), c.push(t.proj_id), f++), a.queryShow && !h && (h = t)) }), t.subs && o(t.subs) }) } function s(e) { e.map(function (e) { "project" == e.attribute && g.indexOf(e.proj_id) >= 0 && !e.queryShow && (e.queryShow = !0, c.push(e.proj_id), f++), e.subs && s(e.subs) }) } function l(e) { e.subs && !h && e.subs.map(function (e) { "dashboard" == e.attribute && e.queryHit ? h = p : "project" == e.attribute && (e.queryHit ? h = e : l(e)) }) } var c = [], d = [], u = [], f = 0, p = null, h = null; r(a), o(a), u = bdp.utils.arrayUnique(u); var g = []; return angular.forEach(d, function (e) { t.findParId(e, g), u = u.concat(g) }), s(a), function (e) { e.some(function (e) { if ("project" == e.attribute && e.queryShow) return p = e, !0 }) }(a), p && l(p), { showList: a, showNum: f, showProjIdList: c, firstHitProjObj: n ? h : "" } } }]).filter("translate", ["$parse", "$translate", function (e, t) { return function (e) { return void 0 == bdpI18N[e] ? e : bdpI18N[e] } }]).factory("$jsTipTranslate", ["$rootScope", "$translate", function (e, t) { return function (e, t) { t.tips = t.tips || {}, function () { angular.forEach(e, function (e, n) { t.tips[e] = bdpI18N[e] }) }() } }]).service("$translate", ["$timeout", function (e) { this.instant = function (e) { return void 0 == bdpI18N[e] ? e : bdpI18N[e] } }]).filter("tplListNameQuery", ["queryTextFunc", function (e) { return function (t, n) { var a = 0; return n.map(function (n) { t ? (n.queryShow = !!e.existText(n.name, t), a = n.queryShow ? ++a : a) : (n.queryShow = !0, a++) }), { showList: n, showNum: a } } }]).filter("tableDateValue", [function () { return function (e, t) { var n, a = "", i = t.data_type; if (!e) return ""; if ("date" === i) { a = t.granularity || "day"; var r = t.granularity_name || "", o = t.month_start_day || 0; "hour" !== a && "minute" !== a && "second" !== a || (a = "g_" + a), "week" === a && (o = t.week_start_day_of_week || 1), ["(空白)", "(Blank)"].indexOf(e) > -1 ? n = e : (n = bdpChart.helper.checkGranularity(a, e, r, o), "week" === a && (n += "（" + Highcharts.dateFormat("%b/%e", new Date(e)) + "~" + Highcharts.dateFormat("%b/%e", new Date(e + 5184e5)) + "）")) } else "sub_date" == i ? (a = t.fid.split("_")[1], n = bdpChart.helper.subDateFormat(a, e)) : n = e; return n = n ? n.toString() : "" } }])
}, function (e, t, n) { "use strict"; angular.module("BC.common").directive("bdpLocalQuery", function () { function e(e, t) { if (t.indexOf(".") < 0) return e[t]; for (var n = t.split("."), a = e; n.length;)a = a[n.shift()]; return a } function t(e, n, a, i, r) { i(e); var o = []; n[0].forEach(function (s, l) { var c = e, d = e[s.key]; "" === s.key ? (c = {}, d = e) : d = d || [], "$" === s.flag ? d.forEach(function (e, s) { t(e, n, a, i, r), a(e, c), o.push(e) }) : "=" === s.flag ? d.forEach(function (e, t) { a(e, c, "isLeaf"), o.push(e) }) : s.flag || d.forEach(function (e, o) { t(e, n.slice(1), a, i, r) }) }), r(e, o) } function n(e) { return e.split(",").map(function (e, t) { var n = e.match(/\[([\$=])?\]$/); if (!n) throw new Error("struct parse error: [] not found! "); return { key: e.replace(n[0], ""), flag: n[1] } }) } return { restrict: "A", scope: { tree: "=bdpLocalQuery", query: "=?ngModel", struct: "=?queryStruct", key: "=?queryKey" }, link: function (a, i, r) { function o() { a.query && "" != a.query ? i.addClass("has-text") : i.removeClass("has-text") } a.struct = a.struct || ["[]"]; var s = a.struct.map(n), l = s[s.length - 1]; l[0].flag || (l[0].flag = "="); var c = function () { function n(t) { var n = e(t, r); return "number" == typeof n && (n = n.toString()), "fuzzy" == o && n.toLowerCase().indexOf(i.toLowerCase()) > -1 || "exactly" == o && n.toLowerCase() == i.toLowerCase() } var i = void 0 == a.query ? "" : String(a.query), r = a.key || "name", o = "fuzzy"; "" === i && (n = function () { return !0 }), t(a.tree, s, function (e, t, a) { a && (e.hide_by_query = !n(e)), t.hide_by_query &= e.hide_by_query }, function (e) { e.hide_by_query = !0 }, function (e, t) { "" === i && 0 === t.length && (e.hide_by_query = !1) }) }; a.$watch("query", function (e, t) { (e || t) && e != t && c() }), a.$watch("tree", function (e, t) { e && (a.query = "", setTimeout(function () { i.blur() }, 10), o(), c()) }), i.on("keyup.localQuery", function (e) { 27 == e.which && (a.$apply('query=""'), i.blur()), o() }), o() } } }).directive("bdpNgRepeatComplete", function () { return function (e, t, n) { if (e.$first) { var a = e.$eval(n.start); "[object Function]" === Object.prototype.toString.call(a) && a() } if (e.$last) { var i = e.$eval(n.end); "[object Function]" === Object.prototype.toString.call(i) && i() } } }).directive("focusMe", ["$timeout", function (e) { return { link: function (t, n, a) { t.$watch(a.focusMe, function (t) { t === !0 && e(function () { n[0].focus() }) }) } } }]).directive("fixMore", [function () { return { restrict: "A", scope: !0, link: function (e, t, n) { $(t).on("mouseover", function (e) { var t = $(this), n = t.next("ul.more-list"); if (n.length) { var a = e.pageY, i = n.height(), r = $(".J-chart-right"); if (r[0]) { var o = n && n.css("width") ? n.css("width").substr(0, n.css("width").indexOf("px")) : null, s = o || t.outerWidth(); r[0].getBoundingClientRect().left - t[0].getBoundingClientRect().right < s - 6 ? n.css("left", "-" + s + "px") : t.parent().parent().hasClass("more-list") ? "-" == t.parent().parent().css("left").substr(0, 1) ? n.css("left", "-" + s + "px") : r[0].getBoundingClientRect().left - t.parent()[0].getBoundingClientRect().right < s ? n.css("left", "-" + s + "px") : n.css("left", "100%") : n.css("left", "100%") } a + i > document.body.clientHeight ? n.css({ top: 24 - i }) : n.css({ top: 0 }) } }) } } }]).directive("exportWorksheet", ["$http", "$rootScope", "commonService", "ngDialog", "errHint", "$translate", function (e, t, n, a, i, r) { return { restrict: "A", scope: !0, link: function (e, o, s) { function l(n) { var i = n.export_max_num || 0, r = e.previewData.field_data_total; t.language; e.exportData = r, e.export_max_num = i, r > i ? (e.exportData = i, a.open({ template: "/static/partials/dialogTemplates/export_worksheet_large_limit_tip.html", className: "ngdialog-theme-default ngDialog-width-400", scope: e })) : c() } function c() { var r = e.selected.tb_id, o = e.filterCondition; t.language; switch (a.open({ template: "/static/partials/dialogTemplates/export_worksheet_large_tip.html", className: "ngdialog-theme-default ngDialog-width-400", scope: e }), s.exportType) { case "tupu": e.loading = !0, n.tb.exportTbTupu({ tb_id: r, row_filter: angular.toJson(o) }).then(function (t) { if (e.loading = !1, 0 == t.status) { var n = t.result.login_url; window.open(n, "_blank") } }); break; case "tupuTag": e.loading = !0, n.tb.exportTbTupuTag({ tb_id: r, row_filter: angular.toJson(o) }).then(function (t) { if (e.loading = !1, 0 == t.status) { var n = t.result.login_url; window.open(n, "_blank") } }); break; default: n.tb.exportTbFile({ tb_id: r, row_filter: angular.toJson(o) }).then(function (e) { 0 == e.status || 27009 == e.status && i(e.errstr) }) } } function d() { var n = ""; n = 3 == t.enterprise_type ? '<p>该功能只对付费会员开放，<a class="link" href="/member-pay.html#?vipLevel=2" target="_blank">立即升级</a>，即可使用</p>' : "<p>" + r.instant("wb.exportWorksheet.noPermission0"), a.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: e, data: { title: r.instant("downloadTitleTip"), cancelValue: r.instant("iKnow"), hideConfirm: !0, trustHtmlStr: !0, message: n } }) } e.openOfflineList = function () { t.fireOfflineTaskList = "export" }, o.on("click", function () { var e = s.exportType, n = null; if (n = "tupu" == e || "tupuTag" == e ? t.global.tpExportDataSeting : t.global.tbExportDataSetting, !n.is_export) return void d(); l(n) }), e.goOnExport = function () { c() } } } }]).directive("showOnload", function () { return { restrict: "A", link: function (e, t, n) { function a() { t.hide() } t.hide(), t.on("loadeddata", function () { t[0].readyState >= 2 && (t.show(), t.off("loadeddata")) }), $(window).on("beforeunload", a), e.$on("$destroy", function () { $(window).off("beforeunload", a) }) } } }).directive("warningAmount", ["$interval", function (e) { return { restrict: "A", link: function (t, n) { n.on("click", function () { e.cancel(t.timer) }) }, controller: ["$scope", "commonHttp", "$rootScope", "$timeout", function (t, n, a, i) { function r() { var n = a.userInfoObj.push_setting; n.warn.sound && ("2" != n.sound_type ? o() : t.timer = e(function () { o() }, 500)) } function o() { document.getElementById("warn-sond").play() } var s = function () { n.get("/api/warn/amount").then(function (e) { "0" === e.status && (a.unread = e.result.unread) }) }; i(function () { s() }, 500), t.timer = null; t.$on("_websocketChartMessage_", function (e, n) { var i = "string" == typeof n.data ? $.parseJSON(n.data) : n.data; 5 == i.type && (a.unread = i.count, t.$digest(), r()) }) }] } }]).directive("fixedWithDom", ["$position", function (e) { return { scope: !0, link: function (t, n, a, i) { function r(t, n, a, i) { var r = e.positionElements(t, n, a, i), o = p[0] || 0, s = p[1] || 0; n.css({ top: r.top + s + "px", left: r.left + o + "px" }) } var o = a.fixedWithDom, s = $(a.fixedDomSelector)[0] ? $(a.fixedDomSelector) : $(n).parent(), l = e.scrollParent(s), c = a.fixedScrollHide, d = bdp.utils.guid(), u = $(l).scrollTop(), f = void 0 != a.fixedDelayRender ? Number(a.fixedDelayRender) : 0, p = a.fixedPosOffset ? t.$eval(a.fixedPosOffset) : [0, 0]; n.css("visibility", "hidden"), setTimeout(function () { r(s, n, o, !0), n.css("visibility", "visible") }, f), void 0 !== c && ($(l).off("scroll" + d).on("scroll." + d, function (e) { Math.abs(u - $(e.target).scrollTop()) > 8 && t.$apply(c) }), t.$on("$destroy", function () { $(l).off("scroll" + d) })) } } }]).directive("rippleButton", [function () { return { restrict: "A", template: function (e, t) { var n = t.rippleButton, a = '\n                <div ng-transclude></div>\n                <svg style="position:absolute;top:0;left:0;width:100%;height:100%;">\n\t\t\t\t\t[template]\n                </svg>\n                <div style="position:absolute;top:0;left:0;width:100%;height:100%;" ng-click="rippleAnimation($event)" class="eventWrap"></div>\n                ', i = { circle: function () { return '\n                        <g class="animateWrap" style="opacity:0;">\n                            <circle fill="#5182E4" cx="1" cy="1" r="1" />\n                        </g>\n                        ' }, radialCircle: function () { return '\n                        <defs>\n                            <radialGradient id="gradient">\n                                <stop offset="0" stop-color="#5182E4" />\n                                <stop offset="0.25" stop-color="#73A1FF" />\n                                <stop offset="0.35" stop-color="#5182E4" />\n                                <stop offset="0.50" stop-color="#73A1FF" />\n                                <stop offset="0.60" stop-color="#5182E4" />\n                                <stop offset="0.85" stop-color="#73A1FF" />\n                                <stop offset="1" stop-color="#5182E4" />\n                            </radialGradient>\n                        </defs>\n                        <g class="animateWrap" style="opacity:0;">\n                            <circle cx="1" cy="1" r="1" fill="url(#gradient)" />\n                        </g>\n                        ' } }, r = i[n]; void 0 === r && (r = i.circle); var o = r(); return a.replace(/\[template\]/, o) }, transclude: !0, link: function (e, t, n) { function a() { r = function (e, t) { var n = new TimelineMax, a = e.offsetX, r = e.offsetY, o = e.target.offsetWidth, s = e.target.offsetHeight, l = Math.abs(o / 2 - a), c = Math.abs(s / 2 - r), d = o / 2 + l, u = s / 2 + c, f = Math.sqrt(Math.pow(d, 2) + Math.pow(u, 2)); return n.fromTo(i, t, { x: a, y: r, transformOrigin: "50% 50%", scale: 0, opacity: 1, ease: Linear.easeIn }, { scale: f, opacity: 0 }), n } } t.css("position", "relative"); var i = t.find(".animateWrap"), r = void 0; e.rippleAnimation = function (e) { r && r(e, .75) }; bdp.loadjs({ callback: a, src: "//m1.bdp.cn/static/js/lib/TweenMax.min_1d4514e.js" }) } } }]) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function e(e, t, n, a, i) { this.$http = e, this.$q = t, this.commonHttp = n, this.ngDialog = a, this.$translate = i, this.cacheObj = { argList: [] }, this.argInfoMap = {}, this.listState = "ready", this.dataTypeMap = { number: 1, string: 2, date: 3 }, this.formatParams = function (e, t) { var n = angular.copy(e); return n.forEach(function (e) { "edit" != t || e.is_current || (e.disable = !0), ("edit" != t && e.display || "edit" == t) && (e.show = !0), "number" == e.type && (e.value = Number(e.value), e.default_value = Number(e.default_value)), "number" == e.type && "percent" == e.config.number_type && (e.value = e.value.mul(100), e.originValue = e.value.mul(100), e.defaultValDisplay = e.default_value = e.default_value.mul(100) + "%", e.config.minDisplay = e.config.min = e.config.range[0] || 0 == e.config.range[0] ? Number(e.config.range[0]).mul(100) + "%" : "不限", e.config.maxDisplay = e.config.range[1] || 0 == e.config.range[1] ? Number(e.config.range[1]).mul(100) + "%" : "不限"), ("date" == e.type || "number" == e.type && "percent" != e.config.number_type) && (e.config.minDisplay = e.config.min = e.config.range[0] || 0 == e.config.range[0] ? e.config.range[0] : "不限", e.config.maxDisplay = e.config.max = e.config.range[1] || 0 == e.config.range[1] ? e.config.range[1] : "不限", e.defaultValDisplay = e.default_value, e.originValue = e.value), "date" == e.type && "date" == e.config.date_type && (e.defaultValDisplay = e.default_value.replace(/.{8}$/, ""), e.config.minDisplay = e.config.minDisplay.replace(/.{8}$/, ""), e.config.maxDisplay = e.config.maxDisplay.replace(/.{8}$/, "")), "string" == e.type && (e.defaultValDisplay = e.default_value) }), angular.copy(n) } } return e.prototype.list = function (e) { var t = this; return this.listState = "loading", this.commonHttp.post("/api/param/list", { tb_id: e.tableId, ct_id: e.chartId }).then(function (e) { return t.listState = "ready", 0 == e.status && (t.cacheObj.argList = t.formatParams(t.generateIconType(e.result.param_list || []), "edit")), t.cacheObj.argList }) }, e.prototype.del = function (e, t) { var n = this; this.ngDialog.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", data: { title: this.$translate.instant("tips"), message: this.$translate.instant("param.deleteParamTip") } }).then(function () { n.commonHttp.post("/api/param/delete", { tb_id: e.tableId, param_id: e.paramId }).then(function (e) { 0 == e.status && n.cacheObj.argList.splice(t, 1) }) }) }, e.prototype.info = function (e) { var t = this.$q.defer(); return this.commonHttp.get("/api/param/info", e).then(function (e) { 0 == e.status ? t.resolve(e.result) : t.reject("error") }), t.promise }, e.prototype.save = function (e, t) { var n = this.$q.defer(), a = "modify" == t ? "/api/param/modify" : "/api/param/create"; return this.commonHttp.post(a, e).then(function (e) { 0 == e.status ? n.resolve("success") : n.reject("error") }), n.promise }, e.prototype.getParamInfo = function (e) { var t = this; return this.commonHttp.post("/api/param/info", { param_id: e }).then(function (n) { 0 == n.status && (t.argInfoMap[e] = n.result.config.range || []) }) }, e.prototype.generateIconType = function (e) { var t = this; return void 0 === e && (e = []), e.forEach(function (e, n) { e.ico_type = t.dataTypeMap[e.type] }), e }, e }(); t.chartArgsService = a }, function (e, t, n) { "use strict"; var a = n(41), i = n(206); n(213), n(215), n(217), n(218), n(197), n(220), n(222), n(224), n(226), n(227), n(228), n(230), n(232), n(234), n(236), n(238), n(240), n(242), n(244), n(246), n(253), n(255), angular.module("BC.common", ["ngDragDrop", "BC.chartWarning", "BC.enumOrder", "BC.advanceSort", "BC.markPoint", "BC.chartArgsUse", "BC.setDateValue", "BC.createField", "BC.chartInfoSummary"]), n(198), n(199), n(200), n(256), n(201), n(257), n(258), n(259), n(202), n(260), n(174), n(262), n(263), n(265), n(266), n(203), n(174), n(267), n(269), n(270), n(271), n(273), n(274), (0, a.extendNgModule)({ name: "BC.common", directive: { BrowserCheckComponent: i.BrowserCheckComponent } }) }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.BrowserCheckComponent = void 0; var i, r, o = n(69), s = a(o), l = n(70), c = a(l), d = n(6), u = a(d), f = n(7), p = a(f), h = n(41); n(209); var g = t.BrowserCheckComponent = (i = (0, h.ngComponent)(function () { "ngInject"; return { scope: {}, controller: g, controllerAs: "browserCheckCtrl", restrict: "E", replace: !0, transclude: !0, templateUrl: n(211), link: function (e, t, n, a) { var i = '{"SHOW_FORGET_PASSWORD":true,"SHOW_ADAPTIVE_FULL_SCREEN":true,"USE_CUSTOM_CHART":true,"SHOW_ADV_DASH":true,"USE_AUTHORIZED":true}', r = !1; i && (i = JSON.parse(i), r = !!i.HIDE_BROWSER_CHECK), e.browserCheckCtrl.ngOnInit({ options: { disabled: r } }) } } }))(r = function () { function e(t, n, a, i) { "ngInject"; (0, u.default)(this, e), this.viewData = {}, this.$rootScope = t, this.$scope = n, this.$timeout = a, this.ngDialog = i } return e.$inject = ["$rootScope", "$scope", "$timeout", "ngDialog"], (0, p.default)(e, [{ key: "ngOnInit", value: function () { function e() { return t.apply(this, arguments) } var t = (0, c.default)(s.default.mark(function e() { var t, n, a, i, r, o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, l = o.options, c = void 0 === l ? {} : l; return s.default.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.viewData = { showCheckTip: !1, ua: navigator.userAgent, vendor: navigator.vendor, disabled: c.disabled }, !this.viewData.disabled) { e.next = 3; break } return e.abrupt("return"); case 3: if (t = navigator.userAgent, n = navigator.vendor, a = t.match(/(Android)\s+([\d.]+)/), i = t.match(/(iPad).*OS\s([\d_]+)/), r = !i && t.match(/(iPhone\sOS)\s([\d_]+)/), !(a || i || r)) { e.next = 10; break } return e.abrupt("return", !1); case 10: t.indexOf("Chrome") >= 0 && !this.checkBrowserFunc("chrome") && (this.viewData.showCheckTip = !0), t.indexOf("Firefox") >= 0 && !this.checkBrowserFunc("firefox") && (this.viewData.showCheckTip = !0), n.indexOf("Apple") >= 0 && t.indexOf("Chrome") < 0 && !this.checkBrowserFunc("safari") && (this.viewData.showCheckTip = !0); case 13: case "end": return e.stop() } }, e, this) })); return e }() }, { key: "checkBrowserFunc", value: function (e) { var t = this.viewData.ua.toString().toLocaleLowerCase(), n = { chrome: function () { var e = t.match(/chrome\/(\d*)\./); return !e || !!e && !!e.length && e[1] >= 49 }, firefox: function () { var e = t.match(/firefox\/(\d*)\./); return !e || !!e && !!e.length && e[1] >= 41 }, safari: function () { var e = t.match(/version\/(\d*)\./); return !e || !!e && !!e.length && e[1] >= 10 } }; return !n.hasOwnProperty(e) || n[e]() } }, { key: "closeTip", value: function () { this.viewData.showCheckTip = !1 } }, { key: "openRecommendDialog", value: function () { this.ngDialog.open({ template: n(212), className: "ngdialog-theme-default ngdialog-width-712 browser-recommend-dialog", showClose: !1, scope: !0 }) } }]), e }()) || r }, function (e, t, n) { var a = function () { return this }() || Function("return this")(), i = a.regeneratorRuntime && Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime") >= 0, r = i && a.regeneratorRuntime; if (a.regeneratorRuntime = void 0, e.exports = n(208), i) a.regeneratorRuntime = r; else try { delete a.regeneratorRuntime } catch (e) { a.regeneratorRuntime = void 0 } }, function (e, t) { !function (t) { "use strict"; function n(e, t, n, a) { var r = t && t.prototype instanceof i ? t : i, o = Object.create(r.prototype), s = new p(a || []); return o._invoke = c(e, n, s), o } function a(e, t, n) { try { return { type: "normal", arg: e.call(t, n) } } catch (e) { return { type: "throw", arg: e } } } function i() { } function r() { } function o() { } function s(e) { ["next", "throw", "return"].forEach(function (t) { e[t] = function (e) { return this._invoke(t, e) } }) } function l(e) { function t(n, i, r, o) { var s = a(e[n], e, i); if ("throw" !== s.type) { var l = s.arg, c = l.value; return c && "object" == typeof c && y.call(c, "__await") ? Promise.resolve(c.__await).then(function (e) { t("next", e, r, o) }, function (e) { t("throw", e, r, o) }) : Promise.resolve(c).then(function (e) { l.value = e, r(l) }, o) } o(s.arg) } function n(e, n) { function a() { return new Promise(function (a, i) { t(e, n, a, i) }) } return i = i ? i.then(a, a) : a() } var i; this._invoke = n } function c(e, t, n) { var i = x; return function (r, o) { if (i === T) throw new Error("Generator is already running"); if (i === E) { if ("throw" === r) throw o; return g() } for (n.method = r, n.arg = o; ;) { var s = n.delegate; if (s) { var l = d(s, n); if (l) { if (l === L) continue; return l } } if ("next" === n.method) n.sent = n._sent = n.arg; else if ("throw" === n.method) { if (i === x) throw i = E, n.arg; n.dispatchException(n.arg) } else "return" === n.method && n.abrupt("return", n.arg); i = T; var c = a(e, t, n); if ("normal" === c.type) { if (i = n.done ? E : D, c.arg === L) continue; return { value: c.arg, done: n.done } } "throw" === c.type && (i = E, n.method = "throw", n.arg = c.arg) } } } function d(e, t) { var n = e.iterator[t.method]; if (n === m) { if (t.delegate = null, "throw" === t.method) { if (e.iterator.return && (t.method = "return", t.arg = m, d(e, t), "throw" === t.method)) return L; t.method = "throw", t.arg = new TypeError("The iterator does not provide a 'throw' method") } return L } var i = a(n, e.iterator, t.arg); if ("throw" === i.type) return t.method = "throw", t.arg = i.arg, t.delegate = null, L; var r = i.arg; return r ? r.done ? (t[e.resultName] = r.value, t.next = e.nextLoc, "return" !== t.method && (t.method = "next", t.arg = m), t.delegate = null, L) : r : (t.method = "throw", t.arg = new TypeError("iterator result is not an object"), t.delegate = null, L) } function u(e) { var t = { tryLoc: e[0] }; 1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t) } function f(e) { var t = e.completion || {}; t.type = "normal", delete t.arg, e.completion = t } function p(e) { this.tryEntries = [{ tryLoc: "root" }], e.forEach(u, this), this.reset(!0) } function h(e) { if (e) { var t = e[b]; if (t) return t.call(e); if ("function" == typeof e.next) return e; if (!isNaN(e.length)) { var n = -1, a = function t() { for (; ++n < e.length;)if (y.call(e, n)) return t.value = e[n], t.done = !1, t; return t.value = m, t.done = !0, t }; return a.next = a } } return { next: g } } function g() { return { value: m, done: !0 } } var m, v = Object.prototype, y = v.hasOwnProperty, _ = "function" == typeof Symbol ? Symbol : {}, b = _.iterator || "@@iterator", w = _.asyncIterator || "@@asyncIterator", C = _.toStringTag || "@@toStringTag", S = "object" == typeof e, k = t.regeneratorRuntime; if (k) return void (S && (e.exports = k)); k = t.regeneratorRuntime = S ? e.exports : {}, k.wrap = n; var x = "suspendedStart", D = "suspendedYield", T = "executing", E = "completed", L = {}, A = {}; A[b] = function () { return this }; var $ = Object.getPrototypeOf, I = $ && $($(h([]))); I && I !== v && y.call(I, b) && (A = I); var O = o.prototype = i.prototype = Object.create(A); r.prototype = O.constructor = o, o.constructor = r, o[C] = r.displayName = "GeneratorFunction", k.isGeneratorFunction = function (e) { var t = "function" == typeof e && e.constructor; return !!t && (t === r || "GeneratorFunction" === (t.displayName || t.name)) }, k.mark = function (e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, o) : (e.__proto__ = o, C in e || (e[C] = "GeneratorFunction")), e.prototype = Object.create(O), e }, k.awrap = function (e) { return { __await: e } }, s(l.prototype), l.prototype[w] = function () { return this }, k.AsyncIterator = l, k.async = function (e, t, a, i) { var r = new l(n(e, t, a, i)); return k.isGeneratorFunction(t) ? r : r.next().then(function (e) { return e.done ? e.value : r.next() }) }, s(O), O[C] = "Generator", O[b] = function () { return this }, O.toString = function () { return "[object Generator]" }, k.keys = function (e) { var t = []; for (var n in e) t.push(n); return t.reverse(), function n() { for (; t.length;) { var a = t.pop(); if (a in e) return n.value = a, n.done = !1, n } return n.done = !0, n } }, k.values = h, p.prototype = { constructor: p, reset: function (e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = m, this.done = !1, this.delegate = null, this.method = "next", this.arg = m, this.tryEntries.forEach(f), !e) for (var t in this) "t" === t.charAt(0) && y.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = m) }, stop: function () { this.done = !0; var e = this.tryEntries[0], t = e.completion; if ("throw" === t.type) throw t.arg; return this.rval }, dispatchException: function (e) { function t(t, a) { return r.type = "throw", r.arg = e, n.next = t, a && (n.method = "next", n.arg = m), !!a } if (this.done) throw e; for (var n = this, a = this.tryEntries.length - 1; a >= 0; --a) { var i = this.tryEntries[a], r = i.completion; if ("root" === i.tryLoc) return t("end"); if (i.tryLoc <= this.prev) { var o = y.call(i, "catchLoc"), s = y.call(i, "finallyLoc"); if (o && s) { if (this.prev < i.catchLoc) return t(i.catchLoc, !0); if (this.prev < i.finallyLoc) return t(i.finallyLoc) } else if (o) { if (this.prev < i.catchLoc) return t(i.catchLoc, !0) } else { if (!s) throw new Error("try statement without catch or finally"); if (this.prev < i.finallyLoc) return t(i.finallyLoc) } } } }, abrupt: function (e, t) { for (var n = this.tryEntries.length - 1; n >= 0; --n) { var a = this.tryEntries[n]; if (a.tryLoc <= this.prev && y.call(a, "finallyLoc") && this.prev < a.finallyLoc) { var i = a; break } } i && ("break" === e || "continue" === e) && i.tryLoc <= t && t <= i.finallyLoc && (i = null); var r = i ? i.completion : {}; return r.type = e, r.arg = t, i ? (this.method = "next", this.next = i.finallyLoc, L) : this.complete(r) }, complete: function (e, t) { if ("throw" === e.type) throw e.arg; return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), L }, finish: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), f(n), L } }, catch: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.tryLoc === e) { var a = n.completion; if ("throw" === a.type) { var i = a.arg; f(n) } return i } } throw new Error("illegal catch attempt") }, delegateYield: function (e, t, n) { return this.delegate = { iterator: h(e), resultName: t, nextLoc: n }, "next" === this.method && (this.arg = m), L } } }(function () { return this }() || Function("return this")()) }, function (e, t, n) { n(210).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "browser-check.component_efe14bb0.css" }, function (e, t) { e.exports = "/dist/static/common/browser-check/browser-check.component.html" }, function (e, t) { e.exports = "/dist/static/common/browser-check/browser-recommend-dialog.html" }, function (e, t, n) { e.exports = "angular-dragdrop", n(214) }, function (e, t) { !function (e, t, n, a) { "use strict"; var i = t.module("ngDragDrop", []).service("ngDragDropService", ["$timeout", "$parse", function (a, r) { this.draggableScope = null, this.droppableScope = null, this.callEventCallback = function (e, t, a, i) { if (t) { var o = function (t) { var a = t.indexOf("(") !== -1 ? t.indexOf("(") : t.length, i = t.lastIndexOf(")") !== -1 ? t.lastIndexOf(")") : t.length, o = t.substring(a + 1, i), s = t.match(/^[^.]+.\s*/)[0].slice(0, -1); return s = e[s] && "function" == typeof e[s].constructor ? s : null, { callback: t.substring(s && s.length + 1 || 0, a), args: n.map(o && o.split(",") || [], function (t) { return [r(t)(e)] }), constructor: s } }(t), s = o.callback, l = o.constructor, c = [a, i].concat(o.args); return (e[s] || e[l][s]).apply(e, c) } }, this.invokeDrop = function (e, n, r, o) { var s, l, c = "", d = "", u = {}, f = {}, p = null, h = {}, g = {}, m = null, v = this.droppableScope, y = this.draggableScope; c = e.ngattr("ng-model"), d = n.ngattr("ng-model"), s = y.$eval(c), l = v.$eval(d), m = n.find("[jqyoui-draggable]:last,[data-jqyoui-draggable]:last"), f = v.$eval(n.attr("jqyoui-droppable") || n.attr("data-jqyoui-droppable")) || [], u = y.$eval(e.attr("jqyoui-draggable") || e.attr("data-jqyoui-draggable")) || [], u.index = this.fixIndex(y, u, s), f.index = this.fixIndex(v, f, l), p = t.isArray(s) ? u.index : null, h = t.isArray(s) ? s[p] : s, u.deepCopy && (h = t.copy(h)), g = t.isArray(l) && f && void 0 !== f.index ? l[f.index] : t.isArray(l) ? {} : l, f.deepCopy && (g = t.copy(g)), u.animate === !0 ? (this.move(e, m.length > 0 ? m : n, null, "fast", f, null), this.move(m.length > 0 && !f.multiple ? m : [], e.parent("[jqyoui-droppable],[data-jqyoui-droppable]"), i.startXY, "fast", f, t.bind(this, function () { a(t.bind(this, function () { e.css({ position: "relative", left: "", top: "" }), m.css({ position: "relative", left: "", top: "", display: "none" === m.css("display") ? "" : m.css("display") }), this.mutateDraggable(y, f, u, c, d, g, e), this.mutateDroppable(v, f, u, d, h, p), this.callEventCallback(v, f.onDrop, r, o) })) }))) : a(t.bind(this, function () { this.mutateDraggable(y, f, u, c, d, g, e), this.mutateDroppable(v, f, u, d, h, p), this.callEventCallback(v, f.onDrop, r, o) })) }, this.move = function (t, n, a, i, r, o) { if (0 === t.length) return o && e.setTimeout(function () { o() }, 300), !1; var s = t.css("z-index"), l = t[r.containment || "offset"](), c = n.css("display"), d = n.hasClass("ng-hide"); null === a && n.length > 0 && (void 0 !== (n.attr("jqyoui-draggable") || n.attr("data-jqyoui-draggable")) && void 0 !== n.ngattr("ng-model") && n.is(":visible") && r && r.multiple ? (a = n[r.containment || "offset"](), r.stack === !1 ? a.left += n.outerWidth(!0) : a.top += n.outerHeight(!0)) : (d && n.removeClass("ng-hide"), a = n.css({ visibility: "hidden", display: "block" })[r.containment || "offset"](), n.css({ visibility: "", display: c }))), t.css({ position: "absolute", "z-index": 9999 }).css(l).animate(a, i, function () { d && n.addClass("ng-hide"), t.css("z-index", s), o && o() }) }, this.mutateDroppable = function (e, n, a, i, o, s) { var l = e.$eval(i); e.dndDragItem = o, t.isArray(l) ? (n && n.index >= 0 ? l[n.index] = o : l.push(o), a && a.placeholder === !0 && (l[l.length - 1].jqyoui_pos = s)) : (r(i + " = dndDragItem")(e), a && a.placeholder === !0 && (l.jqyoui_pos = s)) }, this.mutateDraggable = function (e, n, a, i, o, s, l) { var c = t.equals(s, {}) || !s, d = e.$eval(i); e.dndDropItem = s, a && a.placeholder ? "keep" != a.placeholder && (t.isArray(d) && void 0 !== a.index ? d[a.index] = s : r(i + " = dndDropItem")(e)) : t.isArray(d) ? c ? a && a.placeholder !== !0 && "keep" !== a.placeholder && d.splice(a.index, 1) : d[a.index] = s : (r(i + " = dndDropItem")(e), e.$parent && r(i + " = dndDropItem")(e.$parent)), l.css({ "z-index": "", left: "", top: "" }) }, this.fixIndex = function (e, n, a) { if (n.applyFilter && t.isArray(a) && a.length > 0) { var i = e[n.applyFilter](), r = i[n.index], o = void 0; return a.forEach(function (e, n) { t.equals(e, r) && (o = n) }), o } return n.index } }]).directive("jqyouiDraggable", ["ngDragDropService", function (e) { return { require: "?jqyouiDroppable", restrict: "A", link: function (n, a, r) { var o, s, l, c = function (c, d) { c ? (o = n.$eval(a.attr("jqyoui-draggable") || a.attr("data-jqyoui-draggable")) || {}, s = n.$eval(r.jqyouiOptions) || {}, a.draggable({ disabled: !1 }).draggable(s).draggable({ start: function (a, r) { e.draggableScope = n, l = t.element(s.helper ? r.helper : this).css("z-index"), t.element(s.helper ? r.helper : this).css("z-index", 9999), i.startXY = t.element(this)[o.containment || "offset"](), e.callEventCallback(n, o.onStart, a, r) }, stop: function (a, i) { t.element(s.helper ? i.helper : this).css("z-index", l), e.callEventCallback(n, o.onStop, a, i) }, drag: function (t, a) { e.callEventCallback(n, o.onDrag, t, a) } })) : a.draggable({ disabled: !0 }) }; n.$watch(function () { return n.$eval(r.drag) }, c), c(), a.on("$destroy", function () { a.draggable({ disabled: !0 }).draggable("destroy") }) } } }]).directive("jqyouiDroppable", ["ngDragDropService", "$q", function (e, n) { return { restrict: "A", priority: 1, link: function (a, i, r) { var o, s = function (s, l) { s ? (o = a.$eval(t.element(i).attr("jqyoui-droppable") || t.element(i).attr("data-jqyoui-droppable")) || {}, i.droppable({ disabled: !1 }).droppable(a.$eval(r.jqyouiOptions) || {}).droppable({ over: function (t, n) { e.callEventCallback(a, o.onOver, t, n) }, out: function (t, n) { e.callEventCallback(a, o.onOut, t, n) }, drop: function (i, s) { var l = null; l = o.beforeDrop ? e.callEventCallback(a, o.beforeDrop, i, s) : function () { var e = n.defer(); return e.resolve(), e.promise }(), l.then(t.bind(this, function () { t.element(s.draggable).ngattr("ng-model") && r.ngModel ? (e.droppableScope = a, e.invokeDrop(t.element(s.draggable), t.element(this), i, s)) : e.callEventCallback(a, o.onDrop, i, s) }), function () { s.draggable.css({ left: "", top: "" }) }) } })) : i.droppable({ disabled: !0 }) }; a.$watch(function () { return a.$eval(r.drop) }, s), s(), i.on("$destroy", function () { i.droppable({ disabled: !0 }).droppable("destroy") }) } } }]); t.element.prototype.ngattr = function (e, n) { var a = t.element(this).get(0); return a.getAttribute(e) || a.getAttribute("data-" + e) } }(window, window.angular, window.jQuery) }, function (e, t, n) { n(216).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "common-core_d7364533.css" }, function (e, t, n) {
  "use strict"; !function () {
    angular.module("BC.enumOrder", []).controller("enumOrderCtrl", ["$scope", "commonService", "errHint", "alphaOrderType", "$rootScope", function (e, t, n, a, i) {
      function r(e) { return "source" === e ? "template" : "filter_template" } function o(t, n, a) {
        var i; "x" === t && (i = n[t][m], n.sort = { type: "custom", fid: a, axis: "x", uniq_id: i.uniq_id }), n.is_advanced_sort = 0,
          n.compare_axis && "compare_axis" === t && (i = n[t][m], n.compare_axis.forEach(function (e) { e.fid === a && (e.compare_sort ? e.compare_sort.type = "custom" : e.compare_sort = { type: "custom", fid: a, axis: "compare_axis", uniq_id: i.uniq_id }) })), e.onSaveEnumOrder(a)
      } function s() { var t; return e.ngDialogData.items.forEach(function (n) { n.uniq_id === e.ngDialogData.uniqId && (t = n) }), t } function l() { var t = r(v); return { range: e.viewData[t].range, total: e.viewData[t].total } } function c(e) { var t = angular.extend({}, e); return 2 == e.type && (t.type = "ascending" == e.alpha_order_type ? 2 : 3, delete t.alpha_order_type), t } function d(e) { var t = angular.extend({}, e); return t.alpha_order_type = 3 == e.type ? "descending" : "ascending", t.type = 3 == e.type ? 2 : e.type, t } function u(t) { e.originOrder = t, g && (t.type = 4), e.viewData = d(t), e.viewData.displayTemplate = l() } var f = e.ngDialogData.fid, p = (e.ngDialogData.uniq_id, e.ngDialogData.tb_id), h = e.ngDialogData.ct_id, g = e.ngDialogData.isCustomOrder, m = e.ngDialogData.fieldIndex || 0, v = e.ngDialogData.source, y = e.ngDialogData.orderModule, _ = e.ngDialogData.drillLevel, b = e.ngDialogData.meta, w = b.chart_type, C = m; "C200" === w && "compare_axis" === v && b.compare_axis.forEach(function (e, t) { "virtual" === e.data_type && t < m && C-- }); var S = { template: null, filter_template: null }; e.alpha_order_types = a, e.sortEnumField = { start: function () { }, stop: function () { var t = e.viewData, n = r(v); S[n] = t.displayTemplate.range } }, e.incOnePos = function (t) { var n = e.viewData.template; if (t > 0) { var a = n[t]; n[t] = n[t - 1], n[t - 1] = a } }, e.descOnePos = function (t) { var n = e.viewData.template; if (t < n.length - 1) { var a = n[t]; n[t] = n[t + 1], n[t + 1] = a } }, e.save = function (a, r) { var l = c(e.viewData); if ("source" !== v) { if ("advanced_sort" === y) { s().sort_items.filter_sort_list = l.displayTemplate.range, e.closeThisDialog() } else { b[v][m].filter_sort_list = l.displayTemplate.range; var d = b[r][m]; i.setOperateRecord("chart.op.sort.custom", [d.name]), o(r, b, a) } return !1 } var u = { config_list: [] }, f = { tb_id: p, fid: a, type: l.type, query_for_ct: 1, template: l.displayTemplate.range }; 4 != l.type && delete f.template, u.config_list.push(f), u.config_list = angular.toJson(u.config_list), t.enumField.updateOrder(u).then(function (t) { var i = t; 0 == i.status ? (o(r, b, a), e.closeThisDialog()) : n(i.errstr, { dialog: !0 }) }) }, function (n, a, i, r, o) { if ("source" !== v && "advanced_sort" === y) { var l = s(); if (l.sort_items.filter_sort_list && l.sort_items.filter_sort_list.length > 0) { var c = angular.copy(l.sort_items.filter_sort_list); return u({ filter_template: { range: c, total: c.length } }), void (e.loading = !1) } } e.loading = !0; var d = "source" === v ? "getOrderInfo" : "getFilteredOrderInfo", f = { tb_id: n, fid: a, ct_id: "source" !== v ? h : "", query_for_ct: 1 }; "source" !== v && (f.index = C || 0, f.drill_level = o || 0, f.axis = v), t.enumField[d](f).then(function (t) { e.loading = !1, t && u(t) }, function () { e.loading = !1 }) }(p, f, 0, 0, _)
    }])
  }()
}, function (e, t, n) { n(219).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "enum_order_bcd76b00.css" }, function (e, t, n) { n(221).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "markpoint_3c16d0fd.css" }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.advanceSort", []).directive("advanceSort", ["$rootScope", "ngDialog", "setAdvanceAggregatorName", "$jsTipTranslate", "$timeout", "$translate", "commonService", "formula", "errHint", function (e, t, a, r, o, s, l, c, d) { return { scope: { chartOptions: "=", chartMeta: "=", drillLevel: "=", bdpChartObj: "=", chartMode: "@", saveChartFun: "&" }, restrict: "EA", templateUrl: "/static/chart-edit/advance-sort/advance-sort.html", transclude: !0, link: function (u, f, p, h) { function g(e) { var t = []; return e.map(function (e) { if ("y" === e.axis) { var n = angular.copy(e); n.sort_item_type = 1, t.push(n) } }), t } function m(e, t) { return 0 == e ? "date" === t ? u.tips.date : u.tips.letter : 2 == e ? u.tips.custom : 3 == e ? u.tips.percentage : void 0 } u.setAdvanceAggregatorName = a, u.$on("chart_data_load", function (e, t) { u.advanceSortData.isGraftTb = "graft" == t.info.tb_type, u.canSetAdvancedSort() }); var v = { show: function (e, a, i) { var r = e.tips.rowSummary, o = "zh" == bdpChart.language ? "行总计" : "Row Total", s = e.tips["chart.totalOfMeasures"], l = n(223), c = "edit" == i.chartMode, i = i, d = [], u = i.x, f = i.y, p = i.compare_axis, h = i.y_optional || [], g = i.chart_type, m = this; v.getTbInfo(i).then(function () { if (d = d.concat(v.preHandleData(u, "x", e)), d = d.concat(v.preHandleData(p, "compare_axis", e)), d = d.concat(v.preHandleData(f, "y", e)), d = d.concat(v.preHandleData(h, "y_optional", e)), !c) { var n = []; if (f.forEach(function (e) { if (e.row_setting && !$.isEmptyObject(e.row_setting)) { var t = angular.copy(e.row_setting); t.name += "(" + o + ")", n.push(t) } }), d = d.concat(v.preHandleData(n, "y", e)), i.tb_statistic && angular.isObject(i.tb_statistic.row_setting) && i.tb_statistic.row) { var y = i.tb_statistic.row_setting; y.name = y.nick_name || r, y.axis = "y", y.type = "asc", d.push(y) } } ["C200", "C250", "C310"].indexOf(g) < 0 && i.x.length && "date" !== i.x[0].data_type && i.y.length >= 2 && d.push({ name: s, data_type: "number", axis: "y", type: "asc", fid: "sum", uniq_id: "uniqIdForSum" }), v.initScopeFuns(e, d, a, i, c), m.dia = t.open({ template: l, className: "ngdialog-theme-default table-adv-wrap", scope: e }) }) }, initScopeFuns: function (n, a, i, r, l) { function u() { for (var e = !0, t = {}, a = 0, i = n.sortRuleInfo.length; a < i; a++)if ((t = n.sortRuleInfo[a].sort_items) && 4 == t.sort_item_type) { if (!t.aggregator_sort.fid) { d(s.instant("a0dad2c3")), e = !1; break } if (!t.aggregator_sort.aggregator) { d(s.instant("59aedb6d")), e = !1; break } } return e } var f = this, p = n.bdpChartObj, h = r.advanced_sort = r.advanced_sort || []; n.formulaList = _.slice(c, 0, 4), v.initData(n, h, a, r, l), n.addAdvSortField = function (e) { var t = angular.copy(n.fieldListInfo.splice(e, 1)[0]); n.sortRuleInfo.push(t) }, n.addAllAdvSortFields = function () { n.fieldListInfo = [], a.forEach(function (e) { var t = !1; n.sortRuleInfo.forEach(function (n) { n.uniq_id === e.uniq_id && (t = !0) }), t || n.sortRuleInfo.push(angular.copy(e)) }) }, n.clearAllRuleFields = function () { n.fieldListInfo = angular.copy(a), n.sortRuleInfo = [] }, n.deleteRuleField = function (e) { var t = n.sortRuleInfo.splice(e, 1); n.fieldListInfo.push(t[0]) }, n.tableAdvSortOk = function () { u() && (l ? (r.advanced_sort.length ? n.sortRuleInfo.length ? e.setOperateRecord("chart.op.advSort.edit") : e.setOperateRecord("chart.op.advSort.remove") : n.sortRuleInfo.length && e.setOperateRecord("chart.op.advSort.add"), r.advanced_sort = angular.copy(n.sortRuleInfo), r.is_advanced_sort = 0 == r.advanced_sort.length ? 0 : 1, i({ closeDialog: !0, is_advanced_sort: r.advanced_sort.length > 0 ? 1 : 0 })) : (n.chartOptions.optional.advanced_sort = angular.toJson(n.sortRuleInfo), n.chartOptions.optional.is_advanced_sort = n.sortRuleInfo.length > 0 ? 1 : 0, f.dia.close())) }, n.cancelsetAdvSort = function () { n.clearAllRuleFields(), f.dia.close() }, n.sortRuleFields = { items: ".J-sortable-adv-sort", start: function () { }, update: function (e, t) { }, stop: function (e, t) { var a = t.item.sortable.index, i = t.item.sortable.dropindex, r = n.sortRuleInfo[i], o = n.sortRuleInfo[a]; n.sortRuleInfo[a] = o, n.sortRuleInfo[i] = r } }, n.showDropdown = function (e, t) { t.showDropdown = !t.showDropdown; var a = e.currentTarget.getBoundingClientRect(), i = a.bottom, r = a.left; n.sortItemDropdownStyle = { top: i, left: r } }, n.changeSortItem = function (e, t, n) { var a = e.sort_items; a.sort_item_type = t, 0 == t || 3 == t ? (e.type = "asc", a.selectedName = m(t, e.data_type), delete a.filter_sort_list, delete a.aggregator_sort) : 1 == t ? (e.type = "asc", e.parent_uniq_id = n.parent_uniq_id, a.selectedName = n.name, a.aggregator_sort = { uniq_id: n.uniq_id, parent_uniq_id: n.parent_uniq_id }, delete a.filter_sort_list) : 2 == t ? (e.type = "custom", a.selectedName = m(t), a.filter_sort_list = [], delete a.aggregator_sort) : 4 == t && (e.type = "asc", a.selectedName = s.instant("9c4d5b9f"), a.aggregator_sort || (a.aggregator_sort = {})) }, n.changeTbInfoSchema = function (e, t) { var a = e.sort_items, i = _.find(n.tbInfo.schema, { fid: t }); a.aggregator_sort.schame_name = i.name, a.aggregator_sort.schame_data_type = i.data_type }, n.changeTbInfoSchemaFormula = function (e, t) { e.sort_items.aggregator_sort.formula_name = _.find(n.formulaList, { type: t }).name }, n.showEnumOrderInAdv = function (e) { var a, i, o = n.$parent, s = o.view; "chart_edit" == s ? (a = o.tb_id, i = o.ct_id) : "dashboard" == s ? (a = r.tb_id, i = r.ct_id) : "custom_chart_edit" == s && (a = o.currentView.tb_id, i = o.currentView.ct_id), t.open({ template: "/static/chart-edit/enum-order/enum-order.html", data: { fid: e.fid, tb_id: a, ct_id: i, isCustomOrder: !0, source: e.axis, fieldIndex: e.originIndex, drillLevel: n.drillLevel || 0, orderModule: "advanced_sort", uniqId: e.uniq_id, items: n.sortRuleInfo, meta: r }, scope: n, controller: "enumOrderCtrl", className: "ngdialog-theme-default enum-order-dialog" }) }, p && p.off("dashboard_click_sort").on("dashboard_click_sort", function () { o(function () { r.is_advanced_sort = 0 }) }) }, initData: function (e, t, n, a, i) { var r = a.chart_type || a.type; if (e.metricFields = g(n), "C200" !== r && a.x.length && "date" === a.x[0].data_type) for (var o = n.length - 1; o >= 0; o--) { var l = n[o]; "y" === l.axis && n.splice(o, 1) } if (t.length < 1) e.sortRuleInfo = [], e.fieldListInfo = angular.copy(n) || []; else { for (var c = [], o = 0, d = n.length; o < d; o++) { for (var l = n[o], u = l.fid, f = l.uniq_id, p = !1, h = l.axis, v = 0, y = t.length; v < y; v++) { var _ = t[v], b = _.fid, w = _.uniq_id, C = _.axis, S = _.type; if (h == C && (f && w === f || !f && b === u)) { p = !0, l.type = S, _.name = l.name, _.data_type = l.data_type, _.originIndex = l.originIndex, void 0 === _.sort_items && ("x" === C || "compare_axis" === C ? _.sort_items = { sort_item_type: 0 } : "y" === C && (_.sort_items = { sort_item_type: 1, aggregator_sort: { uniq_id: _.uniq_id } })); break } } p || c.push(l) } e.fieldListInfo = angular.copy(c), e.sortRuleInfo = angular.copy(t), e.sortRuleInfo.map(function (t) { if ("y" !== t.axis) { var n = t.sort_items.sort_item_type; if (0 == n) t.sort_items.selectedName = m(n, t.data_type); else if (1 == n) { var a = t.sort_items.aggregator_sort.uniq_id; "uniqIdForSum" === a ? t.sort_items.selectedName = e.tips["chart.totalOfMeasures"] : e.metricFields.forEach(function (e) { e.uniq_id === a && (t.sort_items.selectedName = e.name) }) } else 2 == n ? t.sort_items.selectedName = m(n, t.data_type) : 4 == n && (t.sort_items.selectedName = s.instant("9c4d5b9f")) } }) } }, preHandleData: function (e, t, n) { var a = [], i = []; if ($.isArray(e)) for (var r = 0, o = e.length; r < o; r++) { var s = e[r], l = "x" === t || "compare_axis" === t ? s.name : s.name + n.setAdvanceAggregatorName(s), c = s.nick_name || l, d = { data_type: s.data_type, fid: s.fid, axis: "y_optional" == t ? "y" : t, name: c, originName: l, originIndex: r, parent_uniq_id: s.parent_uniq_id, type: "asc" }; "compare_axis" === t && "virtual" === s.data_type || "date" === s.data_type && "C200" !== n.chartMeta.chart_type || ("x" === t || "compare_axis" === t ? d.sort_items = { sort_item_type: 0, selectedName: m(0, s.data_type) } : "y" === t && (d.sort_items = { sort_item_type: 1, aggregator_sort: { uniq_id: s.uniq_id, parent_uniq_id: s.parent_uniq_id } }), s.uniq_id ? (d.uniq_id = s.uniq_id, $.inArray(s.uniq_id, a) == -1 && (a.push(s.uniq_id), i.push(d))) : i.push(d)) } return i }, getTbInfo: function (e) { var t, n = u.$parent, a = n.view; "chart_edit" == a ? t = n.tb_id : "dashboard" == a || "data_screen_edit" === a || "data_screen" === a ? t = e.tb_id : "custom_chart_edit" == a && (t = n.currentView.tb_id); var i = { tb_id: t, query_for_ct: 1, need_param: 1 }; return l.field.getList(i).then(function (e) { "0" == e.status && (u.tbInfo = e.result) }) } }; u.showTableAdvSort = function (e) { $.isEmptyObject(e.advanced_sort) && (e.advanced_sort = []), "edit" !== u.chartMode && (e.chart_type = e.chart_type || e.type), e.chartMode = u.chartMode, v.show(u, u.saveChartFun, e), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "adv_sort", ct_id: e.ct_id }) }) }, u.canSetAdvancedSort = function () { u.advanceSortData.canSetAdvancedSort = u.chartMeta && !u.advanceSortData.isGraftTb && bdpChart.helper.canSetAdvancedSort(u.chartMeta, u.chartMeta.chart_type || u.chartMeta.type) }, function () { u.advanceSortData = {} }(), r(["date", "letter", "custom", "percentage", "rowSummary", "chart.totalOfMeasures"], u) } } }]) }, function (e, t) { e.exports = "/dist/static/chart-edit/advance-sort/advance-sort-config.html" }, function (e, t, n) { n(225).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "table-adv-sort_175710d4.css" }, function (e, t, n) { "use strict"; !function () { function e(e, t, n, a, i, r) { function o(t) { if (!e.warnConfigData.pageStatus.isPreview && "filter" == e.warnConfigData.pageStatus.subView) return !1; e.warnConfigData.pageStatus.isPreview = t ? "show" == t : !e.warnConfigData.pageStatus.isPreview, e.warnConfigData.pageStatus.isPreview ? angular.element(".J-chart-warning-dialog").addClass("preview-mode") : angular.element(".J-chart-warning-dialog").removeClass("preview-mode") } function s(t, n) { e.warnConfigData.editWarnInfo = null; var a = ""; switch (t) { case "list": a = r.instant("warn.warningSetting"); break; case "add": a = r.instant("warn.addWarn"); break; case "edit": a = r.instant("warn.editWarn"), e.warnConfigData.editWarnInfo = n; break; default: a = r.instant("warn.warningSetting") }e.warnConfigData.pageStatus.title = a, e.warnConfigData.pageStatus.view = t; var o = angular.element(".J-chart-warning-dialog"); "list" == t ? o.removeClass("edit-mode") : o.length ? o.addClass("edit-mode") : i(function () { angular.element(".J-chart-warning-dialog").addClass("edit-mode") }, 200) } function l() { var t = e.warnConfigData.chartBaseInfo.isDash; if (t) t && (e.$emit("refreshChartForWarn", !0), a.closeAll()); else { if (!$(".drill-crumbs").length) { if ([bdpChart.ChartType.Table, bdpChart.ChartType.BubbleMap, bdpChart.ChartType.AreaMap, bdpChart.ChartType.TextMap].indexOf(e.$bdpChart.getChartType()) > -1); else { var n = e.$bdpChart.info, i = e.warnConfigData.warnList; n.warn_info = i } !function () { e.saveChartImmediate({ only_refresh_data: !0 }) }() } a.closeAll() } } function c() { var a = e.warnConfigData.chartBaseInfo, i = e.warnConfigData.warnList || [], o = n.getSwitchWarnTask(i); if (i.length > 0) { var s = { ct_id: a.ct_id, open_warn_ids: angular.toJson(o.open), off_warn_ids: angular.toJson(o.off), rule_id: a.rule_id }; e.warnConfigData.pageStatus.loading = !0, n.switchWarnTaskAPI(s).then(function (n) { e.warnConfigData.pageStatus.loading = !1, n && (t(r.instant("chart.saveSuccess")), l()) }) } else l() } function d() { e.warnConfigData.chartBaseInfo.isDash ? l() : (e.draw_chart_url && (e.draw_chart_url.options._t = (new Date).getTime(), e.draw_chart_url.options.optional = {}), a.closeAll()), a.closeAll() } function u() { e.$broadcast("broadcastWarnConfigSave", !0) } function f() { e.warnConfigData.pageStatus.onlyEdit ? a.closeAll() : (o("hide"), s("list", {})) } e.init = function () { function t() { e.warnConfigData = { pageStatus: { loading: !1, title: r.instant("warn.warningSetting"), view: h ? "edit" : "list", subView: "condition", isPreview: !1, onlyEdit: !!h, ctTbPermission: g }, chartBaseInfo: a, metaFields: l, chartTbFields: p, warnList: i }, e.warnConfigFunc = { togglePreview: o, changeView: s, configSave: c, configCancel: d, editSave: u, editCancel: f }, h && s("edit", h) } var a = e.ngDialogData.chartBaseInfo, i = e.ngDialogData.warnList, l = e.ngDialogData.metaFields, p = e.ngDialogData.chartTbFields, h = e.ngDialogData.onlyEditTask, g = !0; e.warnConfigData = { pageStatus: { loading: !1 } }, a.isDash && 0 == p.length || a.isWarnCenter ? (e.warnConfigData.pageStatus.loading = !0, n.getChartTbFieldList(a.tb_id).then(function (n) { e.warnConfigData.pageStatus.loading = !1, n.canEdit ? p = n.canEdit ? n.list : l : (p = l, g = !1), t() })) : t() }, e.init(), e.$on("emitWarnChangeView", function (t, n) { if (n) { var i = n.view; if ("list" == i && ("add" == e.warnConfigData.pageStatus.view ? e.warnConfigData.warnList.push(n.data) : e.warnConfigData.warnList.forEach(function (e) { e.warn_id == n.data.warn_id && (n.data.is_trigger = 0, $.extend(e, n.data)) })), e.warnConfigData.pageStatus.onlyEdit) return a.closeAll(), !1; o("hide"), s(i, {}) } }), e.$on("emitWarnChangeSubView", function (t, n) { n && (e.warnConfigData.pageStatus.subView = n.view) }) } angular.module("BC.chartWarning", []).controller("chartWarnConfigCtrl", e), e.$inject = ["$scope", "errHint", "chartWarnService", "ngDialog", "$timeout", "$translate"] }() }, function (e, t, n) { "use strict"; !function () { angular.module("BC.chartWarning").constant("defaultWarnSettingTime", { weekend: 0, no_repeat: 0, warn_time: "00:00", warn_date: [], warn_time_for_month: "", warn_time_for_week: "" }).constant("defaultWarnFilter", { fid: "", fidUniqId: "", opt: "", val: "", string: { range: [], val: "" }, num: { type: "", fid: "", val: "", valRange: [], field: {}, formula: { type: "", name: "" } }, comment: "" }).constant("defaultWarnCondition", { logic: "and", latestDate: {}, filters: [{ fid: "", fidUniqId: "", opt: "", val: "", string: { range: [], val: "" }, num: { type: "", fid: "", val: "", valRange: [], field: {}, formula: { type: "", name: "" } }, comment: "" }] }).constant("defaultWarnInfo", { warn_name: "", warn_condition_list: [], warn_time_type: "0", warn_time_setting: { weekend: 0, no_repeat: 0, warn_time: "00:00", warn_date: [], warn_time_for_month: "", warn_time_for_week: "" }, type: 0, switch: 1 }) }() }, function (e, t, n) { "use strict"; angular.module("BC.chartWarning").service("chartWarnService", ["commonService", "setAdvanceAggregatorName", "ngDialog", "$translate", "$q", "$filter", function (e, t, a, i, r, o) { function s(e, t, i, r, o, s) { a.open({ template: n(229), className: "ngdialog-theme-default ngDialog-width-640 chart-warning-dialog J-chart-warning-dialog", scope: e, disableAnimation: !0, data: { chartBaseInfo: t, warnList: i, metaFields: r, chartTbFields: o, onlyEditTask: s }, controller: "chartWarnConfigCtrl" }) } function l(e, t) { var n = {}; return t.some(function (t) { if (t.fidUniqId == e) return n = t, !0 }), n } function c(t, n, a) { var i = r.defer(), o = { fid: t, ct_id: n, tb_id: a }; return e.field.getRange(o).then(function (e) { 0 == e.status ? (e = e.result, i.resolve(e)) : i.reject(!0) }), i.promise } function d(t) { var n = { tb_id: t, query_for_ct: 1, need_param: 1 }; return e.field.getList(n).then(function (e) { var t = []; return 0 == e.status && (e = e.result, t = bdp.utils.addSpecParamsToFields(e.schema || [])), { list: t, canEdit: e.can_edit } }) } function u(e, t) { return { name: t, fid: e.fid, uniq_id: e.uniq_id, fidUniqId: e.fid + (e.uniq_id || ""), data_type: e.data_type, field_type: "number", axisType: "y", is_build_aggregated: e.is_build_aggregated } } function f(e) { var n = angular.copy(e), a = n.x || []; if (_.map(a, function (e) { e.axisType = "x" }), n.compare_axis) { _.map(n.compare_axis, function (e) { e.axisType = "compare" }); var i = _.filter(n.compare_axis, function (e) { return "virtual" != e.data_type && "date" != e.data_type }); a = a.concat(i || []) } angular.forEach(a, function (e) { e.fidUniqId = e.fid + (e.uniq_id || ""), e.field_type = e.data_type, e.name = e.nick_name || e.name, "sub_date" == e.data_type && (e.field_type = "string"), "date" == e.data_type && (e.originName = e.name, e.name += "(" + o("granularity")(e.granularity) + ")") }); var r = n.y || []; "C250" == n.chart_type && (r = r.concat(n.y_optional || [])), "C280" == n.chart_type && (r = r.concat(n.y_scatter || [])); var s = [], l = ""; return angular.forEach(r, function (e) { if ("row_summary" != e.fid) if (e.nick_name) l = e.nick_name, s.push(u(e, l)); else { l = e.name; var n = t(e); n ? s.push(u(e, l + n)) : s.push(u(e, l)) } }), a = a.concat(s) } function p(e) { var t = [], n = []; return _(e).filter({ switch: 1 }).forEach(function (e) { t.push({ warn_id: e.warn_id, type: e.type }) }), _(e).filter({ switch: 0 }).forEach(function (e) { n.push({ warn_id: e.warn_id, type: e.type }) }), { open: t, off: n } } function h(e) { var t = ""; return e.meta.forEach(function (e) { e.options.forEach(function (n, a) { var i = "and" == e.logic ? " 且 " : " 或 "; t += a == e.options.length - 1 ? n.comment : n.comment + i }) }), t } function g(e, t, n, a, i) { !n || n.warn_time_setting instanceof Object || (n.warn_time_setting = JSON.parse(n.warn_time_setting)), !n || n.meta instanceof Object || (n.meta = JSON.parse(n.meta)); var r = $.extend({}, e, n); if (!n) return r = $.extend({}, e, {}); var r = $.extend({}, e, n), o = n.warn_time_setting; switch (r.warn_time_type = String(r.warn_time_type), r.warn_time_setting.weekend = !(1 != o.weekend), r.warn_time_setting.no_repeat = !(1 != o.no_repeat), r.warn_time_type) { case "3": r.warn_time_setting.warn_time_for_week = r.warn_time_setting.warn_date; break; case "4": r.warn_time_setting.warn_time_for_month = r.warn_time_setting.warn_date }return r.meta.forEach(function (e) { var n = { tmpId: bdp.utils.guid(), comment: "", filters: [], logic: "", latestDate: {} }, o = "", s = ""; n.logic = e.logic, e.latest_date && "" != e.latest_date && (n.latestDate = $.extend({ checked: !0 }, e.latest_date), s = e.latest_date.comment + " "), e.options.forEach(function (r, s) { var l = $.extend({}, angular.copy(t), { fid: r.fid, fidUniqId: r.fid + r.uniq_id, opt: r.compare_type, comment: r.comment }); a.forEach(function (e) { e.fid != r.fid || e.uniq_id && e.uniq_id != r.uniq_id || (l.field = angular.copy(e)) }); var c = l.opt, d = l.field.field_type, u = r.range || [], f = r.compare_value; switch (d) { case "string": l.string.val = c == -1 ? u : u.join(";"); break; case "number": !f && u && u.length && (12 != c ? l.num.val = u[0] : l.num.valRange = u || [], l.num.type = "0"), f && !$.isEmptyObject(f) && (l.num.fid = f.fid, l.num.field = {}, l.num.type = "1", l.num.formula = { type: f.aggregator || "", name: f.aggregator_name || "" }, "PERCENT" == f.aggregator && (l.num.formula.type = "MED"), l.num.field = w(f.fid, i), l.num.showName = b(l.num)) }n.filters.push(l); var p = "and" == n.logic ? " 且 " : " 或 "; o += s == e.options.length - 1 ? l.comment : l.comment + p }), n.latestDate && (n.comment += n.latestDate.comment), n.comment = s + "当 " + o + " 时触发预警", r.warn_condition_list.push(n) }), r } function m(e, t) { var n = { fid: e.fid, uniq_id: e.field.uniq_id, data_type: e.field.data_type, compare_type: Number(e.opt), comment: e.comment, type: "condition" }, a = e.opt, i = e.field.field_type, r = null; switch (i) { case "string": var o = e.string; r = null, a == -1 ? (r = o.val, n.type = "exact") : [8, 9].indexOf(a) < 0 && (r = o.val.indexOf(";") >= 0 ? o.val.split(";") : o.val.split("；")), n.range = r; break; case "number": var s = e.num; switch (r = null, s.type) { case "0": n.range = 12 != a ? [s.val] : s.valRange || []; break; case "1": n.compare_value = { data_type: s.field.data_type, fid_name: s.field.name, alias_name: s.showName, uniq_id: t, fid: s.field.fid, is_build_aggregated: s.field.is_build_aggregated, aggregator: s.formula.type || "", aggregator_name: s.formula.name || "" }, "MED" == s.formula.type && (n.compare_value.aggregator = "PERCENT", n.compare_value.percent = "0.5") } }return n } function v(e) { var t = e.warn_time_type, n = e.warn_time_setting, a = e.warn_condition_list; switch (n.weekend = n.weekend ? 1 : 0, n.no_repeat = n.no_repeat ? 1 : 0, t) { case "1": n.warn_time = "-1"; break; case "3": n.warn_date = n.warn_time_for_week; break; case "4": n.warn_date = n.warn_time_for_month }var i = n.warn_time || "", r = i.split(":"); return r.length >= 2 && (n.warn_time = r[0] + ":" + r[1]), e.meta = [], a.forEach(function (t) { var n = [], a = +new Date; t.filters.forEach(function (e, t) { var i = m(e, a + t); n.push(i) }); var i = t.logic || "and"; 1 == t.filters.length && (i = "and"); var r = t.latestDate, o = r && r.checked ? { fid: r.fid, uniq_id: r.uniq_id, comment: r.comment } : ""; e.meta.push({ options: n, logic: i, latest_date: o }) }), e } function y(e, t) { var n = "", a = e.filters, r = e.latestDate; return r && r.checked && (r.comment = "(" + (r.originName || r.name) + " 为最新日期)", n += r.comment), n += " 当 ", a.forEach(function (r, o) { var s = r.field, l = r.field.field_type, c = r.opt, d = t[l], u = _.filter(d, { value: c })[0] || {}, f = (s.nick_name || s.name) + " "; switch (l) { case "string": if (c == -1) f += "为 " + r.string.val.join("、"); else if ([8, 9].indexOf(c) >= 0) f += i.instant("f90f1930"); else { var p = ""; p = r.string.val.indexOf(";") >= 0 ? r.string.val.split(";") : r.string.val.split("；"), f += u.name + " " + p.join("、") } break; case "number": if (f += u.name + " ", [8, 9].indexOf(c) >= 0) break; "0" == r.num.type ? f += 12 == c ? "为 " + r.num.valRange[0] + "~" + r.num.valRange[1] : r.num.val : "1" == r.num.type && (f += r.num.showName) }r.comment = f; var h = "and" == e.logic ? " 且 " : " 或 "; n += o == a.length - 1 ? f : f + h }), n += " 时触发预警" } function b(e) { var t = ""; return e.fid && (t += e.field.name, e.formula && e.formula.type && (t += "(" + e.formula.name + ")")), t } function w(e, t) { var n = null; return _.forEach(t, function (t) { t.fid == e && (n = t) }), n } function C(e) { var t = angular.copy(e); return delete t.warn_id, delete t.id, delete t.triggerInfo, delete t.warn_condition_list, delete t.warn_time_setting.warn_time_for_month, delete t.warn_time_setting.warn_time_for_week, t } function S(e, t) { "base" == t && (e.val = "", e.string.val = "", e.num = { type: "0", fid: "", val: "", valRange: [], formula: "" }) } function k(e, t) { _.map(e, function (e) { e.selected = t || !1 }) } function x(e) { for (var t = !0, n = "", a = this, i = {}, r = 0, o = e.length; r < o && (i = function (e) { var t = e.opt, n = !0, i = ""; if (e.fid || (n = !1, i = a.errStrObj.field), "" === e.opt && (n = !1, i = a.errStrObj.opt), !n) return { flag: n, errStr: i }; switch (e.field.field_type) { case "string": t != -1 || e.string.val && 0 != e.string.val.length ? [-1, 8, 9].indexOf(t) < 0 && !e.string.val && (n = !1, i = a.errStrObj.value) : (n = !1, i = a.errStrObj.value); break; case "number": if ([8, 9].indexOf(t) >= 0) break; "" === e.num.type ? (n = !1, i = a.errStrObj.opt) : "0" == e.num.type ? (12 == t || void 0 != e.num.val && null != e.num.val && "" !== e.num.val || (n = !1, i = a.errStrObj.value), 12 == t && (void 0 == e.num.valRange[0] || null == e.num.valRange[0] || "" === e.num.valRange[0] || void 0 == e.num.valRange[1] || null == e.num.valRange[1] || "" === e.num.valRange[1] ? (n = !1, i = a.errStrObj.valueRange) : e.num.valRange[0] >= e.num.valRange[1] && (n = !1, i = a.errStrObj.compare))) : "1" == e.num.type && (e.num.fid ? e.num.field.isAggr || "" !== e.num.formula || (n = !1, i = a.errStrObj.formula) : (n = !1, i = a.errStrObj.field)) }return { flag: n, errStr: i } }(e[r]), t = i.flag, n = i.errStr, t); r++); return { flag: t, errStr: n } } function D(e, t) { var n = !1, a = _.filter(t || [], { warn_name: e.warn_name, type: e.type }); return a.length > 1 ? n = !0 : 1 == a.length && a[0].warn_id != e.warn_id && (n = !0), n } function T(e, t) { var n = !0, a = "", i = this, r = e.warn_name, o = e.warn_time_type, s = e.warn_time_setting; if (!r) return { flag: !1, errStr: i.errStrObj.name }; if (D(e, t)) return { flag: !1, errStr: i.errStrObj.repeat }; if (["2", "3", "4"].indexOf(o) >= 0) if (s.warn_time && s.warn_time.indexOf(":") >= 0) { var l = s.warn_time.split(":")[0], c = s.warn_time.split(":")[1]; (l >= "24" || c >= "60") && (n = !1, a = i.errStrObj.hour) } else n = !1, a = i.errStrObj.hour; switch (o) { case "3": 0 == s.warn_time_for_week.length && (n = !1, a = i.errStrObj.week); break; case "4": 0 == s.warn_time_for_month.length && (n = !1, a = i.errStrObj.month) }return 0 == e.warn_condition_list.length && (n = !1, a = i.errStrObj.condition), { flag: n, errStr: a } } function E(t) { return e.warn.warnSwitch(t).then(function (e) { return 0 == Number(e.status) && (e.result || !0) }) } function L(t) { return e.warn.del(t).then(function (e) { return 0 == Number(e.status) }) } function A(e, t) { return t && angular.forEach(e, function (e) { e.selected = !!t.warn[e.val], "sound" == e.id && (e.option.voiceType = t.sound_type) }), e } function I(t) { return e.user.modifyInfo(t).then(function (e) { return 0 == Number(e.status) }) } this.fieldRangeMapCache = { obj: {}, getCache: function (e) { var t = this.obj[e] || []; return angular.copy(t) }, setCache: function (e, t) { this.obj[e] = t }, clearCache: function () { this.obj = null } }, this.openWarnConfigDialog = s, this.getFieldInfoByFidUniqId = l, this.getFieldRange = c, this.getChartTbFieldList = d, this.getYAxisBaseInfo = u, this.getMetaAxisFields = f, this.getWarnCommentText = h, this.getSwitchWarnTask = p, this.formatRequestData = g, this.formatSaveData = v, this.formatConditionComment = y, this.formatNumMatchShowName = b, this.clearWarnInfo = C, this.resetFilterVal = S, this.resetSelectedStatus = k, this.checkWarnFilterValid = x, this.checkWarnInfoValid = T, this.switchWarnTaskAPI = E, this.delWarnTaskAPI = L, this.formatWarnModeData = A, this.saveWarnModeAPI = I, this.errStrObj = { name: i.instant("warn.inputWarnName"), repeat: i.instant("warn.repeatWarnName"), field: i.instant("a0dad2c3"), opt: i.instant("540b7cea"), value: i.instant("5248b357"), valueRange: i.instant("0d57e5d5"), week: i.instant("ffe39ba4"), month: i.instant("8c4f4e50"), hour: i.instant("321b97da"), predict: i.instant("732ce8ef"), config: i.instant("17f060d8"), condition: i.instant("8e7b5821"), formula: i.instant("1d66362e"), compare: i.instant("a3a1e8c2") } }]) }, function (e, t) { e.exports = "/dist/static/chart-edit/chart-warning/view/chart-warn-config-dialog.html" }, function (e, t, n) { "use strict"; !function () { function e(e, t, a, i, r, o) { return { restrict: "A", templateUrl: n(231), replace: !1, scope: { chartBaseInfo: "=", warnList: "=", warnConfigData: "=", changeViewFunc: "&" }, link: function (e, t, n) { function s() { var t = e.warnTaskListData.taskLimit; if (e.warnTaskListData.list.length >= t) return r(e.warnTaskListData.tips.maxLimit + t + e.warnTaskListData.tips.taskLimit), !1; e.warnTaskListData.changeViewFunc({ view: "add", data: {} }) } function l(t) { e.warnTaskListData.changeViewFunc({ view: "edit", data: t }) } function c(t, n) { i.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: e, data: { title: a.instant("tips"), message: a.instant("0ce31b56") } }).then(function () { var i = { ct_id: e.warnTaskListData.chartBaseInfo.ct_id, rule_id: e.warnTaskListData.chartBaseInfo.rule_id, warn_id: n.warn_id }; e.warnTaskListData.pageLoading = !0, o.delWarnTaskAPI(i).then(function (n) { e.warnTaskListData.pageLoading = !1, n && (r(a.instant("chart.warnDelSuccess")), e.warnTaskListData.list.splice(t, 1)) }) }) } function d(e) { e.switch = e.switch ? 0 : 1 } e.initView = function () { var t = e.warnList, n = e.warnConfigData, i = e.changeViewFunc, r = e.chartBaseInfo; e.warnTaskListData = { taskLimit: 50, tips: { maxLimit: a.instant("9b83abfc"), taskLimit: a.instant("4bf3a740") }, chartBaseInfo: r, pageLoading: !1, list: t, configData: n, addTask: s, editTask: l, delTask: c, switchTask: d, changeViewFunc: i } }, e.initView() } } } angular.module("BC.chartWarning").directive("chartWarnTaskList", e), e.$inject = ["$rootScope", "$timeout", "$translate", "ngDialog", "errHint", "chartWarnService"] }() }, function (e, t) { e.exports = "/dist/static/chart-edit/chart-warning/view/chart-warn-task-list.html" }, function (e, t, n) {
  "use strict"; !function () {
    function e(e, t, a, i, r, o, s, l, c, d, u, f, p, h, g, m, v) {
      return {
        restrict: "A", templateUrl: n(233), replace: !1, scope: { pageStatus: "=", chartBaseInfo: "=", warnInfo: "=", warnList: "=", fieldList: "=", tbFields: "=", togglePreviewFunc: "&" }, link: function (e, t, n) {
          function y(t) { var n = e.warnTaskEditData.warnInfo.warn_condition_list; if (n.length >= z) return r(e.warnTaskEditData.tips.maxLimit + z + e.warnTaskEditData.tips.conditionLimit), !1; var i = angular.copy(P); i.latestDate = $.extend({ checked: !1 }, e.warnTaskEditData.xFirstDate), i.tmpId = bdp.utils.guid(), i.name = a.instant("b3ba0609") + (n.length + 1), e.warnTaskEditData.curCondition = i, e.warnTaskEditData.subView = "filter", e.warnTaskEditData.conditionSubView = "add", C() } function b(t, n) { if (t && t.stopPropagation(), $(".J-chart-warn-task-edit-wrap").find(".bdp-chart-loading").length) return r(a.instant("d4b97284")), !1; o.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: e, data: { title: a.instant("tips"), message: a.instant("52b87262") } }).then(function () { e.warnTaskEditData.warnInfo.warn_condition_list.splice(n, 1), e.warnTaskEditData.pageStatus.isPreview && e.$broadcast("broadcastReloadUpdateReview", !0) }) } function w(t, n, i) { t && t.stopPropagation(), e.warnTaskEditData.conditionSubView = "edit", e.warnTaskEditData.subView = "filter", e.warnTaskEditData.curCondition = angular.copy(i); var r = e.warnTaskEditData.curCondition; r.name = a.instant("b3ba0609") + (n + 1), r.logic = r.logic || "and", r.latestDate = $.extend(r.latestDate || { checked: !1 }, e.warnTaskEditData.xFirstDate), C() } function C() { e.$emit("emitWarnChangeSubView", { view: e.warnTaskEditData.subView }), e.warnTaskEditData.pageStatus.onlyEdit || e.$emit("emitWarnChangeView", { view: e.warnTaskEditData.pageStatus.view }) } function S(t, n) { t && t.stopPropagation(); var a = e.warnTaskEditData.curCondition; if (a.filters.length >= j) return r(e.warnTaskEditData.tips.maxLimit + j + e.warnTaskEditData.tips.filterLimit), !1; _.filter(a.filters, function (e) { e.showFieldList = !1, e.showFormulaList = !1 }), a.filters.push(angular.copy(R)); var i = $(t.target).parents(".J-warn-filter-list"); scrollToBottom(i) } function k(t, n) { if (t && t.stopPropagation(), e.warnTaskEditData.curCondition.filters.length < 2) return !1; o.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: e, data: { title: a.instant("tips"), message: a.instant("52b87262") } }).then(function () { e.warnTaskEditData.curCondition.filters.splice(n, 1) }) } function x(t) { var n = e.warnTaskEditData.conditionSubView, a = e.warnTaskEditData.curCondition, i = e.warnTaskEditData.warnInfo, o = l.checkWarnFilterValid(a.filters); if (!o.flag) return r(o.errStr), !1; a.comment = l.formatConditionComment(a, e.warnTaskEditData.operatorList), "add" == n ? i.warn_condition_list.push({ tmpId: a.tmpId, comment: a.comment, filters: a.filters, logic: a.logic, latestDate: a.latestDate }) : i.warn_condition_list.forEach(function (e) { e.tmpId == a.tmpId && (e.comment = a.comment, e.filters = a.filters, e.logic = a.logic, e.latestDate = a.latestDate) }), l.formatSaveData(i), e.warnTaskEditData.subView = "condition", e.$emit("emitWarnChangeSubView", { view: e.warnTaskEditData.subView }) } function D(t) { e.warnTaskEditData.subView = "condition", e.$emit("emitWarnChangeSubView", { view: e.warnTaskEditData.subView }) } function T(t) { var n = e.warnTaskEditData.pageStatus.ctTbPermission, a = e.warnTaskEditData.fieldListForFilter, i = l.getFieldInfoByFidUniqId(t.fidUniqId, a); if (t.field && t.field.fidUniqId == t.fidUniqId) return !1; switch (t.fid = i.fid, t.field = i, i.field_type) { case "string": t.opt = n ? -1 : 0, t.string.range = []; break; case "number": t.opt = 0; break; default: t.opt = "" }l.resetFilterVal(t, "base") } function E(e) { l.resetFilterVal(e, "base"), "number" == e.field.field_type && "" === e.num.type && (e.num.type = "0") } function L(t) {
            function n(e) { var t = { range: [], total: e.total }; return e.range.forEach(function (e) { t.range.push({ _multi_list_id_: e, _multi_list_text_: e }) }), t } var a = l.fieldRangeMapCache.getCache(t.fid); if (a && 0 != a.length) {
              var i = s.defer()
              ; return i.resolve(n(a)), i.promise
            } var r = e.warnTaskEditData.chartBaseInfo; return l.getFieldRange(t.fid, r.ct_id, r.tb_id).then(function (e) { return l.fieldRangeMapCache.setCache(t.fid, e), n(e) })
          } function A(t) { t.showFieldList = !t.showFieldList, t.showFormulaList = !1, e.warnTaskEditData.numSubView = "field" } function I(t, n) { var a = !1; 1 === n.is_build_aggregated && (a = "date" != n.data_type || !n.formula || !(n.formula.indexOf("MAX_DATE") >= 0 || n.formula.indexOf("max_date") >= 0 || n.formula.indexOf("MIN_DATE") >= 0 || n.formula.indexOf("min_date") >= 0)), n.isAggr = a, t.num.fid = n.fid, t.num.field = n, t.num.formula = "", a ? (t.showFieldList = !1, t.showFormulaList = !1) : (t.showFormulaList = !0, e.warnTaskEditData.numSubView = "formula"), t.num.showName = l.formatNumMatchShowName(t.num) } function O(e, t) { e.num.formula = { name: t.name, type: t.type }, e.num.showName = l.formatNumMatchShowName(e.num), e.showFieldList = !1, e.showFormulaList = !1 } function F() { e.warnTaskEditData.warnInfo.warn_time_setting = angular.copy(N), l.resetSelectedStatus(e.warnTaskEditData.dayOfWeekList), l.resetSelectedStatus(e.warnTaskEditData.dateOfMonthList) } function M() { function t(t) { f.warn_id = t || d, e.$emit("emitWarnChangeView", { view: "list", data: f }) } var n = e.warnTaskEditData.pageStatus, o = e.warnTaskEditData.warnList, s = e.warnTaskEditData.warnInfo, c = e.warnTaskEditData.chartBaseInfo, d = "add" == n.view ? "" : e.warnTaskEditData.warnInfo.warn_id; s = angular.copy(s); var u = l.checkWarnInfoValid(s, o); if (!u.flag) return r(u.errStr), !1; s.type = c.role_type; var c = e.warnTaskEditData.chartBaseInfo, f = l.formatSaveData(s); f = l.clearWarnInfo(f); var p = { ct_id: e.warnTaskEditData.chartBaseInfo.ct_id || "", rule_id: e.warnTaskEditData.chartBaseInfo.rule_id || "", data: f }; e.warnTaskEditData.pageLoading = !0, "add" == n.view ? i.warn.add(p).then(function (n) { e.warnTaskEditData.pageLoading = !1, 0 == Number(n.status) && (r(a.instant("chart.warnAddSuccess")), t(n.result)) }) : "edit" == n.view && (p.warn_id = d, i.warn.modify(p).then(function (e) { 0 == Number(e.status) && (r(a.instant("chart.warnModifySuccess")), t()) })) } var N = angular.copy(h), R = angular.copy(g), P = angular.copy(m), B = angular.copy(v), j = 50, z = 50; e.dateTimeByHalfHour = p, e.init = function () { var n = e.pageStatus.ctTbPermission, i = angular.copy(c); n && (i.string = [{ value: -1, name: a.instant("exactly") }].concat(i.string)); var r = angular.copy(u); r.map(function (e) { e._multi_list_id_ = e.value, e._multi_list_text_ = e.name }); var o = angular.copy(f); o.map(function (e) { e._multi_list_id_ = e.value, e._multi_list_text_ = e.name }); var s = null, p = e.fieldList, h = [];["C271", "C272", "C273"].indexOf(e.chartBaseInfo.chart_type) >= 0 ? h = _.filter(p, function (e) { if ("x" != e.axisType && "compare" != e.axisType) return !0 }) : _.map(p, function (e) { "x" == e.axisType && "date" == e.data_type ? s || (s = e) : h.push(e) }), e.warnTaskEditData = { dayOfWeekList: r, dateOfMonthList: o, formulaList: d, operatorList: i, tips: { conditionTitle: [a.instant("c66063dc"), a.instant("2ec8e26e"), a.instant("40c353c3"), a.instant("dbde7d1f")], placeHolder: [a.instant("afebb9eb"), a.instant("35c137f7")], maxLimit: a.instant("9b83abfc"), conditionLimit: a.instant("a8f8c7b8"), filterLimit: a.instant("0285425d") }, viewMode: e.viewMode, subView: "condition", pageLoading: !1, pageStatus: e.pageStatus, numSubView: "field", conditionSubView: "", chartBaseInfo: e.chartBaseInfo, warnList: e.warnList, fieldList: p, fieldListForFilter: h, tbFields: e.tbFields, warnInfo: null, curCondition: null, xFirstDate: s }, e.warnTaskEditFunc = { addCondition: y, delCondition: b, editCondition: w, addFilter: S, delFilter: k, saveFilter: x, cancelFilter: D, changeFilterField: T, changeFilterOpt: E, getFieldRange: L, toggleNumMatchLayer: A, chooseNumField: I, chooseNumFormula: O, changeWarnType: F, togglePreviewFunc: e.togglePreviewFunc }, e.warnTaskEditData.warnInfo = l.formatRequestData(B, g, e.warnInfo, e.fieldList, e.tbFields), e.warnTaskEditData.warnInfo.warn_condition_list.length || $(t).find(".J-warn-name-input").focus() }, e.init(), e.$on("broadcastWarnConfigSave", function (e, t) { t && M() })
        }
      }
    } angular.module("BC.chartWarning").directive("chartWarnTaskEdit", e), e.$inject = ["$rootScope", "$timeout", "$translate", "commonService", "errHint", "ngDialog", "$q", "chartWarnService", "warnOperatorMapByType", "warnFieldFormulaList", "dayOfWeekList", "dateOfMonthList", "dateTimeByHalfHour", "defaultWarnSettingTime", "defaultWarnFilter", "defaultWarnCondition", "defaultWarnInfo"]
  }()
}, function (e, t) { e.exports = "/dist/static/chart-edit/chart-warning/view/chart-warn-task-edit.html" }, function (e, t, n) { "use strict"; !function () { function e(e, t, a, i, r) { return { restrict: "A", templateUrl: n(235), replace: !1, link: function (n, o, s) { function l(e) { i.chart.getInfo(e).success(function (e) { "0" == e.status ? c(e.result) : errorHandle(e) }) } function c(e) { var t = e, a = { name: t.name || void 0, description: t.description, tb_id: t.tb_id || "", meta: { level_fields: [], level: [], filter_list: [], filter_list_inner: [] } }; n.chart_ops = a, a.meta = $.extend(!0, {}, a.meta, angular.fromJson(t.meta)); var i = a.meta.level[n.drill_level]; n.viewMeta = i, d(n.previewData.ct_id) } function d(t) { var i = angular.copy(r), o = n.$parent.warnTaskEditData.warnInfo; o = angular.copy(o), o ? (!o || o.warn_time_setting instanceof Object || (o.warn_time_setting = JSON.parse(o.warn_time_setting)), o.meta = o.meta || "[]", !o || o.meta instanceof Object || (o.meta = JSON.parse(o.meta))) : o = $.extend({}, i, {}); var s = a.formatSaveData(o); n.previewData.draw_chart_url = { options: { theme: 1 == +e.usedThemeId ? "dark" : "default", ct_id: t, optional: { _t: +new Date, read_cache: !1, warn_filter: s.meta }, isWarnPreview: !0 }, lazyload: !1 } } n.initView = function () { var e = n.$parent.chartBaseInfo.ct_id; n.global = {}, n.chart_ops = {}, n.previewData = { ct_id: e }, t(function () { l(e) }, 400) }, n.initView(), n.$on("broadcastReloadUpdateReview", function (e, t) { t && d(n.$parent.chartBaseInfo.ct_id) }) } } } angular.module("BC.chartWarning").directive("chartWarnDataPreview", e), e.$inject = ["$rootScope", "$timeout", "chartWarnService", "commonService", "defaultWarnInfo"] }() }, function (e, t) { e.exports = "/dist/static/chart-edit/chart-warning/view/chart-warn-data-preview.html" }, function (e, t, n) { n(237).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "chart-warn_06567f47.css" }, function (e, t, n) { n(239).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "index_f8b9ef65.css" }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(241); angular.module("BC.setDateValue", []).directive("setDateValue", ["ngDialog", "$filter", "dateTimeByHalfHour", "$timeout", function (e, t, n, i) { return new a.setDateValueDirective(e, t, n, i) }]) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function e(e, t, n, a) { var i = this; this.ngDialog = e, this.$filter = t, this.dateTimeByHalfHour = n, this.$timeout = a, this.innerHourChange = !1, this.restrict = "E", this.scope = { date: "=", dateType: "=", dateVerify: "=", setDateBack: "&", defaultVal: "=?" }, this.templateUrl = "/static/common/set-date-value/set-date-value.html", this.link = function (e, t, n) { var a = i; a.init = function () { e.dateVm = { value: "", dateVal: e.date ? e.date.replace(/.{9}$/, "") : "", hour: e.date ? e.date.replace(/^.{11}/, "") : "", unlimited: !1, dateTimeByHalfHour: i.dateTimeByHalfHour, showStartTime: !1, unlimitedShow: "false" == n.unlimitedShow, verifydate: !0, verifytime: !0, position: n.position, mode: n.mode, setDate: !1 }, a.initDatePickerPos() }, a.initDatePickerPos = function () { n.datePickerPosition && "top" == n.datePickerPosition && $(t).find(".date-picker").css({ bottom: 32 }) }, a.init(), e.dateVm.change = function () { var t = e.dateVm; t.disable = t.unlimited, t.unlimited ? e.date = null : e.date = $.trim(e.dateVm.dateVal + " " + e.dateVm.hour), e.setDateBack() }, e.dateVm.timeChange = function () { e.dateVm.disable || (e.dateVm.showStartTime = !e.dateVm.showStartTime) }, e.$watch("date", function (t) { t ? (t.length <= 10 ? (e.dateVm.dateVal = t, e.dateVm.hour = "00:00:00") : (e.dateVm.dateVal = t.replace(/.{9}$/, ""), e.dateVm.hour = t.replace(/^.{11}/, "") || "00:00:00"), e.dateVm.disable = e.dateVm.unlimited = !1) : null === t && (e.dateVm.disable = e.dateVm.unlimited = !0, e.defaultVal && (e.dateVm.dateVal = e.defaultVal.replace(/.{9}$/, ""), e.dateVm.hour = e.defaultVal.replace(/^.{11}/, "") || "00:00:00")) }), e.dateVm.selectDate = function (t) { var n = e.dateVm; n.unlimited || (n.showStartPicker = !n.showStartPicker, n.showStartPicker ? i.$timeout(function () { if (n.showStartPicker && "fixed" == e.dateVm.position) { var a = $(t.currentTarget).parent().find(".date-picker"), i = $(t.currentTarget).offset(); a.css({ position: "fixed", left: i.left - 315 + 72 + "px", top: i.top + 25 + "px", width: "321px", "z-index": 1e3 }), "edit" == e.dateVm.mode && $(".J-chart-right").css({ "z-index": 9999 }) } else "edit" == e.dateVm.mode && $(".J-chart-right").css({ "z-index": 101 }); r() }, 10) : o()) }, e.$on("setDate", function (t, n) { t.stopPropagation(), i.$timeout(function () { e.dateVm.dateVal = i.formatDate(n), e.date = $.trim(e.dateVm.dateVal + " " + e.dateVm.hour), e.dateVm.verifydate = !0, e.dateVerify = e.dateVm.verifydate && e.dateVm.verifytime, e.dateVm.setDate = !0, e.setDateBack() }, 0) }), i.formatDate = function (e) { return i.$filter("date")(e, "yyyy-MM-dd") }, e.selectTime = function (t) { e.dateVm.hour = t.value, e.dateVm.verifytime = !0, e.dateVm.showStartTime = !1, e.dateVerify = e.dateVm.verifydate && e.dateVm.verifytime, e.date = $.trim(e.dateVm.dateVal + " " + e.dateVm.hour), e.setDateBack() }, e.checkInputDateKeyup = function (t, n) { var i = ""; i = "date" == n ? $.trim(e.dateVm.dateVal) : $.trim(e.dateVm.hour), "date" === n && 10 === i.length ? (e.dateVm["verify" + n] = "" == i || a.reg.isDate(i), e.dateVm.verifydate && e.checkInputDate()) : "time" === n && 8 === i.length && (e.dateVm["verify" + n] = "" == i || a.reg.isTime(i), e.dateVm.verifytime && e.checkInputDate()) }, e.checkInputDate = function (t, n) { i.$timeout(function () { var t = ""; if (e.dateVm.setDate || e.dateVm.timeList) return e.dateVm.setDate = !1, void (e.dateVm.timeList = !1); t = "date" == n ? $.trim(e.dateVm.dateVal) : $.trim(e.dateVm.hour), "date" === n ? e.dateVm["verify" + n] = "" == t || a.reg.isDate(t) : "time" === n && (e.dateVm["verify" + n] = "" == t || a.reg.isTime(t)), e.dateVm.verifydate && e.dateVm.verifytime ? (e.dateVerify = !0, e.date = $.trim(e.dateVm.dateVal + " " + e.dateVm.hour), e.setDateBack()) : e.dateVerify = !1 }, 10) }; var r = function () { angular.element(document).off("click.datepicker" + e.$id).on("click.datepicker" + e.$id, function (t) { var n = angular.element(t.target), i = n.parents(".trigger-datepicker").length > 0; n.hasClass("datepicker-" + e.$id) || i || (a.$timeout(function () { e.dateVm.showStartPicker = !1, "edit" == e.dateVm.mode && $(".J-chart-right").css({ "z-index": 101 }) }), o()) }) }, o = function () { angular.element(document).off("click.datepicker" + e.$id) }; e.$on("$destroy", function () { angular.element(document).off("click.datepicker" + e.$id) }) }, this.ngDialog = e, this.$filter = t, this.$timeout = a, this.reg = { isDate: function (e) { return /^\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[1-2]\d|3[0-1])$/.test(e) }, isTime: function (e) { return /^(((0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9])|(00:00:00))$/.test(e) } } } return e }(); t.setDateValueDirective = a }, function (e, t, n) { n(243).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "index_80491320.css" }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(245), i = n(204); angular.module("BC.chartArgsUse", []).service("chartArgsService", ["$http", "$q", "commonHttp", "ngDialog", "$translate", function (e, t, n, a, r) { return new i.chartArgsService(e, t, n, a, r) }]).directive("chartArgsUse", ["chartArgsService", "errHint", "$timeout", "$translate", "$rootScope", function (e, t, n, i, r) { return new a.chartArgsUseDirective(e, t, n, i, r) }]) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function e(e, t, n, a, i) { var r = this; this.chartArgsService = e, this.errHint = t, this.$timeout = n, this.$translate = a, this.$rootScope = i, this.restrict = "A", this.scope = { chartOptions: "=", chartMode: "@", argViewMeta: "=", argSave: "=" }, this.template = '\n        <div class="pr">\n        <div class="chart-arg-wrap row" ng-repeat="param in argList track by $index" ng-if="param.show" flash-guide="chartArgsEditInnerGuide" fg-show="guideApi.chartArgsEditInnerGuide && $index == 0 && chartMode == \'edit\'">\n            <span class="label-head nowrap">{{param.name}}</span>\n            <div class="display-inline-block" ng-if="param.type === \'number\'">\n                <input type="number" ng-model="param.value" ng-keyup="enterKeyDown($event,param)" ng-blur="enterBlur(param)"/> <span ng-if="param.config.number_type == \'percent\'">%</span>\n            </div>\n            <div class="display-inline-block" ng-if="param.type === \'string\'">\n                <div class="vt" \n                    select-search-list \n                    search-list="argInfoMap[param.param_id]" \n                    select-data="param.value" \n                    need-async="true"\n                    position="relative"\n                    select-click="getParamValues(param.param_id)"\n                    val-change="modifyInnerArg(param)" \n                    show-list-loading="showListLoading"\n                    mode-type="paramType"></div>\n            </div>\n            <div class="display-inline-block" ng-if="param.type === \'date\'">\n                <set-date-value date="param.value" class="display-inline-block" date-verify="dateVerify" mode="{{chartMode}}" position="{{chartMode == \'edit\' ? \'fixed\' : \'\'}}" unlimited-show="false" date-type="param.config.date_type" set-date-back="toSaveArg(param)"></set-date-value>\n            </div>\n            <a class="cursor-pointer pr">\n                <i class="bdp-icon ico-info-sign" ng-mouseover="displayDetail($event, param, true)" ng-mouseleave="displayDetail($event, param, false)"></i>\n            </a>\n        </div>\n        </div>\n    ', this.link = function (e, t, n) { var a = function (e, t) { if (13 == e.keyCode) { if (t.originValue == t.value) return; l(t) } }, i = function (e) { e.originValue != e.value && l(e) }, o = function (e) { if ("date" == e.type || "number" == e.type && "percent" != e.config.number_type) { var t = e.config.range || []; if ("" != t[0] && e.value < t[0]) return r.errHint("参数值需在最大值最小值之间"), !1; if ("" != t[1] && e.value > t[1]) return r.errHint("参数值需在最大值最小值之间"), !1 } else if ("number" == e.type && "percent" == e.config.number_type) { var t = e.config.range || []; if ("" != t[0] && e.value < 100 * t[0]) return r.errHint("参数值需在最大值最小值之间"), !1; if ("" != t[1] && e.value > 100 * t[1]) return r.errHint("参数值需在最大值最小值之间"), !1 } return !0 }, s = function () { var t = angular.copy(e.argList), n = []; return t.forEach(function (e) { "string" != e.type && "number" == e.type && "percent" == e.config.number_type && (e.value = Number(e.value), e.value = e.value.div(100)); var t = { name: e.name, param_id: e.param_id, value: e.value, display: e.display, type: e.type, is_current: e.is_current, comment: e.comment, default_value: e.default_value }; "number" == e.type && (t.config = { range: e.config.range, number_type: e.config.number_type }), "date" == e.type && (t.config = { range: e.config.range, date_type: e.config.date_type }), n.push(t) }), n }, l = function (t) { if (o(t)) { var n = s(); "edit" === e.chartMode ? (e.argViewMeta.param_setting = n, r.$rootScope.setOperateRecord("chart.op.config.set", [r.$translate.instant("param.chartConfigParam") + "-" + t.name]), console.log("编辑页保存了参数"), e.argSave()) : "dashboard" === e.chartMode ? (e.chartOptions.optional.param_setting = angular.toJson(n), console.log("仪表盘页保存了参数", e.chartOptions.optional)) : "fullscreen" === e.chartMode && (e.chartOptions.optional.param_setting = angular.toJson(n), console.log("单图全屏页保存了参数", e.chartOptions.optional)), window.BDPLogger.log("para_modify", { category: "user_interact", action: "chart_interact", opt_label: JSON.stringify({ para_type: t.type, page: e.chartMode }) }) } }, c = function (e) { r.$timeout(function () { e.originValue != e.value && l(e) }, 10) }, d = function (e) { var t = []; return e.forEach(function (e) { t.push({ key: e, name: e }) }), t }, u = function (t) { e.argInfoMap[t] || (e.showListLoading = !0, r.chartArgsService.getParamInfo(t).then(function () { e.argInfoMap[t] = d(r.chartArgsService.argInfoMap[t]), e.showListLoading = !1 })) }, f = function (t, n, a) { if (!a) return void $("#paramInfoPopup").remove(); var i = t.currentTarget.getBoundingClientRect(), o = "position:fixed;left:" + (i.left - 260) + "px;top:" + (i.top + 30) + "px;z-index:99999;display:block;"; "edit" != e.chartMode ? o = "position:absolute;top:27px;right:0;z-index:99999;display:block" : $(".J-chart-right").css({ "z-index": 1e3 }); var s = "", l = r.$translate.instant("param.default"); s = "\n                <div id='paramInfoPopup' style=" + o + ' class="body-func-tip func-tip">\n                    <h5>' + n.name + '</h5>\n                    <div class="offset-top clearfix"><span class="key">' + l + '</span><p class="text">' + n.defaultValDisplay + "</p></div>\n                    " + function (e) { var t = "", n = r.$translate.instant("param.commont"), a = r.$translate.instant("param.minVal"), i = r.$translate.instant("param.maxVal"); return e.comment && (t = '<div class="offset-top clearfix"><span class="key">' + n + '</span><p class="text">' + e.comment + "</p></div>"), "string" !== e.type && (t += '\n                        <div class="offset-top clearfix"><span class="key">' + a + '</span><p class="text">' + e.config.minDisplay + '</p></div>\n                        <div class="offset-top clearfix"><span class="key">' + i + '</span><p class="text">' + e.config.maxDisplay + "</p></div>\n                    "), t }(n) + "\n                </div>\n            ", $(t.currentTarget).parent().append(s) }; e.$watch("argViewMeta.param_setting", function (t) { t && t.length > 0 && (e.argList = r.chartArgsService.formatParams(t, e.chartMode)) }, !0), e.argList = [], e.argInfoMap = {}, e.enterKeyDown = a, e.enterBlur = i, e.modifyInnerArg = l, e.toSaveArg = c, e.getParamValues = u, e.displayDetail = f, e.mode = n.mode, e.dateVerify = !0 } } return e }(); t.chartArgsUseDirective = a }, function (e, t, n) { "use strict"; n(247), n(248), n(249), n(251), angular.module("BC.createField", ["BC.addGroupField", "BC.addCalcField"]) }, function (e, t, n) {
  "use strict"; !function () {
    function e(e, t, n, a, i, r, o, s, l, c) {
      function d(e, t) { return "number" == e && "fixed" == t ? 0 : "number" == e && "custom" == t ? 1 : "string" == e && "condition" == t ? 21 : "string" == e && "item" == t ? 22 : "date" == e && "custom" == t ? 3 : "date" == e && "group_year" == t ? 4 : "date" == e && "group_month" == t ? 5 : "date" == e && "group_week" == t ? 6 : "date" == e && "fixed" == t ? 7 : "expression" == t ? 8 : -1 } function u() { var t = k[e.selected.field.fid] || []; t.length > 0 || e.showLoading ? (e.searchList = t, e.searchListAll = t) : e.fieldRangeMap[e.selected.field.fid] || (e.showLoading = !0, a.post("/api/field/item_search", { tb_id: (e.currentView ? e.currentView.tb_id : e.tb_id) || e.ngDialogData.tb_id, field: angular.toJson(e.selected.field), keyword: "" }).then(function (t) { var n = t.result; e.fieldTotalItems = n.total, e.searchList = e.fieldRangeMap[e.selected.field.fid] = n.items, e.searchListAll = e.fieldRangeMap[e.selected.field.fid] = n.items, k[e.selected.field.fid] = n.items, e.showLoading = !1, e.itemEvent.noSearchList() })) } function f(t, n) { var a, r = { default_name: e.defaultGroupName }; if ("expression" === n) a = { type: n, groups: [] }; else if ("number" == t) if ("fixed" == n) { a = { type: n, range: [] }; var o = { fid: e.selected.field.fid, ct_id: e.newField.ct_id, tb_id: e.newField.tb_id, query_for_ct: 1 }; i.field.getRange(o).success(function (e) { 0 == e.status && (a.range[0] = e.result.range[0], a.range[1] = e.result.range[1]) }) } else "custom" == n && (a = { type: n, groups: [] }); else "string" == t ? ("item" === n && u(), a = { type: n, groups: [], default_name: e.defaultGroupName }) : "date" == t && (a = "custom" == n || v(n, "group_") ? { type: n, groups: [] } : { type: n, aggregator: "year", start: [], step: "" }); return a && a.groups && a.groups.push(p(t, n)), angular.extend(r, a) } function p(t, n) { var a = { name: e.newGroupPrefix + 1 }; return "expression" === n ? a.expression = "" : "number" == t && "custom" == n ? (a.range = [], a.boundary = [0, 0]) : "string" == t ? n && "condition" !== n || (a.logic = "AND", a.conditions = [], "condition" === n && (a.conditions = [{ operator: "0", value: "" }])) : "date" == t && (a.range = "group_year" == n ? [1, 1, 1, 1] : "group_month" == n ? [1, 1] : "group_week" == n ? [1, 1] : []), a } function h() { if (e.groupData.info.groups) { for (var t = e.groupData.info.groups, n = 0; n < t.length; n++)if ("" == t[n].name || !t[n].name) return !0; return !1 } } function g() { if (e.groupData.info.groups) { var t, n = e.groupData.info.groups, a = []; for (t = 0; t < n.length; t++)a.push(n[t].name); for (a = a.sort(), t = 0; t < a.length; t++)if (a[t] == a[t + 1]) return !0; return !1 } } function m(e) { return e < 10 ? "0" + e : e + "" } function v(e, t) { return !(null == t || "" == t || 0 == e.length || t.length > e.length) && e.substr(0, t.length) == t } function y(e, t) { var n = { "M+": e.getMonth() + 1, "d+": e.getDate() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (e.getFullYear() + "").substr(4 - RegExp.$1.length))); for (var a in n) new RegExp("(" + a + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? n[a] : ("00" + n[a]).substr(("" + n[a]).length))); return t } function _(t, n) { if ("pickStart" == t) { for (var a in e.pickStart) a != n && (e.pickStart[a] = !1); e.pickStart[n] = !e.pickStart[n], e.pickEnd = {} } if ("pickEnd" == t) { for (var i in e.pickEnd) i != n && (e.pickEnd[i] = !1); e.pickEnd[n] = !e.pickEnd[n], e.pickStart = {} } } var b = e.groupData = angular.copy(e.newField.param) || { type: "group", info: { groups: [] } }; !b.info.default_name && b.info.default && (b.info.default_name = b.info.default, delete b.info.default), "string" === b.data_type && void 0 === b.info.type && (b.info.type = "condition"); var w = "", C = [], S = "create" == e.newField.type; e.LessThen = [{ value: 0, text: "<" }, { value: 1, text: "≤" }], e.selectedlist = !0, e.addmanually = !1, e.select = {}, e.selected = { field: null, dateGroupType: null }, e.fieldRangeMap = {}, e.searchList = [], e.searchListAll = [], e.field_list = e.ngDialogData.fieldList, e.fieldList = e.field_list, e.dateList = { monthList: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], weekDayList: [1, 2, 3, 4, 5, 6, 7], dayList: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31] }, e.dayList1 = e.dateList.dayList, e.dayList2 = e.dateList.dayList; var k = (e.dateList.dayList, {}); e.initGroupInfo = function (t) { e.itemEvent && (e.itemEvent.keyword = ""); var n = e.selected.field.data_type; t = "date" == n ? t || e.selected.dateGroupType && e.selected.dateGroupType.type || "custom" : "string" == n ? t || "condition" : t || "fixed", b.info.type = t; var a = d(n, t); e.select = {}, (S || a != e.groupType) && (e.groupType = a, b.info = f(n, t)), b.info.groups && e.selectGroup(b.info.groups[0], n, t) }, e.$watch("groupData.info.aggregator", function (t) { if ("date" == e.selected.field.data_type && "fixed" == b.info.type) { var n = { fid: e.selected.field.fid, ct_id: e.newField.ct_id, tb_id: e.newField.tb_id, granularity: t, adv_enum_display: 0, query_for_ct: 1 }; i.field.getRange(n).then(function (n) { 0 == n.status && (e.dateRanges = n.result.range, S || w && w != t ? "day" == t ? e.groupData.info.start[1] = e.dateRanges[e.dateRanges.length - 1] : e.groupData.info.start[0] = bdpChart.helper.checkGranularity(t, e.dateRanges[e.dateRanges.length - 1]) : w && w == t && C.length && ("day" == t ? e.groupData.info.start[1] = C[1] : e.groupData.info.start[0] = C[0])) }).finally(function () { e.showLoading = !1 }) } }), e.getAggreName = function () { for (var t = 0; t < e.aggregators.length; t++)if (e.aggregators[t].type == e.groupData.info.aggregator) return "en" == e.lang && e.groupData.info.step > 1 ? e.aggregators[t].name + "s" : e.aggregators[t].name }; var x = []; if (e.checkInvalidNumber = function (t, a) { var i = t.target; angular.element(i).hasClass("ng-invalid-number") ? (x[a] = !0, n(e.tips["field.invalidNumber"])) : x[a] = !1 }, e.operatorMap = { 0: r.instant("equal"), 1: r.instant("contain"), 2: r.instant("notContain") }, e.logicMap = { AND: r.instant("field.meetAll"), OR: r.instant("field.meetAny") }, e.dateGroupTypeList = [{ type: "custom", name: r.instant("field.general") }, { type: "group_year", name: r.instant("field.yearsGroup") }, { type: "group_month", name: r.instant("field.monthsGroup") }, { type: "group_week", name: r.instant("field.weeksGroup") }, { type: "fixed", name: r.instant("field.fixedStep") }, { type: "expression", name: r.instant("chart.dateFilterExpression") }].filter(function (t) { return e.isGraftTb ? $.inArray(t.type, ["custom", "expression"]) > -1 : t }), e.lang = r.instant("lang"), e.aggregators = [{ type: "year", name: r.instant("year") }, { type: "quarter", name: r.instant("quarter") }, { type: "month", name: r.instant("month") }, { type: "week", name: r.instant("week") }, { type: "day", name: r.instant("day") }], e.to = r.instant("field.to"), e.newGroupPrefix = r.instant("field.groupPrefix"), e.itemWithoutGroup = r.instant("field.itemWithoutGroup"), e.defaultGroupName = r.instant("field.defaultGroup"), e.addNewNumberGroup = function (t) { for (var t, a = e.groupData.info.groups, i = 0; i < a.length; i++) { var r = a[i]; if (r.name || (r.name = e.newGroupPrefix + a.length), 0 == r.range.length || void 0 == r.range[0] && void 0 == r.range[1] || x[0] || x[1]) return void n(e.tips["field.mustBeNumber"]); if (r.range[0] > r.range[1]) return void n(e.tips["field.numberRangeErr"]); void 0 == r.range[0] ? r.range[0] = null : void 0 == r.range[1] && (r.range[1] = null) } t = { name: e.newGroupPrefix + (b.info.groups.length + 1), range: [], boundary: [0, 0] }, b.info.groups.push(t), x = [] }, e.addNewStringGroup = function () { if (!function () { var t = !0; return angular.forEach(e.groupData.info.groups, function (e) { e.name || (t = !1) }), t }()) return void n(e.tips["field.nameRequired"]); var t = b.info.type, a = b.info.groups, i = { name: e.newGroupPrefix + (a.length + 1), conditions: [] }; if ("condition" === t) { for (var r = 0; r < a.length; r++)for (var o = a[r].conditions, s = 0; s < o.length; s++) { var l = o[s]; if (!l.value) return void n(e.tips["field.conditionRequired"]) } i.logic = "AND", i.conditions.push({ operator: "0", value: "" }) } else if ("item" === t) for (var r = 0; r < a.length; r++) { var o = a[r].conditions; if (!o.length) return void n(e.tips["field.conditionRequired"]) } a.push(i), e.selectGroup(i, "string", t) }, e.addNewDateGroup = function (t) { var a, i = e.groupData.info.groups; if ("custom" == t) { for (var r = 0; r < i.length; r++) { var o = i[r]; if (o.name || (o.name = e.newGroupPrefix + i.length), 0 == o.range.length || void 0 == o.range[0] && void 0 == o.range[1]) return n(e.tips["field.plzChooseLeastOneOfStart_endDate"]), !1 } a = { name: e.newGroupPrefix + (b.info.groups.length + 1), range: [] } } else if ("group_year" == t) { for (var r = 0; r < i.length; r++) { var o = i[r]; if (o.name || (o.name = e.newGroupPrefix + i.length), o.range[0] > o.range[2] || o.range[0] == o.range[2] && o.range[1] > o.range[3]) return n(e.tips["field.endDateGtStartDate"]), void (o.range = [1, 1, 1, 1]) } a = { name: e.newGroupPrefix + (b.info.groups.length + 1), range: [1, 1, 1, 1] } } else if ("group_month" == t) { for (var r = 0; r < i.length; r++) { var o = i[r]; if (o.name || (o.name = e.newGroupPrefix + i.length), o.range[0] > o.range[1]) return n(e.tips["field.endDateGtStartDate"]), void (o.range = [1, 1]) } a = { name: e.newGroupPrefix + (b.info.groups.length + 1), range: [1, 1] } } else if ("group_week" == t) { for (var r = 0; r < i.length; r++) { var o = i[r]; if (o.name || (o.name = e.newGroupPrefix + i.length), o.range[0] > o.range[1]) return n(e.tips["field.endDateGtStartDate"]), void (o.range = [1, 1]) } a = { name: e.newGroupPrefix + (b.info.groups.length + 1), range: [1, 1] } } b.info.groups.push(a) }, e.addNewExpressionGroup = function () { if ("default" !== e.select.group.type && e.select.group && !e.select.group.expression) return void n(e.tips["filter.checkFailed"]); var t = { name: e.newGroupPrefix + (b.info.groups.length + 1), expression: "" }; b.info.groups.push(t), e.selectGroup(t, e.selected.field.data_type, "expression") }, e.removeGroup = function (t) { var n = e.groupData.info.groups.splice(t, 1); n = n[0], angular.toJson(n) == angular.toJson(e.select.group) && (e.groupData.info.groups.length ? e.selectGroup(e.groupData.info.groups[0], e.groupData.data_type, e.groupData.info.type) : e.selectGroup("default")) }, e.selectGroup = function (t, a, i) { if (e.select.group != t) { if (e.select.group && !e.select.group.name && "default" != e.select.group.type) return void n(e.tips["field.nameRequired"]); if ("default" === t) return e.select.group = {}, e.select.group.name = b.info.default_name, void (e.select.group.type = "default"); e.select.group = t; var r = d(a, i); if (21 == r) e.select.group.conditions || (e.select.group.conditions = [], e.select.group.logic = "AND", e.select.group.conditions.push({ operator: "0", value: "" })); else if (22 == r) u(), e.select.group.conditions || (e.select.group.conditions = []); else if (8 == r) { e.select.group.expression || (e.select.group.expression = ""); var o = new RegExp("\\[_field_id_\\]", "g"); e.select.group.expression = e.select.group.expression.replace(o, "[" + e.selected.field.name + "]"), c(function () { e.$broadcast("changeDateExpression", e.select.group.expression) }) } e.itemEvent.noSearchList(), e.selectgroup = !1, e.selectedlist = !0 } }, e.addCondition = function (t, a) { for (var a, i = t.conditions, r = 0; r < i.length; r++) { if (!i[r].value) return void n(e.tips["field.conditionRequired"]) } a = { operator: "0" }, t.conditions.push(a) }, e.sortGroupField = { start: function () { }, stop: function () { }, items: "li:not(.default-group-name)" }, e.showDefaultGroup = function () { return e.select.group && "default" === e.select.group.type }, e.showConditionList = function () { return e.select.group && !e.showDefaultGroup() }, e.removeCondition = function (e, t) { e.splice(t, 1) }, e.commit = function () { if (o.global.clickComplete = !1, !e.selected.field) return o.global.clickComplete = !0, !1; if (0 == e.newField.name.length) return n(e.tips["field.nameRequired"]), void (o.global.clickComplete = !0); if (e.newField.name.length > 200) return n(e.tips["field.newFieldNameTooLong"]), void (o.global.clickComplete = !0); for (var t = 0; t < e.field_list.length; t++)if (e.field_list[t].name === e.newField.name && e.field_list[t].fid !== e.newField.fid) return n(e.tips["error.fieldRepeat"]), o.global.clickComplete = !0, !1; if (h()) return n(e.tips["field.plzCommitAfterCheckGroupName"]), void (o.global.clickComplete = !0); if (g()) return n(e.tips["field.groupNameRepeated"]), void (o.global.clickComplete = !0); e.groupData.info.default_name || (e.groupData.info.default_name = "zh" == o.language ? "未分组" : "Ungrouped"); var a, i = function () { return a && 0 != a.length ? a : (n(e.tips["field.atLeastOneGroup"]), !1) }; e.groupData.fid = e.selected.field.fid, e.groupData.data_type = e.selected.field.data_type; var r = d(e.groupData.data_type, e.groupData.info.type); angular.copy(e.groupData.info); switch (a = angular.copy(e.groupData.info.groups), r) { case 0: var s = e.groupData.info.range, l = e.groupData.info.step; if (void 0 == s[0] || void 0 == s[1]) return n(e.tips["field.stepStartAndEnd"]), o.global.clickComplete = !0, !1; if (!l) return n(e.tips["field.stepValueInvalid1"]), o.global.clickComplete = !0, !1; if (!/^-?\d+(\.\d{1,5})?$/.test(+l)) return n(e.tips["field.stepValueInvalid2"]), o.global.clickComplete = !0, !1; break; case 1: if (!a || 0 == a.length) return n(e.tips["field.atLeastOneGroup"]), o.global.clickComplete = !0, !1; for (var t = 0; t < a.length; t++) { var c = a[t]; if (0 == c.range.length || void 0 == c.range[0] && void 0 == c.range[1] || x[0] || x[1]) return n(e.tips["field.mustBeNumber"]), void (o.global.clickComplete = !0); if (void 0 != c.range[0] && void 0 != c.range[1] && c.range[0] > c.range[1]) return n(e.tips["field.numberRangeErr"]), void (o.global.clickComplete = !0); void 0 == c.range[0] ? c.range[0] = null : void 0 == c.range[1] && (c.range[1] = null) } break; case 21: case 22: if (!a || 0 == a.length) return n(e.tips["field.atLeastOneGroupItem"]), o.global.clickComplete = !0, !1; for (var u, t = 0, f = a.length; t < f; t++) { if (u = a[t], 0 == u.conditions.length) return n(u.name + " " + e.tips["field.groupConditionRequired"]), o.global.clickComplete = !0, !1; if (u.conditions.length > 1e3) return n(u.name + " " + e.tips["filter.groupItemOver1000"]), o.global.clickComplete = !0, !1 } if (21 === r) for (var t = 0, f = a.length; t < f; t++)for (var p = a[t].conditions, v = 0; v < p.length; v++) { var c = p[v]; if (!c.value) return n(e.tips["field.conditionRequired"]), void (o.global.clickComplete = !0) } break; case 3: for (var t = 0; t < a.length; t++) { var c = a[t]; if (0 == c.range.length || void 0 == c.range[0] && void 0 == c.range[1]) return n(e.tips["field.plzChooseLeastOneOfStart_endDate"]), o.global.clickComplete = !0, !1; if (void 0 != c.range[0] && void 0 != c.range[1] && c.range[0] > c.range[1]) return n(e.tips["field.endDateGtStartDate"]), void (o.global.clickComplete = !0); void 0 == c.range[0] ? c.range[0] = null : c.range[0] = y(new Date(c.range[0]), "yyyy-MM-dd"), void 0 == c.range[1] ? c.range[1] = null : c.range[1] = y(new Date(c.range[1]), "yyyy-MM-dd") } break; case 4: a = i(); for (var t = 0; t < a.length; t++)a[t].range[0] = m(a[t].range[0]) + m(a[t].range[1]), a[t].range[1] = m(a[t].range[2]) + m(a[t].range[3]), a[t].range.splice(2, 2); break; case 7: var l = e.groupData.info.step, _ = e.groupData.info.aggregator, b = e.groupData.info.start; if (!l) return n(e.tips["field.stepValueRequired"]), o.global.clickComplete = !0, !1; if (l < 1) return n(e.tips["field.stepValueGtOne"]), o.global.clickComplete = !0, !1; if (!b.length) return n(e.tips["field.plzChooseAStartDate"]), o.global.clickComplete = !0, !1; if ("year" == _ || "quarter" == _ || "month" == _ || "week" == _) { if (!b[0]) return n(e.tips["field.plzChooseAStartDate"]), o.global.clickComplete = !0, !1; b.length > 1 && b.splice(1, 1); var w = b[0].match(/\d+/g); "zh" == e.lang ? angular.extend(b, w) : angular.extend(b, w.reverse()) } else { if (!b[1]) return n(e.tips["field.plzChooseAStartDate"]), o.global.clickComplete = !0, !1; b[0] = y(new Date(b[1]), "yyyy-MM-dd"), b.splice(1, 1) } break; case 8: default: if (!(a = i())) return o.global.clickComplete = !0, !1 }var C = angular.copy(e.groupData); C.info.groups = a; var S = angular.extend(e.newField, { param: C, data_type: "string" }); e.addCalcField(S) }, e.pickStart = {}, e.pickEnd = {}, e.$on("setDate", function (t, n, a) { n && "date" == a && (e.pickStart = {}, e.pickEnd = {}) }), e.fixDatePickerPos = function (t, n, a) {
        _(n, a); var i = { left: t.clientX, top: t.clientY }, r = $(t.target).closest(".J-show-date-picker"); r.length < 1 && $(t.target).hasClass(".J-show-date-picker") && (r = $(t.target)),
          r.length && (i.left = r.offset().left + 32, i.top = r.offset().top + 24), e.datePickerPos = { left: i.left, top: i.top }
      }, e.groupExpression = { setExpression: function (t) { e.groupData.info.groups && e.select.group && (e.select.group.expression = t) }, expressionChanged: function (t, n) { e.expressionChangedFlag = t, e.groupExpression.setExpression(n) }, insertFieldNameToExpression: function (t) { e.expressionChangedFlag = !0, e.$broadcast("insertFieldNameToExpression", t) }, checkFormulaGrammar: function (t, i, r) { "" == t && (t = e.selected.field.name), t = bdp.utils.requote(t); var o = new RegExp("\\[" + t + "\\]", "g"); e.select.group.expression = e.select.group.expression.replace(o, "[_field_id_]"); var s = { tb_id: e.currentView ? e.currentView.tb_id : e.tb_id, fid: i, expression: e.select.group.expression }; return e.expressionChangedFlag = !1, a.post("/api/field/group_expr_verify", s, { errHint: !1 }).then(function (t) { return 0 == t.status ? (n(e.tips["filter.checkSuccess"]), e.checkFormulaGrammarFlag = !0, !0) : (n(e.tips["filter.checkFailed"]), e.checkFormulaGrammarFlag = !1, !1) }) } }, e.itemEvent = { addItem: function (t) { var a = !1, i = $(".add-manually"); return $.inArray(t, e.select.group.conditions) > -1 && (a = !0), a ? void n(e.tips["filter.itemExist"]) : e.select.group.conditions.length >= 1e3 ? (n(e.tips["filter.groupItemOver1000"], { dialog: !0 }), !1) : (e.select.group.conditions.push(t), "" === i.val() ? i.val(i.val() + t) : i.val(i.val() + "\n" + t), void c(function () { var e = $(".add-list").find("ul"), t = e[0].scrollHeight; e.animate({ scrollTop: t }), i.focus() }, 300)) }, delItem: function (t) { e.select.group.conditions.splice(t, 1), e.nosearch_list = [], e.itemEvent.noSearchList() }, addAll: function () { if (e.select.group.conditions.length >= 1e3) return n(e.tips["filter.groupItemOver1000"], { dialog: !0 }), !1; angular.forEach(e.searchList, function (t, n) { e.select.group.conditions.indexOf(t) < 0 && e.select.group.conditions.push(t) }) }, delAll: function () { e.select.group.conditions.length = 0, e.nosearch_list = [] }, search: function (t) { var n = { tb_id: e.currentView ? e.currentView.tb_id : e.tb_id, field: angular.toJson(e.selected.field), rule_id: o.global.rule_id || "", keyword: t }; a.post("/api/field/item_search", n).then(function (t) { 0 == t.status && (e.searchList = t.result.items, e.show = !0) }) }, keyupEvent: function (t, n) { 13 === t.keyCode && e.itemEvent.search(n) }, mouseLeave: function () { e.show = !1 }, itemEdit: function () { e.selectedlist = !1, e.addmanually = !0, e.selectgroup = !0; var t = e.select.group.conditions, n = $(".add-manually"); n.val(""), setTimeout(function () { n.focus() }, 300); var a = n.val(), i = a.split("\n"), r = 0, o = ""; if ("" == a) o += t.join("\n"); else for (var s = 0; s < t.length; s++) { for (var l = 0; l < i.length; l++)i[l] == t[s] && (r = 1); 0 === r && (o += "\n" + t[s]) } n.val(a + o) }, addDone: function () { var t = $(".add-manually").val().split("\n"); e.select.group.conditions; if (e.select.group.conditions = [], angular.forEach(t, function (n, a) { e.select.group.conditions.indexOf(n) < 0 && "" !== t[a] && e.select.group.conditions.push(n) }), !(e.select.group.conditions.length <= 1e3)) return n(e.tips["filter.groupItemOver1000"], { dialog: !0 }), !1; e.itemEvent.noSearchList(), e.selectedlist = !0, e.addmanually = !1 }, noSearchList: function () { if (e.nosearch_list = [], "item" === e.groupData.info.type && e.select.group.conditions.length > 0) { if (e.select.group.conditions.length > 1e3) return n(e.tips["filter.groupItemOver1000"], { dialog: !0 }), !1; a.post("/api/field/item_validate", { tb_id: e.currentView ? e.currentView.tb_id : e.tb_id, field: angular.toJson(e.selected.field), items: angular.toJson(e.select.group.conditions) }).then(function (t) { var n = t.result; "0" == t.status && angular.forEach(e.select.group.conditions, function (t, a) { n[t] || e.nosearch_list.push(a) }) }) } } }, S) { e.selected.field = e.fieldList[0]; var D = e.selected.field.data_type; "date" == D && (e.selected.dateGroupType = e.dateGroupTypeList[0]), "string" === D ? e.initGroupInfo("condition") : e.initGroupInfo("custom") } else { e.groupType = d(b.data_type, b.info.type); for (var T = 0, E = e.fieldList.length; T < E; T++)if (b.fid == e.fieldList[T].fid) { e.selected.field = e.fieldList[T]; break } if ("date" == e.selected.field.data_type) { for (var L = 0; L < e.dateGroupTypeList.length; L++)if (e.dateGroupTypeList[L].type == b.info.type) { e.selected.dateGroupType = e.dateGroupTypeList[L]; break } var A = b.info.groups; if ("fixed" == b.info.type) { var I = b.info.aggregator, O = b.info.start; if (w = angular.copy(I), "day" !== I && "week" != I) { var F = new Date(O[0] + "-01-01 00:00:00"); "quarter" == I ? F.setMonth(3 * O[1] - 1) : "month" == I && F.setMonth(O[1] - 1), O[0] = bdpChart.helper.checkGranularity(I, F.getTime()) } else "week" == I ? "zh" == e.lang ? O[0] = O[0] + "年第" + O[1] + "周" : O[0] = "Week " + O[1] + "-" + O[0] : "day" == I && (O[1] = O[0]); C = angular.copy(O) } else if ("group_year" == b.info.type) for (var T = 0; T < A.length; T++)A[T].range[3] = Number(A[T].range[1].substr(2, 2)), A[T].range[2] = Number(A[T].range[1].substr(0, 2)), A[T].range[1] = Number(A[T].range[0].substr(2, 2)), A[T].range[0] = Number(A[T].range[0].substr(0, 2)); else if ("group_month" == b.info.type) for (var T = 0; T < A.length; T++)A[T].range[0] = Number(A[T].range[0]), A[T].range[1] = Number(A[T].range[1]) } e.initGroupInfo(b.info.type) } s(["field.numberRangeErr", "field.invalidNumber", "field.mustBeNumber", "field.conditionRequired", "field.nameRequired", "field.stepStartAndEnd", "field.stepValueRequired", "field.atLeastOneGroup", "field.atLeastOneGroupItem", "field.groupConditionRequired", "field.newFieldNameTooLong", "field.plzCommitAfterCheckGroupName", "field.groupNameRepeated", "field.stepValueInvalid1", "field.stepValueInvalid2", "field.stepValueGtOne", "field.plzChooseAStartDate", "field.plzChooseLeastOneOfStart_endDate", "field.endDateGtStartDate", "filter.itemExist", "filter.groupItemOver1000", "error.fieldRepeat"], e)
    } angular.module("BC.addGroupField", []).controller("FieldGroupController", e), e.$inject = ["$scope", "$stateParams", "errHint", "commonHttp", "commonService", "$translate", "$rootScope", "$jsTipTranslate", "$filter", "$timeout"]
  }()
}, function (e, t, n) { "use strict"; !function () { angular.module("BC.addCalcField", []).controller("FormulaEditController", ["$rootScope", "$scope", "dataTypeList", "commonHttp", "chartArgsService", function (e, t, n, a, i) { t.func_list = []; t.data = { editor: null }, t.fieldArgsList = { active: 0, argsQuery: "" }, t.typeList = n; var r = t.field_list = t.ngDialogData.fieldList; t.fieldListResult = angular.copy(t.ngDialogData.fieldList), t.fieldListResult = bdp.utils.addSpecParamsToFields(t.fieldListResult), t.fields = []; for (var o = 0, s = r.length; o < s; o++)r[o].name && (t.fields[o] = r[o].name); t.showLoading = !0, a.get("/api/function/list").then(function (e) { if ("0" === e.status) { var n = e.result.classification; t.func_list_result = angular.copy(n[0]), t.func_list = angular.copy(n); var a = {}; angular.forEach(n, function (e, t) { a[t] = [], angular.forEach(n[t], function (e, n) { a[t].push({ usage: e.usage, description: e.desc, example: e.demo, type: e.name }) }) }), "wb" == t.newField.module && (a[1] = [], a[0] = [], a[0] = a[0].concat(a[2]).concat(a[3]).concat(a[4]).concat(a[5]).concat(a[6])), t.func_list_result = angular.copy(a[0]), t.func_list = angular.copy(a), t.showLoading = !1 } }), t.paramListLoaded = "chart_edit" !== e.view, t.argListResult = [], i.list({ tableId: t.ngDialogData.tableId }).then(function (e) { t.argListResult = i.cacheObj.argList, t.paramListLoaded = !0 }), t.switchFieldAndArgs = function (e) { t.fieldArgsList.active = e }, t.isClassify = !0, t.search_formula = function (e) { if (t.isClassify = !1, t.formula_query) { var n = []; angular.forEach(t.func_list[0], function (e) { e.type.indexOf(t.formula_query) >= 0 || e.type.indexOf(t.formula_query.toUpperCase()) >= 0 ? n.push(e) : (e.description.indexOf(t.formula_query) >= 0 || e.description.indexOf(t.formula_query.toUpperCase()) >= 0) && n.push(e) }), t.func_list_result = n } else t.func_list_result = angular.copy(t.func_list[0]); t.$$phase || t.$digest() }, t.formula_query = "en" == $.cookie("locale") ? "All" : "全部", t.show_classify_list = !1, t.inputQuery = function () { t.show_classify_list = !1, t.show_top = !1, angular.element("#function_query").addClass("long") }, t.clearContent = function () { t.isClassify && (t.formula_query = "", t.isClassify = !1) }, t.cancelQuery = function () { angular.element("#function_query").removeClass("long"), "" == t.formula_query && (t.formula_query = "en" == $.cookie("locale") ? "All" : "全部", t.isClassify = !0, t.func_list_result = t.func_list[0]) }, t.showClassify = function (e) { t.show_classify_list = !t.show_classify_list, t.show_top = !t.show_top, t.show_classify_list ? angular.element("#function_query").focus() : angular.element("#function_query").blur() }, t.selectClassifyItem = function (e) { switch (t.isClassify = !0, t.show_classify_list = !1, t.show_top = !1, e) { case 0: t.formula_query = "en" == $.cookie("locale") ? "All" : "全部"; break; case 1: t.formula_query = "en" == $.cookie("locale") ? "Aggregate" : "聚合统计"; break; case 2: t.formula_query = "en" == $.cookie("locale") ? "Not Aggregate" : "非聚合统计"; break; case 3: t.formula_query = "en" == $.cookie("locale") ? "Date and Time" : "日期和时间"; break; case 4: t.formula_query = "en" == $.cookie("locale") ? "String" : "字符串"; break; case 5: t.formula_query = "en" == $.cookie("locale") ? "Logic" : "逻辑"; break; case 6: t.formula_query = "en" == $.cookie("locale") ? "Number" : "数值" }t.func_list_result = t.func_list[e] }, t.cancelSearch = function () { t.show_classify_list = !1, t.show_top = !1, angular.element("#function_query").blur() }, t.search_field = function (e) { if (t.field_query) { var n = []; angular.forEach(t.field_list, function (e) { (e.name.indexOf(t.field_query) >= 0 || e.name.indexOf(t.field_query.toUpperCase()) >= 0) && n.push(e) }), t.fieldListResult = n } else t.fieldListResult = angular.copy(t.field_list); t.fieldListResult = bdp.utils.addSpecParamsToFields(t.fieldListResult), t.$$phase || t.$digest() }, t.add_func_to_formula = function (e) { if (!t.data.editor) return !1; var n = t.data.editor.getCursor(), a = "COUNT_DISTINCT" === e.type ? "COUNT(DISTINCT())" : e.type + "()", i = n.ch + a.length - ("COUNT_DISTINCT" == e.type ? 2 : 1); t.data.editor.replaceSelection(a), t.data.editor.setCursor(n.line, i), t.data.editor.focus() }, t.add_field_to_formula = function (e, n) { if (!t.data.editor) return !1; n ? t.data.editor.replaceSelection("{" + e.name + "}") : t.data.editor.replaceSelection("[" + e.name + "]"), t.data.editor.focus() }, t.$on("getFuncByKeyword", function (e, n) { t.currFunc = n, t.$$phase || t.$digest() }), t.$on("getFuncByArgName", function (e, n) { t.currArg = n, t.$$phase || t.$digest() }) }]).directive("bdpFormula", ["formulaDocument", "$timeout", function (e, t) { return { restrict: "A", scope: { editor: "=", fields: "=", argListResult: "=", newField: "=" }, link: function (n, a, i) { function r(t) { return t = t.toUpperCase(), "WHEN" == t ? t = "CASE_WHEN" : "DISTINCT" == t && (t = "COUNT_DISTINCT"), e[t] } function o(e) { for (var t = {}, a = 0; a < n.argListResult.length; a++)if (e === "{" + n.argListResult[a].name + "}") { t = n.argListResult[a]; break } return t } function s() { n.editor = l = CodeMirror.fromTextArea(a[0], { mode: "text/x-bdp-formula", indentWithTabs: !0, smartIndent: !0, lineWrapping: !0, matchBrackets: !0, theme: "paraiso-light", fields: n.fields, chartArgsList: n.argListResult.map(function (e) { return e.name }), placeholder: i.p ? "" : "SUM([A]) + SUM([B])" }), l.on("change", function () { n.newField.aggregator = l.getValue().replace(/0xa0/, "") }), c = bdp.utils.throttle(function () { for (var e = l.getCursor(), t = e.ch, a = 0, i = t; i > -1;) { var s = l.getTokenAt({ line: e.line, ch: i }); if (!s.string) break; if (null == s.type) for (var c = s.string.length; --c > -1;)")" == s.string.charAt(c) && a++; else if ("keyword" == s.type) { if (0 == a) { var d = s.string; n.$emit("getFuncByKeyword", r(d)); break } a-- } else if ("chart-args" == s.type) { if (0 == a) { n.$emit("getFuncByArgName", o(s.string)); break } a-- } i -= s.string.length } }, 300), l.on("cursorActivity", c) } var l, c; t(function () { bdp.loadbdpFormula(s) }, 0) } } }]).directive("funcTip", [function () { return { restrict: "A", link: function (e, t, n) { var a = n.funcTip ? t.closest(n.funcTip)[0] : t.parent().parent()[0]; t.hover(function () { if (a) { var e = t[0].offsetTop, n = a.scrollTop, i = $(this).find(".func-tip"); i.css({ top: e - n - i.outerHeight() / 2 + 14 }) } }) } } }]) }() }, function (e, t, n) { n(250).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "add-field_ccb4ee24.css" }, function (e, t, n) { n(252).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "field-list_8e004b0b.css" }, function (e, t, n) { n(254).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "chart-config_7e5d7ac2.css" }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); !function () { function e(e) { return { scope: !0, link: function (t, n, a) { n.hover(function (e) { var a = n.find(".chart-info-summary"), r = $(".J-scroll-project").width(), o = e.clientX, s = "-25px"; n.parents(".chart-edit-layer").length > 0 && (s = "-8px"), o - r < 200 ? a.css({ right: "-200px" }) : a.css({ right: s }), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "info", ct_id: t.ct_id || "" }) }) }), t.$on("chart_data_load", function (n, a) { var i = bdpChart.language || "zh", r = a.info; a.data; if (e(function () { "C500" == a.getChartType() ? t.tb_update_time = 1e3 * (Math.max.apply(null, a.views.map(function (e) { return e.info.tb_update_time })) || r.update_time) : t.tb_update_time = 1e3 * r.tb_update_time }), t.width = 50, r.xAxis && (t.xAxis = r.xAxis), r.yAxis) { var o = r.yAxis.concat(r.yAxisOptional || []); if (o.forEach(function (e) { e.row_setting && !$.isEmptyObject(e.row_setting) && o.push(angular.copy(e.row_setting)) }), r.tb_statistic && angular.isObject(r.tb_statistic.row_setting) && r.tb_statistic.row) { var s = r.tb_statistic.row_setting; s.name = s.nick_name || ("zh" == i ? "行总计" : "Row Summary"), o.splice(s.pos, 0, s) } t.yAxis = o, angular.forEach(o, function (e) { var n = hz.cutString.getP(e.nick_name || e.name); n > t.width && (t.width = n) }) } t.width = Math.min(t.width, 96) }) } } } angular.module("BC.chartInfoSummary", []).directive("chartInfoSummary", e), e.$inject = ["$timeout"] }() }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); !function () { angular.module("BC.common").service("logService", [function () { function e(e, t) { a[e] = t || +new Date } function t(e, t) { if (a[e]) { var i = function () { var e = r; e.time = +new Date - o, e.page += "_render", console.log(e), n(e) }, r = t || {}, o = a[e]; r.time = +new Date - o, delete a[e], console.log(r), n(r), window.requestAnimFrame(i) } } function n(e) { BDPLogger.log("ctrl_first_time", { category: "performance", action: "loading", opt_label: (0, i.default)(e) }) } var a = {}; this.speedTimeLog = { start: e, end: t } }]) }() }, function (e, t, n) { "use strict"; !function () { angular.module("BC.common").service("multipleProService", ["commonService", "$q", function (e, t) { function n(e, t) { var n = { projList: [], dashList: [] }; return angular.forEach(e.subs, function (e) { "project" != e.attribute || !t && e.hidden || n.projList.push(e), "dashboard" != e.attribute || !t && e.hidden || n.dashList.push(e) }), n } function a(e, t) { for (var n = t.length - 1; n >= 0; n--) { var i = t[n]; if ("project" === i.attribute && i.proj_id === e) return i; if (i.subs && i.subs.length > 0) { var r = a(e, i.subs); if (r) return i.openType = !0, r } } return null } function i(e, t, n) { for (var a = { mostDeep: t, showDashLen: 0, showProjLen: 0 }, r = 0, o = 0, s = 0; s < e.length; s++) { var l, c = e[s]; c.deep = t, c.styleVal = { "padding-left": 36 * c.deep + "px" }, c.openType = !1, c.parentId = n, c.subs && c.subs.length > 0 && (l = i(c.subs, t + 1, c.proj_id), a.mostDeep = l.mostDeep > a.mostDeep ? l.mostDeep : a.mostDeep, c.showDashLen = l.showDashLen, c.showProjLen = l.showProjLen), "project" == c.attribute && (c.hidden && (a.showProjLen += 1), r += 1), "dashboard" == c.attribute && (c.hidden && (a.showDashLen += 1), o += 1) } return a.showProjLen = r - a.showProjLen, a.showDashLen = o - a.showDashLen, a } function r(e, t) { e.forEach(function (e, n, a) { t && (e.parent = t), ("project" == e.attribute || e.subs) && e.subs && e.subs.length > 0 && r(e.subs, e) }) } function o(e) { function t(e) { delete e.parent, e.subs && e.subs.map(function (e) { t(e) }) } e.map(function (e) { t(e) }) } function s(e, t) { var n = e.subs; e.dsh_id ? t.push(e.dsh_id) : n && angular.forEach(n, function (e) { s(e, t) }) } function l(e, t) { function n(e, t) { var a = {}; return "project" == e.attribute ? ("projLen" == t && i.push(1), angular.forEach(e.subs, function (e) { a.depth = n(e, t) })) : "depth" == t && (a.depth = e.deep), a } var a; if ("depth" == t) a = n(e).depth - e.deep + 1; else if ("projLen" == t) { var i = []; angular.forEach(e, function (e) { n(e, t) }), a = i.length } return a } function c(e, t) { t[e.proj_id + e.type] = 0, e.parent && c(e.parent, t) } function d(e, t) { var n = e.proj_id; if (n && t.push(n), !e.parent) return t; d(e.parent, t) } function u(e, t) { var n = e; if (n && !$.isEmptyObject(n) && t.push(n), !e.parent) return t; u(e.parent, t) } function f(e, t, n, a) { e.proj_id == t && n && n.splice(a, 1); var i = e.subs; i && i.forEach(function (e, n, a) { f(e, t, a, n) }) } function p(e, t) { var n; if (e) { for (var a = 0; a < t.length; a++) { if (t[a].proj_id == e || t[a].dsh_id == e) { n = t[a]; break } if (t[a].subs && (n = p(e, t[a].subs))) return n } return n } } function h(e, t, n) { var a; if (e) { for (var i = 0; i < t.length; i++) { if (t[i].proj_id == e || t[i].dsh_id == e) { if ("project" == t[i].attribute && (t[i].rule_id && n == t[i].rule_id || !t[i].rule_id && !n)) { a = t[i]; break } if ("dashboard" == t[i].attribute && t[i].parent && (t[i].parent.rule_id && n == t[i].parent.rule_id || !t[i].parent.rule_id && !n)) { a = t[i]; break } } if (t[i].subs && (a = h(e, t[i].subs, n))) return a } return a } } function g(e, t, n, a, i, r, o) { var s = 0, l = t, c = 0; !function e(t, a) { for (var i = 0; i < t.length; i++) { var r = t[i]; if ("project" === r.attribute) { if (r.proj_id === n) { s = null === a ? i : a; break } r.subs && r.subs.length > 0 && e(r.subs, null !== a ? a : i) } } }(l, null), $(".own-project-list > .project-item").each(function (e, t) { e < s && (c += $(t).height()) }), c += 0, 1 == o && (c = 0), e($(".project-list"), c) } function m(e, t) { var n = "J-folder-icon bdp-icon fl"; return 0 != e.type || e.property ? e.property || 2 == e.type ? t[e.proj_id + e.type] ? n += " ico-folder-rule" : n += " ico-folder-rule-open" : 1 == e.type && (t[e.proj_id + e.type] ? n += " ico-folder-shared" : n += " ico-folder-shared-open") : t[e.proj_id + e.type] ? n += " ico-folder1" : n += " ico-folder2-open", n } function v(e, t) { e.subs && e.subs.length > 0 && function e(n) { for (var a = 0; a < n.length; a++) { var i = n[a]; i.hasOwnProperty("handler_more_show") && (i.handler_more_show = t), "project" === i.attribute && i.subs && i.subs.length > 0 && e(i.subs) } }(e.subs) } this.delPar = o, this.initDeep = i, this.findItem = p, this.findItemWithRuleId = h, this.findParId = d, this.findParObj = u, this.deleteItem = f, this.makeParent = r, this.pushChooseDsh = s, this.openCurFolder = c, this.getSubsByType = n, this.getProjObjById = a, this.getRecursiveParam = l, this.jumpToTargetDashPos = g, this.getChangedFolderIconClassName = m, this.resetChildrenHandlerMoreShow = v }]).filter("dashParentsPath", [function (e) { return function (e, t) { if (!angular.isArray(e)) throw new Error("list must be array."); for (var n = 0, a = e.length; n < a; n++) { for (var i = e[n].parents, r = [], o = 0, s = i.length; o < s; o++)r.push(i[o].name); e[n].proj_id && e[n].dsh_id && r.push(e[n].proj_name), e[n].dsh_id && e[n].ct_id && r.push(e[n].dsh_name), e[n].path = r.join(" / ") } return e } }]) }() }, function (e, t, n) { "use strict"; !function () { angular.module("BC.common").service("styleService", [function () { function e(e) { var t = document.createElement("link"); return t.setAttribute("rel", "stylesheet"), t.setAttribute("type", "text/css"), t.setAttribute("href", e), t } function t(t, a) { for (var i = document.getElementsByTagName("link"), r = !0, o = i.length - 1; o >= 0; o--)if (i[o] && null != i[o].getAttribute("href") && i[o].getAttribute("href") === t) { var s = e(a); i[o].parentNode.replaceChild(s, i[o]), r = !1 } r && n(a) } function n(t) { var n = e(t); console.log(t, n), void 0 !== n && document.getElementsByTagName("head")[0].appendChild(n) } function a(e) { for (var t = document.getElementsByTagName("link"), n = t.length - 1; n >= 0; n--)t[n] && null != t[n].getAttribute("href") && t[n].getAttribute("href") === e && t[n].parentNode.removeChild(t[n]) } return { createCssFile: e, replaceCssFile: t, addCssFile: n, deleteCssFile: a } }]) }() }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } var i = n(106), r = a(i), o = n(6), s = a(o), l = n(7), c = a(l); angular.module("BC.common").factory("ChartOperateStack", ["$q", "commonService", function (e, t) { var n = { maxStep: 100, initFrom: "config", undoStack: [], redoStack: [], initialChartData: null }; return function () { function e() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : n; (0, s.default)(this, e), t = _.extend(n, t), this.storageKey = "chart_operate_stack_storage", this.undoStack = [], this.redoStack = [], this.maxStep = t.maxStep, this.initialChartData = null, this.initData(t) } return (0, c.default)(e, [{ key: "initData", value: function (e) { if ("config" === e.initFrom) this.undoStack = [].concat((0, r.default)(e.undoStack)), this.redoStack = [].concat((0, r.default)(e.redoStack)), this.initialChartData = angular.copy(e.initialChartData); else if (e.initFrom.indexOf("localStorage") > -1) { var t = localStorage.getItem(this.storageKey); if (t) { var n = angular.fromJson(t); this.maxStep = n.maxStep, this.undoStack = n.undoStack, this.redoStack = n.redoStack, this.initialChartData = n.initialChartData, this.firstStepData = n.firstStepData, this.notRecordFirstStep = n.notRecordFirstStep, "localStorage_then_delete" === e.initFrom && localStorage.removeItem(this.storageKey) } } } }, { key: "storage", value: function () { var e = { undoStack: this.undoStack, redoStack: this.redoStack, initialChartData: this.initialChartData, maxStep: this.maxStep, firstStepData: this.firstStepData, notRecordFirstStep: this.notRecordFirstStep }; localStorage.setItem(this.storageKey, angular.toJson(e)) } }, { key: "redo", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = this.redoStack.slice(this.redoStack.length - t, this.redoStack.length); return this.redoStack.splice(this.redoStack.length - t), Array.prototype.push.apply(this.undoStack, n.reverse().map(function (t, n) { return t.order = e.undoStack.length + n, t })), $.extend({}, this.undoStack[this.undoStack.length - 1], { chartData: angular.fromJson(this.undoStack[this.undoStack.length - 1].chartData) }) } }, { key: "undo", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, t = this.undoStack.slice(this.undoStack.length - e, this.undoStack.length); this.undoStack.splice(this.undoStack.length - e), Array.prototype.push.apply(this.redoStack, t.reverse()); var n = this.undoStack.length ? this.undoStack[this.undoStack.length - 1] : this.initialChartData; return $.extend({}, n, { chartData: angular.fromJson(n.chartData) }) } }, { key: "clearRedoStack", value: function () { this.redoStack.splice(0) } }, { key: "clearUndoStack", value: function () { this.undoStack.splice(0) } }, { key: "clearStack", value: function () { this.clearRedoStack(), this.clearUndoStack() } }, { key: "setInitialData", value: function (e) { this.initialChartData = $.extend({}, { type: "" }, e) } }, { key: "pushUndoStack", value: function (e, t) { if (this.initialChartData) { if (this.undoStack.length + 1 > this.maxStep) { var n = this.undoStack.shift(), a = n.dataInfo; a = angular.fromJson(a), !n.unionInfo && a.length > 1 && this.initialChartData.unionInfo && (n.unionInfo = this.initialChartData.unionInfo), this.initialChartData = n } this.undoStack.push($.extend({}, { order: this.undoStack.length ? this.undoStack[this.undoStack.length - 1].order + 1 : 0, type: e }, t)) } else this.initialChartData = $.extend({}, { type: e }, t); this.clearRedoStack() } }], [{ key: "replaceMeta", value: function (e, t) { angular.forEach(e, function (t, n) { delete e[n] }), angular.forEach(t, function (t, n) { e[n] = t }) } }, { key: "replaceChartData", value: function (t, n) { angular.forEach(t, function (a, i) { "[object Object]" === Object.prototype.toString.call(a) ? angular.isDefined(n[i]) ? e.replaceMeta(t[i], n[i]) : delete t[i] : angular.isArray(a) ? angular.isDefined(n[i]) ? (t[i].splice(0), Array.prototype.push.apply(t[i], n[i])) : delete t[i] : angular.isDefined(n[i]) ? t[i] = n[i] : delete t[i] }), angular.forEach(n, function (e, a) { angular.isDefined(t[a]) || (t[a] = n[a]) }) } }]), e }() }]) }, function (e, t, n) { "use strict"; !function () { function e(e, t, a) { return { restrict: "EA", templateUrl: n(261), replace: !0, scope: { mode: "=", position: "=", ableOptBtn: "=", ableSearch: "=", ableSelectAll: "=", ableSelectOnly: "=", ableListApi: "=", checkBox: "=", radioBox: "=", defaultPlaceHolder: "=", matchWith: "=", saveData: "=", valList: "=", loadingAni: "=", okCallback: "&", cancelCallback: "&", itemCallback: "&", isDisabled: "=", listQueryApi: "&", listItemApi: "&", parentData: "=" }, link: function (n, i, r) { function o(e, t) { if (n.layerViewData.isDisabled) return !1; n.layerViewData.showLayerFlag = void 0 != t ? t : !n.layerViewData.showLayerFlag, l(), d(e) } function s(e) { var t = [], a = 0, i = "id" == n.layerViewData.matchWith ? S : k, r = []; r = "string" == typeof n.layerViewData.saveData.ids ? n.layerViewData.saveData.ids.split(",") : n.layerViewData.saveData.ids, (r || []).forEach(function (n) { e.forEach(function (e) { n == e[i] && (e.selected = !0, a++, t.push(e[S])) }) }), n.layerViewData.selectAll = e.length == a, n.layerViewData.displayData.id = t } function l() { n.layerViewData.searchQueryText = "", n.layerViewData.isDoingQuery = !1, n.layerViewData.showSelected = !1, c(s), m() } function c(e) { if (n.layerViewData.showLayerFlag) if (n.layerViewFunc.hasOwnProperty("listItemApi") && n.layerViewData.parentData) n.layerViewData.loadingAni = !0, n.layerViewFunc.listItemApi({ data: n.layerViewData.parentData }).then(function (t) { n.layerViewData.loadingAni = !1; var a = t.range; e(a), n.layerViewData.valList = a, n.layerViewData.valListTotal = t.total, n.layerViewData.valListBackup = angular.copy(a), n.layerViewData.showLen = t.length }); else { var t = n.valList; e(t), n.layerViewData.valList = t, n.layerViewData.valListBackup = angular.copy(t), n.layerViewData.showLen = t.length } } function d(t) { var a = n.layerViewData.position, i = n.layerViewData.showLayerFlag; if ("fixed" == a) { var r = angular.element(t.target); r = r.hasClass("bdp-icon") ? r.parents(".select-search-value:first") : r; var o = r.parents(".select-search-value:first"); o = 0 == o.length ? r : o; var s = r.offset(), l = o.next(".search-list-box"); if (i) { var c = s.top + r.closest(".select-search-list-wrap").height(); l.css({ position: "fixed", top: c, left: s.left, width: o.width() + 16 }), e(function () { var e = document.documentElement.clientHeight || document.body.clientHeight, t = l[0].getBoundingClientRect().height; t + s.top > e && l.css("top", s.top - t) }) } else l.css({ top: "-9999px", left: "-9999px" }) } } function u(e) { function t(e, t) { return e.toLowerCase().indexOf(t.toLowerCase()) >= 0 } var a = n.layerViewData.searchQueryText, i = n.layerViewData.valList, r = 0; _.forEach(i, function (n) { e && "showSelected" == e.mode ? n.show = a ? t(n[k], a) && n.selected : n.selected : (n.show = !a || t(n[k], a), n.show = t(n[k], a)), r = n.show ? ++r : r }), n.layerViewData.showLen = r, n.layerViewData.selectAll = !!r && r == i.length, m() } function f() { var e = n.layerViewData.searchQueryText, t = n.layerViewData.valList, a = n.layerViewData.selectAll; t.forEach(function (t) { t.selected = e ? t.show ? a : t.selected : a }) } function p() { var e = n.layerViewData.searchQueryText, a = n.layerViewData.valList, i = !1; if (a.forEach(function (t) { i = e ? !(!t.show || !t.selected) || i : !!t.selected || i }), !i && !n.layerViewData.showSelected) return t("当前未选择任意一项"), !1; n.layerViewData.showSelected = !n.layerViewData.showSelected, u({ mode: n.layerViewData.showSelected ? "showSelected" : "" }) } function h(e) { if (!e) return !1; 13 === e.keyCode ? (u({ mode: n.layerViewData.showSelected ? "showSelected" : "" }), n.layerViewData.isDoingQuery = !0) : "" === n.layerViewData.searchQueryText && (n.layerViewData.isDoingQuery = !1) } function g(t, a) { t && t.stopPropagation(); var i = n.layerViewData.valList; if (n.layerViewData.ableOptBtn && n.layerViewData.ableSelectAll) m(); else if (a.value) { var i = n.layerViewData.valList; i[i.length - 1].value || (i[i.length - 1].selected = !1), b(), n.saveData = n.layerViewData.displayData.id, n.layerViewData.saveData.ids = n.layerViewData.displayData.id } else { var r = [""]; _.forEach(i, function (e) { e.value ? e.selected = !1 : e.selected = !0 }), n.layerViewData.saveData.ids = r, n.saveData = r, b() } n.layerViewData.itemCallback && e(function () { n.layerViewData.itemCallback() }) } function m() { var e = n.layerViewData.searchQueryText, t = n.layerViewData.valList, a = n.layerViewData.showSelected, i = 0, r = 0; n.layerViewData.selectAll = !1, _.forEach(t, function (t) { e || a ? (r = t.selected && t.show ? ++r : r, i = t.show ? ++i : i) : (r = t.selected ? ++r : r, i++) }), n.layerViewData.selectAll = !!i && i == r } function v() { b(), n.saveData = n.layerViewData.displayData.id, n.layerViewData.saveData.ids = n.layerViewData.displayData.id, n.layerViewData.showLayerFlag = !n.layerViewData.showLayerFlag } function y() { n.layerViewData.showLayerFlag = !n.layerViewData.showLayerFlag, w() } function b() { var e = n.layerViewData.valList, t = _.filter(e, function (e) { return !!e.selected }); n.layerViewData.displayData = { id: _.map(t, S), text: _.map(t, k).join(";") } } function w() { n.layerViewData.valList = angular.copy(n.layerViewData.valListBackup) } var C = $.cookie("locale") || "zh", S = "_multi_list_id_", k = "_multi_list_text_", x = "en" == C ? "Select" : "请选择"; !function () { n.layerViewData = { customID: S, customText: k, defaultPlaceHolder: n.defaultPlaceHolder || x, mode: n.mode, isDisabled: n.isDisabled, ableOptBtn: n.ableOptBtn, ableSearch: n.ableSearch, ableSelectAll: n.ableSelectAll, ableSelectOnly: n.ableSelectOnly, ableListApi: n.ableListApi, position: n.position, checkBox: n.checkBox, radioBox: n.radioBox, matchWith: n.matchWith, parentData: n.parentData, loadingAni: n.showLoading, saveData: { ids: n.saveData || [] }, valList: [], valListTotal: 0, valListBackup: angular.copy(n.valList), valListSelected: [], okCallback: n.okCallback, cancelCallback: n.cancelCallback, itemCallback: n.itemCallback, searchQueryText: "", showLayerFlag: !1, displayData: { id: "", text: "" }, showLen: n.valList.length || 0, selectAll: !1, showSelected: !1, isDoingQuery: !1 }, n.layerViewFunc = { listQueryApi: n.listQueryApi, listItemApi: n.listItemApi, toggleList: o, doQuery: h, chooseItem: g, okFunc: v, cancelFunc: y, selectAllItems: f, showSelectedItems: p } }(), n.$watch(function () { return n.layerViewData.saveData }, function (t) { if (!t || !t.ids) return !1; var i = []; i = "string" == typeof t.ids ? t.ids.split(",") : t.ids; var r = a.instant("chart.noneOfCol"); switch (i = _.uniq(i), n.layerViewData.mode) { case "field-item": e(function () { n.layerViewData.displayData.text = i.join(";") }); default: var o = [], s = n.layerViewData.valList; s.length || (s = n.valList), s.forEach(function (e) { i.forEach(function (t) { e[S] && e[S] == t && o.push(e[k]) }) }), n.layerViewData.displayData.text = o.join(";") || r } }), n.$watch(function () { return n.isDisabled }, function (e) { void 0 != e && (n.layerViewData.isDisabled = e) }) } } } angular.module("BC.common").directive("multiSelectListLayer", e), e.$inject = ["$timeout", "errHint", "$translate"] }() }, function (e, t) { e.exports = "/dist/static/common/tpl/multi-select-list-layer.html" }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); !function () { angular.module("BC.common").directive("dependeceList", ["$rootScope", "$timeout", "$jsTipTranslate", "commonService", "ngDialog", function (e, t, n, a, i) { return { restrict: "A", replace: !1, scope: { tbId: "=", field: "=" }, link: function (e, t, n) { t.on("click.dependecceList", function (t) { t.preventDefault(), i.open({ template: "/static/common/dependence/dependence.html", className: "ngdialog-theme-default ngDialog-width-680", scope: e, controller: "dependeceCtr" }) }) } } }]).controller("dependeceCtr", ["$scope", "commonService", "ngDialog", "errHint", function (e, t, n, a) { function r() { var n = { field_id: e.field.fid, title: e.field.title ? e.field.title : "title" }, r = { check_field: (0, i.default)(n), tb_id: e.tbId }; t.field.dependency(r).then(function (t) { 0 == t.status ? t.result.length > 0 ? (e.dependenceChart = t.result[0].chart, e.dependenceWb = t.result[0].tbs, e.dependenceMl = t.result[0].ml) : e.noDepnedece = !0 : a(t.errstr) }) } !function () { e.noDepnedece = !1, r() }(), e.close = function () { n.closeAll() } }]) }() }, function (e, t, n) { n(264).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "dependence_c8c7f577.css" }, function (e, t, n) { "use strict"; !function () { angular.module("BC.common").service("chooseAdminService", ["$rootScope", "commonService", "$translate", function (e, t, n) { function a(e) { var t = e, n = {}, a = []; return t.map(function (e) { e.user_id = e.user_id ? e.user_id : e.userid, n[e.user_id] = !0, a.push(e.user_id) }), { addList: t, originAddList: angular.copy(t), addUserMap: n, originalAddList: a, showAddNum: t.length } } function i(e, a) { return t.account.userList(a).then(function (t) { if (0 == t.status) { var a = []; e && (a = [{ name: n.instant("ownership.allUser"), user_id: "all", userid: "all", username: "all" }]); var i = []; return t.result && t.result.sub_list && t.result.sub_list.length > 0 && (i = a.concat(t.result.sub_list), i.map(function (e) { e.user_id = e.user_id ? e.user_id : e.userid })), l(i), { wholeList: i, originWholeList: angular.copy(i), showWholeNum: i.length, pages_count: t.result.pages_count } } }) } function r(e, t) { var n = []; return e.map(function (e) { t[e.user_id] || n.push(e) }), { wholeList: n, originWholeList: angular.copy(n), showWholeNum: n.length } } function o(e, t, n) { var a = e.wholeList; "del" == n && angular.forEach(a, function (e, n) { e.user_id == t.user_id && a.splice(n, 1) }), "del_all" == n && (a = []), "del_query_all" == n && angular.forEach(t, function (e) { angular.forEach(a, function (t, n) { t.user_id == e && a.splice(n, 1) }) }), "add" == n && a.push(t), "add_all" != n && "add_query_all" != n || (a = a.concat(t)), e.wholeList = a, e.originWholeList = angular.copy(a), e.showWholeNum = a.length } function s() { return angular.copy(d) } function l(e) { d = e } function c() { d = null } var d = null; this.prepareData = a, this.getPrevClearList = r, this.getUserList = i, this.getUserListCache = s, this.clearUserListCache = c, this.updateWholeList = o }]).filter("chooseAdminSearch", [function () { return function (e, t) { function n(e, t) { return !!e && e.toString().toLowerCase().indexOf(t.toLowerCase()) >= 0 } var a = 0; return angular.forEach(t, function (t) { e ? (t.queryShow = !!n(t.name, e) || !!n(t.username, e), a = t.queryShow ? ++a : a) : (t.queryShow = !0, a++) }), { list: t, showNum: a } } }]) }() }, function (e, t, n) {
  "use strict"
    ; function a(e) { return e && e.__esModule ? e : { default: e } } var i = n(31), r = a(i), o = n(6), s = a(o), l = n(7), c = a(l); !function () { angular.module("BC.common").service("bdpOuterParamService", ["$rootScope", "commonService", "$translate", function (e, t, n) { return function () { function e(t) { (0, s.default)(this, e), this.mode = t, this.paramExtendObj = {}, this.updateTimes = {} } return (0, c.default)(e, [{ key: "_setUrlObj", value: function (e) { if (e && e.toString().length > 1) { e = e.split("#/")[0]; try { this.paramExtendObj = JSON.parse(e) } catch (t) { e = e.substring(1, e.length - 1), this.paramExtendObj = JSON.parse(e) } this.mode = "url", console.log(this.paramExtendObj) } } }, { key: "getUrlObj", value: function () { return this.paramExtendObj } }, { key: "isHit", value: function () { return !!this.paramExtendObj && !$.isEmptyObject(this.paramExtendObj) } }, { key: "parseUrlParam", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "extend", t = new RegExp("([?]|&)" + e + "=([^&]*)(&|$)"), n = window.location.href.match(t); if (n) { var a = decodeURIComponent(n[2]); return this._setUrlObj(a), a } return null } }, { key: "setUpdateTimes", value: function (e, t) { this.updateTimes[e] = t } }, { key: "getUpdateTimes", value: function (e) { return this.updateTimes[e] || 0 } }, { key: "matchGlobalFilter", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, n = [], a = this.paramExtendObj.filter_list || []; return e && e == this.paramExtendObj.dsh_id && _.forEach(a, function (e) { t.df_id == e.df_id && (t.range = e.range, n.push(t.df_id)) }), n } }, { key: "matchDashFilter", value: function (e, t) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : [], a = this, i = [], r = this.paramExtendObj.filter_list || []; return this.paramExtendObj.ct_id == t && _.forEach(r, function (e) { _.forEach(n, function (t) { if (e.fid == t.fid && e.uniq_id == t.uniq_id) { var n = a._combineFilterData(t, e); i.push(n) } }) }), { ct_id: i.length ? t : "", list: i } } }, { key: "findGlobalFilter", value: function (e) { this.mode = "websocket", this.paramExtendObj = e.paramData; var t = e.globalFilters, n = e.param, a = []; _.forEach(t, function (e) { _.forEach(n.filter_list, function (t) { e.df_id == t.df_id && n.is_df && (e.range = t.range, a.push(e.df_id)) }) }), e.callback(a) } }, { key: "findDashFilter", value: function (e) { var t = this, n = !1; this.mode = "websocket", this.paramExtendObj = e.paramData; var a = e.param, i = e.dashItems, r = e.drawChartUrl; _.forEach(i, function (e) { var i = e.children[0].meta, o = e.children[0].dom_id, s = r[o] && r[o].options; if (s && i.ct_id == a.ct_id) { var l; !function () { var e = i.filter_list_inner || [], r = []; _.forEach(e, function (e) { _.forEach(a.filter_list, function (n) { if (n.fid == e.fid && n.uniq_id == e.uniq_id) { var a = t._combineFilterData(e, n); r.push(a) } }) }), r.length && ("C500" == i.chart_type ? (l = {}, r.forEach(function (e) { l[e.ct_id] || (l[e.ct_id] = []), l[e.ct_id].push(e) }), s.optional.filter_list_map = l) : s.optional.filter_list = r, n = !0) }() } }), e.callback(n) } }, { key: "_combineFilterData", value: function (e, t) { var n = $.extend({}, e, { range: t.range, granularity: t.granularity || "" }), a = t.range; if ("string" == t.data_type && (a.length >= 2 && (n.inner_adv_type = "exact", n.is_defined = !0), 1 == a.length)) try { if ("object" == (0, r.default)(JSON.parse(a[0]))) { JSON.parse(a[0]) instanceof Array && (n.inner_adv_type = "exact", n.is_defined = !0) } } catch (e) { } return n } }]), e }() }]) }()
}, function (e, t, n) { "use strict"; angular.module("BC.common").directive("pagination", ["commonService", "errHint", "$jsTipTranslate", function (e, t, a) { return { restrict: "A", templateUrl: n(268), scope: { currPage: "=", totalPage: "=", onCommit: "&" }, link: function (e) { e.pageListPos = function (e) { var t = $(e.target).offset(), n = $(window).height(), a = 30; n - t.top < 110 && (a = -80), $(".page-list").css({ top: a }), e.stopPropagation() }, e.goToFirstPage = function () { 1 == e.currPage ? t(e.tips["pagination.isAlreadyFirstPage"]) : (e.currPage = 1, e.onCommit({ page: e.currPage })) }, e.goToLastPage = function () { e.currPage == e.totalPage ? t(e.tips["pagination.isAlreadyLastPage"]) : (e.currPage = e.totalPage, e.onCommit({ page: e.currPage })) }, e.goToPrevPage = function () { 1 == e.currPage ? t(e.tips["pagination.isAlreadyFirstPage"]) : (e.currPage--, e.onCommit({ page: e.currPage })) }, e.goToNextPage = function () { e.currPage == e.totalPage ? t(e.tips["pagination.isAlreadyLastPage"]) : (e.currPage++, e.onCommit({ page: e.currPage })) }, a(["pagination.isAlreadyFirstPage", "pagination.isAlreadyLastPage"], e) } } }]) }, function (e, t) { e.exports = "/dist/static/common/tpl/pagination.html" }, function (e, t, n) { "use strict"; angular.module("BC.common").directive("resizeWidthChartSidebar", [function () { return { restrict: "A", replace: !1, scope: !0, template: '\n                 <span class="drag-btn-wrap">\n                    <i class="bdp-icon ico-triangle-right ico-no-opacity" ng-if="!!isHidden"></i>\n                    <i class="bdp-icon ico-triangle-left ico-no-opacity" ng-if="!isHidden"></i>\n                 </span>   \n            ', link: function (e, t, n) { var a = n.mode; e.isHidden = !1, t.off("click.resizeWidthChartSideBar-" + a).on("click.resizeWidthChartSideBar-" + a, function (n) { var i = $(".chart-left"), r = $(".chart-main"), o = $(".J-chart-right"), s = 0; if (t.parent().find(".bdp-chart-error").length) return !1; e.isHidden = !e.isHidden, "left" == a ? (s = e.isHidden ? 0 : 220, i.css({ width: s + "px" }), r.css({ "margin-left": s + "px" }), t.css({ left: s + "px", right: "auto" })) : "right" == a && (s = e.isHidden ? 0 : 320, o.css({ width: s + "px" }), r.css({ "margin-right": s + "px" }), t.css({ left: "auto", right: s + "px" })), e.$apply(function () { e.draw_chart_url.options._t = (new Date).getTime() }) }) } } }]).directive("resizeWidthFilterList", [function () { return { restrict: "A", replace: !1, link: function (e, t, n) { t.on("mousedown", function (n) { var a = $(".chart-left-side"), i = $("#chartBox"), r = n.pageX - a.outerWidth(); n.preventDefault(), $(document).on("mousemove", function (e) { var n = e.pageX - r; n = Math.max(172, n), n = Math.min(300, n), a.css("width", n + "px"), i.css("left", n + "px"), t.css("left", n + "px") }), $(document).on("mouseup", function (t) { $(document).off("mousemove"), $(document).off("mouseup"), e.$apply(function () { e.draw_chart_url.options._t = (new Date).getTime() }) }) }) } } }]).directive("resizeProjectList", ["$timeout", function (e) { return { link: function (t, n, a) { var i = t.$eval(a.isDashManage); if (localStorage) { var r = localStorage.getItem("project_width"); i && (r = 220), r && !i && e(function () { $(".J_dash_sidebar").css("width", r + "px"), $(".J_dash_edit_content").css("padding-left", r + "px"), angular.element(".item-chart").each(function () { reflowChart(angular.element(this), !0) }) }, 0) } n.on("mousedown", function (n) { var a = $(".J_dash_sidebar"), r = $(".J_dash_edit_content"), o = n.pageX - a.outerWidth(); i && (a = $(".J-tree-wrapper"), r = $(".J-project-info-wrapper"), o = n.pageX - a.outerWidth()), n.preventDefault(), $(document).on("mousemove.drag_project", function (e) { var t = e.pageX - o; t = Math.max(190, t), t = Math.min(300, t), a.css("width", t + "px"), i ? r.css("left", t + "px") : (r.css("padding-left", t + "px"), $(".global-filter-scroll").css("margin-left", t + 24 + "px")) }), $(document).on("mouseup.drag_project", function (n) { i && !t.$$phase && (t.$apply(), e(function () { angular.element(".item-chart").each(function () { reflowChart(angular.element(this), !0) }) }, 0)), localStorage && localStorage.setItem("project_width", a.width()), $(document).off("mousemove.drag_project"), $(document).off("mouseup.drag_project") }) }) } } }]).directive("resizeMergeTable", function () { return { restrict: "A", link: function (e, t, n) { var a = n.leftSelector, i = n.rightSelector; if (localStorage) { var r = localStorage.getItem("ds_tree_width"); r && (r >>>= 0, setTimeout(function () { $(a).css("width", r + "px"), $(i).css("margin-left", r + 1 + "px") }, 10)) } t.on("mousedown", function (e) { var t = $(a), n = $(i), r = e.pageX - t.outerWidth(); e.preventDefault(), $(document).on("mousemove.drag_data_source", function (e) { var a = e.pageX - r; a = Math.max(100, a), a = Math.min(300, a), t.css("width", a + "px"), n.css("margin-left", a + 1 + "px") }), $(document).on("mouseup.drag_data_source", function (e) { localStorage && localStorage.setItem("ds_tree_width", t.width()), $(document).off("mousemove.drag_data_source"), $(document).off("mouseup.drag_data_source") }) }) } } }) }, function (e, t, n) { "use strict"; !function () { angular.module("BC.common").directive("advanceDataFormula", ["$timeout", function (e) { return { scope: { expressionContent: "=", onBlur: "&", onKeyUp: "&" }, link: function (t, n, a) { function i() { r = CodeMirror.fromTextArea(n[0], { mode: "text/x-bdp-sql", indentWithTabs: !0, smartIndent: !0, lineWrapping: !0, matchBrackets: !0, readOnly: !!o && "nocursor", theme: "paraiso-light", autofocus: !o, extraKeys: { "Ctrl-Space": "autocomplete" } }), e(function () { void 0 != t.expressionContent && r.setValue(t.expressionContent) }, 200), r.on("blur", function () { var e = r.getValue().replace(/0xa0/, ""); t.onBlur({ content: e }) }), r.on("keyup", function () { var e = r.getValue().replace(/0xa0/, ""); t.onKeyUp({ flag: !0, content: e }) }) } var r, o = !!a.readonly; bdp.loadbdpFormula(i), t.$on("changeDateExpression", function (e, t) { r && r.setValue(t) }), t.$on("insertFieldNameToExpression", function (e, t) { if (defined(t)) { var n = "[" + t + "]", a = r.getCursor(); r.replaceSelection(n), r.setCursor(a.line + 1, a.ch + n.length), r.focus() } }) } } }]) }() }, function (e, t, n) { "use strict"; function a(e) { return { restrict: "A", link: function (e, t, n) { var a = n.funcTip ? t.closest(n.funcTip)[0] : t.parent().parent()[0]; t.hover(function () { if (a) { var e = t.offset(), n = t.width(), i = (t.height(), $(this).find(".func-tip")), r = (i.offset(), i.outerHeight()), o = $(window).height(), s = { left: e.left + n + 10 }; e.top + r / 2 - 10 < o ? s.top = e.top - i.outerHeight() / 2 - 10 : s.top = o - i.outerHeight(), i.css(s) } }) } } } function i(e) { return { templateUrl: n(272), link: function (e, t) { }, replace: !0, scope: { tbList: "=", expressionData: "=", hasBtn: "=", multipleTb: "=" }, controller: "expressionFilterCtrl" } } function r(e, t, n, a, i, r, o) { function s(e) { if (0 == t.tbList.length) h.curTb = void 0, h.sql = "", t.expressionData = {}, c(""); else { var n = []; angular.forEach(t.expressionData, function (a, i) { l(i) ? e && e.isReplace && e.isReplace == i && delete t.expressionData[i] : (n.push(i), delete t.expressionData[i]) }), n.indexOf(h.curTb) > -1 && (c(t.tbList[0].tb_id), t.tbList[0].open = !0) } } function l(e) { for (var n = t.tbList, a = !1, i = 0; i < n.length; i++)if (n[i].tb_id == e) { a = !0; break } return a } function c(e) { h.curTb = e, h.sql = t.expressionData[e] || "", t.updataSqlVal && t.updataSqlVal() } function d(e) { if (0 != t.tbList.length) return e ? void angular.forEach(t.tbList, function (t) { t.open = !1, t.tb_id == e && (t.open = !0) }) : void (t.tbList[0].open = !0) } var u; t.viewData = { tab: 1, funcList: [], sql: "", curTb: u || "" }; var f = e.$watch("global.funcList", function (e) { e && (t.viewData.funcList = e.base) }); t.$on("$destroy", function () { f() }), t.expressionData = t.expressionData || {}, t.$on("initTbList", function (e, n) { if (0 != t.tbList.length) { var a = n; n || (a = t.tbList[0].tb_id), c(a), d(a), t.$broadcast("updateTbList") } }), t.$on("updateTbList", function (e, n) { s(n), t.tbList && t.tbList.length > 0 && t.tbList.forEach(function (e, t) { e.fields = bdp.utils.addSpecParamsToFields(e.fields) }) }); var p = t.$watch("tbList", function (e) { e && (t.$broadcast("initTbList"), p()) }), h = t.viewData; h.tbList = t.tbList, t.tbList && t.tbList.length > 0 && (u = t.tbList[0].tb_id, t.tbList[0].open = !0, h.curTb = t.tbList[0].tb_id), h.curTb && (h.sql = t.expressionData[u]), t.$on("initSql", function (e, n, a) { a && (t.expressionData = $.extend(!0, {}, t.expressionData, a)); var i = n || h.curTb; c(i), d(i) }), t.tabTable = function (e, n) { e.open = !e.open, angular.forEach(t.tbList, function (t) { e.tb_id != t.tb_id && (t.open = !1) }), e.open && (h.curTb = e.tb_id, h.sql = t.expressionData[e.tb_id] || "", t.updataSqlVal()) }, t.insertFieldName = function (e) { t.insert("[" + e + "]") }, t.insertFunc = function (e) { e = "COUNT_DISTINCT" === e ? "COUNT(DISTINCT())" : e + "()", t.insert(e), t.setCursor("COUNT(DISTINCT())" == e ? 2 : 1) }, t.previewFilterAction = function () { t.$emit("toFilter", "parent") }, t.sqlTrans = function () { if (0 != t.tbList.length && (1 != t.tbList.length || 0 != t.tbList[0].fields.length) && h.curTb) { if (!h.sql) return void o(t.tips["where.sqlScriptNull"]); if ("common" == h.curTb) return void t.$emit("toSqlTrans", h.sql); var e = h.curTb; t.tbList.map(function (t) { t.tb_id == e && t.hasOwnProperty("tb_id_origin") && (e = t.tb_id_origin) }), i.tb.sqlTrans({ tb_id: e, sql: h.sql }).then(function (e) { 0 == e.status && o(t.tips["filter.checkSuccess"]) }) } }, r(["filter.checkSuccess", "where.sqlScriptNull"], t) } function o(e) { function t(e, t, n) { function a() { i = CodeMirror.fromTextArea(t[0], { mode: "text/x-bdp-sql", indentWithTabs: !0, smartIndent: !0, lineWrapping: !0, matchBrackets: !0, readOnly: !!r && "nocursor", theme: "paraiso-light", fields: e.fields, placeholder: n.expPlaceholder ? n.expPlaceholder : "SUM([A]) + SUM([B])" }), e.viewData.sql && i.setValue(e.viewData.sql), r || (i.on("change", function () { e.expressionData[e.viewData.curTb] = e.viewData.sql = i.getValue().replace(/0xa0/, "") }), e.insert = function (e) { i.replaceSelection(e), i.focus() }, e.setCursor = function (e) { var t = i.getCursor(), n = t.ch - e; i.setCursor(t.line, n) }), e.updataSqlVal = function () { i.setValue(e.viewData.sql || "") }, e.updataSqlVal() } var i, r = !!n.readonly; bdp.loadbdpFormula(a) } return { restrict: "A", link: t } } function s() { function e(e, t, n) { function a() { i = CodeMirror.fromTextArea(t[0], { mode: "text/x-bdp-sql", indentWithTabs: !0, smartIndent: !0, lineWrapping: !0, matchBrackets: !0, readOnly: !!r && "nocursor", theme: "paraiso-light", fields: e.fields, placeholder: n.p ? n.p : "SUM([A]) + SUM([B])" }), i.setValue(e.formulaData) } var i, r = !!n.readonly; bdp.loadbdpFormula(a) } return { restrict: "A", link: e, scope: { formulaData: "=" } } } angular.module("BC.common").directive("expressionFilter", i).directive("expressionFuncTip", a).directive("formulaExpression", o).directive("formulaExpressionReadonly", s).controller("expressionFilterCtrl", r), a.$inject = ["$rootScope"], i.$inject = ["$rootScope"], r.$inject = ["$rootScope", "$scope", "getFunctionList", "$timeout", "commonService", "$jsTipTranslate", "errHint"], o.$inject = ["$rootScope"], s.$inject = [] }, function (e, t) { e.exports = "/dist/static/common/expression-filter/expression_filter.html" }, function (e, t, n) { "use strict"; angular.module("BC.common").directive("searchFolderTableCheckbox", function () { return { restrict: "A", link: function (e, t, n) { function a() { var t = e.query; t ? angular.forEach(e.folderList, function (e) { e.hide = !e.name.match(t), e.hide ? (angular.forEach(e.tb_list, function (n) { n.name.match(t) ? (n.hide = !1, e.hide = !1, e.open = !0) : n.hide = !0 }), angular.forEach(e.sub_folders, function (n) { n.name.match(t) ? (n.hide = !1, n.open = !0, e.hide = !1, e.open = !0) : n.hide = !0, n.hide ? angular.forEach(n.tb_list, function (a) { a.name.match(t) ? (a.hide = !1, n.hide = !1, n.open = !0, e.hide = !1, e.open = !0) : a.hide = !0 }) : angular.forEach(n.tb_list, function (e) { e.hide = !1 }) })) : (angular.forEach(e.tb_list, function (e) { e.hide = !1 }), angular.forEach(e.sub_folders, function (e) { e.hide = !1, e.open = !1, angular.forEach(e.tb_list, function (e) { e.hide = !1 }) })) }) : angular.forEach(e.folderList, function (e) { e.hide = !1, e.open = !1, angular.forEach(e.sub_folders, function (e) { e.hide = !1, e.open = !1, angular.forEach(e.tb_list, function (e) { e.hide = !1 }) }), angular.forEach(e.tb_list, function (e) { e.hide = !1 }) }), e.$digest() } var i; t.bind("keyup", function () { clearTimeout(i), i = setTimeout(a, 10) }) } } }) }, function (e, t, n) { "use strict"; !function () { function e(e, t, a, i, r, o, s, l) { function c(e, t, s) { function c(t) { for (var n = e.info[t], a = 0; a < n.length; a++) { if ("" === n[a].name) return alert(e.tips["granularity.nullNameCheck"]), !1; for (var i = a + 1; i < n.length; i++)if (n[a].name === n[i].name) return alert(e.tips["granularity.duplicatedNameCheck"] + '"' + n[i].name + '"'), !1 } return !0 } function d(e) { for (var t in e) e.hasOwnProperty(t) && e[t].map(function (e, t) { delete e.endDateInfo, delete e.granularityMap, delete e.granularityMapDay }); return e } var u; e.selected = "year", e.granularityMap = { month: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], day: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31], day_of_week: [1, 2, 3, 4, 5, 6, 7] }, e.updateDay = function (e) { var t = e.month; e.day; 2 == t ? e.granularityMapDay = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28] : [4, 6, 9, 11].indexOf(t) > -1 ? e.granularityMapDay = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30] : e.granularityMapDay = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31] }, i.post("/api/date_granularity/list", { tb_id: e.tbId }).then(function (t) { 0 == t.status && (e.info = t.result, e.getInitialData = !1, u = angular.copy(t.result)) }), e.setting = { open: function () { e.preCloseDialog = !1, e.getInitialData = !e.info, a.open({ template: n(275), className: "ngdialog-theme-default global-filter-model granularity-modal", scope: e, preCloseCallback: function (t) { if (e.preCloseDialog) return !0; var n = d(u), i = d(angular.copy(e.info)); if (angular.toJson(n) !== angular.toJson(i)) { return a.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: e, data: { title: l.instant("tips"), message: e.tips["chart.notSave"], okClick: function () { } } }).then(function () { return e.info = angular.copy(u), !0 }) } } }) }, getInfo: function (t) { if (setTimeout(function () { $(".date-granularity-rule-list").scrollTop(0) }, 0), !c(e.selected)) return !1; e.selected = t }, add: function (t) { if (e.info[t].length > 9) return void r(e.tips["granularity.tooMuchRules"]); var n = { name: "" }; switch (t) { case "year": n.month = 1, n.day = 1; break; case "month": n.day = 1; break; case "week": n.day_of_week = 1 }e.info[t].push(n), scrollToBottom($(".date-granularity-rule-list")) }, del: function (t, n) { e.info[t].splice(n, 1) }, modify: function () { if (e.preCloseDialog = !0, e.preCloseDialogSure = !0, !c(e.selected)) return !1; e.info = d(e.info); var t = !1; for (var n in e.info) e.info[n].length > 10 && (t = !0); if (t) return void r(e.tips["granularity.tooMuchRules"]); i.post("/api/date_granularity/commit", { tb_id: e.tbId, data: angular.toJson(e.info) }).then(function (t) { 0 == t.status && (u = angular.copy(e.info), a.closeAll()) }) }, reset: function () { e.info = angular.copy(u) } }, o(["chart.notSave", "granularity.nullNameCheck", "granularity.duplicatedNameCheck", "granularity.tooMuchRules"], e) } return { restrict: "A", templateUrl: n(276), scope: { tbId: "=", field: "=", axis: "=", setGranularity: "=" }, link: c } } angular.module("BC.common").directive("dateGranularity", e), e.$inject = ["$timeout", "$rootScope", "ngDialog", "commonHttp", "errHint", "$jsTipTranslate", "granularityMap", "$translate"] }() }, function (e, t) { e.exports = "/dist/static/common/date-granularity/set-custom-granularity.html" }, function (e, t) { e.exports = "/dist/static/common/date-granularity/granularity.html" }, function (e, t, n) { n(278).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "common-main_b77dfe1b.css" }, function (e, t, n) { "use strict"; n(280), n(283), n(288), n(290), n(294), n(296) }, function (e, t, n) { e.exports = "angular-gridster", n(281) }, function (e, t, n) {
  var a, i, r; !function (o, s) { "use strict"; i = [n(282)], a = s, void 0 !== (r = "function" == typeof a ? a.apply(t, i) : a) && (e.exports = r) }(0, function (e) {
    "use strict"; return e.module("gridster", []).constant("gridsterConfig", { layoutStyle: 1, insideContainer: !1, columns: 6, pushing: !0, floating: !0, swapping: !1, width: "auto", colWidth: "auto", rowHeight: "match", margins: [10, 10], outerMargin: !0, sparse: !1, isMobile: !1, mobileBreakPoint: 600, mobileModeEnabled: !0, minColumns: 1, minRows: 1, maxRows: 100, defaultSizeX: 2, defaultSizeY: 1, minSizeX: 1, maxSizeX: null, minSizeY: 1, maxSizeY: null, saveGridItemCalculatedHeightInMobile: !1, resizable: { enabled: !0, handles: ["s", "e", "n", "w", "se", "ne", "sw", "nw"] }, draggable: { enabled: !0, scrollSensitivity: 20, scrollSpeed: 15 } }).controller("GridsterCtrl", ["gridsterConfig", "$timeout", function (t, n) { var a = this; e.extend(this, t), this.resizable = e.extend({}, t.resizable || {}), this.draggable = e.extend({}, t.draggable || {}); var i = !1; this.layoutChanged = function () { i || (i = !0, n(function () { i = !1, a.loaded && a.floatItemsUp(), a.updateHeight(a.movingItem ? a.movingItem.sizeY : 0) }, 30)) }, this.grid = [], this.allItems = [], this.destroy = function () { this.grid && (this.grid = []), this.$element = null, this.allItems && (this.allItems.length = 0, this.allItems = null) }, this.setOptions = function (t) { if (t) if (t = e.extend({}, t), t.draggable && (e.extend(this.draggable, t.draggable), delete t.draggable), t.resizable && (e.extend(this.resizable, t.resizable), delete t.resizable), e.extend(this, t), this.margins && 2 === this.margins.length) for (var n = 0, a = this.margins.length; n < a; ++n)this.margins[n] = parseInt(this.margins[n], 10), isNaN(this.margins[n]) && (this.margins[n] = 0); else this.margins = [0, 0] }, this.canItemOccupy = function (e, t, n) { return t > -1 && n > -1 && e.sizeX + n <= this.columns && e.sizeY + t <= this.maxRows }, this.autoSetItemPosition = function (e) { for (var t = 0; t < this.maxRows; ++t)for (var n = 0; n < this.columns; ++n) { var a = this.getItems(t, n, e.sizeX, e.sizeY, e); if (0 === a.length && this.canItemOccupy(e, t, n)) return void this.putItem(e, t, n) } throw new Error("Unable to place item!") }, this.getItems = function (e, t, n, a, i) { var r = []; n && a || (n = a = 1), !i || i instanceof Array || (i = [i]); var o; if (this.sparse === !1) for (var s = 0; s < a; ++s)for (var l = 0; l < n; ++l)!(o = this.getItem(e + s, t + l, i)) || i && i.indexOf(o) !== -1 || r.indexOf(o) !== -1 || r.push(o); else for (var c = e + a - 1, d = t + n - 1, u = 0; u < this.allItems.length; ++u)!(o = this.allItems[u]) || i && i.indexOf(o) !== -1 || r.indexOf(o) !== -1 || !this.intersect(o, t, d, e, c) || r.push(o); return r }, this.getBoundingBox = function (e) { if (0 === e.length) return null; if (1 === e.length) return { row: e[0].row, col: e[0].col, sizeY: e[0].sizeY, sizeX: e[0].sizeX }; for (var t = 0, n = 0, a = 9999, i = 9999, r = 0, o = e.length; r < o; ++r) { var s = e[r]; a = Math.min(s.row, a), i = Math.min(s.col, i), t = Math.max(s.row + s.sizeY, t), n = Math.max(s.col + s.sizeX, n) } return { row: a, col: i, sizeY: t - a, sizeX: n - i } }, this.intersect = function (e, t, n, a, i) { return t <= e.col + e.sizeX - 1 && n >= e.col && a <= e.row + e.sizeY - 1 && i >= e.row }, this.removeItem = function (e) { for (var t, n = 0, a = this.grid.length; n < a; ++n) { var i = this.grid[n]; if (i && (t = i.indexOf(e)) !== -1) { i[t] = null; break } } this.sparse && (t = this.allItems.indexOf(e)) !== -1 && this.allItems.splice(t, 1), this.layoutChanged() }, this.getItem = function (e, t, n) { !n || n instanceof Array || (n = [n]); for (var a = 1; e > -1;) { for (var i = 1, r = t; r > -1;) { var o = this.grid[e]; if (o) { var s = o[r]; if (s && (!n || n.indexOf(s) === -1) && s.sizeX >= i && s.sizeY >= a) return s } ++i, --r } --e, ++a } return null }, this.putItems = function (e) { for (var t = 0, n = e.length; t < n; ++t)this.putItem(e[t]) }, this.putItem = function (e, t, n, a) { if ((void 0 === t || null === t) && (t = e.row, n = e.col, void 0 === t || null === t)) return void this.autoSetItemPosition(e); if (this.canItemOccupy(e, t, n) || (n = Math.min(this.columns - e.sizeX, Math.max(0, n)), t = Math.min(this.maxRows - e.sizeY, Math.max(0, t))), null !== e.oldRow && void 0 !== e.oldRow) { var i = e.oldRow === t && e.oldColumn === n, r = this.grid[t] && this.grid[t][n] === e; if (i && r) return e.row = t, void (e.col = n); var o = this.grid[e.oldRow]; o && o[e.oldColumn] === e && delete o[e.oldColumn] } e.oldRow = e.row = t, e.oldColumn = e.col = n, this.moveOverlappingItems(e, a), this.grid[t] || (this.grid[t] = []), this.grid[t][n] = e, this.sparse && this.allItems.indexOf(e) === -1 && this.allItems.push(e), this.movingItem === e && this.floatItemUp(e), this.layoutChanged() }, this.swapItems = function (e, t) { this.grid[e.row][e.col] = t, this.grid[t.row][t.col] = e; var n = e.row, a = e.col; e.row = t.row, e.col = t.col, t.row = n, t.col = a }, this.moveOverlappingItems = function (e, t) { t ? t.indexOf(e) === -1 && (t = t.slice(0), t.push(e)) : t = [e]; var n = this.getItems(e.row, e.col, e.sizeX, e.sizeY, t); this.moveItemsDown(n, e.row + e.sizeY, t) }, this.moveItemsDown = function (e, t, n) { if (e && 0 !== e.length) { e.sort(function (e, t) { return e.row - t.row }), n = n ? n.slice(0) : []; var a, i, r, o = {}; for (i = 0, r = e.length; i < r; ++i) { a = e[i]; var s = o[a.col]; (void 0 === s || a.row < s) && (o[a.col] = a.row) } for (i = 0, r = e.length; i < r; ++i) { a = e[i]; var l = t - o[a.col]; this.moveItemDown(a, a.row + l, n), n.push(a) } } }, this.moveItemDown = function (e, t, n) { if (!(e.row >= t)) { for (; e.row < t;)++e.row, this.moveOverlappingItems(e, n); this.putItem(e, e.row, e.col, n) } }, this.floatItemsUp = function () { if (this.floating !== !1) for (var e = 0, t = this.grid.length; e < t; ++e) { var n = this.grid[e]; if (n) for (var a = 0, i = n.length; a < i; ++a) { var r = n[a]; r && this.floatItemUp(r) } } }, this.floatItemUp = function (e) { if (this.floating !== !1) { for (var t = e.col, n = e.sizeY, a = e.sizeX, i = null, r = null, o = e.row - 1; o > -1;) { if (0 !== this.getItems(o, t, a, n, e).length) break; i = o, r = t, --o } null !== i && this.putItem(e, i, r) } }, this.updateHeight = function (e) { var t = this.minRows; e = e || 0; for (var n = this.grid.length; n >= 0; --n) { var a = this.grid[n]; if (a) for (var i = 0, r = a.length; i < r; ++i)a[i] && (t = Math.max(t, n + e + a[i].sizeY)) } this.gridHeight = this.maxRows - t > 0 ? Math.min(this.maxRows, t) : Math.max(this.maxRows, t) }, this.pixelsToRows = function (e, t) { return this.outerMargin || (e += this.margins[0] / 2), t === !0 ? Math.ceil(e / this.curRowHeight) : t === !1 ? Math.floor(e / this.curRowHeight) : Math.round(e / this.curRowHeight) }, this.pixelsToColumns = function (e, t) { return this.outerMargin || (e += this.margins[1] / 2), t === !0 ? Math.ceil(e / this.curColWidth) : t === !1 ? Math.floor(e / this.curColWidth) : Math.round(e / this.curColWidth) } }]).directive("gridsterPreview", function () { return { replace: !0, scope: !0, require: "^gridster", template: '<div ng-style="previewStyle()" class="gridster-preview-holder"></div>', link: function (e, t, n, a) { e.previewStyle = function () { return a.movingItem ? { display: "block", height: a.movingItem.sizeY * a.curRowHeight - a.margins[0] + "px", width: a.movingItem.sizeX * a.curColWidth - a.margins[1] + "px", top: a.movingItem.row * a.curRowHeight + (a.outerMargin ? a.margins[0] : 0) + "px", left: a.movingItem.col * a.curColWidth + (a.outerMargin ? a.margins[1] : 0) + "px" } : { display: "none" } } } } }).directive("gridster", ["$timeout", "$window", "$rootScope", "gridsterDebounce", function (t, n, a, i) { return { scope: !0, restrict: "EAC", controller: "GridsterCtrl", controllerAs: "gridster", compile: function (r) { return r.prepend('<div ng-if="gridster.movingItem" gridster-preview></div>'), function (r, o, s, l) { function c() { 1 == l.layoutStyle ? o.css("height", l.gridHeight * l.curRowHeight + (l.outerMargin ? l.margins[0] : -l.margins[0]) + "px") : 2 == l.layoutStyle && o.css("height", l.wrapHeight) } function d(e) { if (l.setOptions(e), u(o[0])) { "auto" === l.width ? l.curWidth = o[0].offsetWidth || parseInt(o.css("width"), 10) : l.curWidth = l.width, "auto" === l.colWidth ? l.curColWidth = (l.curWidth + (l.outerMargin ? -l.margins[1] : l.margins[1])) / l.columns : l.curColWidth = l.colWidth, l.curRowHeight = l.rowHeight, "string" == typeof l.rowHeight && ("match" === l.rowHeight ? "match" === l.rowHeight ? l.curRowHeight = .9 * Math.round(l.curColWidth) : l.curRowHeight = .9 * Math.round(l.rowHeight) : l.rowHeight.indexOf("*") !== -1 ? l.curRowHeight = Math.round(l.curColWidth * l.rowHeight.replace("*", "").replace(" ", "")) : l.rowHeight.indexOf("/") !== -1 && (l.curRowHeight = Math.round(l.curColWidth / l.rowHeight.replace("/", "").replace(" ", "")))); for (var t = 0, n = l.grid.length; t < n; ++t) { var a = l.grid[t]; if (a) for (var i = 0, r = a.length; i < r; ++i)if (a[i]) { var s = a[i]; s.setElementPosition(), s.setElementSizeY(), s.setElementSizeX() } } c() } } l.loaded = !1, l.$element = o, r.gridster = l, o.addClass("gridster"); var u = function (e) { return "hidden" !== e.style.visibility && "none" !== e.style.display }; r.$watch(function () { return l.gridHeight }, c), r.$watch(function () { return l.movingItem }, function () { l.updateHeight(l.movingItem ? l.movingItem.sizeY : 0) }); var f = s.gridster; f ? r.$parent.$watch(f, function (e) { d(e) }, !0) : d({}), r.$watch(function () { return l.loaded }, function () { l.loaded ? (o.addClass("gridster-loaded"), a.$broadcast("gridster-loaded", l)) : o.removeClass("gridster-loaded") }), r.$watch(function () { return l.isMobile }, function () { l.isMobile ? o.addClass("gridster-mobile").removeClass("gridster-desktop") : o.removeClass("gridster-mobile").addClass("gridster-desktop"), a.$broadcast("gridster-mobile-changed", l) }), r.$watch(function () { return l.draggable }, function () { a.$broadcast("gridster-draggable-changed", l) }, !0), r.$watch(function () { return l.resizable }, function () { a.$broadcast("gridster-resizable-changed", l) }, !0); var p = o[0].offsetWidth || parseInt(o.css("width"), 10), h = function () { var e = o[0].offsetWidth || parseInt(o.css("width"), 10); e && e !== p && !l.movingItem && (p = e, l.loaded && o.removeClass("gridster-loaded"), d(), l.loaded && o.addClass("gridster-loaded"), a.$broadcast("gridster-resized", [e, o[0].offsetHeight], l)) }, g = i(function () { h(), t(function () { r.$apply() }) }, 100); r.$watch(function () { return u(o[0]) }, g), "function" == typeof window.addResizeListener ? window.addResizeListener(o[0], g) : r.$watch(function () { return o[0].offsetWidth || parseInt(o.css("width"), 10) }, h); var m = e.element(n); m.on("resize", g), r.$on("$destroy", function () { l.destroy(), m.off("resize", g), "function" == typeof window.removeResizeListener && window.removeResizeListener(o[0], g) }), t(function () { r.$watch("gridster.floating", function () { l.floatItemsUp() }), r.$watch("gridster.isBDP", function (e) { e && (l.loaded = !0) }) }, 100) } } } }]).controller("GridsterItemCtrl", function () { this.$element = null, this.gridster = null, this.row = null, this.col = null, this.sizeX = null, this.sizeY = null, this.minSizeX = 0, this.minSizeY = 0, this.maxSizeX = null, this.maxSizeY = null, this.init = function (e, t) { this.$element = e, this.gridster = t, this.sizeX = t.defaultSizeX, this.sizeY = t.defaultSizeY }, this.destroy = function () { this.gridster = null, this.$element = null }, this.toJSON = function () { return { row: this.row, col: this.col, sizeY: this.sizeY, sizeX: this.sizeX } }, this.isMoving = function () { return this.gridster.movingItem === this }, this.setPosition = function (e, t) { this.gridster.putItem(this, e, t), this.isMoving() || this.setElementPosition() }, this.setSize = function (e, t, n) { e = e.toUpperCase(); var a = "size" + e, i = "Size" + e; if ("" !== t) { t = parseInt(t, 10), (isNaN(t) || 0 === t) && (t = this.gridster["default" + i]); var r = "X" === e ? this.gridster.columns : this.gridster.maxRows; this["max" + i] && (r = Math.min(this["max" + i], r)), this.gridster["max" + i] && (r = Math.min(this.gridster["max" + i], r)), "X" === e && this.cols ? r -= this.cols : "Y" === e && this.rows && (r -= this.rows); var o = 0; this["min" + i] && (o = Math.max(this["min" + i], o)), this.gridster["min" + i] && (o = Math.max(this.gridster["min" + i], o)), t = Math.max(Math.min(t, r), o); var s = this[a] !== t || this["old" + i] && this["old" + i] !== t; return this["old" + i] = this[a] = t, this.isMoving() || this["setElement" + i](), !n && s && (this.gridster.moveOverlappingItems(this), this.gridster.layoutChanged()), s } }, this.setSizeY = function (e, t) { return this.setSize("Y", e, t) }, this.setSizeX = function (e, t) { return e > this.gridster.columns && (e = this.gridster.columns), this.setSize("X", e, t) }, this.isFreedom = function () { return 2 == this.gridster.layoutStyle }, this.setElementPosition = function () { this.isFreedom() || (this.gridster.isMobile ? this.$element.css({ marginLeft: this.gridster.margins[0] + "px", marginRight: this.gridster.margins[0] + "px", marginTop: this.gridster.margins[1] + "px", marginBottom: this.gridster.margins[1] + "px", top: "", left: "" }) : this.$element.css({ margin: 0, top: this.row * this.gridster.curRowHeight + (this.gridster.outerMargin ? this.gridster.margins[0] : 0) + "px", left: this.col * this.gridster.curColWidth + (this.gridster.outerMargin ? this.gridster.margins[1] : 0) + "px" })) }, this.setElementSizeY = function () { this.isFreedom() || (this.gridster.isMobile && !this.gridster.saveGridItemCalculatedHeightInMobile ? this.$element.css("height", "") : this.$element.css("height", this.sizeY * this.gridster.curRowHeight - this.gridster.margins[0] + "px")) }, this.setElementSizeX = function () { this.isFreedom() || (this.gridster.isMobile ? this.$element.css("width", "") : this.$element.css("width", this.sizeX * this.gridster.curColWidth - this.gridster.margins[1] + "px")) }, this.getElementSizeX = function () { return this.sizeX * this.gridster.curColWidth - this.gridster.margins[1] }, this.getElementSizeY = function () { return this.sizeY * this.gridster.curRowHeight - this.gridster.margins[0] } }).factory("GridsterTouch", [function () {
      return function (e, t, n, a) {
        var i, r, o = {}, s = function (e) { if (Object.keys) return Object.keys(e).length; var t, n = 0; for (t in e) ++n; return n }, l = function (e) { for (var t = 0, n = 0, a = navigator.userAgent.match(/\bMSIE\b/), i = e; null != i; i = i.offsetParent)a && (!document.documentMode || document.documentMode < 8) && "relative" === i.currentStyle.position && i.offsetParent && "relative" === i.offsetParent.currentStyle.position && i.offsetLeft === i.offsetParent.offsetLeft ? n += i.offsetTop : (t += i.offsetLeft, n += i.offsetTop); return { x: t, y: n } }, c = l(e), d = !1, u = function (i) {
          if ("mousemove" !== i.type || 0 !== s(o)) {
            for (var r = !0, f = i.changedTouches ? i.changedTouches : [i], p = 0; p < f.length; ++p) {
              var h = f[p], g = void 0 !== h.identifier ? h.identifier : void 0 !== h.pointerId ? h.pointerId : 1; if (void 0 === h.pageX) if (h.pageX = h.offsetX + c.x, h.pageY = h.offsetY + c.y, h.srcElement.offsetParent === e && document.documentMode && 8 === document.documentMode && "mousedown" === h.type) h.pageX += h.srcElement.offsetLeft, h.pageY += h.srcElement.offsetTop; else if (h.srcElement !== e && !document.documentMode || document.documentMode < 8) { for (var m = -2, v = -2, y = h.srcElement; null !== y; y = y.parentNode)m += y.scrollLeft ? y.scrollLeft : 0, v += y.scrollTop ? y.scrollTop : 0; h.pageX = h.clientX + m, h.pageY = h.clientY + v } var _ = h.pageX, b = h.pageY; i.type.match(/(start|down)$/i) ? (c = l(e), o[g] && (a && a({ target: i.target, which: i.which, pointerId: g, pageX: _, pageY: b }), delete o[g]), t && r && (r = t({ target: i.target, which: i.which, pointerId: g, pageX: _, pageY: b })), o[g] = { x: _, y: b }, e.msSetPointerCapture && r ? e.msSetPointerCapture(g) : "mousedown" === i.type && 1 === s(o) && (d ? e.setCapture(!0) : (document.addEventListener("mousemove", u, !1), document.addEventListener("mouseup", u, !1)))) : i.type.match(/move$/i) ? !o[g] || o[g].x === _ && o[g].y === b || (n && r && (r = n({
                target: i.target, which: i.which, pointerId: g, pageX: _, pageY: b
              })), o[g].x = _, o[g].y = b) : o[g] && i.type.match(/(up|end|cancel)$/i) && (a && r && (r = a({ target: i.target, which: i.which, pointerId: g, pageX: _, pageY: b })), delete o[g], e.msReleasePointerCapture ? e.msReleasePointerCapture(g) : "mouseup" === i.type && 0 === s(o) && (d ? e.releaseCapture() : (document.removeEventListener("mousemove", u, !1), document.removeEventListener("mouseup", u, !1))))
            } r && (i.preventDefault && i.preventDefault(), i.preventManipulation && i.preventManipulation(), i.preventMouseEvent && i.preventMouseEvent())
          }
        }; return this.enable = function () { window.navigator.msPointerEnabled ? (e.addEventListener("MSPointerDown", u, !1), e.addEventListener("MSPointerMove", u, !1), e.addEventListener("MSPointerUp", u, !1), e.addEventListener("MSPointerCancel", u, !1), void 0 !== e.style.msContentZooming && (i = e.style.msContentZooming, e.style.msContentZooming = "none"), void 0 !== e.style.msTouchAction && (r = e.style.msTouchAction, e.style.msTouchAction = "none")) : e.addEventListener ? (e.addEventListener("touchstart", u, !1), e.addEventListener("touchmove", u, !1), e.addEventListener("touchend", u, !1), e.addEventListener("touchcancel", u, !1), e.addEventListener("mousedown", u, !1), e.setCapture && !window.navigator.userAgent.match(/\bGecko\b/) && (d = !0, e.addEventListener("mousemove", u, !1), e.addEventListener("mouseup", u, !1))) : e.attachEvent && e.setCapture && (d = !0, e.attachEvent("onmousedown", function () { return u(window.event), window.event.returnValue = !1, !1 }), e.attachEvent("onmousemove", function () { return u(window.event), window.event.returnValue = !1, !1 }), e.attachEvent("onmouseup", function () { return u(window.event), window.event.returnValue = !1, !1 })) }, this.disable = function () { window.navigator.msPointerEnabled ? (e.removeEventListener("MSPointerDown", u, !1), e.removeEventListener("MSPointerMove", u, !1), e.removeEventListener("MSPointerUp", u, !1), e.removeEventListener("MSPointerCancel", u, !1), i && (e.style.msContentZooming = i), r && (e.style.msTouchAction = r)) : e.removeEventListener ? (e.removeEventListener("touchstart", u, !1), e.removeEventListener("touchmove", u, !1), e.removeEventListener("touchend", u, !1), e.removeEventListener("touchcancel", u, !1), e.removeEventListener("mousedown", u, !1), e.setCapture && !window.navigator.userAgent.match(/\bGecko\b/) && (d = !0, e.removeEventListener("mousemove", u, !1), e.removeEventListener("mouseup", u, !1))) : e.detachEvent && e.setCapture && (d = !0, e.detachEvent("onmousedown"), e.detachEvent("onmousemove"), e.detachEvent("onmouseup")) }, this
      }
    }]).factory("GridsterDraggable", ["$document", "$window", "GridsterTouch", function (t, n, a) { function i(i, r, o, s, l) { function c(e) { i.addClass("gridster-item-moving"), 2 != o.layoutStyle && (o.movingItem = s, o.updateHeight(s.sizeY)), r.$apply(function () { o.draggable && o.draggable.start && o.draggable.start(e, i, l, s) }) } function d(e) { var t = s.row, a = s.col, c = o.draggable && o.draggable.drag, d = o.draggable.scrollSensitivity, u = o.draggable.scrollSpeed; if (2 != o.layoutStyle) { var f = Math.min(o.pixelsToRows(m), o.maxRows - 1), p = Math.min(o.pixelsToColumns(g), o.columns - 1), h = o.getItems(f, p, s.sizeX, s.sizeY, s), v = 0 !== h.length; if (o.swapping === !0 && v) { var y = o.getBoundingBox(h), _ = y.sizeX === s.sizeX && y.sizeY === s.sizeY, b = y.row === t, w = y.col === a, C = y.row === f && y.col === p, S = b || w; if (_ && 1 === h.length) { if (C) o.swapItems(s, h[0]); else if (S) return } else if (y.sizeX <= s.sizeX && y.sizeY <= s.sizeY && S) for (var k = s.row <= f ? s.row : f + s.sizeY, x = s.col <= p ? s.col : p + s.sizeX, D = k - y.row, T = x - y.col, E = 0, A = h.length; E < A; ++E) { var $ = h[E], I = o.getItems($.row + D, $.col + T, $.sizeX, $.sizeY, s); 0 === I.length && o.putItem($, $.row + D, $.col + T) } } o.pushing === !1 && v || (s.row = f, s.col = p) } e.pageY - L.body.scrollTop < d ? L.body.scrollTop = L.body.scrollTop - u : n.innerHeight - (e.pageY - L.body.scrollTop) < d && (L.body.scrollTop = L.body.scrollTop + u), e.pageX - L.body.scrollLeft < d ? L.body.scrollLeft = L.body.scrollLeft - u : n.innerWidth - (e.pageX - L.body.scrollLeft) < d && (L.body.scrollLeft = L.body.scrollLeft + u), (c || t !== s.row || a !== s.col) && r.$apply(function () { c && o.draggable.drag(e, i, l, s) }) } function u(e) { i.removeClass("gridster-item-moving"); var t = Math.min(o.pixelsToRows(m), o.maxRows - 1), n = Math.min(o.pixelsToColumns(g), o.columns - 1); 2 != o.layoutStyle && (o.pushing === !1 && 0 !== o.getItems(t, n, s.sizeX, s.sizeY, s).length || (s.row = t, s.col = n)), o.movingItem = null, 2 != o.layoutStyle && s.setPosition(s.row, s.col), r.$apply(function () { o.draggable && o.draggable.stop && o.draggable.stop(e, i, l, s) }) } function f(t) { if (A.indexOf(t.target.nodeName.toLowerCase()) !== -1) return !1; var n = e.element(t.target); if (n.hasClass("gridster-item-resizable-handler")) return !1; if (n.closest && n.closest(".gridster-no-drag").length) return !1; if (o.draggable && o.draggable.handle) { var a = e.element(i[0].querySelectorAll(o.draggable.handle)), r = !1; e: for (var l = 0, d = a.length; l < d; ++l) { var u = a[l]; if (u === t.target) { r = !0; break } for (var f = t.target, p = 0; p < 20; ++p) { var h = f.parentNode; if (h === i[0] || !h) break; if (h === u) { r = !0; break e } f = h } } if (!r) return !1 } switch (t.which) { case 1: break; case 2: case 3: return }return S = t.pageX, k = t.pageY, g = parseInt(i.css("left"), 10), m = parseInt(i.css("top"), 10), v = i[0].offsetWidth, y = i[0].offsetHeight, _ = s.col, b = s.row, c(t), !0 } function p(e) { if (!i.hasClass("gridster-item-moving") || i.hasClass("gridster-item-resizing")) return !1; var t = o.curWidth - 1, n = o.curRowHeight * o.maxRows - 1; w = e.pageX, C = e.pageY; var a = w - S + x, r = C - k + D; x = D = 0, S = w, k = C; var s = o.insideContainer, l = o.$element.height(), c = a, u = r; return g + c < E ? (a = E - g, x = c - a) : g + v + c > t && (a = t - g - v, x = c - a), m + u < T ? (r = T - m, D = u - r) : m + y + u > n && (r = n - m - y, D = u - r), g += a, m += r, s && y + m > l && (m = l - y), i.css({ top: m + "px", left: g + "px" }), d(e), !0 } function h(e) { return !(!i.hasClass("gridster-item-moving") || i.hasClass("gridster-item-resizing")) && (x = D = 0, u(e), !0) } var g, m, v, y, _, b, w = 0, C = 0, S = 0, k = 0, x = 0, D = 0, T = 0, E = 0, L = t[0], A = ["select", "option", "input", "textarea", "button"], $ = null, I = null; this.enable = function () { if ($ !== !0) { if ($ = !0, I) return void I.enable(); I = new a(i[0], f, p, h), I.enable() } }, this.disable = function () { $ !== !1 && ($ = !1, I && I.disable()) }, this.toggle = function (e) { e ? this.enable() : this.disable() }, this.destroy = function () { this.disable() } } return i }]).factory("GridsterResizable", ["GridsterTouch", function (t) { function n(n, a, i, r, o) { function s() { var e = window.location.href.indexOf("data_screen") >= 0, t = window.location.href.indexOf("/mode/adv") >= 0, n = r.$element[0].getAttribute("data-chart-type"), a = !1; switch (n) { case "C230": case "C261": case "C271": case "C272": case "C273": case "C290": r.minSizeY = 3, r.minSizeX = 3; break; case "C310": r.minSizeY = 2, r.minSizeX = 2; break; default: r.minSizeY = 3, r.minSizeX = 3 }(a = ["C101", "C102", "C103", "C105"].indexOf(n) > -1 || r.$element[0].getAttribute("data-is-special-chart") || e || t) && (r.minSizeX = .001, r.minSizeY = .001) } function l(l) { function c(e) { s(), n.addClass("gridster-item-moving"), n.addClass("gridster-item-resizing"), 2 != i.layoutStyle && (i.movingItem = r, r.setElementSizeX(), r.setElementSizeY(), r.setElementPosition(), i.updateHeight(1)), a.$apply(function () { i.resizable && i.resizable.start && i.resizable.start(e, n, o, r) }) } function d(e) { bdp.utils.throttle(function (e) { var t = r.row, s = r.col, c = r.sizeX, d = r.sizeY, u = i.resizable && i.resizable.resize, f = r.col;["w", "nw", "sw"].indexOf(l) !== -1 && (f = i.pixelsToColumns(g, !1)); var p = r.row;["n", "ne", "nw"].indexOf(l) !== -1 && (p = i.pixelsToRows(m, !1)); var h = r.sizeX;["n", "s"].indexOf(l) === -1 && (h = i.pixelsToColumns(v, !0)); var _ = r.sizeY;["e", "w"].indexOf(l) === -1 && (_ = i.pixelsToRows(y, !0)), !(p > -1 && f > -1 && h + f <= i.columns && _ + p <= i.maxRows) || i.pushing === !1 && 0 !== i.getItems(p, f, h, _, r).length || (r.row = p, r.col = f, r.sizeX = h, r.sizeY = _); var b = r.row !== t || r.col !== s || r.sizeX !== c || r.sizeY !== d; (u || b) && a.$apply(function () { u && i.resizable.resize(e, n, o, r) }) }, 30)() } function u(e) { n.removeClass("gridster-item-moving"), n.removeClass("gridster-item-resizing"), i.movingItem = null, a.$apply(function () { i.resizable && i.resizable.stop && i.resizable.stop(e, n, o, r) }), 2 != i.layoutStyle && (r.setPosition(r.row, r.col), r.setSizeY(r.sizeY), r.setSizeX(r.sizeX)) } function f(t) { var o = e.element(t.target); if (o.closest && o.closest(".gridster-no-resize").length) return !1; switch (t.which) { case 1: break; case 2: case 3: return }return w = i.draggable.enabled, w && (i.draggable.enabled = !1, a.$broadcast("gridster-draggable-changed", i)), D = t.pageX, T = t.pageY, g = parseInt(n.css("left"), 10), m = parseInt(n.css("top"), 10), v = n[0].offsetWidth, y = n[0].offsetHeight, _ = r.sizeX, b = r.sizeY, c(t), N.css("display", "block"), !0 } function p(e) { if (n.hasClass("gridster-no-resize")) return !1; var t = i.curWidth - 1; k = e.pageX, x = e.pageY; var a = k - D + E, r = x - T + L; E = L = 0, D = k, T = x; var o = r, s = a, l = F(), c = O(), u = i.insideContainer, f = i.$element.height(); return S.indexOf("n") >= 0 && (y - o < c ? (r = y - c, L = o - r) : m + o < A && (r = A - m, L = o - r), m += r, y -= r), S.indexOf("s") >= 0 && (y + o < c ? (r = c - y, L = o - r) : m + y + o > $ && (r = $ - m - y, L = o - r), y += r, u && y + m > f && (y = f - m)), S.indexOf("w") >= 0 && (v - s < l ? (a = v - l, E = s - a) : g + s < I && (a = I - g, E = s - a), g += a, v -= a), S.indexOf("e") >= 0 && (v + s < l ? (a = l - v, E = s - a) : g + v + s > t && (a = t - g - v, E = s - a), v += a), n.css({ top: m + "px", left: g + "px", width: v + "px", height: y + "px" }), d(e), !0 } function h(e) { return N.css("display", "none"), i.draggable.enabled !== w && (i.draggable.enabled = w, a.$broadcast("gridster-draggable-changed", i)), E = L = 0, u(e), !0 } var g, m, v, y, _, b, w, C, S = l, k = 0, x = 0, D = 0, T = 0, E = 0, L = 0, A = 0, $ = 9999, I = 0, $ = i.curRowHeight * i.maxRows - 1, O = function () { return (r.minSizeY ? r.minSizeY : 1) * i.curRowHeight - i.margins[0] }, F = function () { return (r.minSizeX ? r.minSizeX : 1) * i.curColWidth - i.margins[1] }, M = null, N = null; this.enable = function () { M || (M = e.element('<div class="gridster-item-resizable-handler handle-' + S + '"></div>'), n.append(M)), N || (N = e.element('<div class="gridster-item-drag-cover"></div>'), n.append(N)), C = new t(M[0], f, p, h), C.enable() }, this.disable = function () { M && (M.remove(), M = null), C.disable(), C = void 0 }, this.destroy = function () { this.disable() } } var c = [], d = i.resizable.handles; "string" == typeof d && (d = i.resizable.handles.split(",")); for (var u = !1, f = 0, p = d.length; f < p; f++)c.push(new l(d[f])); this.enable = function () { if (!u) { for (var e = 0, t = c.length; e < t; e++)c[e].enable(); u = !0 } }, this.disable = function () { if (u) { for (var e = 0, t = c.length; e < t; e++)c[e].disable(); u = !1 } }, this.toggle = function (e) { e ? this.enable() : this.disable() }, this.destroy = function () { for (var e = 0, t = c.length; e < t; e++)c[e].destroy() } } return n }]).factory("gridsterDebounce", function () { return function (e, t, n) { var a; return function () { var i = this, r = arguments, o = function () { a = null, n || e.apply(i, r) }, s = n && !a; clearTimeout(a), a = setTimeout(o, t), s && e.apply(i, r) } } }).directive("gridsterItem", ["$parse", "GridsterDraggable", "GridsterResizable", "gridsterDebounce", function (e, t, n, a) { return { scope: !0, restrict: "EA", controller: "GridsterItemCtrl", controllerAs: "gridsterItem", require: ["^gridster", "gridsterItem"], link: function (i, r, o, s) { function l() { p.setPosition(p.row, p.col), m.row && m.row.assign && m.row.assign(i, p.row), m.col && m.col.assign && m.col.assign(i, p.col) } function c() { var e = p.setSizeX(p.sizeX, !0); e && m.sizeX && m.sizeX.assign && m.sizeX.assign(i, p.sizeX); var t = p.setSizeY(p.sizeY, !0); t && m.sizeY && m.sizeY.assign && m.sizeY.assign(i, p.sizeY), (e || t) && (p.gridster.moveOverlappingItems(p), f.layoutChanged(), i.$broadcast("gridster-item-resized", p)) } var d, u = o.gridsterItem, f = s[0], p = s[1]; if (i.gridster = f, u) { var h = e(u); d = h(i) || {}, !d && h.assign && (d = { row: p.row, col: p.col, sizeX: p.sizeX, sizeY: p.sizeY, minSizeX: 0, minSizeY: 0, maxSizeX: null, maxSizeY: null }, h.assign(i, d)) } else d = o; p.init(r, f), r.addClass("gridster-item"); for (var g = ["minSizeX", "maxSizeX", "minSizeY", "maxSizeY", "sizeX", "sizeY", "row", "col"], m = {}, v = [], y = 0, _ = g.length; y < _; ++y)!function (t) { var n; if ("string" == typeof d[t]) n = d[t]; else if ("string" == typeof d[t.toLowerCase()]) n = d[t.toLowerCase()]; else { if (!u) return; n = u + "." + t } v.push('"' + t + '":' + n), m[t] = e(n); var a = m[t](i); "number" == typeof a && (p[t] = a) }(g[y]); var b = "{" + v.join(",") + "}"; i.$watchCollection(b, function (e, t) { for (var n in e) { var a = e[n]; t[n] !== a && (a = parseInt(a, 10), isNaN(a) || (p[n] = a)) } }), i.$watch(function () { return p.row + "," + p.col }, l), i.$watch(function () { return p.sizeY + "," + p.sizeX + "," + p.minSizeX + "," + p.maxSizeX + "," + p.minSizeY + "," + p.maxSizeY }, c); var w = new t(r, i, f, p, d), C = new n(r, i, f, p, d), S = function () { C.toggle(!f.isMobile && f.resizable && f.resizable.enabled) }; S(); var k = function () { w.toggle(!f.isMobile && f.draggable && f.draggable.enabled) }; k(), i.$on("gridster-draggable-changed", k), i.$on("gridster-resizable-changed", S), i.$on("gridster-resized", S), i.$on("gridster-mobile-changed", function () { S(), k() }); var x = a(function () { i.$apply(function () { i.$broadcast("gridster-item-transition-end", p) }) }, 50); return r.on(function () { var e = document.createElement("div"), t = { transition: "transitionend", OTransition: "oTransitionEnd", MozTransition: "transitionend", WebkitTransition: "webkitTransitionEnd" }; for (var n in t) if (void 0 !== e.style[n]) return t[n] }(), x), i.$broadcast("gridster-item-initialized", p), i.$on("$destroy", function () { try { C.destroy(), w.destroy() } catch (e) { } try { f.removeItem(p) } catch (e) { } try { p.destroy() } catch (e) { } }) } } }]).directive("gridsterNoDrag", function () { return { restrict: "A", link: function (e, t) { t.addClass("gridster-no-drag") } } })
  })
}, function (e, t) { e.exports = window.angular }, function (e, t, n) { e.exports = "textAngular", n(284), n(285), n(287) }, function (e, t) { !function (e, t, n) { "use strict"; function a() { this.$get = ["$$sanitizeUri", function (e) { return function (t) { void 0 !== arguments[1] && (arguments[1].version = "taSanitize"); var n = []; return o(t, u(n, function (t, n) { return !/^unsafe/.test(e(t, n)) })), n.join("") } }] } function i(e) { var n = []; return u(n, t.noop).chars(e), n.join("") } function r(e) { var t, n = {}, a = e.split(","); for (t = 0; t < a.length; t++)n[a[t]] = !0; return n } function o(e, n) { function a(e, a, r, o) { if (a = t.lowercase(a), T[a]) for (; d.last() && E[d.last()];)i("", d.last()); D[a] && d.last() == a && i("", a), (o = S[a] || !!o) || d.push(a); var l = {}; r.replace(g, function (e, t, n, a, i) { var r = n || a || i || ""; l[t] = s(r) }), n.start && n.start(a, l, o) } function i(e, a) { var i, r = 0; if (a = t.lowercase(a)) for (r = d.length - 1; r >= 0 && d[r] != a; r--); if (r >= 0) { for (i = d.length - 1; i >= r; i--)n.end && n.end(d[i]); d.length = r } } "string" != typeof e && (e = null === e || void 0 === e ? "" : "" + e); var r, o, l, c, d = [], u = e; for (d.last = function () { return d[d.length - 1] }; e;) { if (c = "", o = !0, d.last() && A[d.last()] ? (e = e.replace(new RegExp("([^]*)<\\s*\\/\\s*" + d.last() + "[^>]*>", "i"), function (e, t) { return t = t.replace(y, "$1").replace(b, "$1"), n.chars && n.chars(s(t)), "" }), i("", d.last())) : (0 === e.indexOf("<!--") ? (r = e.indexOf("--", 4)) >= 0 && e.lastIndexOf("-->", r) === r && (n.comment && n.comment(e.substring(4, r)), e = e.substring(r + 3), o = !1) : _.test(e) ? (l = e.match(_)) && (e = e.replace(l[0], ""), o = !1) : v.test(e) ? (l = e.match(h)) && (e = e.substring(l[0].length), l[0].replace(h, i), o = !1) : m.test(e) && (l = e.match(p), l ? (l[4] && (e = e.substring(l[0].length), l[0].replace(p, a)), o = !1) : (c += "<", e = e.substring(1))), o && (r = e.indexOf("<"), c += r < 0 ? e : e.substring(0, r), e = r < 0 ? "" : e.substring(r), n.chars && n.chars(s(c)))), e == u) throw f("badparse", "The sanitizer was unable to parse the following block of html: {0}", e); u = e } i() } function s(e) { if (!e) return ""; var t = R.exec(e), n = t[1], a = t[3], i = t[2]; return i && (N.innerHTML = i.replace(/</g, "&lt;"), i = "textContent" in N ? N.textContent : N.innerText), n + i + a } function l(e) { return e.replace(/&/g, "&amp;").replace(w, function (e) { return "&#" + (1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320) + 65536) + ";" }).replace(C, function (e) { var t = e.charCodeAt(0); return t <= 159 || 173 == t || t >= 1536 && t <= 1540 || 1807 == t || 6068 == t || 6069 == t || t >= 8204 && t <= 8207 || t >= 8232 && t <= 8239 || t >= 8288 && t <= 8303 || 65279 == t || t >= 65520 && t <= 65535 ? "&#" + t + ";" : e }).replace(/</g, "&lt;").replace(/>/g, "&gt;") } function c(e) { var n = "", a = e.split(";"); return t.forEach(a, function (e) { var a = e.split(":"); if (2 == a.length) { var i = P(t.lowercase(a[0])), e = P(t.lowercase(a[1])); (("color" === i || "background-color" === i) && (e.match(/^rgb\([0-9%,\. ]*\)$/i) || e.match(/^rgba\([0-9%,\. ]*\)$/i) || e.match(/^hsl\([0-9%,\. ]*\)$/i) || e.match(/^hsla\([0-9%,\. ]*\)$/i) || e.match(/^#[0-9a-f]{3,6}$/i) || e.match(/^[a-z]*$/i)) || "text-align" === i && ("left" === e || "right" === e || "center" === e || "justify" === e) || "float" === i && ("left" === e || "right" === e || "none" === e) || ("width" === i || "height" === i) && e.match(/[0-9\.]*(px|em|rem|%)/) || "direction" === i && e.match(/^ltr|rtl|initial|inherit$/) || "font-size" === i && e.match(/[0-9\.]*(px|em|rem)/)) && (n += i + ": " + e + ";") } }), n } function d(e, t, n, a) { return !("img" !== e || !t["ta-insert-video"] || "ta-insert-video" !== n && "allowfullscreen" !== n && "frameborder" !== n && ("contenteditable" !== n || "false" !== a)) } function u(e, n) { var a = !1, i = t.bind(e, e.push); return { start: function (e, r, o) { e = t.lowercase(e), !a && A[e] && (a = e), a || $[e] !== !0 || (i("<"), i(e), t.forEach(r, function (a, o) { var s = t.lowercase(o), u = "img" === e && "src" === s || "background" === s; ("style" === s && "" !== (a = c(a)) || d(e, r, s, a) || M[s] === !0 && (I[s] !== !0 || n(a, u))) && (i(" "), i(o), i('="'), i(l(a)), i('"')) }), i(o ? "/>" : ">")) }, end: function (e) { e = t.lowercase(e), a || $[e] !== !0 || (i("</"), i(e), i(">")), e == a && (a = !1) }, chars: function (e) { a || i(l(e)) } } } var f = t.$$minErr("$sanitize"), p = /^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/, h = /^<\/\s*([\w:-]+)[^>]*>/, g = /([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g, m = /^</, v = /^<\//, y = /<!--(.*?)-->/g, _ = /<!DOCTYPE([^>]*?)>/i, b = /<!\[CDATA\[(.*?)]]>/g, w = /[\uD800-\uDBFF][\uDC00-\uDFFF]/g, C = /([^\#-~| |!])/g, S = r("area,br,col,hr,img,wbr,input"), k = r("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"), x = r("rp,rt"), D = t.extend({}, x, k), T = t.extend({}, k, r("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")), E = t.extend({}, x, r("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")), L = r("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use"), A = r("script,style"), $ = t.extend({}, S, T, E, D, L), I = r("background,cite,href,longdesc,src,usemap,xlink:href"), O = r("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,id,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"), F = r("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan"), M = t.extend({}, I, F, O), N = document.createElement("pre"), R = /^(\s*)([\s\S]*?)(\s*)$/, P = function () { return String.prototype.trim ? function (e) { return t.isString(e) ? e.trim() : e } : function (e) { return t.isString(e) ? e.replace(/^\s\s*/, "").replace(/\s\s*$/, "") : e } }(); t.module("ngSanitize", []).provider("$sanitize", a), t.module("ngSanitize").filter("linky", ["$sanitize", function (e) { return function (n, a) { function r(e) { e && d.push(i(e)) } if (!n) return n; for (var o, s, l, c = n, d = []; o = c.match(/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"”’]/);)s = o[0], o[2] || o[4] || (s = (o[3] ? "http://" : "mailto:") + s), l = o.index, r(c.substr(0, l)), function (e, n) { d.push("<a "), t.isDefined(a) && d.push('target="', a, '" '), d.push('href="', e.replace(/"/g, "&quot;"), '">'), r(n), d.push("</a>") }(s, o[0].replace(/^mailto:/, "")), c = c.substring(l + o[0].length); return r(c), e(d.join("")) } }]) }(window, window.angular) }, function (e, t, n) {
  var a; void 0 !== e && void 0 !== t && e.exports === t && (e.exports = "textAngular"), function () {
    "use strict"; function i(e) { try { return 0 !== angular.element(e).length } catch (e) { return !1 } } function r(e, t) { if (!e || "" === e || b.hasOwnProperty(e)) throw "textAngular Error: A unique name is required for a Tool Definition"; if (t.display && ("" === t.display || !i(t.display)) || !t.display && !t.buttontext && !t.iconclass) throw 'textAngular Error: Tool Definition for "' + e + '" does not have a valid display/iconclass/buttontext value'; b[e] = t } var o = { ie: function () { for (var e = 3, t = document.createElement("div"), n = t.getElementsByTagName("i"); t.innerHTML = "<!--[if gt IE " + ++e + "]><i></i><![endif]-->", n[0];); return e > 4 ? e : void 0 }(), webkit: /AppleWebKit\/([\d.]+)/i.test(navigator.userAgent) }, s = !1; o.webkit && (document.addEventListener("mousedown", function (e) { var t = e || window.event, n = t.target; if (s && null !== n) { for (var a = !1, i = n; null !== i && "html" !== i.tagName.toLowerCase() && !a;)a = "true" === i.contentEditable, i = i.parentNode; a || (document.getElementById("textAngular-editableFix-010203040506070809").setSelectionRange(0, 0), n.focus(), n.select && n.select()) } s = !1 }, !1), angular.element(document).ready(function () { angular.element(document.body).append(angular.element('<input id="textAngular-editableFix-010203040506070809" class="ta-hidden-input" aria-hidden="true" unselectable="on" tabIndex="-1">').css({ width: "1px", height: "1px", border: 0, margin: 0, padding: 0, position: "absolute", top: "-10000px", left: "-10000px", opacity: 0, overflow: "hidden" })) })); var l = /^(address|article|aside|audio|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video)$/i, c = /^(address|article|aside|audio|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video|li)$/i; String.prototype.trim || (String.prototype.trim = function () { return this.replace(/^\s+|\s+$/g, "") }); var d, u, f, p, h, g; if (o.ie > 8 || void 0 === o.ie) { for (var m = document.styleSheets, v = 0; v < m.length; v++)if ((0 === m[v].media.length || m[v].media.mediaText.match(/(all|screen)/gi)) && m[v].href && m[v].href.match(/textangular\.(min\.|)css/gi)) { d = m[v]; break } d || (d = function () { var e = document.createElement("style"); return o.webkit && e.appendChild(document.createTextNode("")), document.getElementsByTagName("head")[0].appendChild(e), e.sheet }()), u = function (e, t) { return p(d, e, t) }, p = function (e, t, n) { var a, i; return e.cssRules ? a = Math.max(e.cssRules.length - 1, 0) : e.rules && (a = Math.max(e.rules.length - 1, 0)), e.insertRule ? e.insertRule(t + "{" + n + "}", a) : e.addRule(t, n, a), d.rules ? i = d.rules[a] : d.cssRules && (i = d.cssRules[a]), i }, g = function (e, t) { var n, a; for (n = 0; n < t.length; n++)if (t[n].cssText === e.cssText) { a = n; break } return a }, f = function (e) { h(d, e) }, h = function (e, t) { var n = e.cssRules || e.rules; if (n && 0 !== n.length) { var a = g(t, n); e.removeRule ? e.removeRule(a) : e.deleteRule(a) } } } angular.module("textAngular.factories", []).factory("taBrowserTag", [function () { return function (e) { return e ? "" === e ? void 0 === o.ie ? "div" : o.ie <= 8 ? "P" : "p" : o.ie <= 8 ? e.toUpperCase() : e : o.ie <= 8 ? "P" : "p" } }]).factory("taApplyCustomRenderers", ["taCustomRenderers", "taDOM", function (e, t) { return function (n) { var a = angular.element("<div></div>"); return a[0].innerHTML = n, angular.forEach(e, function (e) { var n = []; e.selector && "" !== e.selector ? n = a.find(e.selector) : e.customAttribute && "" !== e.customAttribute && (n = t.getByAttribute(a, e.customAttribute)), angular.forEach(n, function (t) { t = angular.element(t), e.selector && "" !== e.selector && e.customAttribute && "" !== e.customAttribute ? void 0 !== t.attr(e.customAttribute) && e.renderLogic(t) : e.renderLogic(t) }) }), a[0].innerHTML } }]).factory("taFixChrome", function () { return function (e) { if (!e || !angular.isString(e) || e.length <= 0) return e; for (var t, n, a, i = /<([^>\/]+?)style=("([^"]+)"|'([^']+)')([^>]*)>/gi, r = "", o = 0; t = i.exec(e);)(n = t[3] || t[4]) && n.match(/line-height: 1.[0-9]{3,12};|color: inherit; line-height: 1.1;/i) && (n = n.replace(/( |)font-family: inherit;|( |)line-height: 1.[0-9]{3,12};|( |)color: inherit;/gi, ""), a = "<" + t[1].trim(), n.trim().length > 0 && (a += " style=" + t[2].substring(0, 1) + n + t[2].substring(0, 1)), a += t[5].trim() + ">", r += e.substring(o, t.index) + a, o = t.index + t[0].length); return r += e.substring(o), o > 0 ? r.replace(/<span\s?>(.*?)<\/span>(<br(\/|)>|)/gi, "$1") : e } }).factory("taSanitize", ["$sanitize", function (e) { function t(e, t) { for (var n, a = 0, i = 0, r = /<[^>]*>/gi; n = r.exec(e);)if (i = n.index, "/" === n[0].substr(1, 1)) { if (0 === a) break; a-- } else a++; return t + e.substring(0, i) + angular.element(t)[0].outerHTML.substring(t.length) + e.substring(i) } function n(e) { if (!e || !angular.isString(e) || e.length <= 0) return e; for (var a, r, o, s, l, d, u = /<([^>\/]+?)style=("([^"]+)"|'([^']+)')([^>]*)>/gi, f = "", p = "", h = 0; r = u.exec(e);) { s = r[3] || r[4]; var g = new RegExp(c, "i"); if (angular.isString(s) && g.test(s)) { l = ""; for (var m = new RegExp(c, "ig"); o = m.exec(s);)for (a = 0; a < i.length; a++)o[2 * a + 2] && (l += "<" + i[a].tag + ">"); d = n(e.substring(h, r.index)), f.length > 0 ? p += t(d, f) : p += d, s = s.replace(new RegExp(c, "ig"), ""), p += "<" + r[1].trim(), s.length > 0 && (p += ' style="' + s + '"'), p += r[5] + ">", h = r.index + r[0].length, f = l } } return f.length > 0 ? p += t(e.substring(h), f) : p += e.substring(h), p } function a(e) { if (!e || !angular.isString(e) || e.length <= 0) return e; for (var t, n = /<([^>\/]+?)align=("([^"]+)"|'([^']+)')([^>]*)>/gi, a = "", i = 0; t = n.exec(e);) { a += e.substring(i, t.index), i = t.index + t[0].length; var r = "<" + t[1] + t[5]; /style=("([^"]+)"|'([^']+)')/gi.test(r) ? r = r.replace(/style=("([^"]+)"|'([^']+)')/i, 'style="$2$3 text-align:' + (t[3] || t[4]) + ';"') : r += ' style="text-align:' + (t[3] || t[4]) + ';"', r += ">", a += r } return a + e.substring(i) } for (var i = [{ property: "font-weight", values: ["bold"], tag: "b" }, { property: "font-style", values: ["italic"], tag: "i" }], r = [], o = 0; o < i.length; o++) { for (var s = "(" + i[o].property + ":\\s*(", l = 0; l < i[o].values.length; l++)l > 0 && (s += "|"), s += i[o].values[l]; s += ");)", r.push(s) } var c = "(" + r.join("|") + ")"; return function (t, i, r) { if (!r) try { t = n(t) } catch (e) { } t = a(t); var o; try { o = e(t), r && (o = t) } catch (e) { o = i || "" } var s, l = o.match(/(<pre[^>]*>.*?<\/pre[^>]*>)/gi), c = o.replace(/(&#(9|10);)*/gi, ""), d = /<pre[^>]*>.*?<\/pre[^>]*>/gi, u = 0, f = 0; for (o = ""; null !== (s = d.exec(c)) && u < l.length;)o += c.substring(f, s.index) + l[u], f = s.index + s[0].length, u++; return o + c.substring(f) } }]).factory("taToolExecuteAction", ["$q", "$log", function (e, t) { return function (n) { void 0 !== n && (this.$editor = function () { return n }); var a, i = e.defer(), r = i.promise, o = this.$editor(); try { a = this.action(i, o.startAction()), r.finally(function () { o.endAction.call(o) }) } catch (e) { t.error(e) } (a || void 0 === a) && i.resolve() } }]), angular.module("textAngular.DOM", ["textAngular.factories"]).factory("taExecCommand", ["taSelection", "taBrowserTag", "$document", function (e, t, n) { var a = function (t, n) { var a, i, r = t.find("li"); for (i = r.length - 1; i >= 0; i--)a = angular.element("<" + n + ">" + r[i].innerHTML + "</" + n + ">"), t.after(a); t.remove(), e.setSelectionToElementEnd(a[0]) }, i = function (t) { /(<br(|\/)>)$/i.test(t.innerHTML.trim()) ? e.setSelectionBeforeElement(angular.element(t).find("br")[0]) : e.setSelectionToElementEnd(t) }, r = function (e, t) { var n = angular.element("<" + t + ">" + e[0].innerHTML + "</" + t + ">"); e.after(n), e.remove(), i(n.find("li")[0]) }, o = function (e, n, a) { for (var r = "", o = 0; o < e.length; o++)r += "<" + t("li") + ">" + e[o].innerHTML + "</" + t("li") + ">"; var s = angular.element("<" + a + ">" + r + "</" + a + ">"); n.after(s), n.remove(), i(s.find("li")[0]) }; return function (i, s) { return i = t(i), function (c, d, u, f) { var p, h, g, m, v, y, _, b = angular.element("<" + i + ">"); try { _ = e.getSelectionElement() } catch (e) { } var w = angular.element(_); if (void 0 !== _) { var C = _.tagName.toLowerCase(); if ("insertorderedlist" === c.toLowerCase() || "insertunorderedlist" === c.toLowerCase()) { var S = t("insertorderedlist" === c.toLowerCase() ? "ol" : "ul"); if (C === S) return a(w, i); if ("li" === C && w.parent()[0].tagName.toLowerCase() === S && 1 === w.parent().children().length) return a(w.parent(), i); if ("li" === C && w.parent()[0].tagName.toLowerCase() !== S && 1 === w.parent().children().length) return r(w.parent(), S); if (C.match(l) && !w.hasClass("ta-bind")) { if ("ol" === C || "ul" === C) return r(w, S); var k = !1; return angular.forEach(w.children(), function (e) { e.tagName.match(l) && (k = !0) }), k ? o(w.children(), w, S) : o([angular.element("<div>" + _.innerHTML + "</div>")[0]], w, S) } if (C.match(l)) { if (m = e.getOnlySelectedElements(), 0 === m.length) h = angular.element("<" + S + "><li>" + _.innerHTML + "</li></" + S + ">"), w.html(""), w.append(h); else { if (1 === m.length && ("ol" === m[0].tagName.toLowerCase() || "ul" === m[0].tagName.toLowerCase())) return m[0].tagName.toLowerCase() === S ? a(angular.element(m[0]), i) : r(angular.element(m[0]), S); g = ""; var x = []; for (p = 0; p < m.length; p++)if (3 !== m[p].nodeType) { var D = angular.element(m[p]); if ("li" === m[p].tagName.toLowerCase()) continue; "ol" === m[p].tagName.toLowerCase() || "ul" === m[p].tagName.toLowerCase() ? g += D[0].innerHTML : "span" !== m[p].tagName.toLowerCase() || "ol" !== m[p].childNodes[0].tagName.toLowerCase() && "ul" !== m[p].childNodes[0].tagName.toLowerCase() ? g += "<" + t("li") + ">" + D[0].innerHTML + "</" + t("li") + ">" : g += D[0].childNodes[0].innerHTML, x.unshift(D) } h = angular.element("<" + S + ">" + g + "</" + S + ">"), x.pop().replaceWith(h), angular.forEach(x, function (e) { e.remove() }) } return void e.setSelectionToElementEnd(h[0]) } } else { if ("formatblock" === c.toLowerCase()) { for (y = u.toLowerCase().replace(/[<>]/gi, ""), "default" === y.trim() && (y = i, u = "<" + i + ">"), h = "li" === C ? w.parent() : w; !h[0].tagName || !h[0].tagName.match(l) && !h.parent().attr("contenteditable");)h = h.parent(), C = (h[0].tagName || "").toLowerCase(); if (C === y) { m = h.children(); var T = !1; for (p = 0; p < m.length; p++)T = T || m[p].tagName.match(l); T ? (h.after(m), v = h.next(), h.remove(), h = v) : (b.append(h[0].childNodes), h.after(b), h.remove(), h = b) } else if (h.parent()[0].tagName.toLowerCase() !== y || h.parent().hasClass("ta-bind")) if (C.match(/^(ul|li|ol)$/i)) h.wrap(u); else { for (m = e.getOnlySelectedElements(), 0 === m.length && (m = [h[0]]), p = 0; p < m.length; p++)if (3 === m[p].nodeType || !m[p].tagName.match(l)) for (; 3 === m[p].nodeType || !m[p].tagName || !m[p].tagName.match(l);)m[p] = m[p].parentNode; if (angular.element(m[0]).hasClass("ta-bind")) h = angular.element(u), h[0].innerHTML = m[0].innerHTML, m[0].innerHTML = h[0].outerHTML; else if ("blockquote" === y) { for (g = "", p = 0; p < m.length; p++)g += m[p].outerHTML; for (h = angular.element(u), h[0].innerHTML = g, m[0].parentNode.insertBefore(h[0], m[0]), p = m.length - 1; p >= 0; p--)m[p].parentNode && m[p].parentNode.removeChild(m[p]) } else for (p = 0; p < m.length; p++)h = angular.element(u), h[0].innerHTML = m[p].innerHTML, m[p].parentNode.insertBefore(h[0], m[p]), m[p].parentNode.removeChild(m[p]) } else { var E = h.parent(), L = E.contents(); for (p = 0; p < L.length; p++)E.parent().hasClass("ta-bind") && 3 === L[p].nodeType && (b = angular.element("<" + i + ">"), b[0].innerHTML = L[p].outerHTML, L[p] = b[0]), E.parent()[0].insertBefore(L[p], E[0]); E.remove() } return void e.setSelectionToElementEnd(h[0]) } if ("createlink" === c.toLowerCase()) { var A = '<a href="' + u + '" target="' + (f.a.target ? f.a.target : "") + '">'; if (e.getSelection().collapsed) e.insertHtml(A + u + "</a>", s); else if (rangy.getSelection().getRangeAt(0).canSurroundContents()) { var $ = angular.element(A + "</a>")[0]; rangy.getSelection().getRangeAt(0).surroundContents($) } return } if ("inserthtml" === c.toLowerCase()) return void e.insertHtml(u, s) } } try { if (n[0].execCommand(c, d, u), "fontSize" == c) for (var I = document.getElementsByTagName("font"), p = 0, O = I.length; p < O; ++p)"8" == I[p].size && (I[p].removeAttribute("size"), I[p].style.fontSize = u) } catch (e) { } } } }]).service("taSelection", ["$window", "$document", "taDOM", function (e, t, a) {
      var i = t[0], r = n(177), o = function (e, t) { return e.tagName && e.tagName.match(/^br$/i) && 0 === t && !e.previousSibling ? { element: e.parentNode, offset: 0 } : { element: e, offset: t } }, s = {
        getSelection: function () { var e = r.getSelection().getRangeAt(0), t = e.commonAncestorContainer, n = { start: o(e.startContainer, e.startOffset), end: o(e.endContainer, e.endOffset), collapsed: e.collapsed }; return t = 3 === t.nodeType ? t.parentNode : t, t.parentNode === n.start.element || t.parentNode === n.end.element ? n.container = t.parentNode : n.container = t, n }, getOnlySelectedElements: function () { var e = r.getSelection().getRangeAt(0), t = e.commonAncestorContainer; return t = 3 === t.nodeType ? t.parentNode : t, e.getNodes([1], function (e) { return e.parentNode === t }) },
        getSelectionElement: function () { return s.getSelection().container }, setSelection: function (e, t, n) { var a = r.createRange(); a.setStart(e, t), a.setEnd(e, n), r.getSelection().setSingleRange(a) }, setSelectionBeforeElement: function (e) { var t = r.createRange(); t.selectNode(e), t.collapse(!0), r.getSelection().setSingleRange(t) }, setSelectionAfterElement: function (e) { var t = r.createRange(); t.selectNode(e), t.collapse(!1), r.getSelection().setSingleRange(t) }, setSelectionToElementStart: function (e) { var t = r.createRange(); t.selectNodeContents(e), t.collapse(!0), r.getSelection().setSingleRange(t) }, setSelectionToElementEnd: function (e) { var t = r.createRange(); t.selectNodeContents(e), t.collapse(!1), e.childNodes && e.childNodes[e.childNodes.length - 1] && "br" === e.childNodes[e.childNodes.length - 1].nodeName && (t.startOffset = t.endOffset = t.startOffset - 1), r.getSelection().setSingleRange(t) }, insertHtml: function (e, t) { var n, o, d, u, f, p, h, g = angular.element("<div>" + e + "</div>"), m = r.getSelection().getRangeAt(0), v = i.createDocumentFragment(), y = g[0].childNodes, _ = !0; if (y.length > 0) { for (u = [], d = 0; d < y.length; d++)"p" === y[d].nodeName.toLowerCase() && "" === y[d].innerHTML.trim() || 3 === y[d].nodeType && "" === y[d].nodeValue.trim() || (_ = _ && !l.test(y[d].nodeName), u.push(y[d])); for (var b = 0; b < u.length; b++)p = v.appendChild(u[b]); !_ && m.collapsed && /^(|<br(|\/)>)$/i.test(m.startContainer.innerHTML) && m.selectNode(m.startContainer) } else _ = !0, p = v = i.createTextNode(e); if (_) m.deleteContents(); else if (m.collapsed && m.startContainer !== t) if (m.startContainer.innerHTML && m.startContainer.innerHTML.match(/^<[^>]*>$/i)) n = m.startContainer, 1 === m.startOffset ? (m.setStartAfter(n), m.setEndAfter(n)) : (m.setStartBefore(n), m.setEndBefore(n)); else { if (3 === m.startContainer.nodeType && m.startContainer.parentNode !== t) for (n = m.startContainer.parentNode, o = n.cloneNode(), a.splitNodes(n.childNodes, n, o, m.startContainer, m.startOffset); !c.test(n.nodeName);) { angular.element(n).after(o), n = n.parentNode; var w = o; o = n.cloneNode(), a.splitNodes(n.childNodes, n, o, w) } else n = m.startContainer, o = n.cloneNode(), a.splitNodes(n.childNodes, n, o, void 0, void 0, m.startOffset); if (angular.element(n).after(o), m.setStartAfter(n), m.setEndAfter(n), /^(|<br(|\/)>)$/i.test(n.innerHTML.trim()) && (m.setStartBefore(n), m.setEndBefore(n), angular.element(n).remove()), /^(|<br(|\/)>)$/i.test(o.innerHTML.trim()) && angular.element(o).remove(), "li" === n.nodeName.toLowerCase()) { for (h = i.createDocumentFragment(), f = 0; f < v.childNodes.length; f++)g = angular.element("<li>"), a.transferChildNodes(v.childNodes[f], g[0]), a.transferNodeAttributes(v.childNodes[f], g[0]), h.appendChild(g[0]); v = h, p && (p = v.childNodes[v.childNodes.length - 1], p = p.childNodes[p.childNodes.length - 1]) } } else m.deleteContents(); m.insertNode(v), p && s.setSelectionToElementEnd(p) }
      }; return s
    }]).service("taDOM", function () { var e = { getByAttribute: function (t, n) { var a = [], i = t.children(); return i.length && angular.forEach(i, function (t) { a = a.concat(e.getByAttribute(angular.element(t), n)) }), void 0 !== t.attr(n) && a.push(t), a }, transferChildNodes: function (e, t) { for (t.innerHTML = ""; e.childNodes.length > 0;)t.appendChild(e.childNodes[0]); return t }, splitNodes: function (t, n, a, i, r, o) { if (!i && isNaN(o)) throw new Error("taDOM.splitNodes requires a splitNode or splitIndex"); for (var s = document.createDocumentFragment(), l = document.createDocumentFragment(), c = 0; t.length > 0 && (isNaN(o) || o !== c) && t[0] !== i;)s.appendChild(t[0]), c++; for (!isNaN(r) && r >= 0 && t[0] && (s.appendChild(document.createTextNode(t[0].nodeValue.substring(0, r))), t[0].nodeValue = t[0].nodeValue.substring(r)); t.length > 0;)l.appendChild(t[0]); e.transferChildNodes(s, n), e.transferChildNodes(l, a) }, transferNodeAttributes: function (e, t) { for (var n = 0; n < e.attributes.length; n++)t.setAttribute(e.attributes[n].name, e.attributes[n].value); return t } }; return e }), angular.module("textAngular.validators", []).directive("taMaxText", function () { return { restrict: "A", require: "ngModel", link: function (e, t, n, a) { var i = parseInt(e.$eval(n.taMaxText)); if (isNaN(i)) throw "Max text must be an integer"; n.$observe("taMaxText", function (e) { if (i = parseInt(e), isNaN(i)) throw "Max text must be an integer"; a.$dirty && a.$validate() }), a.$validators.taMaxText = function (e) { var t = angular.element("<div/>"); return t.html(e), t.text().length <= i } } } }).directive("taMinText", function () { return { restrict: "A", require: "ngModel", link: function (e, t, n, a) { var i = parseInt(e.$eval(n.taMinText)); if (isNaN(i)) throw "Min text must be an integer"; n.$observe("taMinText", function (e) { if (i = parseInt(e), isNaN(i)) throw "Min text must be an integer"; a.$dirty && a.$validate() }), a.$validators.taMinText = function (e) { var t = angular.element("<div/>"); return t.html(e), !t.text().length || t.text().length >= i } } } }), angular.module("textAngular.taBind", ["textAngular.factories", "textAngular.DOM"]).service("_taBlankTest", [function () { var e = /<(a|abbr|acronym|bdi|bdo|big|cite|code|del|dfn|img|ins|kbd|label|map|mark|q|ruby|rp|rt|s|samp|time|tt|var)[^>]*(>|$)/i; return function (t) { return function (n) { if (!n) return !0; var a, i = /(^[^<]|>)[^<]/i.exec(n); return i ? a = i.index : (n = n.toString().replace(/="[^"]*"/i, "").replace(/="[^"]*"/i, "").replace(/="[^"]*"/i, "").replace(/="[^"]*"/i, ""), a = n.indexOf(">")), n = n.trim().substring(a, a + 100), !/^[^<>]+$/i.test(n) && (!(0 !== n.length && n !== t && !/^>(\s|&nbsp;)*<\/[^>]+>$/gi.test(n)) || !/>\s*[^\s<]/i.test(n) && !e.test(n)) } } }]).directive("taButton", [function () { return { link: function (e, t, n) { t.attr("unselectable", "on"), t.on("mousedown", function (e, t) { return t && angular.extend(e, t), e.preventDefault(), !1 }) } } }]).directive("taBind", ["taSanitize", "$timeout", "$window", "$document", "taFixChrome", "taBrowserTag", "taSelection", "taSelectableElements", "taApplyCustomRenderers", "taOptions", "_taBlankTest", "$parse", "taDOM", "textAngularManager", function (e, t, n, a, i, r, d, p, h, g, m, v, _, b) { return { priority: 2, require: ["ngModel", "?ngModelOptions"], link: function (r, w, C, S) { function k(e) { var t; return H.forEach(function (n) { if (n.keyCode === e.keyCode) { var a = (e.metaKey ? j : 0) + (e.ctrlKey ? B : 0) + (e.shiftKey ? q : 0) + (e.altKey ? z : 0); if (n.forbiddenModifiers & a) return; n.mustHaveModifiers.every(function (e) { return a & e }) && (t = n.specialKey) } }), t } var x, D, T, E, L = S[0], A = S[1] || {}, $ = void 0 !== w.attr("contenteditable") && w.attr("contenteditable"), I = $ || "textarea" === w[0].tagName.toLowerCase() || "input" === w[0].tagName.toLowerCase(), O = !1, F = !1, M = !1, N = C.taUnsafeSanitizer || g.disableSanitizer, R = /^(9|19|20|27|33|34|35|36|37|38|39|40|45|112|113|114|115|116|117|118|119|120|121|122|123|144|145)$/i, P = /^(8|13|32|46|59|61|107|109|173|186|187|188|189|190|191|192|219|220|221|222)$/i, B = 1, j = 2, z = 4, q = 8, H = [{ specialKey: "UndoKey", forbiddenModifiers: z + q, mustHaveModifiers: [j + B], keyCode: 90 }, { specialKey: "RedoKey", forbiddenModifiers: z, mustHaveModifiers: [j + B, q], keyCode: 90 }, { specialKey: "RedoKey", forbiddenModifiers: z + q, mustHaveModifiers: [j + B], keyCode: 89 }, { specialKey: "TabKey", forbiddenModifiers: j + q + z + B, mustHaveModifiers: [], keyCode: 9 }, { specialKey: "ShiftTabKey", forbiddenModifiers: j + z + B, mustHaveModifiers: [q], keyCode: 9 }]; void 0 === C.taDefaultWrap && (C.taDefaultWrap = "p"), "" === C.taDefaultWrap ? (T = "", E = void 0 === o.ie ? "<div><br></div>" : o.ie >= 11 ? "<p><br></p>" : o.ie <= 8 ? "<P>&nbsp;</P>" : "<p>&nbsp;</p>") : (T = void 0 === o.ie || o.ie >= 11 ? "<" + C.taDefaultWrap + "><br></" + C.taDefaultWrap + ">" : o.ie <= 8 ? "<" + C.taDefaultWrap.toUpperCase() + "></" + C.taDefaultWrap.toUpperCase() + ">" : "<" + C.taDefaultWrap + "></" + C.taDefaultWrap + ">", E = void 0 === o.ie || o.ie >= 11 ? "<" + C.taDefaultWrap + "><br></" + C.taDefaultWrap + ">" : o.ie <= 8 ? "<" + C.taDefaultWrap.toUpperCase() + ">&nbsp;</" + C.taDefaultWrap.toUpperCase() + ">" : "<" + C.taDefaultWrap + ">&nbsp;</" + C.taDefaultWrap + ">"), A.$options || (A.$options = {}); var V = m(E), W = function (e) { if (V(e)) return e; var t = angular.element("<div>" + e + "</div>"); if (0 === t.children().length) e = "<" + C.taDefaultWrap + ">" + e + "</" + C.taDefaultWrap + ">"; else { var n, a = t[0].childNodes, i = !1; for (n = 0; n < a.length && !(i = a[n].nodeName.toLowerCase().match(l)); n++); if (i) for (e = "", n = 0; n < a.length; n++)if (a[n].nodeName.toLowerCase().match(l)) e += a[n].outerHTML; else { var r = a[n].outerHTML || a[n].nodeValue; "" !== r.trim() ? e += "<" + C.taDefaultWrap + ">" + r + "</" + C.taDefaultWrap + ">" : e += r } else e = "<" + C.taDefaultWrap + ">" + e + "</" + C.taDefaultWrap + ">" } return e }; C.taPaste && (D = v(C.taPaste)), w.addClass("ta-bind"); var U; r["$undoManager" + (C.id || "")] = L.$undoManager = { _stack: [], _index: 0, _max: 1e3, push: function (e) { return void 0 === e || null === e || void 0 !== this.current() && null !== this.current() && e === this.current() ? e : (this._index < this._stack.length - 1 && (this._stack = this._stack.slice(0, this._index + 1)), this._stack.push(e), U && t.cancel(U), this._stack.length > this._max && this._stack.shift(), this._index = this._stack.length - 1, e) }, undo: function () { return this.setToIndex(this._index - 1) }, redo: function () { return this.setToIndex(this._index + 1) }, setToIndex: function (e) { if (!(e < 0 || e > this._stack.length - 1)) return this._index = e, this.current() }, current: function () { return this._stack[this._index] } }; var G, J = r["$undoTaBind" + (C.id || "")] = function () { if (!O && $) { var e = L.$undoManager.undo(); void 0 !== e && null !== e && (ce(e), K(e, !1), G && t.cancel(G), G = t(function () { w[0].focus(), d.setSelectionToElementEnd(w[0]) }, 1)) } }, X = r["$redoTaBind" + (C.id || "")] = function () { if (!O && $) { var e = L.$undoManager.redo(); void 0 !== e && null !== e && (ce(e), K(e, !1), G && t.cancel(G), G = t(function () { w[0].focus(), d.setSelectionToElementEnd(w[0]) }, 1)) } }, Y = function () { if ($) return w[0].innerHTML; if (I) return w.val(); throw "textAngular Error: attempting to update non-editable taBind" }, K = function (e, t, n) { M = n || !1, void 0 !== t && null !== t || (t = $), void 0 !== e && null !== e || (e = Y()), V(e) ? ("" !== L.$viewValue && L.$setViewValue(""), t && "" !== L.$undoManager.current() && L.$undoManager.push("")) : (le(), L.$viewValue !== e && (L.$setViewValue(e), t && L.$undoManager.push(e))), L.$render() }; r["updateTaBind" + (C.id || "")] = function () { O || K(void 0, void 0, !0) }; var Q = function (t) { return L.$oldViewValue = e(i(t), L.$oldViewValue, N) }; if (w.attr("required") && (L.$validators.required = function (e, t) { return !V(e || t) }), L.$parsers.push(Q), L.$parsers.unshift(W), L.$formatters.push(Q), L.$formatters.unshift(W), L.$formatters.unshift(function (e) { return L.$undoManager.push(e || "") }), I) if (r.events = {}, $) { var Z = !1, ee = function (n) { if (n && n.trim().length) { if (n.match(/class=["']*Mso(Normal|List)/i)) { var a = n.match(/<!--StartFragment-->([\s\S]*?)<!--EndFragment-->/i); a = a ? a[1] : n, a = a.replace(/<o:p>[\s\S]*?<\/o:p>/gi, "").replace(/class=(["']|)MsoNormal(["']|)/gi, ""); var i = angular.element("<div>" + a + "</div>"), o = angular.element("<div></div>"), s = { element: null, lastIndent: [], lastLi: null, isUl: !1 }; s.lastIndent.peek = function () { var e = this.length; if (e > 0) return this[e - 1] }; for (var l = function (e) { s.isUl = e, s.element = angular.element(e ? "<ul>" : "<ol>"), s.lastIndent = [], s.lastIndent.peek = function () { var e = this.length; if (e > 0) return this[e - 1] }, s.lastLevelMatch = null }, c = 0; c <= i[0].childNodes.length; c++)if (i[0].childNodes[c] && "#text" !== i[0].childNodes[c].nodeName && "p" === i[0].childNodes[c].tagName.toLowerCase()) { var u = angular.element(i[0].childNodes[c]), f = (u.attr("class") || "").match(/MsoList(Bullet|Number|Paragraph)(CxSp(First|Middle|Last)|)/i); if (f) { if (u[0].childNodes.length < 2 || u[0].childNodes[1].childNodes.length < 1) continue; var p = "bullet" === f[1].toLowerCase() || "number" !== f[1].toLowerCase() && !(/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(u[0].childNodes[1].innerHTML) || /^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(u[0].childNodes[1].childNodes[0].innerHTML)), h = (u.attr("style") || "").match(/margin-left:([\-\.0-9]*)/i), g = parseFloat(h ? h[1] : 0), m = (u.attr("style") || "").match(/mso-list:l([0-9]+) level([0-9]+) lfo[0-9+]($|;)/i); if (m && m[2] && (g = parseInt(m[2])), m && (!s.lastLevelMatch || m[1] !== s.lastLevelMatch[1]) || !f[3] || "first" === f[3].toLowerCase() || null === s.lastIndent.peek() || s.isUl !== p && s.lastIndent.peek() === g) l(p), o.append(s.element); else if (null != s.lastIndent.peek() && s.lastIndent.peek() < g) s.element = angular.element(p ? "<ul>" : "<ol>"), s.lastLi.append(s.element); else if (null != s.lastIndent.peek() && s.lastIndent.peek() > g) { for (; null != s.lastIndent.peek() && s.lastIndent.peek() > g;)if ("li" !== s.element.parent()[0].tagName.toLowerCase()) { if (!/[uo]l/i.test(s.element.parent()[0].tagName.toLowerCase())) break; s.element = s.element.parent(), s.lastIndent.pop() } else s.element = s.element.parent(); s.isUl = "ul" === s.element[0].tagName.toLowerCase(), p !== s.isUl && (l(p), o.append(s.element)) } s.lastLevelMatch = m, g !== s.lastIndent.peek() && s.lastIndent.push(g), s.lastLi = angular.element("<li>"), s.element.append(s.lastLi), s.lastLi.html(u.html().replace(/<!(--|)\[if !supportLists\](--|)>[\s\S]*?<!(--|)\[endif\](--|)>/gi, "")), u.remove() } else l(!1), o.append(u) } var v = function (e) { e = angular.element(e); for (var t = e[0].childNodes.length - 1; t >= 0; t--)e.after(e[0].childNodes[t]); e.remove() }; angular.forEach(o.find("span"), function (e) { e.removeAttribute("lang"), e.attributes.length <= 0 && v(e) }), angular.forEach(o.find("font"), v), n = o.html() } else { if (n = n.replace(/<(|\/)meta[^>]*?>/gi, ""), n.match(/<[^>]*?(ta-bind)[^>]*?>/)) { if (n.match(/<[^>]*?(text-angular)[^>]*?>/)) { var y = angular.element("<div>" + n + "</div>"); y.find("textarea").remove(); for (var b = _.getByAttribute(y, "ta-bind"), C = 0; C < b.length; C++) { for (var S = b[C][0].parentNode.parentNode, k = 0; k < b[C][0].childNodes.length; k++)S.parentNode.insertBefore(b[C][0].childNodes[k], S); S.parentNode.removeChild(S) } n = y.html().replace('<br class="Apple-interchange-newline">', "") } } else n.match(/^<span/) && (n = n.replace(/<(|\/)span[^>]*?>/gi, "")); n = n.replace(/<br class="Apple-interchange-newline"[^>]*?>/gi, "").replace(/<span class="Apple-converted-space">( |&nbsp;)<\/span>/gi, "&nbsp;") } /<li(\s.*)?>/i.test(n) && /(<ul(\s.*)?>|<ol(\s.*)?>).*<li(\s.*)?>/i.test(n) === !1 && (n = n.replace(/<li(\s.*)?>.*<\/li(\s.*)?>/i, "<ul>$&</ul>")), n = n.replace(/^[ |\u00A0]+/gm, function (e) { for (var t = "", n = 0; n < e.length; n++)t += "&nbsp;"; return t }).replace(/\n|\r\n|\r/g, "<br />").replace(/\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;"), D && (n = D(r, { $html: n }) || n), n = e(n, "", N), d.insertHtml(n, w[0]), t(function () { L.$setViewValue(Y()), Z = !1, w.removeClass("processing-paste") }, 0) } else Z = !1, w.removeClass("processing-paste") }; w.on("paste", r.events.paste = function (e, i) { if (i && angular.extend(e, i), O || Z) return e.stopPropagation(), e.preventDefault(), !1; Z = !0, w.addClass("processing-paste"); var r, o = (e.originalEvent || e).clipboardData; if (o && o.getData && o.types.length > 0) { for (var s = "", l = 0; l < o.types.length; l++)s += " " + o.types[l]; return /text\/html/i.test(s) ? r = o.getData("text/html") : /text\/plain/i.test(s) && (r = o.getData("text/plain")), ee(r), e.stopPropagation(), e.preventDefault(), !1 } var c = n.rangy.saveSelection(), d = angular.element('<div class="ta-hidden-input" contenteditable="true"></div>'); a.find("body").append(d), d[0].focus(), t(function () { n.rangy.restoreSelection(c), ee(d[0].innerHTML), w[0].focus(), d.remove() }, 0) }), w.on("cut", r.events.cut = function (e) { O ? e.preventDefault() : t(function () { L.$setViewValue(Y()) }, 0) }), w.on("keydown", r.events.keydown = function (e, t) { t && angular.extend(e, t), e.specialKey = k(e); var n; if (g.keyMappings.forEach(function (t) { e.specialKey === t.commandKeyCode && (e.specialKey = void 0), t.testForKey(e) && (n = t.commandKeyCode), "UndoKey" !== t.commandKeyCode && "RedoKey" !== t.commandKeyCode || t.enablePropagation || e.preventDefault() }), void 0 !== n && (e.specialKey = n), void 0 === e.specialKey || "UndoKey" === e.specialKey && "RedoKey" === e.specialKey || (e.preventDefault(), b.sendKeyCommand(r, e)), !O && ("UndoKey" === e.specialKey && (J(), e.preventDefault()), "RedoKey" === e.specialKey && (X(), e.preventDefault()), 13 === e.keyCode && !e.shiftKey)) { var a, i = d.getSelectionElement(); if (!i.tagName.match(c)) return; var o = angular.element(T); if (/^<br(|\/)>$/i.test(i.innerHTML.trim()) && "blockquote" === i.parentNode.tagName.toLowerCase() && !i.nextSibling) { a = angular.element(i); var s = a.parent(); s.after(o), a.remove(), 0 === s.children().length && s.remove(), d.setSelectionToElementStart(o[0]), e.preventDefault() } else /^<[^>]+><br(|\/)><\/[^>]+>$/i.test(i.innerHTML.trim()) && "blockquote" === i.tagName.toLowerCase() && (a = angular.element(i), a.after(o), a.remove(), d.setSelectionToElementStart(o[0]), e.preventDefault()) } }); var te; if (w.on("keyup", r.events.keyup = function (e, a) { if (a && angular.extend(e, a), 9 === e.keyCode) { return void (d.getSelection().start.element === w[0] && w.children().length && d.setSelectionToElementStart(w.children()[0])) } if (U && t.cancel(U), !O && !R.test(e.keyCode)) { if ("" !== T && 13 === e.keyCode && !e.shiftKey) { for (var i = d.getSelectionElement(); !i.tagName.match(c) && i !== w[0];)i = i.parentNode; if (i.tagName.toLowerCase() !== C.taDefaultWrap && "li" !== i.tagName.toLowerCase() && ("" === i.innerHTML.trim() || "<br>" === i.innerHTML.trim())) { var r = angular.element(T); angular.element(i).replaceWith(r), d.setSelectionToElementStart(r[0]) } } var o = Y(); if ("" !== T && "" === o.trim()) ce(T), d.setSelectionToElementStart(w.children()[0]); else if ("<" !== o.substring(0, 1) && "" !== C.taDefaultWrap) { var s = n.rangy.saveSelection(); o = Y(), o = "<" + C.taDefaultWrap + ">" + o + "</" + C.taDefaultWrap + ">", ce(o), n.rangy.restoreSelection(s) } var l = x !== e.keyCode && P.test(e.keyCode); te && t.cancel(te), te = t(function () { K(o, l, !0) }, A.$options.debounce || 400), l || (U = t(function () { L.$undoManager.push(o) }, 250)), x = e.keyCode } }), w.on("blur", r.events.blur = function () { F = !1, O ? (M = !0, L.$render()) : K(void 0, void 0, !0) }), C.placeholder && (o.ie > 8 || void 0 === o.ie)) { var ne; if (!C.id) throw "textAngular Error: An unique ID is required for placeholders to work"; ne = u("#" + C.id + ".placeholder-text:before", 'content: "' + C.placeholder + '"'), r.$on("$destroy", function () { f(ne) }) } w.on("focus", r.events.focus = function () { F = !0, w.removeClass("placeholder-text"), le() }); w.on("mouseup", r.events.mouseup = function (e) { d.getSelection().start.element === w[0] && w.children().length && d.setSelectionToElementStart(w.children()[0]) }), w.on("mousedown", r.events.mousedown = function (e, t) { t && angular.extend(e, t), e.stopPropagation() }) } else { w.on("change blur", r.events.change = r.events.blur = function () { O || L.$setViewValue(Y()) }), w.on("keydown", r.events.keydown = function (e, t) { if (t && angular.extend(e, t), 9 === e.keyCode) { var n = this.selectionStart, a = this.selectionEnd, i = w.val(); if (e.shiftKey) { var r = i.lastIndexOf("\n", n), o = i.lastIndexOf("\t", n); o !== -1 && o >= r && (w.val(i.substring(0, o) + i.substring(o + 1)), this.selectionStart = this.selectionEnd = n - 1) } else w.val(i.substring(0, n) + "\t" + i.substring(a)), this.selectionStart = this.selectionEnd = n + 1; e.preventDefault() } }); var ae = function (e, t) { for (var n = "", a = 0; a < t; a++)n += e; return n }, ie = function (e, t) { var n = "", a = e.childNodes; t++, n += ae("\t", t - 1) + e.outerHTML.substring(0, e.outerHTML.indexOf("<li")); for (var i = 0; i < a.length; i++)a[i].outerHTML && ("ul" === a[i].nodeName.toLowerCase() || "ol" === a[i].nodeName.toLowerCase() ? n += "\n" + ie(a[i], t) : n += "\n" + ae("\t", t) + a[i].outerHTML); return n += "\n" + ae("\t", t - 1) + e.outerHTML.substring(e.outerHTML.lastIndexOf("<")) }; L.$formatters.unshift(function (e) { var t = angular.element("<div>" + e + "</div>")[0].childNodes; if (t.length > 0) { e = ""; for (var n = 0; n < t.length; n++)t[n].outerHTML && (e.length > 0 && (e += "\n"), "ul" === t[n].nodeName.toLowerCase() || "ol" === t[n].nodeName.toLowerCase() ? e += "" + ie(t[n], 0) : e += "" + t[n].outerHTML) } return e }) } var re, oe = function (e) { return r.$emit("ta-element-select", this), e.preventDefault(), !1 }, se = function (e, n) { if (n && angular.extend(e, n), !y && !O) { y = !0; var a; a = e.originalEvent ? e.originalEvent.dataTransfer : e.dataTransfer, r.$emit("ta-drop-event", this, e, a), t(function () { y = !1, K(void 0, void 0, !0) }, 100) } }, le = r["reApplyOnSelectorHandlers" + (C.id || "")] = function () { O || angular.forEach(p, function (e) { w.find(e).off("click", oe).on("click", oe) }) }, ce = function (e) { w[0].innerHTML = e }, de = !1; L.$render = function () { if (!de) { de = !0; var e = L.$viewValue || ""; M || ($ && F && (w.removeClass("placeholder-text"), re && t.cancel(re), re = t(function () { F || (w[0].focus(), d.setSelectionToElementEnd(w.children()[w.children().length - 1])), re = void 0 }, 1)), $ ? (ce(C.placeholder ? "" === e ? T : e : "" === e ? T : e), O ? w.off("drop", se) : (le(), w.on("drop", se))) : "textarea" !== w[0].tagName.toLowerCase() && "input" !== w[0].tagName.toLowerCase() ? ce(h(e)) : w.val(e)), $ && C.placeholder && ("" === e ? F ? w.removeClass("placeholder-text") : w.addClass("placeholder-text") : w.removeClass("placeholder-text")), de = M = !1 } }, C.taReadonly && (O = r.$eval(C.taReadonly), O ? (w.addClass("ta-readonly"), "textarea" !== w[0].tagName.toLowerCase() && "input" !== w[0].tagName.toLowerCase() || w.attr("disabled", "disabled"), void 0 !== w.attr("contenteditable") && w.attr("contenteditable") && w.removeAttr("contenteditable")) : (w.removeClass("ta-readonly"), "textarea" === w[0].tagName.toLowerCase() || "input" === w[0].tagName.toLowerCase() ? w.removeAttr("disabled") : $ && w.attr("contenteditable", "true")), r.$watch(C.taReadonly, function (e, t) { t !== e && (e ? (w.addClass("ta-readonly"), "textarea" !== w[0].tagName.toLowerCase() && "input" !== w[0].tagName.toLowerCase() || w.attr("disabled", "disabled"), void 0 !== w.attr("contenteditable") && w.attr("contenteditable") && w.removeAttr("contenteditable"), angular.forEach(p, function (e) { w.find(e).on("click", oe) }), w.off("drop", se)) : (w.removeClass("ta-readonly"), "textarea" === w[0].tagName.toLowerCase() || "input" === w[0].tagName.toLowerCase() ? w.removeAttr("disabled") : $ && w.attr("contenteditable", "true"), angular.forEach(p, function (e) { w.find(e).off("click", oe) }), w.on("drop", se)), O = e) })), $ && !O && (angular.forEach(p, function (e) { w.find(e).on("click", oe) }), w.on("drop", se), w.on("blur", function () { o.webkit && (s = !0) })) } } }]); var y = !1, _ = angular.module("textAngular", ["ngSanitize", "textAngularSetup", "textAngular.factories", "textAngular.DOM", "textAngular.validators", "textAngular.taBind"]), b = {}; _.constant("taRegisterTool", r), _.value("taTools", b), _.config([function () { angular.forEach(b, function (e, t) { delete b[t] }) }]), _.run([function () { void 0 !== (a = function (e) { window.rangy = n(177), window.rangy.saveSelection = n(286) }.call(t, n, t, e)) && (e.exports = a) }]), _.directive("textAngular", ["$compile", "$timeout", "taOptions", "taSelection", "taExecCommand", "textAngularManager", "$window", "$document", "$animate", "$log", "$q", "$parse", function (e, t, n, a, i, r, o, s, l, c, d, u) {
      return {
        require: "?ngModel", scope: {}, restrict: "EA", priority: 2, link: function (f, p, h, g) {
          var m, v, y, _, b, w, C, S, k, x, D, T = h.serial ? h.serial : Math.floor(1e16 * Math.random()); f._name = h.name ? h.name : "textAngularEditor" + T; var E = function (e, n, a) { t(function () { var t = function () { e.off(n, t), a.apply(this, arguments) }; e.on(n, t) }, 100) }; if (k = i(h.taDefaultWrap), angular.extend(f, angular.copy(n), { wrapSelection: function (e, t, n) { "undo" === e.toLowerCase() ? f["$undoTaBindtaTextElement" + T]() : "redo" === e.toLowerCase() ? f["$redoTaBindtaTextElement" + T]() : (k(e, !1, t, f.defaultTagAttributes), n && f["reApplyOnSelectorHandlerstaTextElement" + T](), f.displayElements.text[0].focus()) }, showHtml: f.$eval(h.taShowHtml) || !1 }), h.taFocussedClass && (f.classes.focussed = h.taFocussedClass), h.taTextEditorClass && (f.classes.textEditor = h.taTextEditorClass), h.taHtmlEditorClass && (f.classes.htmlEditor = h.taHtmlEditorClass), h.taDefaultTagAttributes) try { angular.extend(f.defaultTagAttributes, angular.fromJson(h.taDefaultTagAttributes)) } catch (e) { c.error(e) } h.taTextEditorSetup && (f.setup.textEditorSetup = f.$parent.$eval(h.taTextEditorSetup)), h.taHtmlEditorSetup && (f.setup.htmlEditorSetup = f.$parent.$eval(h.taHtmlEditorSetup)), h.taFileDrop ? f.fileDropHandler = f.$parent.$eval(h.taFileDrop) : f.fileDropHandler = f.defaultFileDropHandler, C = p[0].innerHTML, p[0].innerHTML = "", f.displayElements = { forminput: angular.element("<input type='hidden' tabindex='-1' style='display: none;'>"), html: angular.element("<textarea></textarea>"), text: angular.element("<div></div>"), scrollWindow: angular.element("<div class='ta-scroll-window'></div>"), popover: angular.element('<div class="popover fade bottom" style="max-width: none; width: 305px;"></div>'), popoverArrow: angular.element('<div class="arrow"></div>'), popoverContainer: angular.element('<div class="popover-content"></div>'), resize: { overlay: angular.element('<div class="ta-resizer-handle-overlay"></div>'), background: angular.element('<div class="ta-resizer-handle-background"></div>'), anchors: [angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tl"></div>'), angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tr"></div>'), angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-bl"></div>'), angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-br"></div>')], info: angular.element('<div class="ta-resizer-handle-info"></div>') } }, f.displayElements.popover.append(f.displayElements.popoverArrow), f.displayElements.popover.append(f.displayElements.popoverContainer), f.displayElements.scrollWindow.append(f.displayElements.popover), f.displayElements.popover.on("mousedown", function (e, t) { return t && angular.extend(e, t), e.preventDefault(), !1 }), f.showPopover = function (e) { f.displayElements.popover.css("display", "block"), f.reflowPopover(e), l.addClass(f.displayElements.popover, "in"), E(s.find("body"), "click keyup", function () { f.hidePopover() }) }, f.reflowPopover = function (e) { f.displayElements.text[0].offsetHeight - 51 > e[0].offsetTop ? (f.displayElements.popover.css("top", e[0].offsetTop + e[0].offsetHeight + f.displayElements.scrollWindow[0].scrollTop + "px"), f.displayElements.popover.removeClass("top").addClass("bottom")) : (f.displayElements.popover.css("top", e[0].offsetTop - 54 + f.displayElements.scrollWindow[0].scrollTop + "px"), f.displayElements.popover.removeClass("bottom").addClass("top")); var t = f.displayElements.text[0].offsetWidth - f.displayElements.popover[0].offsetWidth, n = e[0].offsetLeft + e[0].offsetWidth / 2 - f.displayElements.popover[0].offsetWidth / 2; f.displayElements.popover.css("left", Math.max(0, Math.min(t, n)) + "px"), f.displayElements.popoverArrow.css("margin-left", Math.min(n, Math.max(0, n - t)) - 11 + "px") }, f.hidePopover = function () { f.displayElements.popover.css("display", ""), f.displayElements.popoverContainer.attr("style", ""), f.displayElements.popoverContainer.attr("class", "popover-content"), f.displayElements.popover.removeClass("in") }, f.displayElements.resize.overlay.append(f.displayElements.resize.background), angular.forEach(f.displayElements.resize.anchors, function (e) { f.displayElements.resize.overlay.append(e) }), f.displayElements.resize.overlay.append(f.displayElements.resize.info), f.displayElements.scrollWindow.append(f.displayElements.resize.overlay), f.reflowResizeOverlay = function (e) { e = angular.element(e)[0], f.displayElements.resize.overlay.css({ display: "block", left: e.offsetLeft - 5 + "px", top: e.offsetTop - 5 + "px", width: e.offsetWidth + 10 + "px", height: e.offsetHeight + 10 + "px" }), f.displayElements.resize.info.text(e.offsetWidth + " x " + e.offsetHeight) }, f.showResizeOverlay = function (e) { var t = s.find("body"); x = function (n) { var a = { width: parseInt(e.attr("width")), height: parseInt(e.attr("height")), x: n.clientX, y: n.clientY }; (void 0 === a.width || isNaN(a.width)) && (a.width = e[0].offsetWidth), (void 0 === a.height || isNaN(a.height)) && (a.height = e[0].offsetHeight), f.hidePopover(); var i = a.height / a.width, r = function (t) { function n(e) { return Math.round(Math.max(0, e)) } var r = { x: Math.max(0, a.width + (t.clientX - a.x)), y: Math.max(0, a.height + (t.clientY - a.y)) }, o = void 0 !== h.taResizeForceAspectRatio, s = h.taResizeMaintainAspectRatio; if (o || s && !t.shiftKey) { var l = r.y / r.x; r.x = i > l ? r.x : r.y / i, r.y = i > l ? r.x * i : r.y } var c = angular.element(e); c.css("height", n(r.y) + "px"), c.css("width", n(r.x) + "px"), f.reflowResizeOverlay(e) }; t.on("mousemove", r), E(t, "mouseup", function (n) { n.preventDefault(), n.stopPropagation(), t.off("mousemove", r), f.showPopover(e) }), n.stopPropagation(), n.preventDefault() }, f.displayElements.resize.anchors[3].off("mousedown"), f.displayElements.resize.anchors[3].on("mousedown", x), f.reflowResizeOverlay(e), E(t, "click", function () { f.hideResizeOverlay() }) }, f.hideResizeOverlay = function () { f.displayElements.resize.anchors[3].off("mousedown", x), f.displayElements.resize.overlay.css("display", "") }, f.setup.htmlEditorSetup(f.displayElements.html), f.setup.textEditorSetup(f.displayElements.text), f.displayElements.html.attr({ id: "taHtmlElement" + T, "ng-show": "showHtml", "ta-bind": "ta-bind", "ng-model": "html", "ng-model-options": p.attr("ng-model-options") }), f.displayElements.text.attr({ id: "taTextElement" + T, contentEditable: "true", "ta-bind": "ta-bind", "ng-model": "html", "ng-model-options": p.attr("ng-model-options") }), f.displayElements.scrollWindow.attr({ "ng-hide": "showHtml" }), h.taDefaultWrap && f.displayElements.text.attr("ta-default-wrap", h.taDefaultWrap), h.taUnsafeSanitizer && (f.displayElements.text.attr("ta-unsafe-sanitizer", h.taUnsafeSanitizer), f.displayElements.html.attr("ta-unsafe-sanitizer", h.taUnsafeSanitizer)), f.displayElements.scrollWindow.append(f.displayElements.text), p.append(f.displayElements.scrollWindow), p.append(f.displayElements.html), f.displayElements.forminput.attr("name", f._name), p.append(f.displayElements.forminput), h.tabindex && (p.removeAttr("tabindex"), f.displayElements.text.attr("tabindex", h.tabindex), f.displayElements.html.attr("tabindex", h.tabindex)), h.placeholder && (f.displayElements.text.attr("placeholder", h.placeholder), f.displayElements.html.attr("placeholder", h.placeholder)), h.taDisabled && (f.displayElements.text.attr("ta-readonly", "disabled"), f.displayElements.html.attr("ta-readonly", "disabled"), f.disabled = f.$parent.$eval(h.taDisabled), f.$parent.$watch(h.taDisabled, function (e) { f.disabled = e, f.disabled ? p.addClass(f.classes.disabled) : p.removeClass(f.classes.disabled) })), h.taPaste && (f._pasteHandler = function (e) { return u(h.taPaste)(f.$parent, { $html: e }) }, f.displayElements.text.attr("ta-paste", "_pasteHandler($html)")), e(f.displayElements.scrollWindow)(f), e(f.displayElements.html)(f), f.updateTaBindtaTextElement = f["updateTaBindtaTextElement" + T], f.updateTaBindtaHtmlElement = f["updateTaBindtaHtmlElement" + T], p.addClass("ta-root"), f.displayElements.scrollWindow.addClass("ta-text ta-editor " + f.classes.textEditor), f.displayElements.html.addClass("ta-html ta-editor " + f.classes.htmlEditor), f._actionRunning = !1; var L = !1; if (f.startAction = function () { return f._actionRunning = !0, L = o.rangy.saveSelection(), function () { L && o.rangy.restoreSelection(L) } }, f.endAction = function () { f._actionRunning = !1, L && (f.showHtml ? f.displayElements.html[0].focus() : f.displayElements.text[0].focus(), o.rangy.removeMarkers(L)), L = !1, f.updateSelectedStyles(), f.showHtml || f["updateTaBindtaTextElement" + T]() }, b = function () { f.focussed = !0, p.addClass(f.classes.focussed), S.focus(), p.triggerHandler("focus") }, f.displayElements.html.on("focus", b), f.displayElements.text.on("focus", b), w = function (e) { return f._actionRunning || s[0].activeElement === f.displayElements.html[0] || s[0].activeElement === f.displayElements.text[0] || (p.removeClass(f.classes.focussed), S.unfocus(), t(function () { f._bUpdateSelectedStyles = !1, p.triggerHandler("blur"), f.focussed = !1 }, 0)), e.preventDefault(), !1 }, f.displayElements.html.on("blur", w), f.displayElements.text.on("blur", w), f.displayElements.text.on("paste", function (e) { p.triggerHandler("paste", e) }), f.queryFormatBlockState = function (e) { return !f.showHtml && e.toLowerCase() === s[0].queryCommandValue("formatBlock").toLowerCase() }, f.queryCommandState = function (e) { return f.showHtml ? "" : s[0].queryCommandState(e) }, f.switchView = function () { f.showHtml = !f.showHtml, l.enabled(!1, f.displayElements.html), l.enabled(!1, f.displayElements.text), f.showHtml ? t(function () { return l.enabled(!0, f.displayElements.html), l.enabled(!0, f.displayElements.text), f.displayElements.html[0].focus() }, 100) : t(function () { return l.enabled(!0, f.displayElements.html), l.enabled(!0, f.displayElements.text), f.displayElements.text[0].focus() }, 100) }, h.ngModel) { var A = !0; g.$render = function () { if (A) { A = !1; var e = f.$parent.$eval(h.ngModel); void 0 !== e && null !== e || !C || "" === C || g.$setViewValue(C) } f.displayElements.forminput.val(g.$viewValue), f.html = g.$viewValue || "" }, p.attr("required") && (g.$validators.required = function (e, t) { var n = e || t; return !(!n || "" === n.trim()) }) } else f.displayElements.forminput.val(C), f.html = C; if (f.$watch("html", function (e, t) { e !== t && (h.ngModel && g.$viewValue !== e && g.$setViewValue(e), f.displayElements.forminput.val(e)) }), h.taTargetToolbars) S = r.registerEditor(f._name, f, h.taTargetToolbars.split(",")); else { var $ = angular.element('<div text-angular-toolbar name="textAngularToolbar' + T + '">'); h.taToolbar && $.attr("ta-toolbar", h.taToolbar), h.taToolbarClass && $.attr("ta-toolbar-class", h.taToolbarClass), h.taToolbarGroupClass && $.attr("ta-toolbar-group-class", h.taToolbarGroupClass), h.taToolbarButtonClass && $.attr("ta-toolbar-button-class", h.taToolbarButtonClass), h.taToolbarActiveButtonClass && $.attr("ta-toolbar-active-button-class", h.taToolbarActiveButtonClass), h.taFocussedClass && $.attr("ta-focussed-class", h.taFocussedClass), p.prepend($), e($)(f.$parent), S = r.registerEditor(f._name, f, ["textAngularToolbar" + T]) } f.$on("$destroy", function () {
            r.unregisterEditor(f._name),
            angular.element(window).off("blur")
          }), f.$on("ta-element-select", function (e, t) { S.triggerElementSelect(e, t) && f["reApplyOnSelectorHandlerstaTextElement" + T]() }), f.$on("ta-drop-event", function (e, n, a, i) { f.displayElements.text[0].focus(), i && i.files && i.files.length > 0 ? (angular.forEach(i.files, function (e) { try { d.when(f.fileDropHandler(e, f.wrapSelection) || f.fileDropHandler !== f.defaultFileDropHandler && d.when(f.defaultFileDropHandler(e, f.wrapSelection))).then(function () { f["updateTaBindtaTextElement" + T]() }) } catch (e) { c.error(e) } }), a.preventDefault(), a.stopPropagation()) : t(function () { f["updateTaBindtaTextElement" + T]() }, 0) }), f._bUpdateSelectedStyles = !1, angular.element(window).on("blur", function () { f._bUpdateSelectedStyles = !1, f.focussed = !1 }), f.updateSelectedStyles = function () { var e; D && t.cancel(D), void 0 !== (e = a.getSelectionElement()) && e.parentNode !== f.displayElements.text[0] ? S.updateSelectedStyles(angular.element(e)) : S.updateSelectedStyles(), f._bUpdateSelectedStyles && (D = t(f.updateSelectedStyles, 200)) }, m = function () { if (!f.focussed) return void (f._bUpdateSelectedStyles = !1); f._bUpdateSelectedStyles || (f._bUpdateSelectedStyles = !0, f.$apply(function () { f.updateSelectedStyles() })) }, f.displayElements.html.on("keydown", m), f.displayElements.text.on("keydown", m), v = function () { f._bUpdateSelectedStyles = !1 }, f.displayElements.html.on("keyup", v), f.displayElements.text.on("keyup", v), y = function (e, t) { t && angular.extend(e, t), f.$apply(function () { if (S.sendKeyCommand(e)) return f._bUpdateSelectedStyles || f.updateSelectedStyles(), e.preventDefault(), !1 }) }, f.displayElements.html.on("keypress", y), f.displayElements.text.on("keypress", y), _ = function () { f._bUpdateSelectedStyles = !1, f.$apply(function () { f.updateSelectedStyles() }) }, f.displayElements.html.on("mouseup", _), f.displayElements.text.on("mouseup", _)
        }
      }
    }]), _.service("textAngularManager", ["taToolExecuteAction", "taTools", "taRegisterTool", function (e, t, n) { var a = {}, i = {}; return { registerEditor: function (n, r, o) { if (!n || "" === n) throw "textAngular Error: An editor requires a name"; if (!r) throw "textAngular Error: An editor requires a scope"; if (i[n]) throw 'textAngular Error: An Editor with name "' + n + '" already exists'; var s = []; return angular.forEach(o, function (e) { a[e] && s.push(a[e]) }), i[n] = { scope: r, toolbars: o, _registerToolbar: function (e) { this.toolbars.indexOf(e.name) >= 0 && s.push(e) }, editorFunctions: { disable: function () { angular.forEach(s, function (e) { e.disabled = !0 }) }, enable: function () { angular.forEach(s, function (e) { e.disabled = !1 }) }, focus: function () { angular.forEach(s, function (e) { e._parent = r, e.disabled = !1, e.focussed = !0, r.focussed = !0 }) }, unfocus: function () { angular.forEach(s, function (e) { e.disabled = !0, e.focussed = !1 }), r.focussed = !1 }, updateSelectedStyles: function (e) { angular.forEach(s, function (t) { angular.forEach(t.tools, function (n) { n.activeState && (t._parent = r, n.active = n.activeState(e)) }) }) }, sendKeyCommand: function (n) { var a = !1; return (n.ctrlKey || n.metaKey || n.specialKey) && angular.forEach(t, function (t, i) { if (t.commandKeyCode && (t.commandKeyCode === n.which || t.commandKeyCode === n.specialKey)) for (var o = 0; o < s.length; o++)if (void 0 !== s[o].tools[i]) { e.call(s[o].tools[i], r), a = !0; break } }), a }, triggerElementSelect: function (e, n) { var a = function (e, t) { for (var n = !0, a = 0; a < t.length; a++)n = n && e.attr(t[a]); return n }, i = [], o = {}, l = !1; n = angular.element(n); var c = !1; if (angular.forEach(t, function (e, t) { e.onElementSelect && e.onElementSelect.element && e.onElementSelect.element.toLowerCase() === n[0].tagName.toLowerCase() && (!e.onElementSelect.filter || e.onElementSelect.filter(n)) && (c = c || angular.isArray(e.onElementSelect.onlyWithAttrs) && a(n, e.onElementSelect.onlyWithAttrs), e.onElementSelect.onlyWithAttrs && !a(n, e.onElementSelect.onlyWithAttrs) || (o[t] = e)) }), c ? (angular.forEach(o, function (e, t) { e.onElementSelect.onlyWithAttrs && a(n, e.onElementSelect.onlyWithAttrs) && i.push({ name: t, tool: e }) }), i.sort(function (e, t) { return t.tool.onElementSelect.onlyWithAttrs.length - e.tool.onElementSelect.onlyWithAttrs.length })) : angular.forEach(o, function (e, t) { i.push({ name: t, tool: e }) }), i.length > 0) for (var d = 0; d < i.length; d++) { for (var u = i[d].tool, f = i[d].name, p = 0; p < s.length; p++)if (void 0 !== s[p].tools[f]) { u.onElementSelect.action.call(s[p].tools[f], e, n, r), l = !0; break } if (l) break } return l } } }, i[n].editorFunctions }, retrieveEditor: function (e) { return i[e] }, unregisterEditor: function (e) { delete i[e] }, registerToolbar: function (e) { if (!e) throw "textAngular Error: A toolbar requires a scope"; if (!e.name || "" === e.name) throw "textAngular Error: A toolbar requires a name"; if (a[e.name]) throw 'textAngular Error: A toolbar with name "' + e.name + '" already exists'; a[e.name] = e, angular.forEach(i, function (t) { t._registerToolbar(e) }) }, retrieveToolbar: function (e) { return a[e] }, retrieveToolbarsViaEditor: function (e) { var t = [], n = this; return angular.forEach(this.retrieveEditor(e).toolbars, function (e) { t.push(n.retrieveToolbar(e)) }), t }, unregisterToolbar: function (e) { delete a[e] }, updateToolsDisplay: function (e) { var t = this; angular.forEach(e, function (e, n) { t.updateToolDisplay(n, e) }) }, resetToolsDisplay: function () { var e = this; angular.forEach(t, function (t, n) { e.resetToolDisplay(n) }) }, updateToolDisplay: function (e, t) { var n = this; angular.forEach(a, function (a, i) { n.updateToolbarToolDisplay(i, e, t) }) }, resetToolDisplay: function (e) { var t = this; angular.forEach(a, function (n, a) { t.resetToolbarToolDisplay(a, e) }) }, updateToolbarToolDisplay: function (e, t, n) { if (!a[e]) throw 'textAngular Error: No Toolbar with name "' + e + '" exists'; a[e].updateToolDisplay(t, n) }, resetToolbarToolDisplay: function (e, n) { if (!a[e]) throw 'textAngular Error: No Toolbar with name "' + e + '" exists'; a[e].updateToolDisplay(n, t[n], !0) }, removeTool: function (e) { delete t[e], angular.forEach(a, function (t) { delete t.tools[e]; for (var n = 0; n < t.toolbar.length; n++) { for (var a, i = 0; i < t.toolbar[n].length; i++) { if (t.toolbar[n][i] === e) { a = { group: n, index: i }; break } if (void 0 !== a) break } void 0 !== a && (t.toolbar[a.group].slice(a.index, 1), t._$element.children().eq(a.group).children().eq(a.index).remove()) } }) }, addTool: function (e, t, i, r) { n(e, t), angular.forEach(a, function (n) { n.addTool(e, t, i, r) }) }, addToolToToolbar: function (e, t, i, r, o) { n(e, t), a[i].addTool(e, t, r, o) }, refreshEditor: function (e) { if (!i[e]) throw 'textAngular Error: No Editor with name "' + e + '" exists'; i[e].scope.updateTaBindtaTextElement(), i[e].scope.$$phase || i[e].scope.$digest() }, sendKeyCommand: function (e, t) { angular.forEach(i, function (n) { if (n.editorFunctions.sendKeyCommand(t)) return e._bUpdateSelectedStyles || e.updateSelectedStyles(), t.preventDefault(), !1 }) } } }]), _.directive("textAngularToolbar", ["$compile", "textAngularManager", "taOptions", "taTools", "taToolExecuteAction", "$window", function (e, t, n, a, i, r) { return { scope: { name: "@" }, restrict: "EA", link: function (o, s, l) { if (!o.name || "" === o.name) throw "textAngular Error: A toolbar requires a name"; angular.extend(o, angular.copy(n)), l.taToolbar && (o.toolbar = o.$parent.$eval(l.taToolbar)), l.taToolbarClass && (o.classes.toolbar = l.taToolbarClass), l.taToolbarGroupClass && (o.classes.toolbarGroup = l.taToolbarGroupClass), l.taToolbarButtonClass && (o.classes.toolbarButton = l.taToolbarButtonClass), l.taToolbarActiveButtonClass && (o.classes.toolbarButtonActive = l.taToolbarActiveButtonClass), l.taFocussedClass && (o.classes.focussed = l.taFocussedClass), o.disabled = !0, o.focussed = !1, o._$element = s, s[0].innerHTML = "", s.addClass("ta-toolbar " + o.classes.toolbar), o.$watch("focussed", function () { o.focussed ? s.addClass(o.classes.focussed) : s.removeClass(o.classes.focussed) }); var c = function (t, n) { var a; if (a = t && t.display ? angular.element(t.display) : angular.element("<button type='button'>"), t && t.class ? a.addClass(t.class) : a.addClass(o.classes.toolbarButton), a.attr("name", n.name), a.attr("ta-button", "ta-button"), a.attr("ng-disabled", "isDisabled()"), a.attr("tabindex", "-1"), a.attr("ng-click", "executeAction()"), a.attr("ng-class", "displayActiveToolClass(active)"), t && t.tooltiptext && a.attr("title", t.tooltiptext), t && !t.display && !n._display && (a[0].innerHTML = "", t.buttontext && (a[0].innerHTML = t.buttontext), t.iconclass)) { var i = angular.element("<i>"), r = a[0].innerHTML; i.addClass(t.iconclass), a[0].innerHTML = "", a.append(i), r && "" !== r && a.append("&nbsp;" + r) } return n._lastToolDefinition = angular.copy(t), e(a)(n) }; o.tools = {}, o._parent = { disabled: !0, showHtml: !1, queryFormatBlockState: function () { return !1 }, queryCommandState: function () { return !1 } }; var d = { $window: r, $editor: function () { return o._parent }, isDisabled: function () { return "function" != typeof this.$eval("disabled") && this.$eval("disabled") || this.$eval("disabled()") || "html" !== this.name && this.$editor().showHtml || this.$parent.disabled || this.$editor().disabled }, displayActiveToolClass: function (e) { return e ? o.classes.toolbarButtonActive : "" }, executeAction: i }; "BDP" === o.toolbar[0][0] ? angular.forEach(o.toolbar, function (e, t) { if (t) { var n = angular.element("<div>"); n.addClass(o.classes.toolbarGroup); var i, r, l = angular.element('<i class="bdp-icon ico-triangle-down">'); "justifyLeft" === e[0] ? (i = angular.element('<div class="pr bdp-icon-wrap">'), i.append('<i class="bdp-icon ico-text-left">')) : "bold" === e[0] && (i = angular.element('<div class="pr bdp-icon-wrap">'), i.append('<i class="bdp-icon ico-text-bold">')), i && (i.append(l), r = angular.element('<ul class="pa dropdown-wrap">')), angular.forEach(e, function (e) { if (o.tools[e] = angular.extend(o.$new(!0), a[e], d, { name: e }), o.tools[e].$element = c(a[e], o.tools[e]), i) { var t = angular.element('<li class="dropdown-item ta-dropdown">'); t.append(o.tools[e].$element), r.append(t) } else n.append(o.tools[e].$element) }), i && (i.append(r), n.append(i)), s.append(n) } }) : angular.forEach(o.toolbar, function (e) { var t = angular.element("<div>"); t.addClass(o.classes.toolbarGroup), angular.forEach(e, function (e) { o.tools[e] = angular.extend(o.$new(!0), a[e], d, { name: e }), o.tools[e].$element = c(a[e], o.tools[e]), t.append(o.tools[e].$element) }), s.append(t) }), o.updateToolDisplay = function (e, t, n) { var a = o.tools[e]; if (a) { if (a._lastToolDefinition && !n && (t = angular.extend({}, a._lastToolDefinition, t)), null === t.buttontext && null === t.iconclass && null === t.display) throw 'textAngular Error: Tool Definition for updating "' + e + '" does not have a valid display/iconclass/buttontext value'; null === t.buttontext && delete t.buttontext, null === t.iconclass && delete t.iconclass, null === t.display && delete t.display; var i = c(t, a); a.$element.replaceWith(i), a.$element = i } }, o.addTool = function (e, t, n, i) { o.tools[e] = angular.extend(o.$new(!0), a[e], d, { name: e }), o.tools[e].$element = c(a[e], o.tools[e]); var r; void 0 === n && (n = o.toolbar.length - 1), r = angular.element(s.children()[n]), void 0 === i ? (r.append(o.tools[e].$element), o.toolbar[n][o.toolbar[n].length - 1] = e) : (r.children().eq(i).after(o.tools[e].$element), o.toolbar[n][i] = e) }, t.registerToolbar(o), o.$on("$destroy", function () { t.unregisterToolbar(o.name) }) } } }])
  }()
}, function (e, t, n) { var a, i, r; !function (o, s) { i = [n(178)], a = o, void 0 !== (r = "function" == typeof a ? a.apply(t, i) : a) && (e.exports = r) }(function (e) { return e.createModule("SaveRestore", ["WrappedRange"], function (e, t) { function n(e, t) { return (t || document).getElementById(e) } function a(e, t) { var n, a = "selectionBoundary_" + +new Date + "_" + ("" + Math.random()).slice(2), i = h.getDocument(e.startContainer), r = e.cloneRange(); return r.collapse(t), n = i.createElement("span"), n.id = a, n.style.lineHeight = "0", n.style.display = "none", n.className = "rangySelectionBoundary", n.appendChild(i.createTextNode(v)), r.insertNode(n), n } function i(e, a, i, r) { var o = n(i, e); o ? (a[r ? "setStartBefore" : "setEndBefore"](o), g(o)) : t.warn("Marker element has been removed. Cannot restore selection.") } function r(e, t) { return t.compareBoundaryPoints(e.START_TO_START, e) } function o(t, n) { var i, r, o = e.DomRange.getRangeDocument(t), s = t.toString(), l = m(n); return t.collapsed ? (r = a(t, !1), { document: o, markerId: r.id, collapsed: !0 }) : (r = a(t, !1), i = a(t, !0), { document: o, startMarkerId: i.id, endMarkerId: r.id, collapsed: !1, backward: l, toString: function () { return "original text: '" + s + "', new text: '" + t.toString() + "'" } }) } function s(a, r) { var o = a.document; void 0 === r && (r = !0); var s = e.createRange(o); if (a.collapsed) { var l = n(a.markerId, o); if (l) { l.style.display = "inline"; var c = l.previousSibling; c && 3 == c.nodeType ? (g(l), s.collapseToPoint(c, c.length)) : (s.collapseBefore(l), g(l)) } else t.warn("Marker element has been removed. Cannot restore selection.") } else i(o, s, a.startMarkerId, !0), i(o, s, a.endMarkerId, !1); return r && s.normalizeBoundaries(), s } function l(t, a) { var i, s, l = [], c = m(a); t = t.slice(0), t.sort(r); for (var d = 0, u = t.length; d < u; ++d)l[d] = o(t[d], c); for (d = u - 1; d >= 0; --d)i = t[d], s = e.DomRange.getRangeDocument(i), i.collapsed ? i.collapseAfter(n(l[d].markerId, s)) : (i.setEndBefore(n(l[d].endMarkerId, s)), i.setStartAfter(n(l[d].startMarkerId, s))); return l } function c(n) { if (!e.isSelectionValid(n)) return t.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."), null; var a = e.getSelection(n), i = a.getAllRanges(), r = 1 == i.length && a.isBackward(), o = l(i, r); return r ? a.setSingleRange(i[0], r) : a.setRanges(i), { win: n, rangeInfos: o, restored: !1 } } function d(e) { for (var t = [], n = e.length, a = n - 1; a >= 0; a--)t[a] = s(e[a], !0); return t } function u(t, n) { if (!t.restored) { var a = t.rangeInfos, i = e.getSelection(t.win), r = d(a); 1 == a.length && n && e.features.selectionHasExtend && a[0].backward ? (i.removeAllRanges(), i.addRange(r[0], !0)) : i.setRanges(r), t.restored = !0 } } function f(e, t) { var a = n(t, e); a && g(a) } function p(e) { for (var t, n = e.rangeInfos, a = 0, i = n.length; a < i; ++a)t = n[a], t.collapsed ? f(e.doc, t.markerId) : (f(e.doc, t.startMarkerId), f(e.doc, t.endMarkerId)) } var h = e.dom, g = h.removeNode, m = e.Selection.isDirectionBackward, v = "\ufeff"; e.util.extend(e, { saveRange: o, restoreRange: s, saveRanges: l, restoreRanges: d, saveSelection: c, restoreSelection: u, removeMarkerElement: f, removeMarkers: p }) }), e }) }, function (e, t) {
  angular.module("textAngularSetup", []).value("taOptions", { forceTextAngularSanitize: !0, keyMappings: [], toolbar: [["h1", "h2", "h3", "h4", "h5", "h6", "p", "pre", "quote"], ["bold", "italics", "underline", "strikeThrough", "ul", "ol", "redo", "undo", "clear"], ["justifyLeft", "justifyCenter", "justifyRight", "justifyFull", "indent", "outdent"], ["html", "insertImage", "insertLink", "insertVideo", "wordcount", "charcount"]], classes: { focussed: "focussed", toolbar: "btn-toolbar", toolbarGroup: "btn-group", toolbarButton: "btn btn-default", toolbarButtonActive: "active", disabled: "disabled", textEditor: "form-control", htmlEditor: "form-control" }, defaultTagAttributes: { a: { target: "" } }, setup: { textEditorSetup: function (e) { }, htmlEditorSetup: function (e) { } }, defaultFileDropHandler: function (e, t) { var n = new FileReader; return "image" === e.type.substring(0, 5) && (n.onload = function () { "" !== n.result && t("insertImage", n.result, !0) }, n.readAsDataURL(e), !0) } }).value("taSelectableElements", ["a", "img"]).value("taCustomRenderers", [{ selector: "img", customAttribute: "ta-insert-video", renderLogic: function (e) { var t = angular.element("<iframe></iframe>"), n = e.prop("attributes"); angular.forEach(n, function (e) { t.attr(e.name, e.value) }), t.attr("src", t.attr("ta-insert-video")), e.replaceWith(t) } }]).value("taTranslations", { zh: { color: "颜色", justify: "对齐", fontSize: "字号", style: "样式", html: { tooltip: "Toggle html / Rich Text" }, heading: { tooltip: "Heading " }, p: { tooltip: "段落" }, pre: { tooltip: "预处理文本" }, ul: { tooltip: "无序列表" }, ol: { tooltip: "有序列表" }, quote: { tooltip: "添加/取消引号" }, undo: { tooltip: "撤销" }, redo: { tooltip: "重做" }, bold: { tooltip: "加粗" }, italic: { tooltip: "斜体" }, underline: { tooltip: "下划线" }, strikeThrough: { tooltip: "删除线" }, justifyLeft: { tooltip: "左对齐" }, justifyRight: { tooltip: "右对齐" }, justifyFull: { tooltip: "两端对齐" }, justifyCenter: { tooltip: "居中对齐" }, indent: { tooltip: "缩进" }, outdent: { tooltip: "取消缩进" }, clear: { tooltip: "清除格式" }, insertImage: { dialogPrompt: "Please enter an image URL to insert", tooltip: "Insert image", hotkey: "the - possibly language dependent hotkey ... for some future implementation" }, insertVideo: { tooltip: "Insert video", dialogPrompt: "Please enter a youtube URL to embed" }, insertLink: { tooltip: "Insert / edit link", dialogPrompt: "Please enter a URL to insert" }, editLink: { reLinkButton: { tooltip: "Relink" }, unLinkButton: { tooltip: "Unlink" }, targetToggle: { buttontext: "Open in New Window" } }, wordcount: { tooltip: "展示词数统计" }, charcount: { tooltip: "展示字符统计" } }, en: { color: "Color", justify: "Justify", fontSize: "FontSize", style: "Style", html: { tooltip: "Toggle html / Rich Text" }, heading: { tooltip: "Heading " }, p: { tooltip: "Paragraph" }, pre: { tooltip: "Preformatted text" }, ul: { tooltip: "Unordered List" }, ol: { tooltip: "Ordered List" }, quote: { tooltip: "Quote/unquote selection or paragraph" }, undo: { tooltip: "Undo" }, redo: { tooltip: "Redo" }, bold: { tooltip: "Bold" }, italic: { tooltip: "Italic" }, underline: { tooltip: "Underline" }, strikeThrough: { tooltip: "Strikethrough" }, justifyLeft: { tooltip: "Align text left" }, justifyRight: { tooltip: "Align text right" }, justifyFull: { tooltip: "Justify text" }, justifyCenter: { tooltip: "Center" }, indent: { tooltip: "Increase indent" }, outdent: { tooltip: "Decrease indent" }, clear: { tooltip: "Clear formatting" }, insertImage: { dialogPrompt: "Please enter an image URL to insert", tooltip: "Insert image", hotkey: "the - possibly language dependent hotkey ... for some future implementation" }, insertVideo: { tooltip: "Insert video", dialogPrompt: "Please enter a youtube URL to embed" }, insertLink: { tooltip: "Insert / edit link", dialogPrompt: "Please enter a URL to insert" }, editLink: { reLinkButton: { tooltip: "Relink" }, unLinkButton: { tooltip: "Unlink" }, targetToggle: { buttontext: "Open in New Window" } }, wordcount: { tooltip: "Display words Count" }, charcount: { tooltip: "Display characters Count" } } }).factory("taToolFunctions", ["$window", "taTranslations", function (e, t) { var n = $.cookie("locale") || "zh"; return { imgOnSelectAction: function (e, t, n) { var a = function () { n.updateTaBindtaTextElement(), n.hidePopover() }; e.preventDefault(), n.displayElements.popover.css("width", "375px"); var i = n.displayElements.popoverContainer; i.empty(); var r = angular.element('<div class="btn-group" style="padding-right: 6px;">'), o = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">100% </button>'); o.on("click", function (e) { e.preventDefault(), t.css({ width: "100%", height: "" }), a() }); var s = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">50% </button>'); s.on("click", function (e) { e.preventDefault(), t.css({ width: "50%", height: "" }), a() }); var l = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">25% </button>'); l.on("click", function (e) { e.preventDefault(), t.css({ width: "25%", height: "" }), a() }); var c = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">Reset</button>'); c.on("click", function (e) { e.preventDefault(), t.css({ width: "", height: "" }), a() }), r.append(o), r.append(s), r.append(l), r.append(c), i.append(r), r = angular.element('<div class="btn-group" style="padding-right: 6px;">'); var d = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-left"></i></button>'); d.on("click", function (e) { e.preventDefault(), t.css("float", "left"), t.css("cssFloat", "left"), t.css("styleFloat", "left"), a() }); var u = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-right"></i></button>'); u.on("click", function (e) { e.preventDefault(), t.css("float", "right"), t.css("cssFloat", "right"), t.css("styleFloat", "right"), a() }); var f = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-justify"></i></button>'); f.on("click", function (e) { e.preventDefault(), t.css("float", ""), t.css("cssFloat", ""), t.css("styleFloat", ""), a() }), r.append(d), r.append(f), r.append(u), i.append(r), r = angular.element('<div class="btn-group">'); var p = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-trash-o"></i></button>'); p.on("click", function (e) { e.preventDefault(), t.remove(), a() }), r.append(p), i.append(r), n.showPopover(t), n.showResizeOverlay(t) }, aOnSelectAction: function (a, i, r) { a.preventDefault(), r.displayElements.popover.css("width", "436px"); var o = r.displayElements.popoverContainer; o.empty(), o.css("line-height", "28px"); var s = angular.element('<a href="' + i.attr("href") + '" target="_blank">' + i.attr("href") + "</a>"); s.css({ display: "inline-block", "max-width": "200px", overflow: "hidden", "text-overflow": "ellipsis", "white-space": "nowrap", "vertical-align": "middle" }), o.append(s); var l = angular.element('<div class="btn-group pull-right">'), c = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="' + t[n].editLink.reLinkButton.tooltip + '"><i class="fa fa-edit icon-edit"></i></button>'); c.on("click", function (a) { a.preventDefault(); var o = e.prompt(t[n].insertLink.dialogPrompt, i.attr("href")); o && "" !== o && "http://" !== o && (i.attr("href", o), r.updateTaBindtaTextElement()), r.hidePopover() }), l.append(c); var d = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="' + t[n].editLink.unLinkButton.tooltip + '"><i class="fa fa-unlink icon-unlink"></i></button>'); d.on("click", function (e) { e.preventDefault(), i.replaceWith(i.contents()), r.updateTaBindtaTextElement(), r.hidePopover() }), l.append(d); var u = angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on">' + t[n].editLink.targetToggle.buttontext + "</button>"); "_blank" === i.attr("target") && u.addClass("active"), u.on("click", function (e) { e.preventDefault(), i.attr("target", "_blank" === i.attr("target") ? "" : "_blank"), u.toggleClass("active"), r.updateTaBindtaTextElement() }), l.append(u), o.append(l), r.showPopover(i) }, extractYoutubeVideoId: function (e) { var t = e.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/i); return t && t[1] || null } } }]).run(["taRegisterTool", "$window", "taTranslations", "taSelection", "taToolFunctions", "$sanitize", "taOptions", function (e, t, n, a, i, r, o) {
    var s = {}; if (r("", s), o.forceTextAngularSanitize === !0 && "taSanitize" !== s.version) throw angular.$$minErr("textAngular")("textAngularSetup", "The textAngular-sanitize provider has been replaced by another -- have you included angular-sanitize by mistake?"); var l = $.cookie("locale") || "zh"; e("html", { iconclass: "fa fa-code", tooltiptext: n[l].html.tooltip, action: function () { this.$editor().switchView() }, activeState: function () { return this.$editor().showHtml } }); var c = function (e) { return function () { return this.$editor().queryFormatBlockState(e) } }, d = function () { return this.$editor().wrapSelection("formatBlock", "<" + this.name.toUpperCase() + ">") }; e("pre", { buttontext: "pre", tooltiptext: n[l].pre.tooltip, action: function () { return this.$editor().wrapSelection("formatBlock", "<PRE>") }, activeState: function () { return this.$editor().queryFormatBlockState("pre") } }), e("ul", { iconclass: "fa fa-list-ul", tooltiptext: n[l].ul.tooltip, action: function () { return this.$editor().wrapSelection("insertUnorderedList", null) }, activeState: function () { return this.$editor().queryCommandState("insertUnorderedList") } }), e("ol", { iconclass: "fa fa-list-ol", tooltiptext: n[l].ol.tooltip, action: function () { return this.$editor().wrapSelection("insertOrderedList", null) }, activeState: function () { return this.$editor().queryCommandState("insertOrderedList") } }), e("quote", { iconclass: "fa fa-quote-right", tooltiptext: n[l].quote.tooltip, action: function () { return this.$editor().wrapSelection("formatBlock", "<BLOCKQUOTE>") }, activeState: function () { return this.$editor().queryFormatBlockState("blockquote") } }), e("undo", { iconclass: "fa fa-undo", tooltiptext: n[l].undo.tooltip, action: function () { return this.$editor().wrapSelection("undo", null) } }), e("redo", { iconclass: "fa fa-repeat", tooltiptext: n[l].redo.tooltip, action: function () { return this.$editor().wrapSelection("redo", null) } }), e("indent", { iconclass: "fa fa-indent", tooltiptext: n[l].indent.tooltip, action: function () { return this.$editor().wrapSelection("indent", null) }, activeState: function () { return this.$editor().queryFormatBlockState("blockquote") }, commandKeyCode: "TabKey" }), e("outdent", { iconclass: "fa fa-outdent", tooltiptext: n[l].outdent.tooltip, action: function () { return this.$editor().wrapSelection("outdent", null) }, activeState: function () { return !1 }, commandKeyCode: "ShiftTabKey" }), e("clear", { iconclass: "fa fa-ban", tooltiptext: n[l].clear.tooltip, action: function (e, t) { var n; this.$editor().wrapSelection("removeFormat", null); var i = angular.element(a.getSelectionElement()), r = function (e) { e = angular.element(e); var t = e; angular.forEach(e.children(), function (e) { var n = angular.element("<p></p>"); n.html(angular.element(e).html()), t.after(n), t = n }), e.remove() }; if (angular.forEach(i.find("ul"), r), angular.forEach(i.find("ol"), r), "li" === i[0].tagName.toLowerCase()) { var o = i[0].parentNode.childNodes, s = [], l = [], c = !1; for (n = 0; n < o.length; n++)o[n] === i[0] ? c = !0 : c ? l.push(o[n]) : s.push(o[n]); var d = angular.element(i[0].parentNode), u = angular.element("<p></p>"); if (u.html(angular.element(i[0]).html()), 0 === s.length || 0 === l.length) 0 === l.length ? d.after(u) : d[0].parentNode.insertBefore(u[0], d[0]), 0 === s.length && 0 === l.length ? d.remove() : angular.element(i[0]).remove(); else { var f = angular.element("<" + d[0].tagName + "></" + d[0].tagName + ">"), p = angular.element("<" + d[0].tagName + "></" + d[0].tagName + ">"); for (n = 0; n < s.length; n++)f.append(angular.element(s[n])); for (n = 0; n < l.length; n++)p.append(angular.element(l[n])); d.after(p), d.after(u), d.after(f), d.remove() } a.setSelectionToElementEnd(u[0]) } var h = this.$editor(), g = function (e) { e = angular.element(e), e[0] !== h.displayElements.text[0] && e.removeAttr("class"), angular.forEach(e.children(), g) }; angular.forEach(i, g), "li" !== i[0].tagName.toLowerCase() && "ol" !== i[0].tagName.toLowerCase() && "ul" !== i[0].tagName.toLowerCase() && this.$editor().wrapSelection("formatBlock", "default"), t() } }), e("insertImage", { iconclass: "fa fa-picture-o", tooltiptext: n[l].insertImage.tooltip, action: function () { var e; if ((e = t.prompt(n[l].insertImage.dialogPrompt, "http://")) && "" !== e && "http://" !== e) return this.$editor().wrapSelection("insertImage", e, !0) }, onElementSelect: { element: "img", action: i.imgOnSelectAction } }), e("insertVideo", { iconclass: "fa fa-youtube-play", tooltiptext: n[l].insertVideo.tooltip, action: function () { var e; if ((e = t.prompt(n[l].insertVideo.dialogPrompt, "https://")) && "" !== e && "https://" !== e && (videoId = i.extractYoutubeVideoId(e), videoId)) { var a = "https://www.youtube.com/embed/" + videoId, r = '<img class="ta-insert-video" src="https://img.youtube.com/vi/' + videoId + '/hqdefault.jpg" ta-insert-video="' + a + '" contenteditable="false" allowfullscreen="true" frameborder="0" />'; return this.$editor().wrapSelection("insertHTML", r, !0) } }, onElementSelect: { element: "img", onlyWithAttrs: ["ta-insert-video"], action: i.imgOnSelectAction } }), e("insertLink", { tooltiptext: n[l].insertLink.tooltip, iconclass: "fa fa-link", action: function () { var e; if ((e = t.prompt(n[l].insertLink.dialogPrompt, "http://")) && "" !== e && "http://" !== e) return this.$editor().wrapSelection("createLink", e, !0) }, activeState: function (e) { return !!e && "A" === e[0].tagName }, onElementSelect: { element: "a", action: i.aOnSelectAction } }), e("wordcount", { display: '<div id="toolbarWC" style="display:block; min-width:100px;">Words: <span ng-bind="wordcount"></span></div>', disabled: !0, wordcount: 0, activeState: function () { var e = this.$editor().displayElements.text, t = e[0].innerHTML || "", n = 0; return "" !== t.replace(/\s*<[^>]*?>\s*/g, "") && (n = t.replace(/<\/?(b|i|em|strong|span|u|strikethrough|a|img|small|sub|sup|label)( [^>*?])?>/gi, "").replace(/(<[^>]*?>\s*<[^>]*?>)/gi, " ").replace(/(<[^>]*?>)/gi, "").replace(/\s+/gi, " ").match(/\S+/g).length), this.wordcount = n, this.$editor().wordcount = n, !1 } }), e("charcount", { display: '<div id="toolbarCC" style="display:block; min-width:120px;">Characters: <span ng-bind="charcount"></span></div>', disabled: !0, charcount: 0, activeState: function () { var e = this.$editor().displayElements.text, t = e[0].innerText || e[0].textContent, n = t.replace(/(\r\n|\n|\r)/gm, "").replace(/^\s+/g, " ").replace(/\s+$/g, " ").length; return this.charcount = n, this.$editor().charcount = n, !1 } }), angular.forEach(["h1", "h2", "h3", "h4", "h5", "h6"], function (t) { e(t.toLowerCase(), { buttontext: t.toUpperCase(), tooltiptext: n[l].heading.tooltip + t.charAt(1), action: d, activeState: c(t.toLowerCase()) }) }), e("p", { buttontext: "P", tooltiptext: n[l].p.tooltip, action: function () { return this.$editor().wrapSelection("formatBlock", "<P>") }, activeState: function () { return this.$editor().queryFormatBlockState("p") } }), e("bold", { display: '<a class="ta-item"><i class="bdp-icon ico-text-bold"></i>' + n[l].bold.tooltip + "</a>", tooltiptext: n[l].bold.tooltip, action: function () { return this.$editor().wrapSelection("bold", null) }, activeState: function () { return this.$editor().queryCommandState("bold") }, commandKeyCode: 98 }), e("justifyRight", { display: '<a class="ta-item"><i class="bdp-icon ico-text-right"></i>' + n[l].justifyRight.tooltip + "</a>", tooltiptext: n[l].justifyRight.tooltip, action: function () { return this.$editor().wrapSelection("justifyRight", null) }, activeState: function (e) { if (e && "#document" === e.nodeName) return !1; var t = !1; return e && (t = "right" === e.css("text-align")), t = t || this.$editor().queryCommandState("justifyRight") } }), e("justifyFull", { display: '<a class="ta-item"><i class="bdp-icon ico-text-justify"></i>' + n[l].justifyFull.tooltip + "</a>", tooltiptext: n[l].justifyFull.tooltip, action: function () { return this.$editor().wrapSelection("justifyFull", null) }, activeState: function (e) { var t = !1; return e && (t = "justify" === e.css("text-align")), t = t || this.$editor().queryCommandState("justifyFull") } }), e("justifyCenter", { display: '<a class="ta-item"><i class="bdp-icon ico-text-center"></i>' + n[l].justifyCenter.tooltip + "</a>", tooltiptext: n[l].justifyCenter.tooltip, action: function () { return this.$editor().wrapSelection("justifyCenter", null) }, activeState: function (e) { if (e && "#document" === e.nodeName) return !1; var t = !1; return e && (t = "center" === e.css("text-align")), t = t || this.$editor().queryCommandState("justifyCenter") } }), e("justifyLeft", { display: '<a class="ta-item"><i class="bdp-icon ico-text-left"></i>' + n[l].justifyLeft.tooltip + "</a>", tooltiptext: n[l].justifyLeft.tooltip, action: function () { return this.$editor().wrapSelection("justifyLeft", null) }, activeState: function (e) { if (e && "#document" === e.nodeName) return !1; var t = !1; return e && (t = "left" === e.css("text-align") || "left" === e.attr("align") || "right" !== e.css("text-align") && "center" !== e.css("text-align") && "justify" !== e.css("text-align") && !this.$editor().queryCommandState("justifyRight") && !this.$editor().queryCommandState("justifyCenter") && !this.$editor().queryCommandState("justifyFull")), t = t || this.$editor().queryCommandState("justifyLeft") } }), e("italics", { display: '<a class="ta-item"><i class="bdp-icon ico-text-italic"></i>' + n[l].italic.tooltip + "</a>", tooltiptext: n[l].italic.tooltip, action: function () { return this.$editor().wrapSelection("italic", null) }, activeState: function () { return this.$editor().queryCommandState("italic") }, commandKeyCode: 105 }), e("underline", { display: '<a class="ta-item"><i class="bdp-icon ico-text-underline"></i>' + n[l].underline.tooltip + "</a>", tooltiptext: n[l].underline.tooltip, action: function () { return this.$editor().wrapSelection("underline", null) }, activeState: function () { return this.$editor().queryCommandState("underline") }, commandKeyCode: 117 }), e("strikeThrough", { display: '<a class="ta-item"><i class="bdp-icon ico-text-strikethrough"></i>' + n[l].strikeThrough.tooltip + "</a>", tooltiptext: n[l].strikeThrough.tooltip, action: function () { return this.$editor().wrapSelection("strikeThrough", null) }, activeState: function () { return document.queryCommandState("strikeThrough") } }), e("pureTextColor", { display: '<span class="ta-toolbar-head">' + n[l].color + "</span>", action: function () { return !1 } }), e("pureTextFontSize", { display: '<span class="ta-toolbar-head">' + n[l].fontSize + "</span>", action: function () { return !1 } }), e("pureTextJustify", { display: '<span class="ta-toolbar-head">' + n[l].justify + "</span>", action: function () { return !1 } }), e("pureTextStyle", { display: '<span class="ta-toolbar-head">' + n[l].style + "</span>", action: function () { return !1 } }), e("fontColor", {
      display: "<color-picker ng-model='color' on-change='action(color)'></color-picker>", action: function (e) { var t = this; if (this.$editor().wrapSelection) return this.$editor().wrapSelection("foreColor", e); setTimeout(function () { t.action(e) }, 100) }, activeState: function (e) { if (e && "#document" === e.nodeName) return !1; var t = !1; e && (t = e.css("color") || "#666"), this.color = t },
      color: "#666"
    }), e("fontSize", { display: "<div class='pr bdp-icon-wrap font-size-wrap'><i class='bdp-icon ico-text-size'></i><i class='bdp-icon ico-triangle-down'></i><ul class='pa dropdown-wrap'><li ng-repeat='o in options' class='dropdown-item'><a ng-click='action($event, o.fontSize)' ng-class='{\"active\":curSize == o.value}'> {{o.name}}</a></li></ul></div>", show: !1, action: function (e, t) { var t = t ? parseInt(t) : 1; return this.$editor().wrapSelection("fontSize", t) }, options: [{ name: "12px", value: 12, fontSize: 1 }, { name: "13px", value: 13, fontSize: 2 }, { name: "16px", value: 16, fontSize: 3 }, { name: "18px", value: 18, fontSize: 4 }, { name: "24px", value: 24, fontSize: 5 }, { name: "32px", value: 32, fontSize: 6 }, { name: "48px", value: 48, fontSize: 7 }], activeState: function (e) { if (e && "#document" === e.nodeName) return !1; var t = "14px"; e && (t = e.css("fontSize") || "12px"), this.curSize = t.split("px")[0] } })
  }])
}, function (e, t, n) { n(289).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "textAngular_99bb5b74.css" }, function (e, t, n) { e.exports = "angular-slick", n(291), n(293) }, function (e, t, n) {
  var a, i, r; !function (o) { "use strict"; i = [n(292)], a = o, void 0 !== (r = "function" == typeof a ? a.apply(t, i) : a) && (e.exports = r) }(function (e) {
    "use strict"; var t = window.Slick || {}; t = function () { function t(t, a) { var i, r, o, s = this; if (s.defaults = { accessibility: !0, adaptiveHeight: !1, appendArrows: e(t), appendDots: e(t), arrows: !0, asNavFor: null, prevArrow: '<button type="button" data-role="none" class="slick-prev" aria-label="previous">Previous</button>', nextArrow: '<button type="button" data-role="none" class="slick-next" aria-label="next">Next</button>', autoplay: !1, autoplaySpeed: 3e3, centerMode: !1, centerPadding: "50px", cssEase: "ease", customPaging: function (e, t) { return '<button type="button" data-role="none">' + (t + 1) + "</button>" }, dots: !1, dotsClass: "slick-dots", draggable: !0, easing: "linear", edgeFriction: .35, fade: !1, focusOnSelect: !1, infinite: !0, initialSlide: 0, lazyLoad: "ondemand", mobileFirst: !1, pauseOnHover: !0, pauseOnDotsHover: !1, respondTo: "window", responsive: null, rtl: !1, slide: "", slidesToShow: 1, slidesToScroll: 1, speed: 500, swipe: !0, swipeToSlide: !1, touchMove: !0, touchThreshold: 5, useCSS: !0, variableWidth: !1, vertical: !1, waitForAnimate: !0 }, s.initials = { animating: !1, dragging: !1, autoPlayTimer: null, currentDirection: 0, currentLeft: null, currentSlide: 0, direction: 1, $dots: null, listWidth: null, listHeight: null, loadIndex: 0, $nextArrow: null, $prevArrow: null, slideCount: null, slideWidth: null, $slideTrack: null, $slides: null, sliding: !1, slideOffset: 0, swipeLeft: null, $list: null, touchObject: {}, transformsEnabled: !1 }, e.extend(s, s.initials), s.activeBreakpoint = null, s.animType = null, s.animProp = null, s.breakpoints = [], s.breakpointSettings = [], s.cssTransitions = !1, s.hidden = "hidden", s.paused = !1, s.positionProp = null, s.respondTo = null, s.shouldClick = !0, s.$slider = e(t), s.$slidesCache = null, s.transformType = null, s.transitionType = null, s.visibilityChange = "visibilitychange", s.windowWidth = 0, s.windowTimer = null, i = e(t).data("slick") || {}, s.options = e.extend({}, s.defaults, i, a), s.currentSlide = s.options.initialSlide, s.originalSettings = s.options, (r = s.options.responsive || null) && r.length > -1) { s.respondTo = s.options.respondTo || "window"; for (o in r) r.hasOwnProperty(o) && (s.breakpoints.push(r[o].breakpoint), s.breakpointSettings[r[o].breakpoint] = r[o].settings); s.breakpoints.sort(function (e, t) { return s.options.mobileFirst === !0 ? e - t : t - e }) } void 0 !== document.mozHidden ? (s.hidden = "mozHidden", s.visibilityChange = "mozvisibilitychange") : void 0 !== document.msHidden ? (s.hidden = "msHidden", s.visibilityChange = "msvisibilitychange") : void 0 !== document.webkitHidden && (s.hidden = "webkitHidden", s.visibilityChange = "webkitvisibilitychange"), s.autoPlay = e.proxy(s.autoPlay, s), s.autoPlayClear = e.proxy(s.autoPlayClear, s), s.changeSlide = e.proxy(s.changeSlide, s), s.clickHandler = e.proxy(s.clickHandler, s), s.selectHandler = e.proxy(s.selectHandler, s), s.setPosition = e.proxy(s.setPosition, s), s.swipeHandler = e.proxy(s.swipeHandler, s), s.dragHandler = e.proxy(s.dragHandler, s), s.keyHandler = e.proxy(s.keyHandler, s), s.autoPlayIterator = e.proxy(s.autoPlayIterator, s), s.instanceUid = n++, s.htmlExpr = /^(?:\s*(<[\w\W]+>)[^>]*)$/, s.init(), s.checkResponsive(!0) } var n = 0; return t }(), t.prototype.addSlide = t.prototype.slickAdd = function (t, n, a) { var i = this; if ("boolean" == typeof n) a = n, n = null; else if (n < 0 || n >= i.slideCount) return !1; i.unload(), "number" == typeof n ? 0 === n && 0 === i.$slides.length ? e(t).appendTo(i.$slideTrack) : a ? e(t).insertBefore(i.$slides.eq(n)) : e(t).insertAfter(i.$slides.eq(n)) : a === !0 ? e(t).prependTo(i.$slideTrack) : e(t).appendTo(i.$slideTrack), i.$slides = i.$slideTrack.children(this.options.slide), i.$slideTrack.children(this.options.slide).detach(), i.$slideTrack.append(i.$slides), i.$slides.each(function (t, n) { e(n).attr("data-slick-index", t) }), i.$slidesCache = i.$slides, i.reinit() }, t.prototype.animateHeight = function () { var e = this; if (1 === e.options.slidesToShow && e.options.adaptiveHeight === !0 && e.options.vertical === !1) { var t = e.$slides.eq(e.currentSlide).outerHeight(!0); e.$list.animate({ height: t }, e.options.speed) } }, t.prototype.animateSlide = function (t, n) { var a = {}, i = this; i.animateHeight(), i.options.rtl === !0 && i.options.vertical === !1 && (t = -t), i.transformsEnabled === !1 ? i.options.vertical === !1 ? i.$slideTrack.animate({ left: t }, i.options.speed, i.options.easing, n) : i.$slideTrack.animate({ top: t }, i.options.speed, i.options.easing, n) : i.cssTransitions === !1 ? (i.options.rtl === !0 && (i.currentLeft = -i.currentLeft), e({ animStart: i.currentLeft }).animate({ animStart: t }, { duration: i.options.speed, easing: i.options.easing, step: function (e) { e = Math.ceil(e), i.options.vertical === !1 ? (a[i.animType] = "translate(" + e + "px, 0px)", i.$slideTrack.css(a)) : (a[i.animType] = "translate(0px," + e + "px)", i.$slideTrack.css(a)) }, complete: function () { n && n.call() } })) : (i.applyTransition(), t = Math.ceil(t), i.options.vertical === !1 ? a[i.animType] = "translate3d(" + t + "px, 0px, 0px)" : a[i.animType] = "translate3d(0px," + t + "px, 0px)", i.$slideTrack.css(a), n && setTimeout(function () { i.disableTransition(), n.call() }, i.options.speed)) }, t.prototype.asNavFor = function (t) { var n = this, a = null !== n.options.asNavFor ? e(n.options.asNavFor).slick("getSlick") : null; null !== a && a.slideHandler(t, !0) }, t.prototype.applyTransition = function (e) { var t = this, n = {}; t.options.fade === !1 ? n[t.transitionType] = t.transformType + " " + t.options.speed + "ms " + t.options.cssEase : n[t.transitionType] = "opacity " + t.options.speed + "ms " + t.options.cssEase, t.options.fade === !1 ? t.$slideTrack.css(n) : t.$slides.eq(e).css(n) }, t.prototype.autoPlay = function () { var e = this; e.autoPlayTimer && clearInterval(e.autoPlayTimer), e.slideCount > e.options.slidesToShow && e.paused !== !0 && (e.autoPlayTimer = setInterval(e.autoPlayIterator, e.options.autoplaySpeed)) }, t.prototype.autoPlayClear = function () { var e = this; e.autoPlayTimer && clearInterval(e.autoPlayTimer) }, t.prototype.autoPlayIterator = function () { var e = this; e.options.infinite === !1 ? 1 === e.direction ? (e.currentSlide + 1 === e.slideCount - 1 && (e.direction = 0), e.slideHandler(e.currentSlide + e.options.slidesToScroll)) : (e.currentSlide - 1 == 0 && (e.direction = 1), e.slideHandler(e.currentSlide - e.options.slidesToScroll)) : e.slideHandler(e.currentSlide + e.options.slidesToScroll) }, t.prototype.buildArrows = function () { var t = this; t.options.arrows === !0 && t.slideCount > t.options.slidesToShow && (t.$prevArrow = e(t.options.prevArrow), t.$nextArrow = e(t.options.nextArrow), t.htmlExpr.test(t.options.prevArrow) && t.$prevArrow.appendTo(t.options.appendArrows), t.htmlExpr.test(t.options.nextArrow) && t.$nextArrow.appendTo(t.options.appendArrows), t.options.infinite !== !0 && t.$prevArrow.addClass("slick-disabled")) }, t.prototype.buildDots = function () { var t, n, a = this; if (a.options.dots === !0 && a.slideCount > a.options.slidesToShow) { for (n = '<ul class="' + a.options.dotsClass + '">', t = 0; t <= a.getDotCount(); t += 1)n += "<li>" + a.options.customPaging.call(this, a, t) + "</li>"; n += "</ul>", a.$dots = e(n).appendTo(a.options.appendDots), a.$dots.find("li").first().addClass("slick-active").attr("aria-hidden", "false") } }, t.prototype.buildOut = function () { var t = this; t.$slides = t.$slider.children(t.options.slide + ":not(.slick-cloned)").addClass("slick-slide"), t.slideCount = t.$slides.length, t.$slides.each(function (t, n) { e(n).attr("data-slick-index", t) }), t.$slidesCache = t.$slides, t.$slider.addClass("slick-slider"), t.$slideTrack = 0 === t.slideCount ? e('<div class="slick-track"/>').appendTo(t.$slider) : t.$slides.wrapAll('<div class="slick-track"/>').parent(), t.$list = t.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent(), t.$slideTrack.css("opacity", 0), t.options.centerMode !== !0 && t.options.swipeToSlide !== !0 || (t.options.slidesToScroll = 1), e("img[data-lazy]", t.$slider).not("[src]").addClass("slick-loading"), t.setupInfinite(), t.buildArrows(), t.buildDots(), t.updateDots(), t.options.accessibility === !0 && t.$list.prop("tabIndex", 0), t.setSlideClasses("number" == typeof this.currentSlide ? this.currentSlide : 0), t.options.draggable === !0 && t.$list.addClass("draggable") }, t.prototype.checkResponsive = function (t) { var n, a, i, r = this, o = r.$slider.width(), s = window.innerWidth || e(window).width(); if ("window" === r.respondTo ? i = s : "slider" === r.respondTo ? i = o : "min" === r.respondTo && (i = Math.min(s, o)), r.originalSettings.responsive && r.originalSettings.responsive.length > -1 && null !== r.originalSettings.responsive) { a = null; for (n in r.breakpoints) r.breakpoints.hasOwnProperty(n) && (r.originalSettings.mobileFirst === !1 ? i < r.breakpoints[n] && (a = r.breakpoints[n]) : i > r.breakpoints[n] && (a = r.breakpoints[n])); null !== a ? null !== r.activeBreakpoint ? a !== r.activeBreakpoint && (r.activeBreakpoint = a, "unslick" === r.breakpointSettings[a] ? r.unslick() : (r.options = e.extend({}, r.originalSettings, r.breakpointSettings[a]), t === !0 && (r.currentSlide = r.options.initialSlide), r.refresh())) : (r.activeBreakpoint = a, "unslick" === r.breakpointSettings[a] ? r.unslick() : (r.options = e.extend({}, r.originalSettings, r.breakpointSettings[a]), t === !0 && (r.currentSlide = r.options.initialSlide), r.refresh())) : null !== r.activeBreakpoint && (r.activeBreakpoint = null, r.options = r.originalSettings, t === !0 && (r.currentSlide = r.options.initialSlide), r.refresh()) } }, t.prototype.changeSlide = function (t, n) { var a, i, r, o = this, s = e(t.target); switch (s.is("a") && t.preventDefault(), r = o.slideCount % o.options.slidesToScroll != 0, a = r ? 0 : (o.slideCount - o.currentSlide) % o.options.slidesToScroll, t.data.message) { case "previous": i = 0 === a ? o.options.slidesToScroll : o.options.slidesToShow - a, o.slideCount > o.options.slidesToShow && o.slideHandler(o.currentSlide - i, !1, n); break; case "next": i = 0 === a ? o.options.slidesToScroll : a, o.slideCount > o.options.slidesToShow && o.slideHandler(o.currentSlide + i, !1, n); break; case "index": var l = 0 === t.data.index ? 0 : t.data.index || e(t.target).parent().index() * o.options.slidesToScroll; o.slideHandler(o.checkNavigable(l), !1, n); break; default: return } }, t.prototype.checkNavigable = function (e) { var t, n, a = this; if (t = a.getNavigableIndexes(), n = 0, e > t[t.length - 1]) e = t[t.length - 1]; else for (var i in t) { if (e < t[i]) { e = n; break } n = t[i] } return e }, t.prototype.clickHandler = function (e) { this.shouldClick === !1 && (e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault()) }, t.prototype.destroy = function () { var t = this; t.autoPlayClear(), t.touchObject = {}, e(".slick-cloned", t.$slider).remove(), t.$dots && t.$dots.remove(), t.$prevArrow && "object" != typeof t.options.prevArrow && t.$prevArrow.remove(), t.$nextArrow && "object" != typeof t.options.nextArrow && t.$nextArrow.remove(), t.$slides.removeClass("slick-slide slick-active slick-center slick-visible").attr("aria-hidden", "true").removeAttr("data-slick-index").css({ position: "", left: "", top: "", zIndex: "", opacity: "", width: "" }), t.$slider.removeClass("slick-slider"), t.$slider.removeClass("slick-initialized"), t.$list.off(".slick"), e(window).off(".slick-" + t.instanceUid), e(document).off(".slick-" + t.instanceUid), t.$slider.html(t.$slides) }, t.prototype.disableTransition = function (e) { var t = this, n = {}; n[t.transitionType] = "", t.options.fade === !1 ? t.$slideTrack.css(n) : t.$slides.eq(e).css(n) }, t.prototype.fadeSlide = function (e, t) { var n = this; n.cssTransitions === !1 ? (n.$slides.eq(e).css({ zIndex: 1e3 }), n.$slides.eq(e).animate({ opacity: 1 }, n.options.speed, n.options.easing, t)) : (n.applyTransition(e), n.$slides.eq(e).css({ opacity: 1, zIndex: 1e3 }), t && setTimeout(function () { n.disableTransition(e), t.call() }, n.options.speed)) }, t.prototype.filterSlides = t.prototype.slickFilter = function (e) { var t = this; null !== e && (t.unload(), t.$slideTrack.children(this.options.slide).detach(), t.$slidesCache.filter(e).appendTo(t.$slideTrack), t.reinit()) }, t.prototype.getCurrent = t.prototype.slickCurrentSlide = function () { return this.currentSlide }, t.prototype.getDotCount = function () { var e = this, t = 0, n = 0, a = 0; if (e.options.infinite === !0) a = Math.ceil(e.slideCount / e.options.slidesToScroll); else if (e.options.centerMode === !0) a = e.slideCount; else for (; t < e.slideCount;)++a, t = n + e.options.slidesToShow, n += e.options.slidesToScroll <= e.options.slidesToShow ? e.options.slidesToScroll : e.options.slidesToShow; return a - 1 }, t.prototype.getLeft = function (e) { var t, n, a, i = this, r = 0; return i.slideOffset = 0, n = i.$slides.first().outerHeight(), i.options.infinite === !0 ? (i.slideCount > i.options.slidesToShow && (i.slideOffset = i.slideWidth * i.options.slidesToShow * -1, r = n * i.options.slidesToShow * -1), i.slideCount % i.options.slidesToScroll != 0 && e + i.options.slidesToScroll > i.slideCount && i.slideCount > i.options.slidesToShow && (e > i.slideCount ? (i.slideOffset = (i.options.slidesToShow - (e - i.slideCount)) * i.slideWidth * -1, r = (i.options.slidesToShow - (e - i.slideCount)) * n * -1) : (i.slideOffset = i.slideCount % i.options.slidesToScroll * i.slideWidth * -1, r = i.slideCount % i.options.slidesToScroll * n * -1))) : e + i.options.slidesToShow > i.slideCount && (i.slideOffset = (e + i.options.slidesToShow - i.slideCount) * i.slideWidth, r = (e + i.options.slidesToShow - i.slideCount) * n), i.slideCount <= i.options.slidesToShow && (i.slideOffset = 0, r = 0), i.options.centerMode === !0 && i.options.infinite === !0 ? i.slideOffset += i.slideWidth * Math.floor(i.options.slidesToShow / 2) - i.slideWidth : i.options.centerMode === !0 && (i.slideOffset = 0, i.slideOffset += i.slideWidth * Math.floor(i.options.slidesToShow / 2)), t = i.options.vertical === !1 ? e * i.slideWidth * -1 + i.slideOffset : e * n * -1 + r, i.options.variableWidth === !0 && (a = i.slideCount <= i.options.slidesToShow || i.options.infinite === !1 ? i.$slideTrack.children(".slick-slide").eq(e) : i.$slideTrack.children(".slick-slide").eq(e + i.options.slidesToShow), t = a[0] ? a[0].offsetLeft * -1 : 0, i.options.centerMode === !0 && (a = i.options.infinite === !1 ? i.$slideTrack.children(".slick-slide").eq(e) : i.$slideTrack.children(".slick-slide").eq(e + i.options.slidesToShow + 1), t = a[0] ? a[0].offsetLeft * -1 : 0, t += (i.$list.width() - a.outerWidth()) / 2)), t }, t.prototype.getOption = t.prototype.slickGetOption = function (e) { return this.options[e] }, t.prototype.getNavigableIndexes = function () { var e, t = this, n = 0, a = 0, i = []; for (t.options.infinite === !1 ? (e = t.slideCount - t.options.slidesToShow + 1, t.options.centerMode === !0 && (e = t.slideCount)) : (n = t.slideCount * -1, a = t.slideCount * -1, e = 2 * t.slideCount); n < e;)i.push(n), n = a + t.options.slidesToScroll, a += t.options.slidesToScroll <= t.options.slidesToShow ? t.options.slidesToScroll : t.options.slidesToShow; return i }, t.prototype.getSlick = function () { return this }, t.prototype.getSlideCount = function () { var t, n, a = this; return n = a.options.centerMode === !0 ? a.slideWidth * Math.floor(a.options.slidesToShow / 2) : 0, a.options.swipeToSlide === !0 ? (a.$slideTrack.find(".slick-slide").each(function (i, r) { if (r.offsetLeft - n + e(r).outerWidth() / 2 > a.swipeLeft * -1) return t = r, !1 }), Math.abs(e(t).attr("data-slick-index") - a.currentSlide) || 1) : a.options.slidesToScroll }, t.prototype.goTo = t.prototype.slickGoTo = function (e, t) { this.changeSlide({ data: { message: "index", index: parseInt(e) } }, t) }, t.prototype.init = function () { var t = this; e(t.$slider).hasClass("slick-initialized") || (e(t.$slider).addClass("slick-initialized"), t.buildOut(), t.setProps(), t.startLoad(), t.loadSlider(), t.initializeEvents(), t.updateArrows(), t.updateDots()), t.$slider.trigger("init", [t]) }, t.prototype.initArrowEvents = function () { var e = this; e.options.arrows === !0 && e.slideCount > e.options.slidesToShow && (e.$prevArrow.on("click.slick", { message: "previous" }, e.changeSlide), e.$nextArrow.on("click.slick", { message: "next" }, e.changeSlide)) }, t.prototype.initDotEvents = function () { var t = this; t.options.dots === !0 && t.slideCount > t.options.slidesToShow && e("li", t.$dots).on("click.slick", { message: "index" }, t.changeSlide), t.options.dots === !0 && t.options.pauseOnDotsHover === !0 && t.options.autoplay === !0 && e("li", t.$dots).on("mouseenter.slick", function () { t.paused = !0, t.autoPlayClear() }).on("mouseleave.slick", function () { t.paused = !1, t.autoPlay() }) }, t.prototype.initializeEvents = function () { var t = this; t.initArrowEvents(), t.initDotEvents(), t.$list.on("touchstart.slick mousedown.slick", { action: "start" }, t.swipeHandler), t.$list.on("touchmove.slick mousemove.slick", { action: "move" }, t.swipeHandler), t.$list.on("touchend.slick mouseup.slick", { action: "end" }, t.swipeHandler), t.$list.on("touchcancel.slick mouseleave.slick", { action: "end" }, t.swipeHandler), t.$list.on("click.slick", t.clickHandler), t.options.autoplay === !0 && (e(document).on(t.visibilityChange, function () { t.visibility() }), t.options.pauseOnHover === !0 && (t.$list.on("mouseenter.slick", function () { t.paused = !0, t.autoPlayClear() }), t.$list.on("mouseleave.slick", function () { t.paused = !1, t.autoPlay() }))), t.options.accessibility === !0 && t.$list.on("keydown.slick", t.keyHandler), t.options.focusOnSelect === !0 && e(t.$slideTrack).children().on("click.slick", t.selectHandler), e(window).on("orientationchange.slick.slick-" + t.instanceUid, function () { t.checkResponsive(), t.setPosition() }), e(window).on("resize.slick.slick-" + t.instanceUid, function () { e(window).width() !== t.windowWidth && (clearTimeout(t.windowDelay), t.windowDelay = window.setTimeout(function () { t.windowWidth = e(window).width(), t.checkResponsive(), t.setPosition() }, 50)) }), e("*[draggable!=true]", t.$slideTrack).on("dragstart", function (e) { e.preventDefault() }), e(window).on("load.slick.slick-" + t.instanceUid, t.setPosition), e(document).on("ready.slick.slick-" + t.instanceUid, t.setPosition) }, t.prototype.initUI = function () { var e = this; e.options.arrows === !0 && e.slideCount > e.options.slidesToShow && (e.$prevArrow.show(), e.$nextArrow.show()), e.options.dots === !0 && e.slideCount > e.options.slidesToShow && e.$dots.show(), e.options.autoplay === !0 && e.autoPlay() }, t.prototype.keyHandler = function (e) { var t = this; 37 === e.keyCode && t.options.accessibility === !0 ? t.changeSlide({ data: { message: "previous" } }) : 39 === e.keyCode && t.options.accessibility === !0 && t.changeSlide({ data: { message: "next" } }) }, t.prototype.lazyLoad = function () { function t(t) { e("img[data-lazy]", t).each(function () { var t = e(this), n = e(this).attr("data-lazy"); t.load(function () { t.animate({ opacity: 1 }, 200) }).css({ opacity: 0 }).attr("src", n).removeAttr("data-lazy").removeClass("slick-loading") }) } var n, a, i, r, o = this; o.options.centerMode === !0 ? o.options.infinite === !0 ? (i = o.currentSlide + (o.options.slidesToShow / 2 + 1), r = i + o.options.slidesToShow + 2) : (i = Math.max(0, o.currentSlide - (o.options.slidesToShow / 2 + 1)), r = o.options.slidesToShow / 2 + 1 + 2 + o.currentSlide) : (i = o.options.infinite ? o.options.slidesToShow + o.currentSlide : o.currentSlide, r = i + o.options.slidesToShow, o.options.fade === !0 && (i > 0 && i--, r <= o.slideCount && r++)), n = o.$slider.find(".slick-slide").slice(i, r), t(n), o.slideCount <= o.options.slidesToShow ? (a = o.$slider.find(".slick-slide"), t(a)) : o.currentSlide >= o.slideCount - o.options.slidesToShow ? (a = o.$slider.find(".slick-cloned").slice(0, o.options.slidesToShow), t(a)) : 0 === o.currentSlide && (a = o.$slider.find(".slick-cloned").slice(o.options.slidesToShow * -1), t(a)) }, t.prototype.loadSlider = function () { var e = this; e.setPosition(), e.$slideTrack.css({ opacity: 1 }), e.$slider.removeClass("slick-loading"), e.initUI(), "progressive" === e.options.lazyLoad && e.progressiveLazyLoad() }, t.prototype.next = t.prototype.slickNext = function () { this.changeSlide({ data: { message: "next" } }) }, t.prototype.pause = t.prototype.slickPause = function () { var e = this; e.autoPlayClear(), e.paused = !0 }, t.prototype.play = t.prototype.slickPlay = function () { var e = this; e.paused = !1, e.autoPlay() }, t.prototype.postSlide = function (e) { var t = this; t.$slider.trigger("afterChange", [t, e]), t.animating = !1, t.setPosition(), t.swipeLeft = null, t.options.autoplay === !0 && t.paused === !1 && t.autoPlay() }, t.prototype.prev = t.prototype.slickPrev = function () { this.changeSlide({ data: { message: "previous" } }) }, t.prototype.progressiveLazyLoad = function () { var t, n, a = this; (t = e("img[data-lazy]", a.$slider).length) > 0 && (n = e("img[data-lazy]", a.$slider).first(), n.attr("src", n.attr("data-lazy")).removeClass("slick-loading").load(function () { n.removeAttr("data-lazy"), a.progressiveLazyLoad(), a.options.adaptiveHeight === !0 && a.setPosition() }).error(function () { n.removeAttr("data-lazy"), a.progressiveLazyLoad() })) }, t.prototype.refresh = function () { var t = this, n = t.currentSlide; t.destroy(), e.extend(t, t.initials), t.init(), t.changeSlide({ data: { message: "index", index: n } }, !0) }, t.prototype.reinit = function () { var t = this; t.$slides = t.$slideTrack.children(t.options.slide).addClass("slick-slide"), t.slideCount = t.$slides.length, t.currentSlide >= t.slideCount && 0 !== t.currentSlide && (t.currentSlide = t.currentSlide - t.options.slidesToScroll), t.slideCount <= t.options.slidesToShow && (t.currentSlide = 0), t.setProps(), t.setupInfinite(), t.buildArrows(), t.updateArrows(), t.initArrowEvents(), t.buildDots(), t.updateDots(), t.initDotEvents(), t.options.focusOnSelect === !0 && e(t.$slideTrack).children().on("click.slick", t.selectHandler), t.setSlideClasses(0), t.setPosition(), t.$slider.trigger("reInit", [t]) }, t.prototype.removeSlide = t.prototype.slickRemove = function (e, t, n) { var a = this; if ("boolean" == typeof e ? (t = e, e = t === !0 ? 0 : a.slideCount - 1) : e = t === !0 ? --e : e, a.slideCount < 1 || e < 0 || e > a.slideCount - 1) return !1; a.unload(), n === !0 ? a.$slideTrack.children().remove() : a.$slideTrack.children(this.options.slide).eq(e).remove(), a.$slides = a.$slideTrack.children(this.options.slide), a.$slideTrack.children(this.options.slide).detach(), a.$slideTrack.append(a.$slides), a.$slidesCache = a.$slides, a.reinit() }, t.prototype.setCSS = function (e) { var t, n, a = this, i = {}; a.options.rtl === !0 && (e = -e), t = "left" == a.positionProp ? Math.ceil(e) + "px" : "0px", n = "top" == a.positionProp ? Math.ceil(e) + "px" : "0px", i[a.positionProp] = e, a.transformsEnabled === !1 ? a.$slideTrack.css(i) : (i = {}, a.cssTransitions === !1 ? (i[a.animType] = "translate(" + t + ", " + n + ")", a.$slideTrack.css(i)) : (i[a.animType] = "translate3d(" + t + ", " + n + ", 0px)", a.$slideTrack.css(i))) }, t.prototype.setDimensions = function () { var e = this; if (e.options.vertical === !1 ? e.options.centerMode === !0 && e.$list.css({ padding: "0px " + e.options.centerPadding }) : (e.$list.height(e.$slides.first().outerHeight(!0) * e.options.slidesToShow), e.options.centerMode === !0 && e.$list.css({ padding: e.options.centerPadding + " 0px" })), e.listWidth = e.$list.width(), e.listHeight = e.$list.height(), e.options.vertical === !1 && e.options.variableWidth === !1) e.slideWidth = Math.ceil(e.listWidth / e.options.slidesToShow), e.$slideTrack.width(Math.ceil(e.slideWidth * e.$slideTrack.children(".slick-slide").length)); else if (e.options.variableWidth === !0) { var t = 0; e.slideWidth = Math.ceil(e.listWidth / e.options.slidesToShow), e.$slideTrack.children(".slick-slide").each(function () { t += e.listWidth }), e.$slideTrack.width(Math.ceil(t) + 1) } else e.slideWidth = Math.ceil(e.listWidth), e.$slideTrack.height(Math.ceil(e.$slides.first().outerHeight(!0) * e.$slideTrack.children(".slick-slide").length)); var n = e.$slides.first().outerWidth(!0) - e.$slides.first().width(); e.options.variableWidth === !1 && e.$slideTrack.children(".slick-slide").width(e.slideWidth - n) }, t.prototype.setFade = function () { var t, n = this; n.$slides.each(function (a, i) { t = n.slideWidth * a * -1, n.options.rtl === !0 ? e(i).css({ position: "relative", right: t, top: 0, zIndex: 800, opacity: 0 }) : e(i).css({ position: "relative", left: t, top: 0, zIndex: 800, opacity: 0 }) }), n.$slides.eq(n.currentSlide).css({ zIndex: 900, opacity: 1 }) }, t.prototype.setHeight = function () { var e = this; if (1 === e.options.slidesToShow && e.options.adaptiveHeight === !0 && e.options.vertical === !1) { var t = e.$slides.eq(e.currentSlide).outerHeight(!0); e.$list.css("height", t) } }, t.prototype.setOption = t.prototype.slickSetOption = function (e, t, n) { var a = this; a.options[e] = t, n === !0 && (a.unload(), a.reinit()) }, t.prototype.setPosition = function () { var e = this; e.setDimensions(), e.setHeight(), e.options.fade === !1 ? e.setCSS(e.getLeft(e.currentSlide)) : e.setFade(), e.$slider.trigger("setPosition", [e]) }, t.prototype.setProps = function () { var e = this, t = document.body.style; e.positionProp = e.options.vertical === !0 ? "top" : "left", "top" === e.positionProp ? e.$slider.addClass("slick-vertical") : e.$slider.removeClass("slick-vertical"), void 0 === t.WebkitTransition && void 0 === t.MozTransition && void 0 === t.msTransition || e.options.useCSS === !0 && (e.cssTransitions = !0), void 0 !== t.OTransform && (e.animType = "OTransform", e.transformType = "-o-transform", e.transitionType = "OTransition", void 0 === t.perspectiveProperty && void 0 === t.webkitPerspective && (e.animType = !1)), void 0 !== t.MozTransform && (e.animType = "MozTransform", e.transformType = "-moz-transform", e.transitionType = "MozTransition", void 0 === t.perspectiveProperty && void 0 === t.MozPerspective && (e.animType = !1)), void 0 !== t.webkitTransform && (e.animType = "webkitTransform", e.transformType = "-webkit-transform", e.transitionType = "webkitTransition", void 0 === t.perspectiveProperty && void 0 === t.webkitPerspective && (e.animType = !1)), void 0 !== t.msTransform && (e.animType = "msTransform", e.transformType = "-ms-transform", e.transitionType = "msTransition", void 0 === t.msTransform && (e.animType = !1)), void 0 !== t.transform && e.animType !== !1 && (e.animType = "transform", e.transformType = "transform", e.transitionType = "transition"), e.transformsEnabled = null !== e.animType && e.animType !== !1 }, t.prototype.setSlideClasses = function (e) { var t, n, a, i, r = this; r.$slider.find(".slick-slide").removeClass("slick-active").attr("aria-hidden", "true").removeClass("slick-center"), n = r.$slider.find(".slick-slide"), r.options.centerMode === !0 ? (t = Math.floor(r.options.slidesToShow / 2), r.options.infinite === !0 && (e >= t && e <= r.slideCount - 1 - t ? r.$slides.slice(e - t, e + t + 1).addClass("slick-active").attr("aria-hidden", "false") : (a = r.options.slidesToShow + e, n.slice(a - t + 1, a + t + 2).addClass("slick-active").attr("aria-hidden", "false")), 0 === e ? n.eq(n.length - 1 - r.options.slidesToShow).addClass("slick-center") : e === r.slideCount - 1 && n.eq(r.options.slidesToShow).addClass("slick-center")), r.$slides.eq(e).addClass("slick-center")) : e >= 0 && e <= r.slideCount - r.options.slidesToShow ? r.$slides.slice(e, e + r.options.slidesToShow).addClass("slick-active").attr("aria-hidden", "false") : n.length <= r.options.slidesToShow ? n.addClass("slick-active").attr("aria-hidden", "false") : (i = r.slideCount % r.options.slidesToShow, a = r.options.infinite === !0 ? r.options.slidesToShow + e : e, r.options.slidesToShow == r.options.slidesToScroll && r.slideCount - e < r.options.slidesToShow ? n.slice(a - (r.options.slidesToShow - i), a + i).addClass("slick-active").attr("aria-hidden", "false") : n.slice(a, a + r.options.slidesToShow).addClass("slick-active").attr("aria-hidden", "false")), "ondemand" === r.options.lazyLoad && r.lazyLoad() }, t.prototype.setupInfinite = function () { var t, n, a, i = this; if (i.options.fade === !0 && (i.options.centerMode = !1), i.options.infinite === !0 && i.options.fade === !1 && (n = null, i.slideCount > i.options.slidesToShow)) { for (a = i.options.centerMode === !0 ? i.options.slidesToShow + 1 : i.options.slidesToShow, t = i.slideCount; t > i.slideCount - a; t -= 1)n = t - 1, e(i.$slides[n]).clone(!0).attr("id", "").attr("data-slick-index", n - i.slideCount).prependTo(i.$slideTrack).addClass("slick-cloned"); for (t = 0; t < a; t += 1)n = t, e(i.$slides[n]).clone(!0).attr("id", "").attr("data-slick-index", n + i.slideCount).appendTo(i.$slideTrack).addClass("slick-cloned"); i.$slideTrack.find(".slick-cloned").find("[id]").each(function () { e(this).attr("id", "") }) } }, t.prototype.selectHandler = function (t) { var n = this, a = parseInt(e(t.target).parents(".slick-slide").attr("data-slick-index")); if (a || (a = 0), n.slideCount <= n.options.slidesToShow) return n.$slider.find(".slick-slide").removeClass("slick-active").attr("aria-hidden", "true"), n.$slides.eq(a).addClass("slick-active").attr("aria-hidden", "false"), n.options.centerMode === !0 && (n.$slider.find(".slick-slide").removeClass("slick-center"), n.$slides.eq(a).addClass("slick-center")), void n.asNavFor(a); n.slideHandler(a) }, t.prototype.slideHandler = function (e, t, n) { var a, i, r, o = null, s = this; if (t = t || !1, (s.animating !== !0 || s.options.waitForAnimate !== !0) && !(s.options.fade === !0 && s.currentSlide === e || s.slideCount <= s.options.slidesToShow)) { if (t === !1 && s.asNavFor(e), a = e, o = s.getLeft(a), r = s.getLeft(s.currentSlide), s.currentLeft = null === s.swipeLeft ? r : s.swipeLeft, s.options.infinite === !1 && s.options.centerMode === !1 && (e < 0 || e > s.getDotCount() * s.options.slidesToScroll)) return void (s.options.fade === !1 && (a = s.currentSlide, n !== !0 ? s.animateSlide(r, function () { s.postSlide(a) }) : s.postSlide(a))); if (s.options.infinite === !1 && s.options.centerMode === !0 && (e < 0 || e > s.slideCount - s.options.slidesToScroll)) return void (s.options.fade === !1 && (a = s.currentSlide, n !== !0 ? s.animateSlide(r, function () { s.postSlide(a) }) : s.postSlide(a))); if (s.options.autoplay === !0 && clearInterval(s.autoPlayTimer), i = a < 0 ? s.slideCount % s.options.slidesToScroll != 0 ? s.slideCount - s.slideCount % s.options.slidesToScroll : s.slideCount + a : a >= s.slideCount ? s.slideCount % s.options.slidesToScroll != 0 ? 0 : a - s.slideCount : a, s.animating = !0, s.$slider.trigger("beforeChange", [s, s.currentSlide, i]), s.currentSlide, s.currentSlide = i, s.setSlideClasses(s.currentSlide), s.updateDots(), s.updateArrows(), s.options.fade === !0) return n !== !0 ? s.fadeSlide(i, function () { s.postSlide(i) }) : s.postSlide(i), void s.animateHeight(); n !== !0 ? s.animateSlide(o, function () { s.postSlide(i) }) : s.postSlide(i) } }, t.prototype.startLoad = function () { var e = this; e.options.arrows === !0 && e.slideCount > e.options.slidesToShow && (e.$prevArrow.hide(), e.$nextArrow.hide()), e.options.dots === !0 && e.slideCount > e.options.slidesToShow && e.$dots.hide(), e.$slider.addClass("slick-loading") }, t.prototype.swipeDirection = function () { var e, t, n, a, i = this; return e = i.touchObject.startX - i.touchObject.curX, t = i.touchObject.startY - i.touchObject.curY, n = Math.atan2(t, e), a = Math.round(180 * n / Math.PI), a < 0 && (a = 360 - Math.abs(a)), a <= 45 && a >= 0 ? i.options.rtl === !1 ? "left" : "right" : a <= 360 && a >= 315 ? i.options.rtl === !1 ? "left" : "right" : a >= 135 && a <= 225 ? i.options.rtl === !1 ? "right" : "left" : "vertical" }, t.prototype.swipeEnd = function (e) { var t, n = this; if (n.dragging = !1, n.shouldClick = !(n.touchObject.swipeLength > 10), void 0 === n.touchObject.curX) return !1; if (n.touchObject.edgeHit === !0 && n.$slider.trigger("edge", [n, n.swipeDirection()]), n.touchObject.swipeLength >= n.touchObject.minSwipe) switch (n.swipeDirection()) { case "left": t = n.options.swipeToSlide ? n.checkNavigable(n.currentSlide + n.getSlideCount()) : n.currentSlide + n.getSlideCount(), n.slideHandler(t), n.currentDirection = 0, n.touchObject = {}, n.$slider.trigger("swipe", [n, "left"]); break; case "right": t = n.options.swipeToSlide ? n.checkNavigable(n.currentSlide - n.getSlideCount()) : n.currentSlide - n.getSlideCount(), n.slideHandler(t), n.currentDirection = 1, n.touchObject = {}, n.$slider.trigger("swipe", [n, "right"]) } else n.touchObject.startX !== n.touchObject.curX && (n.slideHandler(n.currentSlide), n.touchObject = {}) }, t.prototype.swipeHandler = function (e) { var t = this; if (!(t.options.swipe === !1 || "ontouchend" in document && t.options.swipe === !1 || t.options.draggable === !1 && e.type.indexOf("mouse") !== -1)) switch (t.touchObject.fingerCount = e.originalEvent && void 0 !== e.originalEvent.touches ? e.originalEvent.touches.length : 1, t.touchObject.minSwipe = t.listWidth / t.options.touchThreshold, e.data.action) { case "start": t.swipeStart(e); break; case "move": t.swipeMove(e); break; case "end": t.swipeEnd(e) } }, t.prototype.swipeMove = function (e) { var t, n, a, i, r, o = this; return r = void 0 !== e.originalEvent ? e.originalEvent.touches : null, !(!o.dragging || r && 1 !== r.length) && (t = o.getLeft(o.currentSlide), o.touchObject.curX = void 0 !== r ? r[0].pageX : e.clientX, o.touchObject.curY = void 0 !== r ? r[0].pageY : e.clientY, o.touchObject.swipeLength = Math.round(Math.sqrt(Math.pow(o.touchObject.curX - o.touchObject.startX, 2))), "vertical" !== (n = o.swipeDirection()) ? (void 0 !== e.originalEvent && o.touchObject.swipeLength > 4 && e.preventDefault(), i = (o.options.rtl === !1 ? 1 : -1) * (o.touchObject.curX > o.touchObject.startX ? 1 : -1), a = o.touchObject.swipeLength, o.touchObject.edgeHit = !1, o.options.infinite === !1 && (0 === o.currentSlide && "right" === n || o.currentSlide >= o.getDotCount() && "left" === n) && (a = o.touchObject.swipeLength * o.options.edgeFriction, o.touchObject.edgeHit = !0), o.options.vertical === !1 ? o.swipeLeft = t + a * i : o.swipeLeft = t + a * (o.$list.height() / o.listWidth) * i, o.options.fade !== !0 && o.options.touchMove !== !1 && (o.animating === !0 ? (o.swipeLeft = null, !1) : void o.setCSS(o.swipeLeft))) : void 0) }, t.prototype.swipeStart = function (e) {
      var t, n = this
      ; if (1 !== n.touchObject.fingerCount || n.slideCount <= n.options.slidesToShow) return n.touchObject = {}, !1; void 0 !== e.originalEvent && void 0 !== e.originalEvent.touches && (t = e.originalEvent.touches[0]), n.touchObject.startX = n.touchObject.curX = void 0 !== t ? t.pageX : e.clientX, n.touchObject.startY = n.touchObject.curY = void 0 !== t ? t.pageY : e.clientY, n.dragging = !0
    }, t.prototype.unfilterSlides = t.prototype.slickUnfilter = function () { var e = this; null !== e.$slidesCache && (e.unload(), e.$slideTrack.children(this.options.slide).detach(), e.$slidesCache.appendTo(e.$slideTrack), e.reinit()) }, t.prototype.unload = function () { var t = this; e(".slick-cloned", t.$slider).remove(), t.$dots && t.$dots.remove(), t.$prevArrow && "object" != typeof t.options.prevArrow && t.$prevArrow.remove(), t.$nextArrow && "object" != typeof t.options.nextArrow && t.$nextArrow.remove(), t.$slides.removeClass("slick-slide slick-active slick-visible").attr("aria-hidden", "true").css("width", "") }, t.prototype.unslick = function () { this.destroy() }, t.prototype.updateArrows = function () { var e = this; Math.floor(e.options.slidesToShow / 2), e.options.arrows === !0 && e.options.infinite !== !0 && e.slideCount > e.options.slidesToShow && (e.$prevArrow.removeClass("slick-disabled"), e.$nextArrow.removeClass("slick-disabled"), 0 === e.currentSlide ? (e.$prevArrow.addClass("slick-disabled"), e.$nextArrow.removeClass("slick-disabled")) : e.currentSlide >= e.slideCount - e.options.slidesToShow && e.options.centerMode === !1 ? (e.$nextArrow.addClass("slick-disabled"), e.$prevArrow.removeClass("slick-disabled")) : e.currentSlide >= e.slideCount - 1 && e.options.centerMode === !0 && (e.$nextArrow.addClass("slick-disabled"), e.$prevArrow.removeClass("slick-disabled"))) }, t.prototype.updateDots = function () { var e = this; null !== e.$dots && (e.$dots.find("li").removeClass("slick-active").attr("aria-hidden", "true"), e.$dots.find("li").eq(Math.floor(e.currentSlide / e.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden", "false")) }, t.prototype.visibility = function () { var e = this; document[e.hidden] ? (e.paused = !0, e.autoPlayClear()) : (e.paused = !1, e.autoPlay()) }, e.fn.slick = function () { var e, n = this, a = arguments[0], i = Array.prototype.slice.call(arguments, 1), r = n.length, o = 0; for (o; o < r; o++)if ("object" == typeof a || void 0 === a ? n[o].slick = new t(n[o], a) : e = n[o].slick[a].apply(n[o].slick, i), void 0 !== e) return e; return n }, e(function () { e("[data-slick]").slick() })
  })
}, function (e, t) { e.exports = window.jQuery }, function (e, t, n) { "use strict"; angular.module("slick", []).directive("slick", ["$timeout", function (e) { return { restrict: "AEC", scope: { initOnload: "@", data: "=", currentIndex: "=", accessibility: "@", adaptiveHeight: "@", arrows: "@", asNavFor: "@", appendArrows: "@", appendDots: "@", autoplay: "@", autoplaySpeed: "@", centerMode: "@", centerPadding: "@", cssEase: "@", customPaging: "&", dots: "@", draggable: "@", easing: "@", fade: "@", focusOnSelect: "@", infinite: "@", initialSlide: "@", lazyLoad: "@", onBeforeChange: "&", onAfterChange: "&", onInit: "&", onReInit: "&", onSetPosition: "&", pauseOnHover: "@", pauseOnDotsHover: "@", responsive: "=", rtl: "@", slide: "@", slidesToShow: "@", slidesToScroll: "@", speed: "@", swipe: "@", swipeToSlide: "@", touchMove: "@", touchThreshold: "@", useCSS: "@", variableWidth: "@", vertical: "@", prevArrow: "@", nextArrow: "@" }, link: function (t, n, a) { var i, r, o; return i = function () { return e(function () { var e; return e = $(n), e.unslick(), e.find(".slick-list").remove(), e }) }, r = function () { return e(function () { var e, i, r; return r = $(n), null != t.currentIndex && (e = t.currentIndex), i = function (e, n) { return t.customPaging({ slick: e, index: n }) }, r.slick({ accessibility: "false" !== t.accessibility, adaptiveHeight: "true" === t.adaptiveHeight, arrows: "false" !== t.arrows, asNavFor: t.asNavFor ? t.asNavFor : void 0, appendArrows: t.appendArrows ? $(t.appendArrows) : $(n), appendDots: t.appendDots ? $(t.appendDots) : $(n), autoplay: "true" === t.autoplay, autoplaySpeed: null != t.autoplaySpeed ? parseInt(t.autoplaySpeed, 10) : 3e3, centerMode: "true" === t.centerMode, centerPadding: t.centerPadding || "50px", cssEase: t.cssEase || "ease", customPaging: a.customPaging ? i : void 0, dots: "true" === t.dots, draggable: "false" !== t.draggable, easing: t.easing || "linear", fade: "true" === t.fade, focusOnSelect: "true" === t.focusOnSelect, infinite: "false" !== t.infinite, initialSlide: t.initialSlide || 0, lazyLoad: t.lazyLoad || "ondemand", beforeChange: a.onBeforeChange ? t.onBeforeChange : void 0, onReInit: a.onReInit ? t.onReInit : void 0, onSetPosition: a.onSetPosition ? t.onSetPosition : void 0, pauseOnHover: "false" !== t.pauseOnHover, responsive: t.responsive || void 0, rtl: "true" === t.rtl, slide: t.slide || "div", slidesToShow: null != t.slidesToShow ? parseInt(t.slidesToShow, 10) : 1, slidesToScroll: null != t.slidesToScroll ? parseInt(t.slidesToScroll, 10) : 1, speed: null != t.speed ? parseInt(t.speed, 10) : 300, swipe: "false" !== t.swipe, swipeToSlide: "true" === t.swipeToSlide, touchMove: "false" !== t.touchMove, touchThreshold: t.touchThreshold ? parseInt(t.touchThreshold, 10) : 5, useCSS: "false" !== t.useCSS, variableWidth: "true" === t.variableWidth, vertical: "true" === t.vertical, prevArrow: t.prevArrow ? $(t.prevArrow) : void 0, nextArrow: t.nextArrow ? $(t.nextArrow) : void 0 }), r.on("init", function (n) { if (a.onInit && t.onInit(), null != e) return n.slideHandler(e) }), r.on("afterChange", function (n, a, i, r) { if (t.onAfterChange && t.onAfterChange(), null != e) return t.$apply(function () { return e = i, t.currentIndex = i }) }), t.$watch("currentIndex", function (t, n) { if (null != e && null != t && t !== e) return r.slick("slickGoTo", t) }) }) }, t.initOnload ? (o = !1, t.$watch("data", function (e, t) { if (null != e) return o && i(), r(), o = !0 })) : r() } } }]) }, function (e, t, n) { n(295).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "slick_f4ea4523.css" }, function (e, t, n) { n(297).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "slick-theme_1307ad5b.css" }, function (e, t, n) { n(299).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "dashboard-core_7cc0afe4.css" }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } var i = n(301), r = a(i), o = n(302), s = a(o); n(303), angular.module("BC.dashboard.core").controller("ChartLinkCtrl", ["$scope", "dashChartLinkService", "errHint", "$translate", "ngDialog", r.default]).service("dashChartLinkService", ["commonHttp", "$rootScope", "$translate", "$q", s.default]) }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var i = n(6), r = a(i), o = n(7), s = a(o), l = n(179), c = a(l), d = function () { function e(t, n, a, i, o) { (0, r.default)(this, e), this.loading = !1, this.isShowFields = !1, this.linkInfo = {}, this.charts = {}, this.mainChart = {}, this.checkAllCt = !1, this.tables = [], this.mainTable = {}, this.nnedShowMappingMode = !1, this.metaX = {}, this.activeXItem = {}, this.activeLayer = {}, this.scope = t, this.draw_chart_url = t.draw_chart_url, this.dashStandardItems = t.dashStandardItems, this.dashChartLinkService = n, this.errHint = a, this.$translate = i, this.ngDialog = o, this.ngOnInit(this.scope.ngDialogData.meta) } return (0, s.default)(e, [{ key: "ngOnInit", value: function (e) { var t = this; if (!e.supportChain) return !1; this.mainChart = _.cloneDeep(e), this.mainChart.chartLinkType = this.dashChartLinkService.getChartLinkType(e), this.loading = !0, this.dashChartLinkService.getLinkSetInfo(e.ct_id).then(function (n) { var a = void 0, i = void 0; t.linkInfo = t.dashChartLinkService.setLinkInfoFidToUnique(n.link_info), t.charts = t.dashChartLinkService.getChatList(e.ct_id, t.dashStandardItems, t.linkInfo), t.tables = t.dashChartLinkService.getTablesInfo(t.linkInfo, n.tb_list), t.dashChartLinkService.setTableRelyCtIds(t.tables, t.charts), "C400" === e.type ? (t.dashChartLinkService.setLayerCanSet(t.mainChart.layers), t.mainChart.isGis = !0, t.activeLayer = t.dashChartLinkService.getActiveLayer(t.mainChart.layers, n.master_layer_id), a = t.activeLayer.x, i = t.activeLayer.tb_id) : (a = e.x, i = e.tb_id), t.dashChartLinkService.setInitTableListShow(t.tables, t.linkInfo, i), t._updateModels(i, a), t._updateMapAndCheckAll() }, function () { return t.ngDialog.closeAll() }).finally(function () { return t.loading = !1 }) } }, { key: "_updateModels", value: function (e, t) { this.mainTable = this.dashChartLinkService.getMainTable(e, this.tables), this.metaX = this.dashChartLinkService.getMetaXInfo(t, this.linkInfo, this.mainTable, this.tables, this.mainChart.chartLinkType), this.activeXItem = this.dashChartLinkService.getActiveXItem(this.metaX) } }, { key: "changeMainLayer", value: function () { var e = this; this.activeLayer.canSet && (this._updateModels(this.activeLayer.tb_id, this.activeLayer.x), this.charts.forEach(function (t) { return !t.unsupported && e.changeChartSelectd(t, "noCheckStatus") }), this._updateMapAndCheckAll()) } }, { key: "changeChartSelectd", value: function (e, t) { var n = this; e.isGis ? e.layers.filter(function (e) { return !e.invisible }).forEach(function (t) { t.selected = e.selected, n.changeLayerSelected(t, e, !0) }) : this.dashChartLinkService.setTableShowByCtOrLayer("chart", e, this.tables, this.mainTable), t || this._updateMapAndCheckAll() } }, { key: "_updateMapAndCheckAll", value: function () { this.checkAllCt = this.dashChartLinkService.getCheckAllCharts(this.charts), this.needShowMappingMode = this.dashChartLinkService.getMetaXShow(this.tables) } }, { key: "changeAllChartsSelected", value: function () { var e = this; this.charts.forEach(function (t) { t.unsupported || (t.selected = e.checkAllCt, e.changeChartSelectd(t, !0)) }), this.needShowMappingMode = this.dashChartLinkService.getMetaXShow(this.tables) } }, { key: "isMapChart", value: function () { return $.inArray(this.mainChart.type, ["C271", "C272", "C273"]) > -1 } }, { key: "changeLayerSelected", value: function (e, t, n) { this.dashChartLinkService.setTableShowByCtOrLayer("layer", e, this.tables, this.mainTable, t), t.selLayerAmount = this.dashChartLinkService.getCheckLayerAmount(t.layers), n || (t.selected = t.selLayerAmount > 0 && t.selLayerAmount === t.visibleLayerAmount, this._updateMapAndCheckAll()) } }, { key: "saveConfig", value: function () { var e = this, t = this.dashChartLinkService.vailPostLinkInfo(this.metaX, this.charts, this.tables, this.activeLayer); if (t) return this.errHint(t), !1; var n = { ct_id: this.mainChart.ct_id, link_info: angular.toJson(this.dashChartLinkService.getPostLinkInfo(this.metaX, this.charts, this.mainTable)), master_layer_id: this.activeLayer.layer_id }; this.loading = !0, this.dashChartLinkService.setChartLink(n).then(function (t) { e.scope.$emit("updateDashboardInfo"), e.errHint(e.$translate.instant("saveSuccess")), e.ngDialog.closeAll() }).finally(function () { return e.loading = !1 }) } }, { key: "showSubFieldsList", value: function (e) { var t = this; c.default.show({ isAllField: !0, fields: this.dashChartLinkService.getAllSubFields(this.mainTable.fields, this.metaX), hook: $(e.target), container: $(e.target).parent(), type: "link", isRight: !0, isNotAbs: !0, callback: function (e) { return t.addSubField(e) } }), $(document).off("click.linkSetting").on("click.linkSetting", function (n) { return $(e.target).hasClass("J-add-field") && !t.isShowFields ? void (t.isShowFields = !0) : (t.isShowFields = !1, c.default.remove(), $(document).off("click.linkSetting"), e.preventDefault(), !1) }) } }, { key: "addSubField", value: function (e) { var t = this.dashChartLinkService.getXItemSelectInfo(e, this.linkInfo, this.tables); this.metaX.push($.extend({}, e, t, { isSubField: 1 })), this.activeXItem = this.dashChartLinkService.getActiveXItem(this.metaX, "findLast"), this.scope.$$phase || this.scope.$digest() } }, { key: "removeSubField", value: function (e) { this.metaX.splice(this.metaX.indexOf(e), 1), this.activeXItem = this.dashChartLinkService.getActiveXItem(this.metaX, "findLast") } }]), e }(); t.default = d }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var i = n(6), r = a(i), o = n(7), s = a(o), l = ["C101", "C102", "C103", "C104", "C105"], c = ["C500"], d = function () { function e(t, n, a, i) { (0, r.default)(this, e), this.commonHttp = t, this.$rootScope = n, this.$translate = a, this.$q = i } return (0, s.default)(e, [{ key: "getLinkSetInfo", value: function (e) { var t = this; return this.commonHttp.post("/api/chart_link/info", { ct_id: e }).then(function (e) { return "0" == e.status ? e.result : t.$q.reject("error") }) } }, { key: "setTableShowByCtOrLayer", value: function (e, t, n, a) { var i = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {}, r = t.selected, o = t.tb_id, s = "chart" === e ? t.ct_id : i.ct_id + t.layer_id, l = _.find(n, function (e) { return e.tb_id === o }), c = l.relyCtIds; c[s] = r, l.show = l.tb_id !== a.tb_id && _.filter(c, function (e) { return e }).length > 0 } }, { key: "setTableRelyCtIds", value: function (e, t) { var n = _.keyBy(e, "tb_id"); t.filter(function (e) { return !e.unsupported }).forEach(function (e) { if (e.isGis) e.layers.forEach(function (t) { var a = n[t.tb_id]; a && (a.relyCtIds[e.ct_id + t.layer_id] = t.selected) }); else { var t = n[e.tb_id]; t && (t.relyCtIds[e.ct_id] = e.selected) } }) } }, { key: "getLinkSupport", value: function (e, t, n) { var a = "free_drill_opt" in function (e, t) { for (var n in t) if (t[n].options.ct_id === e) return t[n].options.optional }(e.ct_id, t), i = function (e) { var t = []; return e.forEach(function (e) { var n = e.children[0].meta.type; n && l.indexOf(n) > -1 || t.push(angular.copy(e)) }), t }(n).length > 1, r = function (e) { var t = !0; if ("C400" === e.type) { var n = e.layers && e.layers.filter(function (e) { return e.x && e.x.length > 0 && !e.invisible }).length; n && 0 != n || (t = !1) } return t }(e); return !("C261 C290 C300 C301 C310 C320 C330 C360 C370 C500 C272".indexOf(e.type) > -1 || e.chart_jump && "1" == e.chart_jump.can_jump || e && e.level_fields && e.level_fields.length > 1 || !i || a || !r) } }, { key: "getChatList", value: function (e, t, n) { var a = [], i = {}, r = this._getSelectLinkObj(n), o = r.linkCtIdList || {}, s = r.linkLayerIdList || {}; return t.forEach(function (t, n) { i = t.children[0].meta, i.type && i.ct_id !== e && l.indexOf(i.type) < 0 && function () { var e = { name: i.name, ct_id: i.ct_id, tb_id: i.tb_id, unsupported: c.indexOf(i.type) > -1, selected: $.inArray(i.ct_id, o) > -1, isMainChart: i.chart_link && 2 == i.chart_link.linked_chart_type, isGis: "C400" === i.type }; if (e.isGis) if (i.layers && 0 != i.layers.length) { var t = i.layers.filter(function (e) { return e.invisible }).length; t === i.layers.length && (e.unsupported = !0), e.layers = _.map(i.layers, function (t) { return { layer_id: t.layer_id, selected: s.indexOf(e.ct_id + t.layer_id) > -1, tb_id: t.tb_id, layer_name: t.layer_name, invisible: t.invisible } }), e.visibleLayerAmount = e.layers.filter(function (e) { return e.selected || !e.invisible }).length, e.showLayer = !1, e.selLayerAmount = e.layers.filter(function (e) { return e.selected }).length, e.selected = e.selLayerAmount > 0 && e.selLayerAmount == e.visibleLayerAmount } else e.unsupported = !0; a.push(e) }() }), a } }, { key: "setLayerCanSet", value: function (e) { e.forEach(function (e) { e.canSet = e.x.length > 0 && !e.invisible }) } }, { key: "getTablesInfo", value: function () { var e = (arguments.length > 0 && void 0 !== arguments[0] && arguments[0], arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : []), t = []; return e.forEach(function (e, n) { t.push({ show: !1, name: e.name, fields: e.fields, tb_id: e.tb_id, relyCtIds: {}, fieldsKeyByFid: _.keyBy(e.fields, "fid") }) }), t } }, { key: "getMainTable", value: function (e, t) { return _.find(t, function (t) { return t.tb_id === e }) } }, { key: "getActiveLayer", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0; return _.find(e, function (e) { return t ? e.layer_id === t : e.canSet }) || {} } }, { key: "setInitTableListShow", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [], t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [], n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null, a = this._getSelectLinkObj(t).linkTbIdList || {}; e.forEach(function (e) { e.show = e.tb_id !== n && a.indexOf(e.tb_id) > -1 }) } }, { key: "_getSelectLinkObj", value: function (e) { var t = { linkCtIdList: [], linkTbIdList: [], linkLayerIdList: [] }; return _.isArray(e) ? (e.forEach(function (e) { t.linkCtIdList.push(e.link_ct_id), t.linkTbIdList.push(e.link_tb_id), e.guest_layer_id && t.linkLayerIdList.push(e.link_ct_id + e.guest_layer_id) }), t.linkLayerIdList = _.flatMap(t.linkLayerIdList), t) : t } }, { key: "getMetaXInfo", value: function (e, t, n, a, i) { function r(e, t, n, a, i) { var r = this, o = {}; return e.forEach(function (e, s) { o = r.getXItemSelectInfo(e, t, n, s, a, i), e.selectedTable = o.selectedTable, e.selected = o.selected }), 0 === e.filter(function (e) { return e.selected }).length && (e[0].selected = !0), e } var o = e.slice(0), s = function (e, t, n) { var a = o.map(function (e) { return e.fid }), i = [], r = _(t).filter(function (e) { return e.link_tb_id !== n.tb_id }).take(1).value()[0]; return r && r.field_map.forEach(function (e) { var t = n.fieldsKeyByFid[e.field]; void 0 !== t && a.indexOf(t.fid) < 0 && (t = _.cloneDeep(t), t.isSubField = 1, i.push(t), a.push(e.field)) }), i }(e, t, n); return o = o.concat(s), r.call(this, o, t, a, n, i) } }, { key: "setLinkInfoFidToUnique", value: function (e) { return e.forEach(function (e) { e.uniqueIdMap = _.keyBy(e.field_map, function (e) { return e.field + e.index }) }), e } }, { key: "getActiveXItem", value: function (e, t) { return t ? _.findLast(e, function (e) { return e.selected }) || e[0] : _.find(e, function (e) { return e.selected }) || e[0] } }, { key: "getXItemSelectInfo", value: function (e, t, n) { function a(e, t, n, a) { var i = t.tb_id, r = e.name, o = {}, s = !1, l = a[i] && a[i].uniqueIdMap[n] && a[i].uniqueIdMap[n].link_field; return l ? s = !0 : (o = _.find(t.fields, function (e) { return e.name === r }), l = o ? o.fid : null), { fromLinkInfo: s, linkFieldId: l } } var i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : void 0, r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {}, o = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "", s = e.fid, l = e.fid + i, c = !1, d = {}, u = _.keyBy(t, function (e) { return e.link_tb_id }); return n.forEach(function (t) { var n = t.tb_id, i = a(e, t, l, u); "manyDms" === o ? i.fromLinkInfo && t.tb_id !== r.tb_id && (c = !0) : c = !0, c = !(!i.fromLinkInfo || t.tb_id === r.tb_id) || c, d[n] = { tbId: n, linkFieldId: i.linkFieldId, fid: s } }), void 0 === i && (c = !0), { selectedTable: d, selected: c } } }, { key: "getChartLinkType", value: function (e) { return $.inArray(e.type, ["C210", "C211", "C212", "C220", "C240", "C241", "C242"]) > -1 && 2 == e.x.length ? "doubleDms" : "C200" == e.type ? "manyDms" : "oneDms" } }, { key: "getMetaXShow", value: function (e) { return !!_.find(e, function (e) { return e.show }) } }, { key: "getCheckAllCharts", value: function (e) { return !_.find(e, function (e) { return !e.unsupported && !e.selected }) } }, { key: "getCheckLayerAmount", value: function (e) { return e.filter(function (e) { return e.selected }).length } }, { key: "delChartLink", value: function (e) { var t = this; return this.commonHttp.post("/api/chart_link/delete", { ct_id: e }).then(function (n) { var a = $.inArray(e, t.$rootScope.mainChartIdContainer); angular.forEach(t.$rootScope.mainChartContainer, function (n, a) { n.ctId == e && t.$rootScope.mainChartContainer.splice(a, 1) }), t.$rootScope.mainChartIdContainer.splice(a, 1) }) } }, { key: "getAllSubFields", value: function (e, t) { for (var n = e.slice(0), a = 0, i = t.length; a < i; a++)for (var r = t[a], o = 0, s = n.length; o < s; o++) { var l = n[o]; l && r && l.fid === r.fid && n.splice(o, 1) } return n } }, { key: "vailPostLinkInfo", value: function (e, t, n, a) { var i = _.keyBy(n, "tb_id"), r = null; return 0 == a.canSet && (r = this.$translate.instant("dash.layerIsNull")), 0 === _.filter(t, function (e) { return e.selected || e.selLayerAmount > 0 }).length && (r = this.$translate.instant("chart.chainChart")), _(e).filter(function (e) { return !!(e.selected && _(e.selectedTable).filter(function (e) { return i[e.tbId].show && !e.linkFieldId }).take(1).value().length > 0) }).take(1).value().length > 0 && (r = this.$translate.instant("chart.chainField")), r } }, { key: "getPostLinkInfo", value: function (e, t, n) { function a(e, t, n, a, r) { var o = { link_ct_id: e, link_tb_id: t, field_map: i(t, n, a) }; return r && (o.guest_layer_id = r), o } function i(e, t, n) { var a = [], i = null, o = e == n.tb_id; return t.forEach(function (t, n) { if (!t.selected && !o) return !1; var r = t.fid, s = {}; i = o ? r : _.filter(t.selectedTable, function (t) { return t.tbId === e })[0].linkFieldId, i = i.split("_")[0], s = { field: r, index: n, link_field: i }, t.isSubField && (s.is_sub_field = 1), a.push(s) }), o && (a = a.concat(r(a, n))), a } function r(e, t) { var n = [], a = _.map(e, function (e) { return e.field }), i = a.length; return t.fields.forEach(function (e) { var t = e.fid; a.indexOf(t) < 0 && (n.push({ field: t, index: i, link_field: t, is_sub_field: 1 }), i++) }), n } var o = []; return t.forEach(function (t) { t.isGis ? t.layers && t.layers.filter(function (e) { return e.selected }).forEach(function (i) { o.push(a(t.ct_id, i.tb_id, e, n, i.layer_id)) }) : t.selected && o.push(a(t.ct_id, t.tb_id, e, n)) }), o } }, { key: "setChartLink", value: function (e) { var t = this; return this.commonHttp.post("/api/chart_link/commit", e).then(function (e) { t.$rootScope.mainChartIdContainer = [], t.$rootScope.mainChartContainer = [] }) } }]), e }(); t.default = d }, function (e, t, n) { n(304).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "chart-link_7a552470.css" }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").factory("dashChartJump", ["$rootScope", "ngDialog", "commonService", "multipleProService", "errHint", "$state", "$translate", function (e, t, n, a, r, o, s) { function l(a) { var l = { checkSupport: function (e) { return !("C500".indexOf(e.type) > -1) && !("C261 C281 C290 C300 C301 C310 C320 C330 C340 C400 C360 C370 C213 C390 C282 C221".indexOf(e.type) > -1 && 0 == e.ct_type || e && e.level_fields && e.level_fields.length > 1 || e && e.chart_link && 1 * e.chart_link.linked_chart_type == 2) }, getChartFields: function (e) { var t = ["C210", "C211", "C212", "C220", "C240", "C241", "C242"], n = null; if ("C200" === e.type) { n = e.x.slice(0); for (var a = 0, i = n.length; a < i; a++) { var o = n[a]; o.name = o.nick_name || o.name, o.fIndex = a } return { fields: n, type: "arr" } } return $.inArray(e.type, t) > -1 && e.x && 2 == e.x.length ? n = e.x[1] : e.x && 1 == e.x.length ? n = e.x[0] : r(s.instant("dash.dashCartJump.needDimensionsFields")), n && (n.name = n.nick_name || n.name), { fields: n, type: "str" } }, getInitFieldId: function (e, t) { var n = "arr" == t.type ? t.fields[0] : t.fields; return e.fid || n.fid }, getInitFieldObj: function (e, t) { var n = t.fields; if ("arr" == t.type) { for (var a = null, i = 0, r = n.length; i < r; i++) { var o = n[i]; if (o.fid == e.fid && "f_index" in e && e.f_index == o.fIndex) { a = o; break } } return a || n[0] || {} } return n }, getInitMode: function (e) { return e.is_blank ? 1 : 0 }, getInitDash: function (e, t) { for (var n, a = 0, i = t.length; a < i; a++) { var r = t[a]; if ("dashboard" === r.attribute && r.dsh_id == e) { n = r; break } } return n = n || t[0] || {}, n.df_list = n.df_list || [], n }, getInitFilter: function (e, t) { for (var n, a = 0, i = t.length; a < i; a++) { var r = t[a]; if (r.df_id == e) { n = r; break } } return n = n || t[0] || {} }, jumpController: ["$scope", "$timeout", "multipleProService", function (a, i, s) { function c(e) { var t = e.select_info || {}; s.initDeep(e.info_list, 0); var n = e.info_list, i = s.getProjObjById(t.proj_id, n), r = i ? l.getInitDash(t.dsh_id, i.subs || []) : {}, o = l.getInitFilter(t.df_id, r.df_list || []), c = l.getInitMode(t), d = l.getInitFieldObj(t, v); h.openMode = c, h.infoList = n, h.initField = d, h.jumpFields = v, h.initProj = i, h.initDash = r, h.initFilter = o, h.initProj ? a.changeProj(h.initProj) : a.changeProj(h.infoList[0]) } function d(e, t) { e && e.stopPropagation(), t.nodeCollapse = !t.nodeCollapse } function u(e) { if (h.selectProjObj && h.selectProjObj.proj_id !== e.proj_id && (a.dashChartJumpData.currentDashName = ""), a.dashChartJumpData.currentProjectName = e.name, a.dashChartJumpData.showProjectList = !1, e) { h.selectProjObj = angular.copy(e), h.selectDashObj = null; var t = h.selectProjObj.subs || [], n = []; t.map(function (e, t) { "dashboard" === e.attribute && e.dsh_id !== a.selected.dsh_id && n.push(e) }), h.selectProjObj.subs = n, $.isEmptyObject(h.initDash) ? n && n.length > 0 && (a.changeDash(n[0]), h.selectFilterObj = h.selectDashObj.df_list ? h.selectDashObj.df_list[0] : {}) : a.changeDash(h.initDash) } a.$$phase || a.$digest() } function f(e) { a.dashChartJumpData.currentDashName = e.name, a.dashChartJumpData.showDashList = !1, h.selectDashObj = e, h.selectDashObj.df_list = e.df_list || [], h.selectFilterObj = $.isEmptyObject(h.initFilter) ? e.df_list[0] : h.initFilter } function p(e) { if (e.selectFilterObj && e.selectFilterObj.df_id) { e.selectFieldObj = e.selectFieldObj || e.initField; var i = { ct_id: e.meta.ct_id, fid: e.selectFieldObj.fid, f_index: e.selectFieldObj.fIndex, proj_id: e.selectProjObj.proj_id, dsh_id: e.selectDashObj.dsh_id, df_id: e.selectFilterObj.df_id, is_blank: 1 * e.openMode }; if (!function (e, t) { var n; return n = "date" == e ? 2 : 1, t == n && 1 == t }(e.selectFieldObj.data_type, e.selectFilterObj.type)) return void r(a.tips["dash.dashCartJump.errSameTip"]); n.ds.saveJumpInfo(i).then(function (e) { "0" == e.status ? (a.getDashboardInfo(a.dashSelected), t.closeAll()) : r(e.errstr) }) } } var h = a.ngDialogData, g = h.meta, m = g.ct_id, v = l.getChartFields(g); a.dashChartJumpData = { showProjectList: !1, showDashList: !1, currentDashName: "", currentProjectName: "" }, a.changeProj = u, a.changeDash = f, a.nodeCollapseHandle = d, a.save = p, function (t, i) { a.showLoading = !0; var r = o.params.dashId, s = { ct_id: t, dsh_id: r };[0, 2].indexOf(e.dashCategory) >= 0 && (s.categories = angular.toJson([0, 2])), n.ds.getJumpInfo(s).then(function (t) { "0" == t.status ? c(t.result) : e.pageLoading = !1 }).finally(function () { a.showLoading = !1 }) }(m) }], showDia: function (e) { if (BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "dashboard_hyperlink", ct_id: e.ct_id }) }), l.checkSupport(e)) { var n = l.getChartFields(e); n && n.fields && t.open({ template: "/static/dashboard-core/chart-jump/chart-jump-dash.html", className: "ngdialog-theme-default chart-jump-model", data: { meta: e }, scope: a, controller: l.jumpController }) } }, del: function (e, i) { e.stopPropagation(), n.ds.delJumpInfo({ ct_id: i }).then(function (e) { "0" == e.status && r(a.tips["dash.dashCartJump.successDelTip"]), a.getDashboardInfo(a.dashSelected), t.closeAll() }) } }; return l } return l }]).factory("chartJumpFuns", ["commonService", "multipleProService", "$location", "$state", "ngDialog", "$translate", "errHint", function (e, t, n, a, i, r, o) { var s = { gotoDashboard: function (e, t, a, l) { var c = e.is_blank, d = (e.jumpInfo, e.dsh_id); e.df_id; if (!t) return o(r.instant("dash.dashTargetForbiddenOrNotExist")), !1; var u = s.getDashUrl(e, t, a, l); if (0 == c) { return n.path().indexOf("/dash_fullscreen/") > -1 ? void n.url(u) : (i.closeAll(), void $("body").trigger("changeDashboard", { dshId: d, projInfo: t, url: u })) } window.open(u, "_blank") }, getPointData: function (e, t, n) { var a = ["C271", "C272", "C273"], i = n.info.chart_type, r = n.data.x, o = []; if ("C200" === i) return t; var s = !1; if (n.info.color_setting && n.info.color_setting.field) { n.info.color_setting.field.forEach(function (t) { t.fid == e.fid && (s = !0) }) } return $.inArray(i, a) > -1 ? o.push(t.name) : angular.forEach(r, function (e) { var n = 0; n = s ? t.series.index : t.index, o.push(e.data[n]) }), o[o.length - 1] }, getDashUrl: function (e, t, a, i) { for (var r, o = e.proj_id, l = e.dsh_id, c = e.df_id, d = e.is_blank, u = d ? "/#" : "", f = n.path(), p = f.indexOf("/dash_edit") > -1 || f.indexOf("/dash_fullscreen") > -1, h = (f.indexOf("dash_tpl"), t.subs.length - 1); h >= 0; h--) { var g = t.subs[h]; if ("dashboard" == g.attribute && g.dsh_id === l) { r = g; break } } var m = r && 2 == r.category, v = u; r && 0 == r.category && (p = !0), v += p || m ? "/dash_edit" : "/dash_tpl"; var y, _ = t.rule_id, b = s.getPointData(e, a, i), w = m ? "/mode/adv" : "", C = "?df_id=" + c + "&range=" + b; return y = _ ? v + "/" + o + "/" + l + "/" + _ : v + "/" + o + "/" + l, y = y + w + C }, check: function (n, i, r) { var l = i.optional.chart_jump_info, c = i.ct_id, d = l.dsh_id, u = a.params.dashId, f = t.getProjObjById(l.proj_id, r); e.ds.checkJumpInfo({ ct_id: c, tgt_dsh_id: d, dsh_id: u }).then(function (e) { "0" == e.status && (1 == e.result.can_jump ? s.gotoDashboard(l, f, n, i) : o("没有筛选器")) }) } }; return s }]) }, function (e, t, n) {
  "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").directive("chartOperate", ["$location", "$stateParams", "$rootScope", "ngDialog", "chartInstService", function (e, t, a, r, o) {
    return {
      restrict: "A", templateUrl: n(307), replace: !0, link: function (s, l, c) { function d(e, t) { if ("add" == e) { var n = '<div class="chart-operate-mask" style="position:absolute;left:0;top:0;bottom:0;right:0;z-index:10;cursor:default"></div>'; $(l).parent().find(".item-chart").append(n), $(l).prepend(n) } else $(l).parent().find(".chart-operate-mask").remove() } function u(e) { if (1 == e.info.is_ct_tpl) { var t = { refresh: !1, edit: !1, summary: !1, fullScreen: !0, dashFilter: !1, warn: !1, sort: !1, editData: !bdp.bdpPageStatus.isUnderDataScreenNormal() }; _.extend(s.chartOptPermission, t) } else s.chartOptPermission = y; s.$$phase || s.$digest() } function f(e) { for (var t = 0, n = null, a = s.dashStandardItems.length - 1; a >= 0; a--) { var i = s.dashStandardItems[a]; if (i.children[0].meta.ct_id === e) { n = i.children[0].meta, t = a; break } } return { meta: n, index: t } } var p = c.ctId, h = $(l).parents(".chart-box").find(".chart"), g = $(l).find(".J-width-change"), m = {}; h = h.length > 0 ? h : l.parents("li.gridster-item").find(".chart"), c.origin && c.origin.indexOf("data_screen") > -1 && (s.permision.isDataScreen = !0); var v = bdp.bdpPageStatus.isUnderAdvDashEdit() || bdp.bdpPageStatus.isUnderDataScreenEdit(); s.chartOptPermission = { refresh: !a.dashEditMode || v, edit: !a.dashEditMode || v, summary: !a.dashEditMode || v, fullScreen: !a.dashEditMode || v, dashFilter: !a.dashEditMode || v, sort: !a.dashEditMode || v, warn: !a.dashEditMode || v, more: !a.dashEditMode || v }, s.embedType = c.embedType ? c.embedType : "", "chart" == c.embedType && (s.chartOptPermission = { refresh: !1, edit: !1, summary: !1, fullScreen: !1, dashFilter: !1, sort: !1, warn: !1, more: !a.dashEditMode || v }), s.$watch("operateView.chartArgShow", function (e) { void 0 !== e && (e ? d("add", "inner-chart-args") : d("remove", "inner-chart-args")) }), (bdp.bdpPageStatus.isUnderAdvDashNormal() || bdp.bdpPageStatus.isUnderDataScreenNormal() || bdp.bdpPageStatus.isUnderAdvDashFullScreen()) && (s.chartOptPermission = { refresh: !1, edit: !1, summary: !1, fullScreen: !0, dashFilter: !0, warn: !1, sort: !1, more: !1 }); var y = JSON.parse((0, i.default)(s.chartOptPermission)); o.on(p).then(function (e) { m = e, e.on("data", function () { u(e) }) }), s.editData = function () { s.chartId = p, r.open({ templateUrl: n(308), scope: s, className: "ngdialog-theme-default ngDialog-width-520", controller: "editChartTemplateController" }) }, s.edit = function () { var n = f(p), a = { C400: "/gis_edit", C500: "/custom_chart_edit" }, r = a[n.meta.type] || "/chart_edit", o = c.origin ? "?page_referrer=" + c.origin : ""; $.cookie("grid_index", n.index); var s = r + "/" + t.projId + "/" + t.dashId + "/" + p + o; BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "edit", ct_id: p }) }), e.url(s) }, s.refreshChart = function (e) { var t = h.data("chart-data"); if (h.find(".hz-table").length > 0 && h.attr("data-drill", "true"), "warn" === e.type) t.emit("reflow"); else if (t.emit("reflow"), m && m.eChartsInstance) { var n = m.eChartsInstance; n.resize() } g.hide(), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "refresh", ct_id: p }) }) }, s.dashNone = function () { document.getElementById("meiqia-container") && a.$emit("$meiqiaNone") }, s.revertSelection = function () { var e = h.data("chart-data"); e && e.exitSelectionView() }, s.saveTableWidth = function () { h.trigger("saveDashTableWidth") }, s.closeCB = function () { s._t = !s._t }, h.on("hasChangeColWidth", function (e) { g.show(), s._t = !0, s.$$phase || s.$digest() }) }, controller: ["$scope", "commonHttp", "warnOperatorMap", "ngDialog", "$filter", "chartWarnService", function (e, t, n, r, o, s) {
        function l(e) { var t = 0; return (e.info.param_setting || []).forEach(function (e) { e.display && t++ }), !!t } e.switchWarn = function (n) { var a = 1 == n.meta.warn ? 2 : 1; t.get("/api/warn/switch", { ct_id: n.meta.ct_id, opt: a }).then(function (t) { 0 == +t.status && (n.meta.warn = a, e.refreshChart({ type: "warn" })) }) }, e.chartInfo = [], e.chartData = [], e.$on("chart_data_load", function (t, n) { e.ct_id = n.ct_id, e.dash_id = n.dash_id, e.rule_id = n.rule_id, e.chartInfo = n.info, e.chartData = n.chartData, e.warnList = e.chartInfo.warn_info || [], e.warnMark = e.chartData && e.chartData.warn_mark || [], e.warnSwitchOn = !1, e.warnTrigger = { has: !1, show: !1, info: [] }, e.operateView.chartArgIf = l(n), e.operateView.isGraft = "graft" == e.chartInfo.tb_type; for (var a = 0; a < e.warnList.length; a++) { var i = e.warnList[a]; i.switch && (e.warnSwitchOn = !0, i.is_trigger && (e.warnTrigger.has = !0, i.last_warn_result && e.warnTrigger.info.push({ text: i.last_warn_result, time: o("date")(i.last_warn_time, "yyyy-MM-dd HH:mm:ss") }))) } e.canSetWarnLine() }), e.$on("fire-mouseleave-item-event", function () { void 0 !== e.operateView.chartArgShow && (e.operateView.chartArgShow = !1) }), e.canSetWarnLine = function () { e.operateView.canSetWarnLine = !0; var t = e.selected_type, n = e.drill_level || 0; e.operateView.canSetWarnLine = !e.operateView.isGraft && t && ["C212", "C230", "C242", "C271", "C273", "C281", "C290", "C300", "C301", "C320", "C330", "C340", "C352", "C360", "C370", "C400", "C500", "C381", "C213", "C390", "C282", "C221", "C382", "C383"].indexOf(t) < 0 && n < 1 }, e.canEnterFullScreen = function () { var t = !0; bdp.bdpDash.getCurFullScreenElement() && (t = !1), t = bdp.bdpPageStatus.isUnderDataScreen() || bdp.bdpPageStatus.isUnderAdvDash() ? a.dashEditMode || bdp.bdpPageStatus.isUnderAdvDashFullScreen() || bdp.bdpPageStatus.isUnderDataScreenNormal() || bdp.bdpPageStatus.isUnderAdvDashNormal() : !a.dashEditMode, e.operateView.canEnterFullScreen = t }, e.field_list_y = [], e.field_list_y_optional = [], e.showSetWarningDialog = function () {
          angular.forEach(e.warnList, function (e, t) { e.last_warn_time = o("date")(e.last_warn_time, "yyyy-MM-dd HH:mm:ss") }); var t = 0; e.selected.rule_id && a.proj_share ? t = 2 : !e.selected.rule_id && a.proj_share && (t = 1); var n = e.chartInfo, r = {
            name: e.chartInfo.name || e.chartInfo.title, tb_id: e.chartInfo.tb_id, rule_id: e.rule_id || "",
            ct_id: e.ct_id || "", chart_type: e.chartInfo.chart_type, role_type: t, isDash: !0
          }; e.warnModeData = { list: e.warnList, metaFields: [], chartTbFields: [] }, e.warnModeData.metaFields = s.getMetaAxisFields(n), s.openWarnConfigDialog(e, r, e.warnModeData.list, e.warnModeData.metaFields, e.warnModeData.chartTbFields), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "alarm", ct_id: e.chartInfo.chart_id }) })
        }, function () { e.operateView = { chartArgShow: !1, canEnterFullScreen: !0 }, e.canEnterFullScreen() }(), e.$on("refreshChartForWarn", function (t, n) { e.refreshChart({ type: "warn" }), e.warnSwitchOn = !1; for (var a = 0; a < e.warnList.length; a++)if (e.warnList[a].switch) { e.warnSwitchOn = !0; break } })
      }]
    }
  }]).directive("operateMore", ["$rootScope", "$window", "$timeout", "$http", "commonService", "ngDialog", "$stateParams", "commonHttp", "errHint", "$jsTipTranslate", "projectTreeCache", "multipleProService", "$translate", "dashChartLinkService", "chartInstService", function (e, t, a, r, o, s, l, c, d, u, f, p, h, g, m) { return { restrict: "A", templateUrl: n(309), replace: !0, scope: !0, link: function (t, r, v) { function y(n) { var a = t.chartOptMorePermission.exportingExcel; if (a = e.permision.allowExporting && 1 == e.global.exportDataSetting.is_export && a, n) { var i = n.info.chart_type; a = a && ("C500" !== i || "C500" === i && t.customChartEnableExportExcel) } var r = t.chartOptMorePermission.exportingSnapshot; t.embedType && "dataScreen" != t.embedType && (t.chartOptMorePermission.singleExportExcel = e.permision.allowExporting && 1 == e.global.exportDataSetting.is_export, r = !1, a = !1), t.chartOptMorePermission.exportingExcel = a, t.chartOptMorePermission.exportingSnapshot = e.permision.allowExporting && r } function b(e) { var n = void 0; y(e), 1 == e.info.is_ct_tpl ? (n = t.chartOptMorePermission.exportingExcel, t.chartOptMorePermission.exportingExcel = !1, t.chartOptMorePermission.chartLink = !1) : ["C381", "C382", "C383"].indexOf(e.info.chart_type) > -1 ? (t.chartOptMorePermission.chartLink = !1, t.chartOptMorePermission.jumpChart = !1) : (void 0 !== n && (t.chartOptMorePermission.exportingExcel = n), t.chartOptMorePermission.chartLink = !0), t.$$phase || t.$digest() } function w(e) { for (var n = 0, a = null, i = t.dashStandardItems.length - 1; i >= 0; i--) { var r = t.dashStandardItems[i]; if (r.children[0].meta.ct_id === e) { a = r.children[0].meta, n = i; break } } return { meta: a, index: n } } function C(e, t) { var n = angular.copy(e); return angular.forEach(n, function (e) { e.children[0].meta = { ct_id: e.children[0].meta.ct_id, dash_setting: e.children[0].meta.dash_setting, html: e.children[0].meta.html || "" }, t || delete e.children[0].meta.dash_setting }), n } function S(e, t) { var n = angular.copy(f.getTreeCache()); if (n) e(n); else { var a = []; bdp.bdpPageStatus.isUnderAdvDash() && (a = [0, 2]), bdp.bdpPageStatus.isUnderDataScreen() && (a = [1]); var i = { categories: angular.toJson(a) }; o.project.getTree(i).then(function (t) { if (t) { var n = angular.copy(t.proj); p.initDeep(n, 0), f.setTreeCache(n), e(n) } }) } } function k(e) { var n = []; t.project_list ? (n = angular.copy(t.project_list), e(n)) : S(e) } function C(e, t) { var n = angular.copy(e); return angular.forEach(n, function (e) { e.children[0].meta = { ct_id: e.children[0].meta.ct_id, dash_setting: e.children[0].meta.dash_setting, html: e.children[0].meta.html || "" }, t || delete e.children[0].meta.dash_setting }), n } function x() { var e = w(D); t.dashStandardItems.splice(e.index, 1), t.getDashboardInfo(t.dashSelected) } t.$on("fire-mouseleave-item-event", function () { t.viewData.more_show = !1, t.setOperatorIndex(!1, "all") }); var D = v.ctId; t.embedType = v.embedType ? v.embedType : "", t.chartChain = { open: function (e) { e.supportChain && s.open({ template: n(310), className: "ngdialog-theme-default str-filter-model chart-chain-modal", scope: t, data: { meta: e } }) }, del: function (e, n) { e.stopPropagation(), g.delChartLink(n).then(function (e) { d(h.instant("dash.delChartLinkSuccess")), t.$emit("updateDashboardInfo"), s.closeAll() }) } }, function () { t.chartOptMorePermission = { copyChart: !e.dashEditMode, moveChart: !e.dashEditMode, jumpChart: !e.dashEditMode, exportingChart: !e.dashEditMode, exportingExcel: !e.dashEditMode, chartLink: !0, exportingSnapshot: !e.dashEditMode, net_mod_allow: t.dashLayoutInfo && t.dashLayoutInfo.net_mod_allow && t.dashLayoutInfo.net_mod_allow[D], net_info_allow: t.dashLayoutInfo && t.dashLayoutInfo.net_info_allow, singleExportExcel: !1 }, [1, 2].indexOf(e.dashCategory) >= 0 && e.dashEditMode && (t.chartOptMorePermission.copyChart = !0, t.chartOptMorePermission.moveChart = !0, t.chartOptMorePermission.jumpChart = !0, t.chartOptMorePermission.exportingChart = !0, t.chartOptMorePermission.exportingExcel = !0, t.chartOptMorePermission.exportingSnapshot = !0), y() }(), v.origin && v.origin.indexOf("data_screen") > -1 && (t.permision.isDataScreen = !0), t.$watch(v.chartUrl, function (e, n) { e && (t.chartUrl = e) }), t.canExportExcel = function (n) { return e.permision.allowExporting && 1 == e.global.exportDataSetting.is_export && ("C500" !== n.meta.type || "C500" === n.meta.type && t.customChartEnableExportExcel) && t.chartOptMorePermission.exportingExcel }, t.canExportSnapshot = function (n) { return e.permision.allowExporting && t.chartOptMorePermission.exportingSnapshot }, m.on(D).then(function (e) { e.on("data", function () { b(e) }) }), t.del = function () { function n() { var n = angular.copy(t.dashStandardItems); n.splice(l.index, 1), t.global.globalDashFilter && t.global.globalDashFilter.forEach(function (e) { e.rela_ct_ids.indexOf(D) >= 0 && (r = !0) }); var s = { ct_id: D, dsh_meta: { charts: C(n, !0) } }; t.pageWrapStyles && (s.dsh_meta.styles = (0, i.default)(t.pageWrapStyles)), o.chart.del(s).success(function (n) { "0" === n.status || "3211" === n.status ? (t.dashStandardItems.splice(l.index, 1), a(function () { var n = $.inArray(D, e.mainChartIdContainer); 2 == l.meta.chart_link.linked_chart_type || 1 == l.meta.chart_link.linked_chart_type ? t.getDashboardInfo(t.dashSelected) : r && t.getGlobalFilterItem(t.dashSelected), t.dashStandardItems.map(function (e) { var n = e.children[0].meta; n.supportChain = g.getLinkSupport(n, t.draw_chart_url, t.dashStandardItems) }), n > -1 && (e.mainChartContainer.splice(n, 1), e.mainChartIdContainer.splice(n, 1)), _.each(e.mainChartContainer, function (t) { var n = t.ctId; if (t.linkInfo = _.filter(t.linkInfo, function (e) { return e.link_ct_id != D }), t.linkInfo.length <= 0) { var a = $.inArray(n, e.mainChartIdContainer); a > -1 && (e.mainChartContainer.splice(a, 1), e.mainChartIdContainer.splice(a, 1)) } }) })) : errorHandle(n) }) } var r = !1, l = w(D); 2 == l.meta.chart_link.linked_chart_type ? s.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: t, data: { title: h.instant("tips"), message: t.tips["chart.checkToContinueMove"] } }).then(function () { n() }) : s.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: t, data: { title: h.instant("tips"), message: t.tips["chart.confirmDelChart"] + ": " + l.meta.name + "?" } }).then(function () { n() }), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "delete", ct_id: D }) }) }; var T = function (e) { var n = w(D); s.open({ template: "/static/dashboard-core/chart-operate/chart-copy.html", className: "ngdialog-theme-default ngDialog-width-360", scope: t, controller: ["$scope", "commonHttp", "errHint", "$location", function (t, a, r, o) { function c() { t.global.clickComplete = !1; var e = t.copyChartData; if (!e.dashId) return r(t.tips["dash.pleaseSelectDash"]), void (t.global.clickComplete = !0); a.get("/api/chart/copy", { ct_id: D, from: angular.toJson({ proj_id: e.curProId, dsh_id: e.curDshId }), to: angular.toJson({ proj_id: e.projId, dsh_id: e.dashId }), nearby: e.nearby && e.curDshId == e.dashId }).then(function (e) { if (0 == e.status) { r(t.tips["chart.copyChartSuccess"]), s.closeAll(); var a = t.copyChartData; if (a.curProId == a.projId && a.curDshId == a.dashId) { var o = bdp.utils.createNewGridItem(t.dashStandardItems), l = t.dashStandardItems[n.index], c = angular.copy(l), d = t.dashStandardItems[n.index].children[0].meta; c.children[0].meta.ct_id = e.result, c.children[0].meta.chart_link = { link_info: [], linked_chart_type: 0 }, c.children[0].meta.chart_jump = {}; var p = "id" + o.domId; if (c.children[0].dom_id = p, a.nearby && a.curDshId === a.dashId) if (l.col - l.sizeX >= 0 || l.col + 2 * l.sizeX <= 12) { var h = !1, m = !1; l.col - l.sizeX >= 0 && (h = bdp.utils.dropGrid(t.dashStandardItems, "left", angular.copy(c), l)), h || l.col + 2 * l.sizeX <= 12 && (m = bdp.utils.dropGrid(t.dashStandardItems, "right", angular.copy(c), l)), h ? (c.row = l.row, c.col = l.col - l.sizeX) : m ? (c.row = l.row, c.col = l.col + l.sizeX) : (c.row = l.row + l.sizeY, c.col = l.col) } else c.row = l.row + l.sizeY, c.col = l.col; else c.row = o.row, c.col = o.col; (u || f) && (c.left = 100, c.top = 100), t.dashStandardItems.push(c), t.draw_chart_url[p] = angular.copy(t.draw_chart_url[l.children[0].dom_id]), t.draw_chart_url[p].options.ct_id = e.result, t.draw_chart_url[p].options.optional = {}, d.supportChain = g.getLinkSupport(d, t.draw_chart_url, t.dashStandardItems) } } t.global.clickComplete = !0; var v = document.getElementById("J-export-dashboard-height").offsetHeight, y = document.getElementById(D), _ = y.offsetTop + y.offsetHeight; BDPLogger.log("duplicate_chart", { category: "user_interact", action: "click", opt_label: (0, i.default)({ db_id_original: a.curDshId, db_id_destination: a.dashId, duplicate_mode: a.nearby && a.curDshId == a.dashId, db_height: v, original_to_dbtop: _ }) }) }) } t.copyChartData = { curProId: l.projId, curDshId: l.dashId, chartInfo: { chart_id: D, name: n.meta.name }, projId: l.projId, dashId: l.dashId, project_list: e, nearby: !1 }; var d = o.path(), u = (d.indexOf("dash_edit"), d.indexOf("data_screen") > -1), f = bdp.bdpPageStatus.isUnderAdvDash(); t.copyChartData.hideNearby = u || f, t.copyChartSave = c, function () { for (var e = t.copyChartData.project_list, n = 0, a = e.length; n < a; n++)e[n].proj_id == t.copyChartData.projId && (t.copyChartData.dash_list = e[n].dsh_list) }() }] }) }; t.copy_chart = function () { k(T), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "chart_copy", ct_id: D }) }) }, t.setNetWorkSegment = function () { s.open({ template: "/static/dashboard/network-project/network-dashboard.html", className: "ngdialog-theme-default network-dashboard", scope: t, data: { type: "chart", dash_id: l.dashId, ct_id: D, net_info_allow: t.chartOptMorePermission.net_info_allow, net_mod_allow: t.chartOptMorePermission.net_mod_allow, callback: function () { t.refreshChart({ type: "refresh" }) } }, controller: "networkProjDashController" }) }, t.move_chart = function () { k(E), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "chart_move", ct_id: D }) }) }; var E = function (e) { t.global.clickComplete = !defined(t.global.clickComplete) || t.global.clickComplete; var n = w(D); t.moveChartData = { curProId: l.projId, curDshId: l.dashId, chartInfo: { chart_id: D, name: n.meta.name }, projId: l.projId, dashId: l.dashId, project_list: e }, s.open({ template: "/static/dashboard-core/chart-operate/chart-move.html", className: "ngdialog-theme-default ngDialog-width-360", scope: t }); for (var a = t.moveChartData.project_list, i = 0, r = a.length; i < r; i++)a[i].proj_id == t.moveChartData.projId && (t.moveChartData.dash_list = a[i].dsh_list) }; t.changeProjectForMove = function () { for (var e = t.moveChartData.project_list, n = 0, a = e.length; n < a; n++)e[n].proj_id == t.moveChartData.projId && (t.moveChartData.dash_list = e[n].dsh_list, e[n].dsh_list.length > 0 ? t.moveChartData.dashId = e[n].dsh_list[0].dsh_id : t.moveChartData.dashId = "") }, t.moveChartSave = function () { var e = t.moveChartData, n = w(D); if (t.global.clickComplete = !1, !e.dashId) return d(t.tips["template.selectDash"]), void (t.global.clickComplete = !0); if (e.curProId == e.projId && e.curDshId == e.dashId) return d(t.tips["chart.selectOtherPlace"]), void (t.global.clickComplete = !0); var a = [].concat(t.dashStandardItems); a.splice(n.index, 1), c.post("/api/chart/move", { ct_id: D, from: angular.toJson({ proj_id: e.curProId, dsh_id: e.curDshId }), to: angular.toJson({ proj_id: e.projId, dsh_id: e.dashId }), check: "do", dsh_meta: angular.toJson({ charts: C(a, !0) }) }).then(function (e) { t.global.clickComplete = !0, e.result.ismoved ? (d(t.tips["chart.moveChartSuccess"]), x(), s.closeAll()) : s.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngdialog-width-340", scope: t, data: { title: h.instant("tips"), message: t.tips["chart.checkToContinueMove"] } }).then(function () { var e = t.moveChartData; c.post("/api/chart/move", { ct_id: D, from: angular.toJson({ proj_id: e.curProId, dsh_id: e.curDshId }), to: angular.toJson({ proj_id: e.projId, dsh_id: e.dashId }), check: "pass", dsh_meta: angular.toJson({ charts: C(a, !0) }) }).then(function (e) { e.result.ismoved ? (d(t.tips["chart.moveChartSuccess"]), x()) : d(t.tips["chart.moveChartFail"]), s.closeAll() }) }) }) }, u(["chart.copyChartSuccess", "chart.confirmDelChart", "template.selectDash", "chart.selectOtherPlace", "ownership.dashManage.copyFailed", "ownership.dashManage.moveFailed", "ownership.dashManage.selectedItemNoPermission", "chart.checkToContinueMove", "chart.moveChartSuccess", "chart.moveChartFail", "dash.pleaseSelectDash"], t) }, controller: ["$scope", function (e) { e.viewData = { more_show: !1 }, e.setOperatorPos = function (t, n, a) { var r = $(t.currentTarget), o = angular.element("body").height(), s = $("#_iframe_" + n); if (e.viewData.more_show = !e.viewData.more_show, e.setOperatorIndex(e.viewData.more_show, !1, a), o - t.clientY < 176 ? r.find("ul").css({ bottom: 24, top: "inherit" }) : r.find("ul").css({ top: 24, bottom: "inherit" }), s.length) { var l = s[0], c = l.contentWindow["iframe_childCustomData_" + n], d = $(t.currentTarget).parents(".gridster-item"); c && c.enableExportExcel && (e.customChartEnableExportExcel = !0, d.data("custom-chart-data", c)) } BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "more", ct_id: n }) }) }, e.showItemMoreOperate = function (t, n, a) { t.stopPropagation(); var i = $(n), r = $(t.currentTarget), o = r.get(0).getBoundingClientRect(); r.css("position", "relative"); var s = void 0, l = void 0; 2 * o.width + o.left > $(window).width() ? (s = "auto", l = o.width + "px") : (s = o.width + "px", l = "auto"), i.css({ left: s, right: l, top: "-8px" }), e[a] = !0 }, e.setOperatorIndex = function (t, n, a) { n ? e.dashStandardItems.map(function (e) { e.isTopIndex = !!t }) : a.isTopIndex = !!t } }] } }])
}, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-operate/chart-operate.html" }, function (e, t) { e.exports = "/dist/static/dashboard/dash-template/editChartTemplate.html" }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-operate/chart-operate-more.html" }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-link/chart-chain.html" }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").directive("chartFullScreen", ["ngDialog", "$timeout", "$interval", "$translate", function (e, t, n, a) { function r(n, a, r) { function s() { function e() { var e = i.find(".chart").data("chart-data"); e && ["C300", "C301", "C310", "C330", "C340", "C500"].indexOf(e.info.chart_type) >= 0 && ("C300" === e.info.chart_type || "C301" === e.info.chart_type ? t(function () { e.emit("reflow") }, 0) : e.renderChart()), "C200" === e.info.chart_type && e.emit("chartFullScreen", e) } var a = n.chartUrl[n.domid].options.ct_id, i = angular.element("#" + a), r = n.$curfullScreenChart = i[0]; (r.requestFullscreen || r.webkitRequestFullscreen || r.mozRequestFullScreen || r.msRequestFullscreen).apply(r), $(n.$curfullScreenChart).addClass("J-simple-chart-fullscreen"), t(function () { reflowChart(i) }), $(document).off("fullscreenchange.dataScreen webkitfullscreenchange.dataScreen mozfullscreenchange.dataScreen msRequestFullscreen.dataScreen").on("fullscreenchange.dataScreen webkitfullscreenchange.dataScreen mozfullscreenchange.dataScreen msRequestFullscreen.dataScreen", function (t) { bdp.bdpDash.getCurFullScreenElement() ? ($(n.$curfullScreenChart).addClass("J-simple-chart-fullscreen"), e()) : ($(n.$curfullScreenChart).removeClass("J-simple-chart-fullscreen"), $(document).off("fullscreenchange.dataScreen webkitfullscreenchange.dataScreen mozfullscreenchange.dataScreen msRequestFullscreen.dataScreen"), e()) }) } n.$on("ngDialog.opened", function (e, t) { $(".fs-queue-show").addClass("active") }), n.$curfullScreenDom = null, a.on("click", function () { if (n.chartUrl = n.$eval(r.chartUrl), n.domid = n.$eval(r.domid), n.standardItems = n.$eval(r.standardItems), n.isAdvOrScreenFlag = n.$eval(r.advOrScreen), n.autoPlaying = !1, BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "fullscreen", ct_id: n.chartUrl[n.domid].options.ct_id }) }), bdp.bdpDash.getCurFullScreenElement()) return void s(); $("#MEIQIA-BTN-HOLDER") && $("#MEIQIA-BTN-HOLDER").css("display", "none"), $("body").addClass("fs-chart-mode"), o = e.open({ templateUrl: "/static/dashboard-core/chart-fullscreen/fullscreen.html", className: "ngdialog-theme-default fullscreen-modal", showClose: !1, disableAnimation: !0, scope: n, preCloseCallback: function () { $(document).off("keydown.fs_key_ctrl"), $("#MEIQIA-BTN-HOLDER") && $("#MEIQIA-BTN-HOLDER").css("display", "block"), $("body").removeClass("fs-chart-mode") }, controller: "fullscreenCtrl" }) }) } var o, s = a.instant("fs.fullscreen"); return { link: r, template: '<a class="bdp-icon-wrap" title="' + s + '"><i class="bdp-icon ico-fullscreen"></i></a>', restrict: "EA", replace: !0, scope: !0 } }]).controller("fullscreenCtrl", ["$scope", "$rootScope", "$timeout", "$interval", "ngDialog", "autoRefreshChart", "bdpOuterParamService", function (e, t, n, a, i, r, o) { function s(e) { var t = 0; return e = e || [], e.forEach(function (e) { e.display && t++ }), t } function l(e) { var t = []; return (e.meta.x || []).forEach(function (e, n) { if ("date" === e.data_type) { var a = angular.copy(e); a.type = 0, a.origin_index = n, t.push(a) } }), (e.meta.compare_axis || []).forEach(function (e, n) { if ("date" === e.data_type) { var a = angular.copy(e); a.type = 1, a.origin_index = n, t.push(a) } }), t } function c(n, a) { var a = u(a, 0), i = angular.copy(g[a].children[0]); !function (t, n) { _.isFunction(p[t]) && p[t](), p[t] = e.$watch(function () { return e.standardItems[n].children[0] }, function (n, a) { if (n !== a) { var r = e.fullscreen["queue_" + t]; r.filter_opts = i = angular.copy(n), r.date_fields = l(n) } }, !0) }(n, a); var r = l(i); $.extend(e.fullscreen["queue_" + n], { index: a, name: i.meta.name, chart_type: i.meta.type, filter_opts: angular.copy(i), date_fields: r, dom_id: i.dom_id, options: { alwaysShowDataLabels: !0, theme: 1 === e.fullDisplayTheme ? "dark" : "default", device: e.fullDisplayDevice || "pc", _t: new Date, ct_id: i.meta.ct_id, dsh_id: f, optional: { chart_jump_info: i.meta.chart_jump } }, lazyload: !1 }, !0); var o = e.chartUrl[g[a].children[0].dom_id].options, s = o.optional; e.fullscreen["queue_" + n].options.is_tpl = o.is_tpl, s.filter_list && (e.fullscreen["queue_" + n].options.optional.filter_list = s.filter_list), s.dsh_filter && (e.fullscreen["queue_" + n].options.optional.dsh_filter = s.dsh_filter), s.param_setting && (e.fullscreen["queue_" + n].options.optional.param_setting = s.param_setting), s.filter_cmp_date_range && (e.fullscreen["queue_" + n].options.optional.filter_cmp_date_range = s.filter_cmp_date_range), s.sdo_id && (e.fullscreen["queue_" + n].options.optional.sdo_id = s.sdo_id), o.rule_id && (e.fullscreen["queue_" + n].options.optional.rule_id = o.rule_id), e.drillOption && (e.drillOption = void 0), t.fullScreenCacheData = t.fullScreenCacheData || { innerFilterList: {}, advancedSortList: {} }, t.fullScreenCacheData.innerFilterList[o.ct_id] = angular.copy(i.meta.filter_list_inner), t.fullScreenCacheData.advancedSortList[o.ct_id] = angular.copy(i.meta.advanced_sort) } function d(e) { var t = $(".J_chart"), n = $(".fullscreen-modal"), a = n.find(".drill-crumbs-wrap").height(), i = $(".J_filterWrap"), r = $(".J_filterWrap_hidden"); i.css({ visibility: "hidden" }); var o = $(".J_filter", i), s = $(".J_dateGranularity", i), l = $(".J_filter_hidden", r), c = $(".J_dateGranularity_hidden", r), d = i.width(), u = d / 2, f = l.width(), p = c.width() + 24, h = (f + 2) / d * 100, g = p / d * 100; o.css({ width: (h > 100 ? 100 : h) + "%" }), s.css({ width: (g > 100 ? 100 : g) + "%" }), f < u && p < u ? o.css({ width: "50%" }) : f >= u && p >= u ? (o.css({ width: "50%" }), s.css({ width: "50%" })) : f + p >= d && f >= u && p <= u ? o.css({ width: (d - p) / d * 100 + "%" }) : f + p >= d && f <= u && p >= u && 0 != f && s.css({ width: (d - f) / d * 100 + "%" }), i.attr("has-add-diff", "true"), i.css({ visibility: "visible", minWidth: "1000px" }), t.css({ top: i.height() + 79 + a }) } function u(e, t) { return e >= g.length ? e %= g.length : e < 0 && (e = g.length + e), "C101" === g[e].children[0].meta.type && (t >= 0 ? e++ : t < 0 && e--, e = u(e, t)), e < g.length && e >= 0 ? e : u(e) } var f = e.dashSelected, p = {}, h = new o; h.parseUrlParam(); h.getUrlObj(); location.href.indexOf("/embed/dashboard.html") > -1 && (f = bdp.utils.getQueryParams().dashId, console.log(f)); for (var g = [], m = 0; m < e.standardItems.length; m++) { var v = e.standardItems[m]; g.push(v) } var y = function (e, t) { return "index" in e && "index" in t ? e.index - t.index : e.row == t.row ? e.col - t.col : e.row < t.row ? -1 : 1 }; e.standardItems = e.standardItems.sort(y), g = g.sort(y), e.fullscreen = { auto_play_flag: !1, isAdvOrScreenFlag: bdp.bdpPageStatus.isUnderDataScreen() || bdp.bdpPageStatus.isUnderAdvDash() || bdp.bdpPageStatus.isUnderAdvDashNormal() || !!e.isAdvOrScreenFlag, index: 0, charts: g, filter: {}, queue_show: {}, queue_next: {} }, e.shareAdvDash && 2 == e.shareAdvDash.dashCategory && (e.fullscreen.isAdvOrScreenFlag = !0), 2 == t.dashCategory && (e.fullscreen.isAdvOrScreenFlag = !0), e.fullscreen.ableSlide = !e.fullscreen.isAdvOrScreenFlag, e.fullscreen.ableLeftNav = !e.fullscreen.isAdvOrScreenFlag, t.fullScreenCacheData = {}, t.fullScreenCacheData.innerFilterList = t.fullScreenCacheData.innerFilterList || {}, t.fullScreenCacheData.advancedSortList = t.fullScreenCacheData.advancedSortList || {}, function () { $(document).off("keydown.change_item_pos"), $(document).off("keydown.save_item_pos"); for (var t = 0, n = 0; n < g.length; n++)if (e.chartUrl[e.domid].options.ct_id === g[n].children[0].meta.ct_id) { t = n; break } e.fullscreen.index = t, e.fullscreen.name = g[e.fullscreen.index].children[0].meta.name, c("show", t), e.fullscreen.info = e.fullscreen.queue_show, e.fullscreen.paramSettingShow = s(e.fullscreen.info.filter_opts.meta.param_setting), e.$on("_websocketChartMessage_", function (t, n) { var a = "string" == typeof n.data ? $.parseJSON(n.data) : n.data; if (1 == a.type && r.refresh({ drawChartUrl: e.fullscreen.queue_show, type: "fullscreen", evt: t, scope: e, ret: n }), 12 == a.type) { if (!$("body").hasClass("fs-chart-mode")) return !1; var i = n.data.msg_content; if (console.log("外部传参param", i), 0 == Number(i.is_df)) { var o = {}; o[e.fullscreen.queue_show.dom_id] = e.fullscreen.queue_show; var s = {}; e.fullscreen.charts.forEach(function (e) { var t = e.children[0].dom_id; s[t] = e }), h.findDashFilter({ param: i, drawChartUrl: o, dashItems: s, callback: function (t) { t && !e.$$phase && e.$digest() } }) } } }), e.toggleParam = function () { var t = { dsh_id: "dsh_7fcf519515c2e88a8bdcf70b47b9d6a0", ct_id: "ct_d0fdeafd1564b9be9820d6bbd3e66eed", is_df: 0, filter_list: [{ fid: "fk8ac61cca_day", data_type: "sub_date", uniq_id: 1522031274038, range: ["1"] }] }; console.log("外部传参param", t); var n = {}, a = {}; n[e.fullscreen.queue_show.dom_id] = e.fullscreen.queue_show, e.fullscreen.charts.forEach(function (e) { var t = e.children[0].dom_id; a[t] = e }), h.findDashFilter({ param: t, drawChartUrl: n, dashItems: a, callback: function (t) { t && !e.$$phase && e.$digest() } }) } }(), e.slide = function (t, n) { if (t) { var a = u((e.fullscreen.index + t) % g.length, t); if (e.fullscreen.index = a, n && !n.auto) $(".fullscreen-modal").find(".drill-crumbs-wrap").html(""), c("show", a), c("next", a + 1), $(".fs-queue-next").removeClass("active"), $(".fs-queue-show").addClass("active"), e.fullscreen.name = g[e.fullscreen.index].children[0].meta.name; else { var i = $(".fullscreen-chart"); if (1 === g.length) return; for (var r = 0; r < i.length; r++) { var o = i.eq(r), s = o[0].className; if (s.indexOf("active") > -1) { if (s.indexOf("fs-queue-show") > -1) { e.fullscreen.queue_show.options.optional.drill_level > 0 && $(".fullscreen-modal").find(".drill-crumbs-wrap").html(""); var l = $(".fs-queue-next"); o.removeClass("active").html(""), l.addClass("active"), e.fullscreen.name = g[e.fullscreen.index].children[0].meta.name, e.fullscreen.info = e.fullscreen.queue_next, c("show", a + t) } else if (s.indexOf("fs-queue-next") > -1) { e.fullscreen.queue_next.options.optional.drill_level > 0 && $(".fullscreen-modal").find(".drill-crumbs-wrap").html(""); var d = $(".fs-queue-show"); o.removeClass("active").html(""), d.addClass("active"), e.fullscreen.name = g[e.fullscreen.index].children[0].meta.name, e.fullscreen.info = e.fullscreen.queue_show, c("next", a + t) } break } } } $(".J_filterWrap").css({ visibility: "hidden" }) } }; var b, w = null; e.autoPlay = function (t) { e.autoPlaying = t, e.watchPlayState(t, !0), $(".J_filterWrap").css({ visibility: "hidden" }), clearTimeout(w); var n = $(".fs-chart-main").parent(); if (t) { var a = $('<div class="only-layer" style="position:absolute;z-index:10;left:0;right:0;top:20;bottom:0;"></div>'); a.on("click", function () { e.autoPlay(!1) }), n.append(a) } else e.fullscreen.auto_play_flag = !1, n.find(".only-layer").length && n.find(".only-layer").remove(), w = setTimeout(function () { d() }, 25) }, e.watchPlayState = function (t, n) { t ? setTimeout(function () { e.slide(1, { auto: !1 }), b = a(function () { e.slide(1, { auto: !0 }) }, 5e3) }, 1e3) : a.cancel(b) }, e.fullScreenGranularity = function (t, n, a, i, r) { a.granularity = i; var o = (angular.element(t.target), a.origin_index), s = e.fullscreen.queue_show.options.optional.display_granularity || {}; s[e.drill_level] = s[e.drill_level] || [], s[e.drill_level].some(function (e, t) { return e.uniq_id === a.uniq_id && o == e.index }) ? s[e.drill_level].forEach(function (e, t) { e.uniq_id === a.uniq_id && e.index == o && (e.granularity = a.granularity, e.granularity_name = r || "", e.index = o, e.type = a.type) }) : s[e.drill_level].push({ index: 0, granularity: a.granularity, granularity_name: r || "", fid: a.fid, uniq_id: a.uniq_id, type: a.type }), e.fullscreen.queue_show.options.optional.display_granularity = s }, e.$on("$destroy", function () { a.cancel(b), p.show && p.show(), p.next && p.next() }), e.slideNav = function (e, t) { if ("show" === t) $(".fullscreen-modal").find(".nav").addClass("open"), $(".nav-handler").css({ height: 64 }); else if ("hide" === t) { if (e.clientX < 196) return; $(".fullscreen-modal").find(".nav").removeClass("open"), $(".nav-handler").css({ height: "100%" }) } }, e.toggleDataLabel = function (t) { if (e.show_data_label = void 0 !== t ? t : !e.show_data_label, e.show_data_label) $(".fs-data-label").remove(); else { var n = $("<style class='fs-data-label' type='text/css' rel='stylesheet' />").appendTo("head"), a = ".fullscreen-modal .chart .highcharts-data-labels > g, .fullscreen-modal .chart .highcharts-data-labels > div, .fullscreen-modal .chart-pie .highcharts-data-label-connector ,.fullscreen-modal .funnel-datalabels, .fullscreen-modal .sunburst-labels {display:none}", i = ".fullscreen-modal .bdp-datalabels {opacity:0; visibility:hidden;}"; n[0].styleSheet ? n[0].styleSheet.cssText = a + i : n[0].appendChild(document.createTextNode(a + i)) } localStorage.setItem("fs_data_label", 1 & e.show_data_label) }, e.toggleChartDescription = function (t) { e.show_chart_description = void 0 !== t ? t : !e.show_chart_description, setTimeout(function () { d("showRemark"), reflowChart($(".fullscreen-chart").parent(), !0) }, 0), localStorage.setItem("fs_chart_description", e.show_chart_description) }; var C = localStorage.getItem("fs_chart_description"); void 0 != C ? e.toggleChartDescription(1 == C) : e.show_chart_description = !1; var S = localStorage.getItem("fs_data_label"); void 0 != S ? e.toggleDataLabel(1 == S) : e.show_data_label = 0 == $(".fs-data-label").length, e.$watch("show_chart_description", function (t) { e.$broadcast("toggleAllPoints", t) }), e.fullscreen.isAdvOrScreenFlag || $(document).off("keydown.fs_key_ctrl").on("keydown.fs_key_ctrl", function (n) { if (!$(n.target).closest(".string-filter").length && !$(n.target).closest(".daterange-input").length) { switch (n.keyCode) { case 39: case 40: e.slide(1, { auto: !1 }); break; case 37: case 38: e.slide(-1, { auto: !1 }); break; case 27: e.closeThisDialog(), document.getElementById("meiqia-container") && t.$emit("$meiqiaBlock") }e.$$phase || e.$apply() } }), e.revertSelection = function () { var e = $(".fs-queue-show").data("chart-data"); return e && e.exitSelectionView(), !1 }, e.showMore = function (e) { if (!$(e.target).hasClass("J-revert-selection")) { var t = $(".J-more-action"), n = $(".J-action-optlist"), a = $(".J-fullscreen-more"); if (a.addClass("open"), n.addClass("open"), $(".J-action-opt-wrap").css("z-index", "3"), 0 == t.find(".opacity-layer").length) { var i = $('<div class="opacity-layer"></div>'); i.on("mouseenter", function () { t.parent().find(".opacity-layer").remove(), n.removeClass("open"), a.removeClass("open"), $(".J-action-opt-wrap").css("z-index", "1") }), t.parent().append(i) } } } }]) }, function (e, t, n) {
  "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); !function () {
    angular.module("BC.dashboard.core").directive("dashFilter", ["$timeout", "commonService", "$rootScope", "commonHttp", "$filter", "ngDialog", "errHint", "$stateParams", "AdvfilterOperatorMap", "AdvfilterOperatorList", "numberInnerFilterMap", "operatorHelpLink", "formulaKeyMap", "setAdvanceAggregatorName", "$jsTipTranslate", "dateTimeByHalfHour", "globalDateSchemeService", function (e, t, n, a, r, o, s, l, c, d, u, f, p, h, g, m, v) {
      return {
        restrict: "A", templateUrl: "/static/dashboard-core/dash-filter/dash-filter.html", replace: !0, scope: { chartOptions: "=", opts: "=", advDateList: "=" }, link: function (r, p, y) {
          function _(e) { if ("add" == e) { var t = '<div class="chart-operate-mask" style="position:absolute;left:0;top:0;bottom:0;right:0;z-index:10;cursor:default"></div>'; $(p).parents(".chart-box").find(".item-chart").append(t), $(p).prepend(t) } else $(p).parents(".chart-box").find(".chart-operate-mask").remove() } function b() { r.isActive = !1, angular.forEach(r.filter_list_inner, function (e) { void 0 != e.range && e.range.length > 0 && (r.isActive = !0) }) } function w(e, t) { var n = e.fid, a = { right: 0, top: 26 }, i = bdp.utils.getArrayTextWidth(t, e); a.width = i, r.adjustWidth[n] = a } r.dateTimeByHalfHour = m, r.$on("fire-mouseleave-item-event", function () { r.show_dash_filter = !1 }), r.$watch("show_dash_filter", function (e) { void 0 !== e && "dashboard" == y.chartMode && _(e ? "add" : "remove") }), r.adjustWidth = {}, r.fullscreen = !!y.fullscreen, r.goHelp = function (e) { f(e) }; var C = function (e) { if (r.chartOptions.read_cache = !1, "C500" == r.opts.meta.type) { var t = {}; r.filter_list_inner.forEach(function (e) { t[e.ct_id] || (t[e.ct_id] = []), t[e.ct_id].push(e) }), r.chartOptions.optional.filter_list_map = t } else r.chartOptions.optional.filter_list = r.filter_list_inner; r.chartOptions.optional.filter_last_mod = e, BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "chart_filter_apply", ct_id: r.chartOptions.ct_id }) }) }, S = !1, k = 0, x = 0, D = 0; r.handleFilterPos = function (e) { r.show_dash_filter = !r.show_dash_filter; var t = $(e.target), n = t.parent(), a = n.find(".J_filterLayer"); a.removeClass("ng-hide"); var o = n.width(), s = $(".J_dash_sidebar").width(), l = document.getElementById(r.opts.meta.ct_id), c = a.offset().left; D = l.style.left, D != x && (S = !1), S || (k = c <= s ? o - a.width() : -11, S = !0), a.css({ right: k }), x = D, BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "chart_filter_icon", ct_id: r.chartOptions.ct_id }) }) }, r.conditionList = [], r.operatorMap = c, r.AdvfilterOperatorList = d, r.numberInnerFilterMap = u, r.new_condition = { operator: "", content: "" }; var T; r.toggleCmpDropdown = function (e, t) { r.show_options[t.uniq_id] = !r.show_options[t.uniq_id] }, r.compareDateChange = function (e, t) { if (r.dateRangShow = !r.dateRangShow, "default" == e) t.compareType = "default", t.customName = void 0, r.chartOptions.optional.filter_cmp_date_range = [], r.show_options[t.uniq_id] = !1; else if ("custom" == e) { r.show_options[t.uniq_id] = !1; var n, a, i, s = []; r.chartOptions.optional && (i = r.chartOptions.optional.filter_cmp_date_range), i && i[0] ? (n = i[0].compare_date_range.st, a = i[0].compare_date_range.et) : (n = (new Date).getTime(), a = (new Date).getTime()); var l, c; l = isNaN(n) ? n.split(" ")[1] : "00:00:00", c = isNaN(a) ? a.split(" ")[1] : "23:59:59", s.push(n, a, l, c), T = o.open({ template: "/static/partials/dialogTemplates/custom-date-modal.html", className: "ngdialog-theme-default date-picker-modal daterange-bdp-modal", data: { range: s, uniq_id: parseInt(t.uniq_id) }, scope: r }) } }, r.getCmpDefaultName = function (e) { return r.tips["chart.compareDate"] + "(" + e.name + " - " + e.aggregatorName + ")" }, r.addNewCondition = function (e, t) { var n = 8 == t.operator || 9 == t.operator; if (void 0 == t || !t.hasOwnProperty("operator") || !n && "" == t.content) return void s(r.tips["filter.inputCompleteCondition"]); n && (t.content = ""), r.strFilter.conditionList.push({ name: e, operator: t.operator, content: t.content }), angular.element(".new-condition").val(""), angular.element(".condition-select").val(""), r.new_condition = { operator: "", content: "" } }, r.removeCondition = function (e) { r.strFilter.conditionList.splice(e, 1) }, r.saveDateRange = function (e, t) {
            var n = e.sDate ? e.sDate + " " + e.sDateHour : null, a = e.eDate ? e.eDate + " " + e.eDateHour : null; if (!n && !a) return s(r.tips["chart.dateRangeRequired"]), !1; if (n && a) { if (!e.sDateHour) return s(r.tips["filter.startDateErr2"]), !1; if (!e.eDateHour) return s(r.tips["filter.endDateErr2"]), !1; if (new Date(n) - new Date(a) > 0) return s(r.tips["filter.dateRangeInvalid"]), !1 } else {
              if (n && !a && !e.sDateHour) return s(r.tips["filter.startDateErr2"]), !1; if (!n && a && !e.eDateHour) return s(r.tips["filter.endDateErr2"]), !1
            } if (t) { r.chartOptions.optional.filter_cmp_date_range = [{ uniq_id: parseInt(t), compare_date_range: { st: n, et: a } }]; var i = "zh" === bdpChart.language ? "不限" : "Unbounded", l = /00\:00\:00$/, c = /23\:59\:59$/; r.opts.meta.compareDateFilter.forEach(function (e) { e.uniq_id == t && (n && a && l.test(n) && c.test(a) ? (n = n.replace("00:00:00", ""), a = a.replace("23:59:59", "")) : (n = n ? n.replace("00:00:00", "") : i, a = a ? a.replace("23:59:59", "") : i), e.compareType = "custom", r.fullscreen ? e.customName = r.tips["chart.compareDate"] + "(" + e.name + " - " + n + "~" + a + ")" : e.customName = r.tips["filter.compare"] + " " + n + "~" + a) }), o.close(T.id) } else r.innerFilterModule.setInnerFilter({ range: [n, a], index: e.data.index, fid: e.data.fid, type: "custom_date" })
          }, r.isQuery = !1, r.strFilter = {}, r.queryKwd = {}, r.filterQueryModule = { enterToQuery: function (e) { 13 == e.e.keyCode && (e.is_advance ? r.strFilter.filterKwd = r.strFilter.keyword : r.innerFilterItems[e.filter.fid].keyword = r.queryKwd[e.filter.fid], e.real_search && this.query(e.filter, e.is_advance)) }, delQueryField: function (e) { r.tempQueryList && (r.innerFilterItems[e].list = r.tempQueryList || []), r.queryKwd[e] = "" }, query: function (e, t) { r.showLoading = !0; var i = "", o = e.fid; if (i = r.queryKwd[o] ? r.queryKwd[o] : r.strFilter.keyword, t ? r.strFilter.filterKwd = i : r.innerFilterItems[o].keyword = i, !i) return r.showLoading = !1, r.isQuery = !1, void (r.strFilter.searchList = angular.copy(r.strFilter.originalSearchList)); var c = r.opts.meta; r.$parent.drillOption ? r.tempDrillOption = angular.copy(r.$parent.drillOption) : r.tempDrillOption = { drill_field: "", drill_level: "", drill_value: [] }; var d = { ct_id: e.ct_id || c.ct_id, tb_id: e.tb_id || c.tb_id, fid: o, keyword: i, rule_id: n.global.rule_id, filter_list: angular.toJson(r.chartOptions.optional.filter_list ? r.chartOptions.optional.filter_list : []), granularity: e.granularity || "", dsh_id: l.dashId, dsh_filter: angular.toJson(r.chartOptions.optional.dsh_filter ? r.chartOptions.optional.dsh_filter : []), drill_field: r.tempDrillOption.drill_field, drill_level: r.tempDrillOption.drill_level, drill_value: angular.toJson(r.tempDrillOption.drill_value) }; t && (r.strFilter.loading = !0), a.post("/api/adv_enum/search", d).then(function (e) { if (r.strFilter.loading = !1, r.showLoading = !1, 0 == e.status) if (r.tempQueryList = angular.copy(r.innerFilterItems[o].list), t) { r.isQuery = !0; var n = []; angular.forEach(e.result, function (e) { n.push({ name: e, select: !1 }) }), r.strFilter.searchList = n } else r.innerFilterItems[o].list = e.result; else s(Number(e.status)) }) } }, r.defaultRange = {}, r.nullRange = {}; var E; r.innerFilterModule = { showDatePicker: function (e, t, n) { if (navigator.userAgent.indexOf("Firefox") >= 0 && t[0] && t[0].indexOf("opt_") >= 0); else if (navigator.userAgent.indexOf("Firefox") >= 0 && t && t.length > 0) { var a = null, i = null; t[0] && (a = t[0].split("-"), a[1] < 10 && (a[1] = "0" + parseInt(a[1])), a[2] < 10 && (a[2] = "0" + parseInt(a[2])), a = a[0] + "-" + a[1] + "-" + a[2]), t[1] && (i = t[1].split("-"), i[1] < 10 && (i[1] = "0" + parseInt(i[1])), i[2] < 10 && (i[2] = "0" + parseInt(i[2])), i = i[0] + "-" + i[1] + "-" + i[2]), t = [a, i] } if (t.length > 1) { var s = t[0] ? t[0].split(" ")[1] || "00:00:00" : "00:00:00", l = t[1] ? t[1].split(" ")[1] || "23:59:59" : "23:59:59"; t = t.concat([s, l]) } else 0 === t.length && (t = [+new Date, +new Date, "00:00:00", "23:59:59"]); E = o.open({ template: "/static/partials/dialogTemplates/custom-date-modal.html", className: "ngdialog-theme-default date-picker-modal daterange-bdp-modal", data: { fid: n, index: e, range: t }, scope: r }) }, numberInnerFilterMap: u, getItemList: function (i, o, s) { var c = o.fid, d = o.granularity || ""; return o.hasOwnProperty("uniq_id") || (o.uniq_id = ""), r.show_options[c + o.uniq_id] = !s && !r.show_options[c + o.uniq_id], r.queryKwd[c] = "", !r.show_options[c + o.uniq_id] && !s || o.disabled ? void (r.adjustWidth[o.fid] = { top: 26 }) : (r.showLoading = !0, r.currentChartId = i.ct_id, r.$parent.drillOption ? r.tempDrillOption = angular.copy(r.$parent.drillOption) : r.tempDrillOption = { drill_field: "", drill_level: "", drill_value: [] }, "date" != o.data_type || "" != o.granularity || o.hasOwnProperty("aggregator") ? void a.post("/api/field/inner_range", { dsh_id: l.dashId, ct_id: o.ct_id || i.ct_id, tb_id: o.tb_id || i.tb_id, fid: c, granularity: d, rule_id: n.global.rule_id, filter_list: angular.toJson(r.chartOptions.optional.filter_list ? r.chartOptions.optional.filter_list : []), dsh_filter: angular.toJson(r.chartOptions.optional.dsh_filter ? r.chartOptions.optional.dsh_filter : []), drill_field: r.tempDrillOption.drill_field, drill_level: r.tempDrillOption.drill_level, drill_value: angular.toJson(r.tempDrillOption.drill_value) }).then(function (e) { if (r.showLoading = !1, 0 == e.status) { var t = e.result; r.innerFilterItems[c] = { list: t.range, total: t.total, keyword: "" }, s ? s(o, t.range, t.total) : w(o, t.range) } else errorHandle(e) }) : (r.showLoading = !0, t.adv_date.list(i.ct_id, o.scheme_id).then(function (t) { if (r.showLoading = !1, 0 == +t.status) { v.setChartSchemeCache(i.ct_id + "_" + o.scheme_id, t.result); var n = r.adv_date_list.concat(t.result || []); r.adv_date_list = v.advDateListUnique(n), e(function () { r.innerFilterItems[c] = { list: t.result, total: 0, keyword: "" } }), s ? s(o, []) : w(o, []) } }), !1)) }, getItemListForNumber: function (e, t) { if (r.currentChartId = e.ct_id, r.$parent.drillOption ? r.tempDrillOption = angular.copy(r.$parent.drillOption) : r.tempDrillOption = { drill_field: "", drill_level: "", drill_value: [] }, r.show_options[t.fid + t.uniq_id] = !r.show_options[t.fid + t.uniq_id], r.show_options[t.fid + t.uniq_id]) { r.nullRange[t.fid + t.uniq_id] = !1; var i = r.filter_list_inner; angular.forEach(i, function (i) { if (i.fid == t.fid && i.uniq_id == t.uniq_id) if (0 == i.range.length) r.showLoading = !0, a.get("/api/field/inner_range", { dsh_id: l.dashId, ct_id: t.ct_id || e.ct_id, tb_id: t.tb_id || e.tb_id, fid: t.fid, uniq_id: t.uniq_id, granularity: "", rule_id: n.global.rule_id, filter_list: angular.toJson(r.chartOptions.optional.filter_list ? r.chartOptions.optional.filter_list : []), dsh_filter: angular.toJson(r.chartOptions.optional.dsh_filter ? r.chartOptions.optional.dsh_filter : []), drill_field: r.tempDrillOption.drill_field, drill_level: r.tempDrillOption.drill_level, drill_value: angular.toJson(r.tempDrillOption.drill_value) }).then(function (e) { 0 == e.status && (r.showLoading = !1, r.innerFilterItems[t.fid + t.uniq_id].numOpt = -1, r.innerFilterItems[t.fid + t.uniq_id].numRange = [], r.defaultRange[t.fid + t.uniq_id] = e.result.range, 0 == r.defaultRange[t.fid + t.uniq_id].length ? r.nullRange[t.fid + t.uniq_id] = !0 : r.defaultRange[t.fid + t.uniq_id] = r.handleNumberByFormatter(e.result.range, t.formatter, t.aggregator)) }); else { var o = i.range, s = angular.fromJson(o[0]).conditions; 1 == s.length ? (r.innerFilterItems[t.fid + t.uniq_id].numOpt = s[0].calc_type, r.innerFilterItems[t.fid + t.uniq_id].numRange = [s[0].value]) : s.length > 1 && (r.innerFilterItems[t.fid + t.uniq_id].numOpt = 12, r.innerFilterItems[t.fid + t.uniq_id].numRange = [s[0].value, s[1].value]), r.nullRange[t.fid + t.uniq_id] = !1, r.defaultRange[t.fid + t.uniq_id] = [] } }) } }, setInnerFilter: function (t) { var a = []; if ("dashboard" === n.view && (a = r.opts.meta.allMetricFields), "date" == t.type) { var i = !1; if (1 === t.range.length) { (r.innerFilterItems[t.fid].list || []).forEach(function (e, n) { if (e.opt_id === t.range[0]) for (var r = angular.fromJson(e.config), o = 0, s = a.length; o < s; o++) { var l = a[o]; if (l.yoyQoqSetting && "filter" === l.yoyQoqSetting.type && l.yoyQoqSetting.date_field_fid === t.fid) { r.expression && "" != r.expression && (i = !0); break } } }) } if (i && !confirm(r.tips["filter.switchExpTip"])) return } "custom_date" !== t.type ? r.filter_list_inner[t.index].range = t.range || [] : ("" == r.filter_list_inner[t.index].range && (r.filter_list_inner[t.index].range = []), r.filter_list_inner[t.index].range = t.range), t.type && (t.hasOwnProperty("uniq_id") || (t.uniq_id = ""), "string" === t.type ? e(function () { r.innerFilterItems[t.fid].list = [], r.innerFilterItems[t.fid].keyword = "" }, 10) : "date" === t.type && (r.filter_list_inner[t.index].range = t.range || [])), r.filter_list_inner[t.index].inner_adv_type = "", r.filter_list_inner[t.index].is_defined = !1, r.filter_list_inner[t.index].range_type = 1, r["show_custom_" + t.fid + t.uniq_id] = !1, r.show_options[t.fid + t.uniq_id] = !1, r.showLoading = !1, C(t.fid), b(), E && o.close(E.id), E = null }, setInnerFilterForNumber: function (e) { var t = "", n = { condition_type: 2, conditions: [] }, a = r.innerFilterItems[e.fid + e.uniq_id], i = 8 == a.numOpt || 9 == a.numOpt; if (a.numOpt == -1) t = []; else if (12 == a.numOpt) { if ("number" != typeof a.numRange[0] || "number" != typeof a.numRange[1]) return void s(r.tips["filter.pleaseInputCondition"]); n.conditions.push({ calc_type: 4, value: a.numRange[0] }), n.conditions.push({ calc_type: 5, value: a.numRange[1] }), t = [angular.toJson(n)] } else { if (!i && "number" != typeof a.numRange[0]) return void s(r.tips["filter.pleaseInputCondition"]); n.conditions.push({ calc_type: a.numOpt, value: i ? "" : a.numRange[0] }), t = [angular.toJson(n)] } r.numberConditionFormat(e.fid + e.uniq_id, a.numOpt, a.numRange), r.filter_list_inner[e.index].range = t, r.filter_list_inner[e.index].inner_adv_type = "condition", r.filter_list_inner[e.index].is_defined = !1, r["show_custom_" + e.fid + e.uniq_id] = !1, e.hasOwnProperty("uniq_id") || (e.uniq_id = ""), r.show_options[e.fid + e.uniq_id] = !1, C(e.fid), b() }, openAdvanceModal: function (e, t, n) { r.isQuery = !1, r.strFilter = { fid: e.fid, uniq_id: e.uniq_id || "", name: e.name, granularity: e.granularity || "", keyword: "", filterKwd: "", total: n, data_type: e.data_type, is_compare: !!e.is_compare, searchList: [], originalSearchList: [], addList: [], inner_adv_type: e.inner_adv_type || "exact", range_type: "", condition_type: 1, conditions: [], conditionList: [], expression_str: "" }, e.hasOwnProperty("range_type") ? r.strFilter.range_type = e.range_type : r.strFilter.range_type = 1, r.conditionList = [], r.expressionChangedFlag = !1, r.checkFormulaGrammarFlag = !1, "C330" == r.opts.meta.type ? r.disabled_compare = !0 : r.disabled_compare = !1; var a = function () { var n = void 0 == e.range ? [] : e.range; angular.forEach(t, function (e) { $.inArray(e, n) > -1 ? r.strFilter.searchList.push({ name: e, select: !0 }) : r.strFilter.searchList.push({ name: e, select: !1 }) }), r.strFilter.originalSearchList = angular.copy(r.strFilter.searchList) }; if (e.inner_adv_type) { if ("exact" == e.inner_adv_type) r.strFilter.addList = angular.fromJson(e.range[0]) || [], a(); else if ("condition" == e.inner_adv_type) { r.strFilter.inner_adv_type = "condition", a(); var i = angular.fromJson(e.range[0]); r.strFilter.condition_type = i.condition_type, r.strFilter.conditions = i.conditions, angular.forEach(r.strFilter.conditions, function (t) { r.strFilter.conditionList.push({ name: e.name, operator: t.calc_type, content: t.value }) }) } else if ("expression" == e.inner_adv_type) { r.strFilter.inner_adv_type = "expression", a(), r.strFilter.expression_str = e.range[0]; var s = new RegExp("\\[_field_id_\\]", "g"); r.strFilter.expression_str = r.strFilter.expression_str.replace(s, "[" + e.name + "]") } } else a(), angular.forEach(r.filter_list_inner, function (t) { t.hasOwnProperty("uniq_id") || (t.uniq_id = ""), t.fid == e.fid && t.uniq_id == e.uniq_id && (r.strFilter.addList = angular.copy(t.range)) }); r.originalFilter = angular.copy(r.strFilter), r.strInnerFilterDialog = o.open({ template: "/static/dashboard-core/dash-filter/dash-filter-multiple.html", className: "ngdialog-theme-default str-filter-model dash-filter-adv-model", scope: r, preCloseCallback: function () { } }) }, addAdvanceItem: function (t, n) { n && n.stopPropagation(); var a = !1; if ($.inArray(t.name, r.strFilter.addList) > -1 && (a = !0), a) return void s(r.tips["filter.itemExist"]); r.strFilter.addList.push(t.name), e(function () { var e = $(".add-list").find("ul"), t = e[0].scrollHeight; e.animate({ scrollTop: t }) }, 300) }, delAdvanceItem: function (e, t) { t && t.stopPropagation(); for (var n = r.strFilter.searchList, a = 0, i = n.length; a < i; a++)if (n[a].name == r.strFilter.addList[e]) { n[a].select = !1; break } r.strFilter.addList.splice(e, 1) }, addAll: function () { function e(e) { r.strFilter.total <= 100 && r.strFilter.keyword ? e.name.toLocaleLowerCase().indexOf(r.strFilter.keyword.toLocaleLowerCase()) >= 0 && r.strFilter.addList.push(e.name) : r.strFilter.addList.push(e.name) } if (0 == r.strFilter.addList.length) return void angular.forEach(r.strFilter.searchList, function (t) { e(t) }); angular.forEach(r.strFilter.searchList, function (t) { $.inArray(t.name, r.strFilter.addList) < 0 && e(t) }) }, delAll: function () { r.strFilter.addList = [] }, saveAdvance: function () { for (var e = r.filter_list_inner, t = function (t, n, a) { var i = []; "exact" == n || "condition" == n ? (e[t].rangeNumber = a.length, e[t].rangeFirstField = a[0], i.push(angular.toJson(a)), e[t].range = i) : (e[t].rangeNumber = 0, e[t].rangeFirstField = "", i.push(a), e[t].range = i) }, n = function (t, n) { 1 == n ? (r["show_custom_" + r.strFilter.fid + r.strFilter.uniq_id] = !0, e[t].is_defined = !0, r.is_defined = !0) : 0 == n && (e[t].inner_adv_type = "", r["show_custom_" + r.strFilter.fid + r.strFilter.uniq_id] = !1, e[t].is_defined = !1) }, a = 0, i = e.length; a < i; a++) { if (r.strFilter.hasOwnProperty("uniq_id") || (r.strFilter.uniq_id = ""), e[a].fid == r.strFilter.fid && e[a].uniq_id == r.strFilter.uniq_id) { if (e[a].range_type = r.strFilter.range_type, e[a].range = r.strFilter.addList, e[a].is_compare = 1 & !!r.strFilter.is_compare, e[a].inner_adv_type = r.strFilter.inner_adv_type, "exact" == r.strFilter.inner_adv_type) { if (0 == r.strFilter.addList.length) return n(a, 0), C(r.strFilter.fid), b(), void r.strInnerFilterDialog.close(); t(a, "exact", r.strFilter.addList) } else if ("condition" == r.strFilter.inner_adv_type) { if (0 == r.strFilter.conditionList.length) return n(a, 0), C(r.strFilter.fid), b(), void r.strInnerFilterDialog.close(); var o = { condition_type: 1, conditions: [] }; o.condition_type = r.strFilter.condition_type, angular.forEach(r.strFilter.conditionList, function (e) { o.conditions.push({ calc_type: e.operator, value: e.content }) }), t(a, "condition", o) } else if ("expression" == r.strFilter.inner_adv_type) { var l = r.checkFormulaGrammar(r.strFilter.name, r.strFilter.fid, "string"); if (l) return l.then(function (e) { e ? (t(a, "expression", r.strFilter.expression_str), n(a, 1), C(r.strFilter.fid), b(), r.strInnerFilterDialog.close()) : s(r.tips["filter.checkFailed"]) }); return } return n(a, 1), C(r.strFilter.fid), b(), void r.strInnerFilterDialog.close() } } }, isShowFilter: function (e, t) { return !!r["show_custom_" + e + t] }, restoreFilter: function () { r.strFilter = r.originalFilter } }, r.numberConditionFormatString = {}, r.numberConditionFormat = function (e, t, n) { var a = "", i = ""; switch (angular.forEach(u, function (e) { e.value == Number(t) && (i = e.text) }), t) { case -1: a = "en" == $.cookie("locale") ? "All" : "全部"; break; case 0: case 1: case 2: case 3: case 4: case 5: a = i + " " + n[0]; break; case 8: case 9: a = i; break; case 12: a = i + " " + n[0] + "~" + n[1]; break; default: a = "" }r.numberConditionFormatString[e] = a }, r.is_defined = !1, r.checkFormulaGrammarFlag = !1, r.checkFormulaGrammar = function (e, t, n) { if ("string" == n) { var i = r.strFilter.expression_str; if ("" == i) return void s(r.tips["filter.pleaseInputExpression"]); if (i.indexOf(e) < 0 && i.indexOf("[_field_id_]") < 0) return void s(r.tips["filter.pleaseInputFieldName"] + ": [" + e + "]"); e = bdp.utils.requote(e); var o = new RegExp("\\[" + e + "\\]", "g"); r.strFilter.expression_str = i.replace(o, "[_field_id_]"); var l = { ct_id: r.opts.meta.ct_id, tb_id: r.opts.meta.tb_id, fid: t, expression: r.strFilter.expression_str } } return r.expressionChangedFlag = !1, a.post("/api/expression/syntax_verify", l).then(function (e) { return 0 == e.status ? (s(r.tips["filter.checkSuccess"]), r.checkFormulaGrammarFlag = !0, !0) : (s(r.tips["filter.checkFailed"]), r.checkFormulaGrammarFlag = !1, !1) }) }, r.setExpression = function (e) { r.strFilter.expression_str = e }, r.expressionChanged = function (e) { r.expressionChangedFlag = e }, r.insertFieldNameToExpression = function (e) { r.expressionChangedFlag = !0, r.$broadcast("insertFieldNameToExpression", e) }, r.changeNumberOpt = function (e, t, i) { if (r.$parent.drillOption ? r.tempDrillOption = angular.copy(r.$parent.drillOption) : r.tempDrillOption = { drill_field: "", drill_level: "", drill_value: [] }, r.nullRange[t.fid + t.uniq_id] = !1, r.defaultRange[t.fid + t.uniq_id] = [], i == -1) { r.rangeLoading = !0, r.chartOptions.optional.filter_list; var o = angular.copy(r.chartOptions.optional.filter_list) || []; if (o) for (var s = 0; s < o.length; s++)o[s].fid == t.fid && o[s].uniq_id == t.uniq_id && (o[s].range = []); a.get("/api/field/inner_range", { dsh_id: l.dashId, ct_id: t.ct_id || e.ct_id, tb_id: t.tb_id || e.tb_id, fid: t.fid, uniq_id: t.uniq_id, granularity: "", rule_id: n.global.rule_id, filter_list: angular.toJson(o), dsh_filter: angular.toJson(r.chartOptions.optional.dsh_filter ? r.chartOptions.optional.dsh_filter : []), drill_field: r.tempDrillOption.drill_field, drill_level: r.tempDrillOption.drill_level, drill_value: angular.toJson(r.tempDrillOption.drill_value) }).then(function (e) { r.rangeLoading = !1, 0 == e.status && (0 == e.result.range.length && (r.nullRange[t.fid + t.uniq_id] = !0), r.defaultRange[t.fid + t.uniq_id] = r.handleNumberByFormatter(e.result.range, t.formatter, t.aggregator)) }) } }, r.handleNumberByFormatter = function (e, t, n) { for (var a = 2, i = 0; i < e.length; i++)t ? ("" !== t[t.check].digit && (a = t[t.check].digit), "num" == t.check && t.num.millesimal ? e[i] = Highcharts.numberFormat(e[i], a, ".", ",") : "num" == t.check ? e[i] = Highcharts.numberFormat(e[i], a, ".", "") : e[i] = Highcharts.numberFormat(100 * e[i], a, ".", "") + "%") : ("COUNT" != n && "COUNT_DISTINCT" != n || (a = 0), e[i] = Highcharts.numberFormat(e[i], a)); return e }, r.setAdvanceAggregatorName = h, g(["filter.itemExist", "filter.pleaseCheckGrammar", "filter.checkSuccess", "filter.checkFailed", "filter.inputCompleteCondition", "filter.pleaseInputCondition", "default", "filter.pleaseInputExpression", "filter.pleaseInputFieldName", "filter.pleaseSelectItem", "filter.pleaseAddCondition", "filter.hasChecked", "chart.dateRangeRequired", "filter.dateRangeInvalid", "filter.startDateErr2", "filter.endDateErr2", "filter.switchExpTip", "chart.compareDate", "filter.compare"], r)
        }, controller: ["$scope", function (e) { e.show_options = {}, e.isActive = !1, e.innerFilterItems = {}, e.$watch("opts", function (t) { if (t) if (e.opts.meta.filter_list_inner) { if ($("body").hasClass("fs-chart-mode") && !e.fullscreen) return !1; e.filter_list_inner = angular.copy(e.opts.meta.filter_list_inner), 0 == e.filter_list_inner.length && e.opts.meta.compareDateFilter && 0 == e.opts.meta.compareDateFilter.length && (e.show_filter = !1), e.isActive = !1, angular.forEach(e.filter_list_inner, function (t) { if (e.show_filter = !0, void 0 === t.range ? t.range = [] : t.range.length > 0 && (e.isActive = !0), "number" == t.data_type || "number" != t.data_type && t.hasOwnProperty("aggregator")) if (0 == t.range.length) e.numberConditionFormatString[t.fid + t.uniq_id] = "en" == $.cookie("locale") ? "All" : "全部"; else { var n = angular.fromJson(t.range[0]), a = n.conditions; 1 == a.length ? e.numberConditionFormat(t.fid + t.uniq_id, Number(a[0].calc_type), [a[0].value]) : a.length > 1 && e.numberConditionFormat(t.fid + t.uniq_id, 12, [a[0].value, a[1].value]) } "number" == t.data_type || "number" != t.data_type && t.hasOwnProperty("aggregator") ? (t.hasOwnProperty("uniq_id") || (t.uniq_id = ""), e.innerFilterItems[t.fid + t.uniq_id] = {}) : e.innerFilterItems[t.fid] = {} }), e.opts.meta.compareDateFilter.length > 0 && (e.show_filter = !0) } else e.show_filter = !1 }, !0), e.$watch("advDateList", function (t) { t && (e.adv_date_list = t) }) }]
      }
    }])
  }()
}, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").directive("exportImg", ["$http", "$rootScope", "ngDialog", "$timeout", "errHint", "$jsTipTranslate", "$q", function (e, t, n, a, r, o, s) { return { restrict: "A", scope: !0, link: function (e, l, c) { function d(e, t, n) { var a = Number(n.type), i = 1; return [1, 2, 3, 4].indexOf(a) > -1 ? i = a : 5 === a ? i = n.width_value.div(e) : 6 === a && (i = n.height_value.div(t)), i } function u(e, t) { if (e.find(".chart-canvas").length > 0) { var n = function (e) { for (var t = e.find(".chart-canvas").length, n = [], a = window.devicePixelRatio || 1, i = e.find(".chart-canvas"), r = 0; r < t; r++) { var o = i[r], s = ""; s = Canvas2Image.convertToPNG(o, o.width, o.height).src; var l = '<img src="' + s + '" width="' + o.width / a + '" height="' + o.height / a + '" />'; n.push(l) } return n }(e), a = new RegExp("<canvas.*chart-canvas.*></canvas>", "gi"), i = 0; t = t.replace(a, function () { return n[i++] }) } return t } function f(e) { var t = "light"; return 1 == e && (t = "dark"), t } function p(e) { e._xsrf = bdp.utils.getCookie("_xsrf"), a(function () { Highcharts.post("/api/chart/export_png_new", e) }, 10) } function h(e) { var t = [m.Line, m.Column, m.NStackColumn, m.PStackColumn, m.Sankey, m.Area, m.NStackArea, m.PStackArea, m.Biax]; e.info; return t.indexOf(e.getChartType()) > -1 && e.data.x.length > 0 && e.data.y[0] } var g, m = bdpChart.ChartType, v = (bdpChart.language, null), y = !1, b = "2"; l.on("click", function () { if (e.mode = c.mode, e.setting = angular.fromJson(c.setting), "dashboard" === e.mode ? g = l.parents(".chart-box").find(".chart").data("chart-data") : "fullscreen" === e.mode && (g = l.parents(".control-pane").siblings(".fs-chart-main").find(".fullscreen-chart.active").data("chart-data")), !g) return !1; e.chartType = g.info.chart_type, e.theme = g.theme, y = g.info.navigator_setting && g.info.navigator_setting.enabled, y = y && h(g), h(g) && (g.info.navigator_setting && g.info.navigator_setting.enabled && g.data.y[0] && g.data.y[0].data.length > 1 ? (y = "open", b = "1") : y = !1), e.chartType = g.info.chart_type, e.theme = g.theme, y = g.info.navigator_setting && g.info.navigator_setting.enabled, y = y && h(g), h(g) && g.info.navigator_setting && g.info.navigator_setting.enabled && g.data.y[0] && g.data.y[0].data.length > 1 && (y = "open", b = "1"), e.disableScale = "C340" === e.chartType || "C400" === e.chartType, e.disableCustom = "C400" === e.chartType, v = n.open({ template: "/static/dashboard-core/chart-export/chart-export-img.html", className: "ngdialog-theme-default export-img-modal", scope: e, data: { type: "fullscreen" === e.mode ? 1 : 2, range: b, disableFix: "C200".indexOf(e.chartType) > -1, width_value: 1024, height_value: 1024, show_label: !0, navigator: y } }), g.emit("exportSave"), v.closePromise.then(function () { w.show(), g.emit("exportBack") }), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "export_image", ct_id: g.info.chart_id }) }) }), e.exportImg = function (n) { function i(n) { if (n && "3" == n.range) return void C.openScaleDialog(); t.global.watterMark && (h += "<style>" + $("#watermarkStyle").text() + "</style>"); var a = { type: "item", chartItem: h, scale: _, theme: f(k), filename: c.filename || "chart" }; n.navigator && "2" == n.range && "C200".indexOf(e.chartType) > -1 && (o.css({ width: o.data("width") + "px", height: o.data("height") + "px" }), b.destroy(), b.emit("reflow")), p(a), n.navigator && "2" == n.range && (w.show(), b.emit("exportBack")), v.close() } var o, h, g, m, y, _, b, S, k = window.usedThemeId; if ("dashboard" === e.mode ? b = l.parents(".chart-box").find(".chart").data("chart-data") : "fullscreen" === e.mode && (b = l.parents(".control-pane").siblings(".fs-chart-main").find(".fullscreen-chart.active").data("chart-data")), "dashboard" === e.mode) { g = $(l).parents(".chart-box").find(".J-export-img-elem-chart"), o = $(l.parents(".J-export-img-elem-item")), m = o.width(), y = o.height(); var x = ""; if (t.global.watterMark) { x = '<div class="water-mark ' + (1 == window.usedThemeId ? "water-mark-white" : "water-mark-dark") + '"></div>' } h = '<ul class="gridster J-export-img-elem-wrap">' + $(o[0]).prop("outerHTML").replace(/<\/li>$/, x + "</li>") + "</ul>", h = h.replace(/J-item-chart-title-bd/, "J-item-chart-title-bd text-center"), h = h.replace(/J-export-img-elem-item/, "J-export-img-elem-item J-export-elem-back") } else if ("fullscreen" === e.mode) { k = e.fullDisplayTheme, g = $(l).parents(".fullscreen-modal").find(".J-export-img-elem-chart"), o = g, h = $($(l.parents(".J-fullscreen-export-wrap").find(".J-export-img-elem-chart"))[0]).prop("outerHTML"); m = g.width() + 80, y = g.height() + 64 + 60, h = '<div class="J-chart-fullscreen-wrap J-export-elem-back ' + $(".J-chart-fullscreen-wrap-export").attr("class") + '" style="width: ' + m + "px;height:" + y + 'px;padding: 32px 40px;">                                <div class="J-fullscreen-export-title" style="height: 60px; line-height: 60px;">' + c.filename + '</div>                                <div style="position: relative;overflow: hidden;width: ' + g.width() + "px;height:" + g.height() + 'px;">' + h + '</div>                                <div class="water-mark chart-water-mark water-mark-dark"></div>                            </div>' } if ((_ = d(m, y, n)) * m > 16e3 || _ * y > 16e3) return void r(e.tips["chart.chartExportImgMax"]); if ("C200".indexOf(e.chartType) > -1) if (n.navigator && "2" == n.range) { S = b.chartTalbe.sheet; for (var D = 0, T = 0, E = $(o).find(".J_chart_box"), L = 0; L < S.getColumnCount(); L++)D += S.getColumnWidth(L); for (var L = 0; L < S.getRowCount(); L++)T += S.getRowHeight(L); if (E.width() < D || E.height() < T) return D += 300, T = 3 * T / 2, o.css({ width: D + "px", height: T + "px" }), b.destroy(), b.emit("reflow"), o.data("width", m), o.data("height", y), a(function () { e.exportImg(n) }, 800), !1; h = u(o, h) } else h = u(o, h); else if (g.find(".chart-canvas").length > 0) h = u(o, h); else { if ("C400" === e.chartType) { return b.gisMap.exportImage(1).then(function (e) { e[0].style.zIndex = 0; var t = e[0].outerHTML, a = $(h); a.find(".J-export-img-elem-chart").append(t), h = a.prop("outerHTML"), i(n) }), !1 } if ("C500" === e.chartType) { if (o.find(".J-export-iframe-img").length > 0) { var A = o.find(".J-export-iframe-img"), I = s.defer(); return bdp.loadjs({ src: "//m1.bdp.cn/static/js/lib/html2canvas/html2canvas_82a2121.js", callback: function () { var e = A.map(function (e, t) { var n = s.defer(); return html2canvas(t.contentWindow.document.body, { onrendered: function (e) { var a = ""; try { var i = Canvas2Image.convertToPNG(e, e.width, e.height).src; a = '<div style="position: absolute;top: 0; left: 0; z-index: 100;width: ' + ($(t).width() - 1) + "px;height: " + ($(t).height() - 1) + 'px;overflow: auto;"><img src="' + i + '" width="' + (e.width - 1) + '" height="' + (e.height - 1) + '" /></div>' } catch (e) { a = '<p style="position: absolute;top: 0; left: 0; z-index: 100;width:"' + $(t).width() + 'px;" height:"' + $(t).height() + 'px";text-align: center;line-height:' + $(t).height() + 'px;">当前图表含有外部引用图片，暂不支持导出</p>' } n.resolve(a) } }), n.promise }); I.resolve(s.all(e)) } }), I.promise.then(function (e) { var t = new RegExp("<iframe.*J-export-iframe-img.*></iframe>", "gi"), a = 0; h = h.replace(t, function () { return e[a++] }), i(n) }), !1 } h = u(o, h) } else if ("fullscreen" === e.mode && !e.show_data_label) { h = h.replace(/show-datalabels/g, ""); h += "<style>.J-chart-fullscreen-wrap .chart .highcharts-data-labels > g, .J-chart-fullscreen-wrap .chart-pie .highcharts-data-label-connector ,.J-chart-fullscreen-wrap .funnel-datalabels, .J-chart-fullscreen-wrap .sunburst-labels {display:none}.J-chart-fullscreen-wrap .bdp-datalabels {opacity:0; visibility:hidden;}</style>" } } i(n) }, e.exportRange = function (e, t) { t.range != e && ("2" == e ? (w.hide(), g.emit("exportAll")) : "1" == e && (w.show(), g.emit("exportBack"))) }; var w = { show: function () { $(".highcharts-navigator").show(), $(".highcharts-navigator-handle").show(), $(".highcharts-navigator-series").show() }, hide: function () { $(".highcharts-navigator").hide(), $(".highcharts-navigator-handle").hide(), $(".highcharts-navigator-series").hide() } }, C = { scaleDialogObj: null, slider_range: { min: 0, max: 100, preventMin: null, preventMax: 10 }, exportElem: null, html: null, $chart: null, exportObjWidth: 0, exportObjHeight: 0, openScaleDialog: function () { var t = _.cloneDeep(e.draw_chart_url[e.child.dom_id].options); t.hideNavigator = !0, t.disableLink = !0, C.scaleDialogObj = n.open({ template: "/static/dashboard-core/chart-export/chart-export-scale.html", className: "ngdialog-theme-default export-img-modal", scope: e, data: { chart_data: t, slider_range: C.slider_range, on_handle_up: C.onHandleUp, ok_btn_click: C.exportScaleImg } }), C.scaleDialogObj.closePromise.then(function () { C.slider_range.max = 100 }), a(function () { var a = $("#J-chart-box").find(".chart").data("chart-data"); if (a.info && t.optional.drill_value && t.optional.drill_value[0]) a.emit("renderCrumbs", t.optional.drill_value[0], e.child.meta.level_fields[0]); else try { bdpChart.helper.renderCrumbs(a) } catch (e) { } var i = $("#J-chart-box").parents(".ngdialog").find(".ngdialog-close"), r = $("#J-chart-box").parents(".ngdialog").find(".ngdialog-button").eq(0); i.click(function () { n.closeAll() }), r.click(function () { n.closeAll() }) }, 1e3) }, onHandleUp: function (e) { var t = $(".ngdialog-chart-box").width(), n = 100 / C.slider_range.max; C.exportElem = $("#J-chart-box"), C.chartInstance = $("#J-chart-box").find(".chart").data("chart-data"), C.exportElem.css({ width: Math.floor(n * t) + "px" }), a(function () { C.chartInstance.destroy(), C.chartInstance.emit("reflow") }) }, exportScaleImg: function () { var n = window.usedThemeId; C.exportElem = $("#J-chart-box"), C.exportObjWidth = C.exportElem.width(), C.exportObjHeight = C.exportElem.height(); var a = ""; if (t.global.watterMark) { a = '<div class="water-mark ' + (1 == window.usedThemeId ? "water-mark-white" : "water-mark-dark") + '"></div>' } var i = "height:300px;background:#fff;width:" + Math.floor(C.exportObjWidth + 60) + "px;"; if (C.html = '<div class="J-item-chart-title-bd J-export-elem-back" style="' + i + '">' + $(C.exportElem).prop("outerHTML").replace(/(.*)<\/div>$/, a + "</div>") + "</div>", C.html = C.html.replace(/J-item-chart-title-bd/g, "J-item-chart-title-bd text-center"), C.exportObjWidth > 16e3 || C.exportObjHeight > 16e3) return void r(e.tips["chart.chartExportImgMax"]); t.global.watterMark && (C.html += "<style>" + $("#watermarkStyle").text() + "</style>"); var o = { type: "item", chartItem: C.html, scale: 1024..div($(".ngdialog-chart-box").width()), theme: f(n), filename: c.filename || "chart" }; o._xsrf = bdp.utils.getCookie("_xsrf"), Highcharts.post("/api/chart/export_png_new", o), C.scaleDialogObj.close() } }; o(["chart.chartExportImgMax"], e) } } }]) }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").directive("exportExcel", ["$rootScope", "commonService", "ngDialog", function (e, t, n) { return { restrict: "A", scope: !0, link: function (a, r, o) { a.openOfflineList = function () { e.fireOfflineTaskList = "export" }, r.on("click", function (r) { var s, l, c = o.mode, d = o.charttype; "dashboard" === c ? (l = $(r.currentTarget).parents(".gridster-item"), s = a.chartUrl) : "fullscreen" === c && (s = a.fullscreen.info, l = $(r.currentTarget).parents(".J-chart-fullscreen-wrap-export")); var u = l.data("custom-chart-data"), f = l.data("form-dimension-opt"); u = u && u.enableExportExcel ? (0, i.default)(u) : "{}", f = f ? (0, i.default)(f) : "[]"; var p = bdpChart.helper.params(s.options.optional), h = { ct_id: s.options.ct_id, dsh_id: s.options.dsh_id, access_token: $.cookie("token"), rule_id: s.options.rule_id || "" }; e.wsId && (h.ws_id = e.wsId); var g = angular.extend(h, p, { custom_chart_data: u, form_dimension_opt: f }); g._xsrf = bdp.utils.getCookie("_xsrf"), s.options.exportType ? Highcharts.post("/api/chart/export_excel", g) : t.chart.exportExcelType(angular.extend(h, p)).then(function (i) { 0 == i.status && (1 == i.result || "C300" == d || "C301" == d || "C400" == d ? Highcharts.post("/api/chart/export_excel", g) : 2 == i.result && t.chart.exportLargeExcel(g).then(function () { var t = e.language, i = "en" == t ? "ngDialog-width-400" : "ngDialog-width-330"; n.open({ template: "/static/dashboard-core/chart-export/export-large-tip.html", className: "ngdialog-theme-default " + i, scope: a }) })) }), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "export_excel", ct_id: s.options.ct_id }) }) }) } } }]) }, function (e, t, n) {
  "use strict"; var a = n(43), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); !function () {
    function e(e, t, n, a, r, o, s, l, c, d, u, f) {
      function p(e, p, h) {
        function g() { e.showDateAdvanceEdit ? (e.view = "dateAdvance", angular.element(".J-global-filter-model").addClass("date-advance-modal")) : (e.view = "globalFilter", e.GF.getFilterItems(), e.showBaseLoading = !1, angular.element(".J-global-filter-model").removeClass("date-advance-modal")) } function m(t) { e.fieldMap = {}, angular.forEach(t.tb_list, function (t, n) { angular.forEach(t.fields, function (t, n) { e.fieldMap[t.fid] = t.data_type }) }) } e.ctrlScope = e; var v = 0; e.showDateAdvanceEdit = !1, e.view = "globalFilter", e.backRange = [], e.filterKeyword = "", e.isSetFirst = !1, Array.prototype.remove = function (e) { var t = this.indexOf(e); t > -1 && this.splice(t, 1) }, e.setFirstItem = function (t) { var n = e.filterView.selected_opt; e.range.remove(t), e.backRange.remove(t), e.range.unshift(t), e.backRange.unshift(t), e.isSetFirst = !0, e.fieldSortValueCache && e.fieldSortValueCache[e.filterView.selected_opt] || (e.fieldSortValueCache[e.filterView.selected_opt] = { need: !1, sortRange: e.range }), e.fieldSortValueCache[n].sortRange = _.cloneDeep(e.backRange) }, e.searchFilter = _.debounce(function () { var t = e.filterKeyword; if (!t) return void (e.range = _.cloneDeep(e.backRange)); e.showLoading = !0, a.dash_global_filter.filter_range({ keyword: t, first_item: 0, range_list: angular.toJson(e.range) }).then(function (t) { e.showLoading = !1, "0" == t.status && (e.range = t.result.data) }) }, 10), e.new_add_df_name = "", e.prevGlobalSave = function () {
          function t(n) {
            return n.map(function (n) {
              var a = n.df_id, i = e.filterStatus[a]; n.df_id = 0 === a.indexOf("new") ? "" : a, n.name = i.name, n.config = i.config, n.data_type = i.data_type, "string" == i.data_type ? n.type = 1 : n.type = 2, n.selected_charts = [], n.selected_tables = {}, angular.forEach(i.charts, function (e, t) { !!e.selected && n.selected_charts.push(e.ct_id) }), angular.forEach(i.tables, function (e, t) { !!e.show && (n.selected_tables[e.tb_id] = e.selected) }), l = n.data_type, c = n.config.granularity, "date" == l && "" == c ? (n.config.default_select = !1, n.config.range && (n.config.default_select = !0)) : n.config.range = "",
                n.items && n.items.length > 0 ? n.items = t(n.items) : n.items = []
            }), n
          } function a(t) { for (var n = 0; n < t.length; n++) { var r = t[n], s = (0, i.default)(r.selected_tables); r.selected_tables[s[0]] || (o(r.name + ": " + e.tips["dash.gfTableAndFieldRequired"]), d = !1); var l = e.fieldMap[r.selected_tables[s[0]]]; for (var c in r.selected_tables) r.selected_tables.hasOwnProperty(c) && l !== e.fieldMap[r.selected_tables[c]] && (o(r.name + ": " + e.tips["dash.gfFieldTypeMustBeSame"]), d = !1); r.items && r.items.length > 0 && a(r.items) } } var s = angular.copy(e.filterData.dsh_filter_list), l = "", c = ""; s = t(s); var d = !0; if (a(s), d) return e.showBaseLoading = !0, r.post("/api/dsh_filter/commit", { dsh_id: n.dashId, data: angular.toJson(s) }).then(function (e) { return "0" == e.status || (o(Number(e.status)), !1) })
        }, e.goDateAdvanceEdit = function () { var t = e.prevGlobalSave(); t && t.then(function (t) { if (t) { if (!e.new_add_df_name) return e.showDateAdvanceEdit = !0, $(".ngdialog-close").css("display", "none"), e.$broadcast("showDateAdvanceEdit", e.showDateAdvanceEdit), void g(); a.dash_global_filter.list({ dash_id: n.dashId, rule_id: e.ruleId }).success(function (t) { if (e.showBaseLoading = !1, "0" == t.status) { var n, a; !function () { e.GF.initChartsAndTables(t.result), e.getInitialData = !1, n = t.result.dsh_filter_list, n && n.length > 0 && (!function t(n) { n.map(function (n) { n.name == e.new_add_df_name && (e.filterView.selected_opt = n.df_id, a = !0), !a && n.items && t(n.items) }) }(t.result.dsh_filter_list), e.showDateAdvanceEdit = !0, $(".ngdialog-close").css("display", "none"), e.$broadcast("showDateAdvanceEdit", e.showDateAdvanceEdit), g()), a = !1 }() } else o(Number(t.status)) }) } }) }, e.$on("hideDateAdvanceEdit", function (t, n) { if (n) { e.showDateAdvanceEdit = !1, e.filterView.selectedDateSchemeMap[n.df_id] = n.scheme; var a = e.filterStatus[n.df_id]; "date" == a.data_type && "" == a.config.granularity && (a.config.scheme_id = n.scheme), g() } }), e.allCharts = {}, e.getInitialData = !0, e.filterData = {}, e.filterView = { loading: !1, model: "", editFilter: {}, selectedDateSchemeMap: {} }, e.goHelp = function (e) { s(e) }, e.GF = { add: function () { e.filterView.isCreating || (e.filterView.editName = ""), e.filterView.isCreating = !0, setTimeout(function () { $("#add_input").focus() }, 300), v++ }, initChartTableMap: function () { e.chartTableMap = {}; var t; angular.forEach(e.dashStandardItems, function (n, a) { t = n.children[0].meta, e.chartTableMap[t.ct_id] = t.tb_id || t.tb_ids }) }, initChartsAndTables: function (t, n) { function a(t) { for (var n = 0, i = t.length; n < i; n++) { var r = t[n]; e.filterStatus[r.df_id] = { name: r.name, charts: angular.copy(e.charts), tables: angular.copy(e.tables), config: r.config || {}, data_type: "" }, r.hasOwnProperty("items") || (r.items = []), 2 == r.type ? e.filterStatus[r.df_id].data_type = "date" : 1 == r.type && (e.filterStatus[r.df_id].data_type = "string"), e.GF.initSelectedStatus(r), r.items && r.items.length > 0 && a(r.items) } return t } e.charts = []; var i; angular.forEach(e.dashStandardItems, function (t, n) { i = t.children[0].meta, 0 != i.ct_type && 1 != i.ct_type && 7 != i.ct_type && 8 != i.ct_type || e.charts.push({ name: i.name, ct_id: i.ct_id, tb_id: i.tb_id, tb_ids: i.tb_ids || [], is_gis: "C400" == i.type, selected: !1 }) }), e.tables = [], angular.forEach(t.tb_list, function (t, n) { e.tables.push({ show: !1, name: t.name, fields: t.fields, tb_id: t.tb_id, selected: "" }) }), e.filterStatus = {}, e.filterData = t, e.hasGraftTb = _.some(t.tb_list, function (e) { return "graft" === e.tb_type }), e.hasGraftTb && (e.graftTip = "使用数据直连类型的工作表时，不支持筛选项自定义排序"), m(t), e.GF.initChartTableMap(), e.filterData.dsh_filter_list.length && (a(e.filterData.dsh_filter_list), n && (e.filterView.selected_opt = e.filterData.dsh_filter_list[0].df_id)) }, initSelectedStatus: function (t) { angular.forEach(e.charts, function (n, a) { e.filterStatus[t.df_id].charts[a].selected = $.inArray(n.ct_id, t.selected_charts) > -1 }), angular.forEach(e.tables, function (n, a) { e.filterStatus[t.df_id].tables[a].show = !!t.selected_tables[n.tb_id], e.filterStatus[t.df_id].tables[a].selected = t.selected_tables[n.tb_id] || "" }) }, updateStatus: function (t) { e.filterKeyword = "", e.searchFilter(""); var n = e.filterStatus[e.filterView.selected_opt].charts, a = e.filterStatus[e.filterView.selected_opt].tables, i = e.chartTableMap[t.ct_id], r = function (e, t) { for (var n = 0; n < a.length; n++)i.indexOf(a[n].tb_id) >= 0 && (t ? t == a[n].tb_id && (a[n].show = e) : a[n].show = e) }; if (t.selected) e.changeCheckAll(!0), r(!0); else { e.changeCheckAll(!1); for (var o = [], s = 0; s < n.length; s++)r(!1), n[s].selected && o.push(n[s].ct_id); for (var l = 0; l < n.length; l++)o.indexOf(n[l].ct_id) >= 0 && (n[l].tb_id && i.indexOf(n[l].tb_id) >= 0 && r(!0, n[l].tb_id), n[l].tb_ids && n[l].tb_ids.length > 0 && n[l].tb_ids.map(function (e) { i.indexOf(e) >= 0 && r(!0, e) })) } e.GF.checkDataType() }, checkAllCharts: function (t) { e.filterKeyword = "", e.searchFilter(""), e.allCharts[e.filterView.selected_opt] = t, e.isSelectingAllCharts = !0, angular.forEach(e.filterStatus[e.filterView.selected_opt].charts, function (n) { n.selected = t, e.GF.updateStatus(n) }), e.isSelectingAllCharts = !1 }, list: function (t) { a.dash_global_filter.list({ dash_id: n.dashId, rule_id: e.ruleId }).success(function (n) { "0" == n.status ? (e.GF.initChartsAndTables(n.result, t), e.getInitialData = !1, e.filterData.dsh_filter_list.length > 0 && e.changeCheckAll(!0)) : o(Number(n.status)) }) }, info: function (t, n) { n && n.stopPropagation(), e.filterView.selected_opt = t, t.indexOf("df_") >= 0 && (e.new_add_df_name = ""), e.changeCheckAll(!0), e.fieldSortValueCache && e.fieldSortValueCache[t] && (e.fieldSortValueCache[t].need = !0) }, modify: function () { function r(t) { for (var n = 0; n < t.length; n++) { var a = t[n], s = (0, i.default)(a.selected_tables); a.selected_tables[s[0]] || (o(a.name + ": " + e.tips["dash.gfTableAndFieldRequired"]), u = !1); var l = e.fieldMap[a.selected_tables[s[0]]]; for (var c in a.selected_tables) a.selected_tables.hasOwnProperty(c) && l !== e.fieldMap[a.selected_tables[c]] && (o(a.name + ": " + e.tips["dash.gfFieldTypeMustBeSame"]), u = !1); a.items && a.items.length > 0 && r(a.items) } } function s(t) { return angular.forEach(t, function (t) { var n = t.df_id, a = e.filterStatus[n]; t.df_id = 0 === n.indexOf("new") ? "" : n, t.name = a.name, t.config = a.config, t.data_type = a.data_type, "string" == a.data_type ? t.type = 1 : t.type = 2, t.selected_charts = [], t.selected_tables = {}, angular.forEach(a.charts, function (e, n) { !!e.selected && t.selected_charts.push(e.ct_id) }), angular.forEach(a.tables, function (e, n) { !!e.show && (t.selected_tables[e.tb_id] = e.selected) }), c = t.data_type, d = t.config.granularity, "date" == c && "" == d ? t.config.default_select = !!t.config.range : t.config.range = "", ("string" == c && e.fieldSortValueCache[n] && e.fieldSortValueCache[n].sortRange && e.fieldSortValueCache[n].sortRange.length > 0 || e.isSetFirst && e.fieldSortValueCache[n] && e.fieldSortValueCache[n].sortRange && e.fieldSortValueCache[n].sortRange.length > 0) && (t.template = e.fieldSortValueCache[n].sortRange), t.items && t.items.length > 0 ? t.items = s(t.items) : t.items = [] }), t } e.globalDashFilterItems = {}; var l = angular.copy(e.filterData.dsh_filter_list), c = "", d = "", u = !0; l = s(l), r(l), u && (e.filterView.loading = !0, a.dash_global_filter.modify({ dash_id: n.dashId, dash_filter_list: angular.toJson(l) }).success(function (i) { e.filterView.loading = !1, "0" == i.status ? (o(e.tips.saveSuccess), t.closeAll(), a.dash_global_filter.item({ dash_id: n.dashId }).then(function (t) { "0" === t.status ? (e.originalGlobalFilter = angular.copy(t.result), e.globalDashFilter = bdp.utils.handleGlobalFilterLevel(t.result), e.globalDashFilterDisplay = bdp.bdpDash.getGFDisplay(e.globalDashFilter), f.getAttr("resetGFScrollFunc")()) : o(Number(t.status)) }), angular.forEach(e.drawChartUrl, function (e, t) { e.lazyload || (e.options.optional._t = new Date, e.options.read_cache = !1, delete e.options.optional.dsh_filter) })) : o(Number(i.status)) })) }, del: function (n, a, i) { function r(e) { for (var t = 0, n = e.length; t < n; t++) { if (e[t].df_id == i) { if (e[t].items && e[t].items.length > 0) { var a = angular.copy(e[t].items); angular.forEach(a, function (t) { e.push(t) }) } e.splice(t, 1); break } e[t].items && e[t].items.length > 0 && r(e[t].items) } return e } t.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngdialog-width-340", scope: e, data: { title: u.instant("tips"), message: u.instant("dash.gfConfirmRemove") } }).then(function () { r(e.filterData.dsh_filter_list), delete e.filterStatus[i], i === e.filterView.selected_opt && (e.filterView.selected_opt = e.filterData.dsh_filter_list.length ? e.filterData.dsh_filter_list[0].df_id : "") }) }, checkDataType: function () { function t(n) { for (var a = 0, i = n.length; a < i; a++) { if (n[a].df_id == e.filterView.selected_opt) return n[a]; n[a].items && n[a].items.length > 0 && t(n[a].items) } return {} } e.filterKeyword = null, e.searchFilter(), $(".query-text").removeClass("has-text"); var n; for (var a in e.filterStatus) if (a == e.filterView.selected_opt) n = e.filterStatus[a]; else { var i = t(e.filterStatus); i.hasOwnProperty("df_id") && (n = i) } var r = n.tables, o = []; angular.forEach(r, function (e, t) { var n = ""; e.fields.forEach(function (t) { t.fid == e.selected && (n = t.data_type) }), e.show && o.indexOf(n) < 0 && o.push(n) }), 1 === o.length && o[0] ? (n.data_type = o[0], n.config && !isObjectEmpty(n.config) || (n.config = angular.copy(c)), e.isSelectingAllCharts || e.GF.getFilterItems()) : (e.range = [], n.data_type = "") }, getFilterItems: function () { var t = e.filterView.selected_opt, n = e.filterStatus[t], a = {}; if (angular.forEach(n.tables, function (e, t) { !!e.show && (a[e.tb_id] = e.selected) }), e.range = [], "string" == n.data_type && e.fieldSortValueCache[t] && e.fieldSortValueCache[t].need && e.fieldSortValueCache[t].sortRange.length) return e.range = e.fieldSortValueCache[t].sortRange || [], void (e.fieldSortValueCache[t].need = !1); if (t = 0 === t.indexOf("new") ? "" : t, "date" != n.data_type || "" != n.config.granularity || n.config.scheme_id) e.GF.getDashGlobalFilterRange(t, n, a); else { d.getLatestScheme() ? (n.config.scheme_id = d.getLatestScheme(), e.GF.getDashGlobalFilterRange(t, n, a)) : d.getSchemeList().then(function (i) { var r = d.getDefaultSchemeObj(i) || { scheme_id: "" }; d.setLatestScheme(r.scheme_id), n.config.scheme_id = d.getLatestScheme(), e.GF.getDashGlobalFilterRange(t, n, a) }) } }, getDashGlobalFilterRange: function (t, i, r) { e.showLoading = !0, a.dash_global_filter.range({ dash_id: n.dashId, rule_id: e.ruleId, scheme_id: i.config.scheme_id || "", df_id: t, selected_tables: angular.toJson(r), granularity: i.config.granularity }).then(function (t) { if ("0" === t.status) { if (e.showLoading = !1, e.range = t.result.range || [], e.backRange = _.cloneDeep(e.range), !e.filterStatus[e.filterView.selected_opt]) return; if ("date" == e.filterStatus[e.filterView.selected_opt].data_type && "" == e.filterStatus[e.filterView.selected_opt].config.granularity && (e.filterStatus[e.filterView.selected_opt].config.default_select = !1), "string" == e.filterStatus[e.filterView.selected_opt].data_type && delete e.fieldSortValueCache[e.filterView.selected_opt], 0 == e.range.length) e.filterStatus[e.filterView.selected_opt].config.range = ""; else { var n = !1, a = e.filterStatus[e.filterView.selected_opt].data_type, i = e.filterStatus[e.filterView.selected_opt].config.granularity; "date" == a && "" == i && (angular.forEach(e.range, function (t) { t.opt_id == e.filterStatus[e.filterView.selected_opt].config.range && (n = !0) }), n || (e.filterStatus[e.filterView.selected_opt].config.range = "", e.filterStatus[e.filterView.selected_opt].config.show_all = !0)) } } else o(Number(t.status)) }) }, level: function (e, t, n) { e && e.stopPropagation(); var a = t.index(), i = t.$parentNodeScope; "down" === n ? a && (t.prev().$modelValue.items.push(t.$modelValue), t.remove()) : "up" === n && i && t.$last && (i.$parentNodesScope.$modelValue.push(t.$modelValue), t.remove()) }, hideInDash: function (t, n) { t && t.stopPropagation(), n.config || (n.config = $.extend(!0, {}, c)), n.config.hide_in_dash = !n.config.hide_in_dash, e.filterStatus[n.df_id].config.hide_in_dash = n.config.hide_in_dash } }, e.$watch("filterView.selected_opt", function (t, n) { t && e.GF.checkDataType() }), p.on("click", function () { e.fieldSortValueCache = {}, t.open({ template: "/static/dashboard-core/global-filter/global-filter-config.html", className: "ngdialog-theme-default global-filter-model J-global-filter-model", scope: e, preCloseCallback: function (t) { e.filterData = {}, e.filterView.selected_opt = "", e.filterView.selected_date_scheme = "", e.fieldSortValueCache = {}, e.filterView.isCreating = !1, e.filterView.model = "", e.range = [] } }), e.GF.list(!0) }), e.confirmName = function (t, n, a, i) { function r(t) { t.map(function (t) { if (t.df_id != n && t.name == e.filterView.editName) return void (s = !0); t.items && t.items.length > 0 && r(t.items) }) } if (i && i.stopPropagation(), "" === e.filterView.editName || !defined(e.filterView.editName)) return o(e.tips["dash.gfNameRequired"]), !1; var s = !1; if (r(e.filterData.dsh_filter_list), s) return void o(e.tips["dash.gfNameDuplicate"]); "create" === t ? (e.filterView.isCreating = !1, e.isCreating = !1, e.filterData.dsh_filter_list.push({ df_id: "new" + v, name: e.filterView.editName, items: [] }), e.filterStatus["new" + v] = {}, e.filterStatus["new" + v].config = angular.copy(c), e.filterStatus["new" + v].charts = angular.copy(e.charts), e.filterStatus["new" + v].tables = angular.copy(e.tables), e.filterStatus["new" + v].name = e.filterView.editName, e.GF.info("new" + v), e.new_add_df_name = e.filterView.editName) : function () { !function t(a) { a.map(function (a) { a.df_id == n && (a.name = e.filterView.editName), a.items && a.items.length > 0 && t(a.items) }) }(e.filterData.dsh_filter_list), e.filterStatus[n].name = e.filterView.editName, e.filterView.editFilter[n] = !1, e.GF.info(n) }(), e.filterView.model = "createInfo", e.filterView.editName = "" }, e.keyupFun = function (t, n, a, i) { 13 == t.keyCode && e.confirmName(n, a, i) }, e.cancelEditStatus = function () { function t(n) { n.map(function (n) { e.filterView.editFilter[n.df_id] = !1, n.items && n.items.length > 0 && t(n.items) }) } e.filterData.dsh_filter_list && e.filterData.dsh_filter_list.length > 0 && t(e.filterData.dsh_filter_list), e.filterView.model = "createInfo" }, e.editFilterName = function (t, n, a) { t && t.stopPropagation(), e.filterView.isCreating || (e.cancelEditStatus(), e.filterView.editFilter[n] = !0, e.filterView.editName = a) }, e.stopPropagation = function (e) { e.stopPropagation() }, e.changeShowAllItem = function () { e.filterStatus[e.filterView.selected_opt].config.show_all = !e.filterStatus[e.filterView.selected_opt].config.show_all; var t = e.filterStatus[e.filterView.selected_opt].data_type, n = e.filterStatus[e.filterView.selected_opt].config.granularity, a = e.filterStatus[e.filterView.selected_opt].config.show_all, i = e.filterStatus[e.filterView.selected_opt].config.range; "date" == t && "" == n && !i && !a && e.range.length > 0 && (e.filterStatus[e.filterView.selected_opt].config.range = e.range[0].opt_id) }, e.changeCheckAll = function (t) { if (t) { var n = 0; angular.forEach(e.filterStatus[e.filterView.selected_opt].charts, function (e) { e.selected && n++ }), e.allCharts[e.filterView.selected_opt] = n == e.filterStatus[e.filterView.selected_opt].charts.length } else e.allCharts[e.filterView.selected_opt] = !1 }, e.globalFilterTree = { dragStart: function (e) { }, dragMove: function (e) { }, dragStop: function () { function t(a) { angular.forEach(a, function (a) { n[a.df_id] = e.filterStatus[a.df_id], a.items && a.items.length > 0 && t(a.items) }) } var n = {}, a = e.filterData.dsh_filter_list; angular.forEach(a, function (t) { n[t.df_id] = e.filterStatus[t.df_id] }), t(a), e.filterStatus = n } }, e.sortGlobalStringFilter = { items: ".J-sortable-string", start: function () { }, update: function (t, n) { e.fieldSortValueCache[e.filterView.selected_opt] = { need: !1, sortRange: e.range } }, stop: function (e, t) { } }, l(["dash.gfTableAndFieldRequired", "dash.gfFieldTypeMustBeSame", "dash.gfConfirmRemove", "dash.gfNameRequired", "dash.gfNameDuplicate", "saveSuccess"], e)
      } return { restrict: "A", scope: { originalGlobalFilter: "=", globalDashFilter: "=", globalDashFilterDisplay: "=", ruleId: "=", drawChartUrl: "=", dashStandardItems: "=", globalDashFilterItems: "=" }, link: p }
    } angular.module("BC.dashboard.core").directive("globalFilterSet", e).constant("gfConfigDefault", { granularity: "", default_select: !1, show_all: !0 }), e.$inject = ["$timeout", "ngDialog", "$stateParams", "commonService", "commonHttp", "errHint", "operatorHelpLink", "$jsTipTranslate", "gfConfigDefault", "globalDateSchemeService", "$translate", "globalFilterService"]
  }()
}, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); !function () { function e(e, t, n, a, r, o, s, l, c, d, u, f) { function p(t, n, u) { function p(e, n, a) { var i = n.df_id, r = $(".project-nav").width() + 64, o = e.pageX < r + 200 ? { left: 0 } : { right: 0 }, s = bdp.utils.getArrayTextWidth(a, n); o.width = s, t.adjustWidth[i] = o } t.advanceView = {}, t.showQueryfilter = {}, t.queryString = {}, t.globalDashFilterItems = t.globalDashFilterItems || {}; t.adjustWidth = {}, t.originalRange = []; var h; t.dateTimeByHalfHour = d, t.globalFilterMultiple = {}, t.refreshCharts = function (e, n, a) { var r = []; e.range = a, e.show = !1, e.showName = "" !== n ? n : e.name, t.globalDashFilterItems[e.df_id] = { granularity: e.config.granularity || "", df_id: e.df_id, range: a, data_type: e.data_type, show_name: e.showName, real_name: n, rela_charts: e.rela_ct_ids, range_type: e.range_type }, angular.forEach(t.drawChartUrl, function (e, n) { e.global_filter_value = []; var a = []; angular.forEach(t.globalDashFilterItems, function (t, n) { t.rela_charts.indexOf(e.options.ct_id) > -1 && a.push({ df_id: t.df_id, range: t.range, data_type: t.data_type, granularity: t.granularity, range_type: t.range_type }) }), a.length > 0 && (e.options.optional.dsh_filter = a, delete e.options.optional.filter_list, delete e.options.optional.linked_value, e.options.read_cache = !1, e.options.optional._t = new Date, r.push(e.options.ct_id)) }), t.$emit("globalFilter.refreshCharts", r), setTimeout(function () { t.scrollHandler.init(t.scrollHandler.scrollWidth) }, 10), BDPLogger.log("chart_operation", { category: "user_interact", action: "chart_interact", opt_label: (0, i.default)({ operation_type: "dashboard_filter_apply", ct_id: "" }) }) }, t.saveDateRange = function (e) { var n = t.globalDashFilter[e.data.index], i = "", r = e.sDate ? e.sDate + " " + e.sDateHour : null, o = e.eDate ? e.eDate + " " + e.eDateHour : null; if (!r && !o) return l(t.tips["chart.dateRangeRequired"]), !1; if (r && o) { if (!e.sDateHour) return l(t.tips["filter.startDateErr2"]), !1; if (!e.eDateHour) return l(t.tips["filter.endDateErr2"]), !1; if (new Date(r) - new Date(o) > 0) return l(t.tips["filter.dateRangeInvalid"]), !1 } else { if (r && !o && !e.sDateHour) return l(t.tips["filter.startDateErr2"]), !1; if (!r && o && !e.eDateHour) return l(t.tips["filter.endDateErr2"]), !1 } r ? (i += r, i += o ? "~" + o : "~" + t.tips["chart.notLimit"]) : (i += t.tips["chart.notLimit"] + "~", i += o), a.close(h.id), h = null, t.refreshCharts(n, i, [r, o]) }, t.queryKwd = {}, t.globalFilterModule = { showDatePicker: function (e, n) { if (navigator.userAgent.indexOf("Firefox") >= 0 && n[0] && n[0].indexOf("opt_") >= 0); else if (navigator.userAgent.indexOf("Firefox") >= 0 && n && n.length > 0) { var i = null, r = null; n[0] && (i = n[0].split("-"), i[1] < 10 && (i[1] = "0" + parseInt(i[1])), i[2] < 10 && (i[2] = "0" + parseInt(i[2])), i = i[0] + "-" + i[1] + "-" + i[2]), n[1] && (r = n[1].split("-"), r[1] < 10 && (r[1] = "0" + parseInt(r[1])), r[2] < 10 && (r[2] = "0" + parseInt(r[2])), r = r[0] + "-" + r[1] + "-" + r[2]), n = [i, r] } if (n.length > 1) { var o = n[0] ? n[0].split(" ")[1] || "00:00:00" : "00:00:00", s = n[1] ? n[1].split(" ")[1] || "23:59:59" : "23:59:59"; n = n.concat([o, s]) } else 1 === n.length && n[0].indexOf("opt_") > -1 ? n = [+new Date, +new Date, "00:00:00", "23:59:59"] : 0 === n.length && (n = [+new Date, +new Date, "00:00:00", "23:59:59"]); h = a.open({ template: "/static/partials/dialogTemplates/custom-date-modal.html", className: "ngdialog-theme-default date-picker-modal daterange-bdp-modal", data: { index: e, range: n }, scope: t }) }, getItemList: function (e, n, a) { t.setParentAndChildMap(); var i = t.getParentFilterRange(n.df_id); n.show = !a && !n.show, (n.show || a) && (t.globalFilterMultiple.loading = !0, t.queryKwd[n.df_id] = "", o.dash_global_filter.range({ dash_id: r.dashId, rule_id: t.ruleId, df_id: n.df_id, scheme_id: n.config.scheme_id || "", granularity: n.config.granularity || "", range: angular.toJson(i) }).then(function (i) { if (t.globalFilterMultiple.loading = !1, 0 == i.status) { var r = i.result.range; !a && p(e, n, r), t.showQueryfilter[n.df_id] = i.result.total > 100, t.queryString[n.df_id] = { show: !t.showQueryfilter[n.df_id], keyword: "", list: r, total: i.result.total }, a && (a(n, r, i.result.total), t.originalRange = r) } else l(Number(i.status)) }).finally(function () { t.globalFilterMultiple.loading = !1 })) }, getItemListAfterDialog: function (e, n, i) { a.open({ template: "/static/dashboard-core/global-filter/global-filter-string-multiple.html", className: "ngdialog-theme-default str-filter-model global-str", scope: t }), this.getItemList(e, n, i) }, openAdvanceModal: function (e, n, a) { for (var i, e = angular.copy(e), r = 0; r < t.globalDashFilter.length; r++)if (t.globalDashFilter[r].df_id === e.df_id) { i = r; break } var o = void 0 == e.range ? [] : e.range; t.globalDashFilter[i].showName; t.globalFilterMultiple = { index: i, df_id: e.df_id, name: e.name, data_type: e.data_type, keyword: "", filterKwd: "", config: e.config, searchList: [], total: a, addList: o, range_type: e.hasOwnProperty("range_type") ? e.range_type : "1" }, angular.forEach(n, function (e) { $.inArray(e, o) > -1 ? t.globalFilterMultiple.searchList.push({ name: e, select: !0 }) : t.globalFilterMultiple.searchList.push({ name: e, select: !1 }) }), t.disabled_compare = !0 }, addAdvanceItem: function (n, a) { a && a.stopPropagation(); var i = !1; if ($.inArray(n.name, t.globalFilterMultiple.addList) > -1 && (i = !0), i) return void l(t.tips["filter.hasTheFilter"]); t.globalFilterMultiple.addList.push(n.name), e(function () { var e = $(".add-list").find("ul"), t = e[0].scrollHeight; e.animate({ scrollTop: t }) }, 300) }, delAdvanceItem: function (e, n) { n && n.stopPropagation(); for (var a = t.globalFilterMultiple.searchList, i = 0, r = a.length; i < r; i++)if (a[i].name == t.globalFilterMultiple.addList[e]) { a[i].select = !1; break } t.globalFilterMultiple.addList.splice(e, 1) }, delAll: function () { t.globalFilterMultiple.addList = [] }, addAll: function () { function e(e) { t.globalFilterMultiple.total <= 100 && t.globalFilterMultiple.keyword ? e.name.toLocaleLowerCase().indexOf(t.globalFilterMultiple.keyword.toLocaleLowerCase()) >= 0 && t.globalFilterMultiple.addList.push(e.name) : t.globalFilterMultiple.addList.push(e.name) } if (0 == t.globalFilterMultiple.addList.length) return void angular.forEach(t.globalFilterMultiple.searchList, function (t) { e(t) }); angular.forEach(t.globalFilterMultiple.searchList, function (n) { $.inArray(n.name, t.globalFilterMultiple.addList) < 0 && e(n) }) }, saveAdvance: function () { var e = t.globalDashFilter[t.globalFilterMultiple.index], n = t.globalFilterMultiple.addList, a = n.join(","); e.range_type = t.globalFilterMultiple.range_type, t.refreshCharts(e, a, n) }, enterToQuery: function (e) { 13 == e.e.keyCode && (e.is_advance ? t.globalFilterMultiple.filterKwd = t.globalFilterMultiple.keyword : t.queryString[e.filter.df_id].keyword = t.queryKwd[e.filter.df_id], e.real_search && this.query(e.filter, e.is_advance)) }, query: function (e, n) { t.showLoading = !0, t.setParentAndChildMap(); var a = t.getParentFilterRange(e.df_id), i = e.df_id, r = t.queryKwd[i] || t.globalFilterMultiple && t.globalFilterMultiple.keyword; if (n ? t.globalFilterMultiple.filterKwd = r : t.queryString[e.df_id].keyword = r, r) { var o = { keyword: r, rule_id: t.ruleId, df_id: e.df_id, granularity: e.config.granularity || "", parent_range: angular.toJson(a) }; n && (t.globalFilterMultiple.loading = !0), s.post("/api/dsh_filter/enum_search", o).then(function (e) { if (t.showLoading = !1, 0 == e.status) if (n) { var a = []; angular.forEach(e.result, function (e) { a.push({ name: e, select: !1 }) }), t.globalFilterMultiple.loading = !1, t.globalFilterMultiple.searchList = a } else t.tempQueryList = angular.copy(t.queryString[i].list), t.queryString[i].list = e.result, t.queryString[i].show = !0; else l(Number(e.status)) }) } else if (t.showLoading = !1, n) { var c = []; angular.forEach(t.originalRange, function (e) { c.push({ name: e, select: !1 }) }), t.globalFilterMultiple.searchList = c } }, delQueryField: function (e) { t.tempQueryList && (t.queryString[e].list = t.tempQueryList || []), t.queryKwd[e] = "" } }, t.setParentAndChildMap = function () { function e(n, o) { angular.forEach(n, function (n) { i = [], angular.forEach(a, function (e) { e.df_id == o.df_id && (i = e.range, r = e.hasOwnProperty("range_type") ? e.range_type : "1") }), "string" == o.data_type && (o.config.granularity = ""), t.parentAndChildMap.push({ parent_df_id: o.df_id, parent_name: o.name, parent_granularity: o.config.granularity, parent_range: i, parent_data_type: o.data_type, parent_range_type: r, self_df_id: n.df_id, self_name: n.name }), n.items && n.items.length > 0 && e(n.items, n) }) } t.parentAndChildMap = []; var n = angular.copy(t.originalGlobalFilter), a = t.globalDashFilter, i = [], r = "1"; e(n, { df_id: "", name: "", range: [], data_type: "", config: { granularity: "" }, range_type: "1" }) }, t.getParentFilterRange = function (e) { function n(e) { angular.forEach(t.parentAndChildMap, function (t) { e == t.self_df_id && t.parent_df_id && (a.push({ df_id: t.parent_df_id, range: t.parent_range, data_type: t.parent_data_type, name: t.parent_name, granularity: t.parent_granularity || "", range_type: t.parent_range_type }), n(t.parent_df_id)) }) } var a = []; return n(e), angular.forEach(a, function (e) { delete e.name }), a }, t.setParentAndChildMap(), t.resetRangeType = function (e) { e.range_type = "1", $(".J_dash_edit_content").length && $(".J_dash_edit_content").attr("issetFilter", "1") }, t.scrollHandler = { scrollCount: 0, scrollWidth: 0, firstIndex: 0, nextIndex: 0, itemWidthArr: [], rightShadow: 24, getItemWidth: function () { for (var e = n.find(".global-filter").find(".filter-i"), t = [], a = 0; a < e.length; a++)t.push(e[a].scrollWidth + 24); this.itemWidthArr = []; for (var a = 0; a < t.length; a++)0 === a ? this.itemWidthArr.push(t[0]) : this.itemWidthArr.push(this.itemWidthArr[a - 1] + t[a]) }, _setFirstIndex: function (e) { var t = this.itemWidthArr.length; if (e - this.rightShadow >= this.itemWidthArr[t - 1]) return this.firstIndex = t - 1, void (this.scrollWidth = this.itemWidthArr[this.firstIndex - 1] || 0); for (var n = 0; n < t; n++)if (e - this.rightShadow <= this.itemWidthArr[n]) { this.firstIndex = n, this.scrollWidth = this.itemWidthArr[this.firstIndex - 1] || 0; break } }, _setNextIndex: function (e, t) { for (var n = this.firstIndex; n < this.itemWidthArr.length; n++)if (this.nextIndex = 0, e + t - this.rightShadow <= this.itemWidthArr[n]) { this.nextIndex = n; break } 0 === this.nextIndex && (this.nextIndex = this.itemWidthArr.length) }, init: function (e) { this.getItemWidth(); var t = n.find(".global-filter"), a = t.innerWidth(); this._setFirstIndex(e), this._setNextIndex(e, a) }, reset: function () { this.scrollCount = 0, this.scrollWidth = 0, this.firstIndex = 0, this.nextIndex = 0, n.find(".global-filter").animate({ left: 32 }) }, scroll: function (e) { this.scrollCount = this.scrollCount + e, this.getItemWidth(); var t = n.find(".global-filter"), a = t[0].scrollWidth, i = t.innerWidth(); if (e > 0 ? this.scrollWidth = (this.scrollWidth || 0) + i : this.scrollCount ? this.scrollWidth = (this.scrollWidth || 0) - i + 56 + 32 + 32 : this.scrollWidth = 0, this.scrollCount < 0 || a + this.rightShadow <= i || this.scrollWidth >= a + i - 56) return void (this.scrollCount = this.scrollCount - e); this.scrollWidth >= 0 && (this._setFirstIndex(this.scrollWidth), this._setNextIndex(this.scrollWidth, i)); var r = 0 === this.scrollWidth ? 32 : 56 - this.scrollWidth; t.animate({ left: r }) } }, setTimeout(function () { t.scrollHandler.init(0) }), f.setAttr("resetGFScrollFunc", function () { t.scrollHandler.reset(), setTimeout(function () { t.scrollHandler.init(0) }) }); var g = t.$watch(function () { return t.globalDashFilter.length }, function (e, n) { e !== n && setTimeout(function () { t.scrollHandler.scroll(-t.scrollHandler.scrollCount) }) }); $(window).on("resize.globalFilter", $.debounce(300, function () { t.scrollHandler.init(t.scrollHandler.scrollWidth) })), $("body").on("dashboard-scroll-start.globalFilter", function () { var e = t.globalDashFilter; if ($(".J_globle_filter_layer").addClass("ng-hide"), $.isArray(e)) for (var n = 0, a = e.length; n < a; n++)e[n].show = !1 }), t.$on("$destroy", function () { $(window).off("resize.globalFilter"), $("body").off("dashboard-scroll-start.globalFilter"), g() }), c(["chart.notLimit", "chart.dateRangeRequired", "filter.hasTheFilter", "filter.dateRangeInvalid", "filter.startDateErr2", "filter.endDateErr2"], t) } return { restrict: "A", templateUrl: "/static/dashboard-core/global-filter/global-filter.html", scope: { originalGlobalFilter: "=", globalDashFilter: "=", globalDashFilterItems: "=", globalDashFilterDisplay: "=", ruleId: "=", showLoading: "=", drawChartUrl: "=", filterStatus: "=", onSharePage: "=" }, link: p } } angular.module("BC.dashboard.core").directive("globalFilter", e), e.$inject = ["$timeout", "$interval", "$rootScope", "ngDialog", "$stateParams", "commonService", "commonHttp", "errHint", "$jsTipTranslate", "dateTimeByHalfHour", "$location", "globalFilterService"] }() }, function (e, t, n) {
  "use strict"; angular.module("BC.dashboard.core").directive("dateAdvanceEdit", ["$rootScope", "errHint", "commonService", "commonHttp", "$stateParams", "$timeout", "$jsTipTranslate", "globalDateSchemeService", "$translate", "ngDialog", function (e, t, n, a, i, r, o, s, l, c) {
    return {
      restrict: "A", templateUrl: "/static/dashboard-core/global-filter/date-advance-edit.html", link: function (d, u, f) {
        function p(e) { var t = !1; return angular.forEach(y, function (n) { n.name == e && (t = !0) }), t } var h = e.language || "zh", g = "未命名", m = "日期"; "en" == h && (g = "Untitled", m = "DATE"); var v = angular.copy(GlobalConstant.defaultAdvDateConfig); v.is_global = 2, d.listLoading = !0, d.infoLoading = !1, d.hasNew = !1, d.model = !1, d.permisionDateFilter = e.permision.canDateFilter, d.tempData = { name: "" }, d.dateAdvanceData = {}, d.dateAdvanceView = {}, d.dateAdvanceList = [], d.dateFieldId = [], d.selected_date_opt_id = "", d.selected_date_opt_is_default = !1; var y = d.dateAdvanceList; d.$on("showDateAdvanceEdit", function (e, t) { if (t) { d.selected_date_opt_id = ""; var n = d.filterView.selected_opt, a = d.filterStatus[n]; d.globalDateFilterConfig.applySchemeId = a.config.scheme_id, d.globalDateFilterConfig.selectedScheme = null, d.globalDateFilterConfig.list() } }), d.dateAdvance = {
          getList: function () { var e = d.filterView.selected_opt, a = d.filterStatus[e], r = {}, o = d.globalDateFilterConfig.selectedScheme; return angular.forEach(a.tables, function (e, t) { !!e.show && (r[e.tb_id] = e.selected) }), d.dateFieldIds = angular.copy(r), d.listLoading = !0, n.dash_global_filter.range({ dash_id: i.dashId, scheme_id: o.scheme_id, rule_id: d.ruleId, df_id: e, selected_tables: angular.toJson(r), granularity: a.config.granularity }).then(function (e) { if (d.listLoading = !1, "0" === e.status) { d.dateAdvanceList = e.result.range || []; var n = !1; d.dateAdvanceList.forEach(function (e) { d.selected_date_opt_id == e.opt_id && (n = !0, d.globalDateFilterConfig.isConfig && 1 != e.is_global && (n = !1)) }), n ? d.dateAdvance.getInfo(d.selected_date_opt_id) : d.dateAdvanceList.length > 0 && d.dateAdvance.getInfo(d.dateAdvanceList[0].opt_id), d.globalDateFilterConfig.isConfig || (d.globalDateFilterConfig.applyAdvDateList = angular.copy(d.dateAdvanceList)) } else t(Number(e.status)) }) }, getInfo: function (e, a) { if (d.hasNew) return void t(d.tips["filter.pleaseSaveCurrentFilterItem"]); d.infoLoading = !0, d.selected_date_opt_id = e, d.tempData = v, d.tempData.name = a, n.adv_date.info(e).success(function (e) { "0" == e.status ? (d.tempData = angular.fromJson(e.result), d.dateAdvance.setDefaultData(e.result), d.infoLoading = !1, d.selected_date_opt_disabled = !d.globalDateFilterConfig.isConfig && 1 == d.tempData.is_global, d.globalDateFilterConfig.isConfig && 1 == d.tempData.is_global && d.globalDateFilterConfig.selectedScheme.is_default && (d.selected_date_opt_disabled = !0)) : t(Number(e.status)) }) }, setDefaultData: function (e) { if ("accurate" !== d.tempData.type ? (d.tempData.accurate.start = "", d.tempData.accurate.end = "") : (d.tempData.accurate.start = e.accurate.start, d.tempData.accurate.end = e.accurate.end), d.tempData.fixed.hasOwnProperty("granularity") || (d.tempData.fixed.granularity = "day"), "expression" === d.tempData.type) { var t = new RegExp("\\[_field_id_\\]", "g"); d.tempData.expression = d.tempData.expression.replace(t, "[" + m + "]"), r(function () { d.$broadcast("changeDateExpression", d.tempData.expression) }, 50) } else r(function () { d.$broadcast("changeDateExpression", "") }, 50) }, createItem: function () { if (d.hasNew) return void t(d.tips["filter.pleaseSaveCurrentFilterItem"]); d.tempData = angular.copy(v), d.tempData.is_global = d.globalDateFilterConfig.isConfig ? 1 : 2, d.selected_date_opt_id = "newId", d.selected_date_opt_disabled = !1, d.model = "create", d.tempData.name = g, $(".date-advance-name > input").focus(), d.dateAdvanceList.push(d.tempData), scrollToBottom(angular.element(u).find(".item-list")), d.hasNew = !0 }, clickFun: function (e) { e && e.stopPropagation(), d.tempData.name == g && (d.tempData.name = "") }, blurFun: function (e) { e && e.stopPropagation(), d.tempData.name || (d.tempData.name = g), d.tempData.name && d.tempData.name != g && p(d.tempData.name) && (t(d.tips["filter.duplicatedNames"]), d.tempData.name = "") }, changeTypeFun: function (e) { if (e && e.stopPropagation(), "expression" === d.tempData.type) { var t = new RegExp("\\[_field_id_\\]", "g"); d.tempData.expression = d.tempData.expression.replace(t, "[" + m + "]"), r(function () { d.$broadcast("changeDateExpression", d.tempData.expression) }, 50) } else r(function () { d.$broadcast("changeDateExpression", "") }, 50) }, fixedGranularityChange: function (e) { e && e.stopPropagation(), "day" == d.tempData.fixed.granularity ? d.tempData.fixed.start = 30 : d.tempData.fixed.start = 1 }, deleteItem: function (e, a, i) {
            e && e.stopPropagation(); var r = d.filterView.selected_opt; if ("newId" == d.selected_date_opt_id) d.dateAdvanceList.splice(i, 1), d.hasNew = !1, d.dateAdvanceList.length > 0 && d.dateAdvance.getInfo(d.dateAdvanceList[0].opt_id, d.dateAdvanceList[0].name); else {
              if (!confirm(d.tips["filter.delTip"])) return
                ; a.opt_id == d.selected_date_opt_id && (d.selected_date_opt_id = ""), n.adv_date.global_del(a.opt_id, r).success(function (e) { 0 == e.status ? (d.dateAdvance.getList(), t(d.tips.delSuccess)) : t(Number(e.status)) })
            }
          }, modifyItem: function () { if (0 != d.dateAdvanceList.length) { var e = d.selected_date_opt_id || "", a = i.dashId, r = d.tempData.name, o = d.filterView.selected_opt, s = d.globalDateFilterConfig.selectedScheme.scheme_id; if (!r) return void t(d.tips["filter.nullTitle"]); if (p(r) && (t(d.tips["filter.duplicatedNames"]), d.tempData.name = ""), "newId" == e && (e = ""), d.dateAdvance.formatData()) { var l = angular.toJson(d.tempData); n.adv_date.global_modify(a, e, o, s, l).then(function (e) { 0 == e.status ? (e.result.hasOwnProperty("opt_id") && (d.selected_date_opt_id = e.result.opt_id), d.dateAdvance.getList(), d.hasNew = !1, t(d.tips.saveSuccess)) : t(Number(e.status)) }) } } }, formatData: function () { var e = !0, a = d.tempData.type, r = d.tempData.accurate.start, o = d.tempData.accurate.end; if ("fixed" === a) "0" === d.tempData.fixed.start && (t(d.tips["filter.inputPositiveNumber"]), e = !1), isNaturalNumber(d.tempData.fixed.start) && isNaturalNumber(d.tempData.fixed.end.value) || (t(d.tips["chart.plzTypePositionInteger"]), e = !1); else if ("accurate" === a) "string" == typeof r && (r = new Date(r)), "string" == typeof o && (o = new Date(o)), r || o || (t(d.tips["filter.nullData"]), e = !1), r.getTime() - o.getTime() > 0 && (t(d.tips["chart.dateRangeInvalid"]), e = !1); else if ("relative" === a); else if ("expression" === a) { var s = d.selected_date_opt_id || "", l = i.dashId, c = d.dateAdvance.checkFormulaGrammar(), u = d.filterView.selected_opt, f = d.globalDateFilterConfig.selectedScheme.scheme_id; c && c.then(function (a) { if (a) { d.tempData.accurate.start = Highcharts.dateFormat("%Y-%m-%d", r), d.tempData.accurate.end = Highcharts.dateFormat("%Y-%m-%d", o); var i = angular.toJson(d.tempData); "newId" == s && (s = ""), n.adv_date.global_modify(l, s, u, f, i).success(function (e) { 0 == e.status ? (d.dateAdvance.getList(), e.result.hasOwnProperty("opt_id") && (d.selected_date_opt_id = e.result.opt_id), d.hasNew = !1, t(d.tips.saveSuccess)) : t(Number(e.status)) }), e = !1 } else t(d.tips["filter.checkFailed"]), d.checkFormulaGrammarFlag = !1, e = !1; return e }), e = !1 } return d.tempData.accurate.start = Highcharts.dateFormat("%Y-%m-%d", r), d.tempData.accurate.end = Highcharts.dateFormat("%Y-%m-%d", o), e }, setExpression: function (e) { d.tempData.expression = e }, expressionChanged: function (e) { d.expressionChangedFlag = e }, insertFieldNameToExpression: function () { d.expressionChangedFlag = !0, d.$broadcast("insertFieldNameToExpression", m) }, checkFormulaGrammar: function () { var e = d.tempData.expression; if ("" == e) return void t(d.tips["filter.pleaseInputExpression"]); var n = m, r = new RegExp("\\[" + n + "\\]", "g"); d.tempData.expression = e.replace(r, "[_field_id_]"); var o = [], s = []; angular.forEach(d.dateFieldIds, function (e, t) { o.push(t), s.push(e) }); var l = { dash_id: i.dashId, tb_id: angular.toJson(o), fid: angular.toJson(s), expression: d.tempData.expression }; return d.expressionChangedFlag = !1, a.post("/api/expression/syntax_verify", l).then(function (e) { return 0 == e.status ? (t(d.tips["filter.checkSuccess"]), d.checkFormulaGrammarFlag = !0, !0) : (t(d.tips["filter.checkFailed"]), d.checkFormulaGrammarFlag = !1, !1) }) }, turnToLastItem: function () { var e = "", t = ""; !d.selected_date_opt_id && d.dateAdvanceList.length > 0 ? (d.selected_date_opt_id = d.dateAdvanceList[0].opt_id, e = d.selected_date_opt_id, t = d.dateAdvanceList[0].name) : (angular.forEach(d.dateAdvanceList, function (n) { n.opt_id == d.selected_date_opt_id && (e = d.selected_date_opt_id, t = n.name) }), scrollToBottom(angular.element(u).find(".item-list"), 0)), d.dateAdvance.getInfo(e, t) }
        }, d.returnGlobalFilter = function () { d.showDateAdvanceEdit = !1, d.hasNew = !1, $(".ngdialog-close").css("display", "inline-block"), d.$emit("hideDateAdvanceEdit", { df_id: d.filterView.selected_opt, scheme: d.globalDateFilterConfig.applySchemeId }) }, d.globalDateFilterConfig = { isConfig: !1, isEditing: !1, isCreating: !1, selectedScheme: null, applySchemeId: "", applyAdvDateList: [], schemeList: [], newScheme: null, editMap: {}, status: { listLoading: !1, infoLoading: !1 }, tip: l.instant("ownership.filter.globalSchemeTip"), changeApply: function () { var e = d.globalDateFilterConfig.schemeList, t = s.getSchemeObj(e, d.globalDateFilterConfig.applySchemeId); d.globalDateFilterConfig.info("", t), s.setLatestScheme(t.scheme_id) }, enter: function () { if (d.hasNew) return void t(d.tips["filter.pleaseSaveCurrentFilterItem"]); d.globalDateFilterConfig.isConfig = !0, angular.element(".J-global-filter-model").addClass("global-date-config-modal"), d.globalDateFilterConfig.list("init") }, exit: function () { if (d.hasNew) return t(d.tips["filter.pleaseSaveCurrentFilterItem"]), !1; var e = d.globalDateFilterConfig.schemeList; d.globalDateFilterConfig.isConfig = !1, d.dateAdvanceList = angular.copy(d.globalDateFilterConfig.applyAdvDateList); var n = s.getSchemeObj(e, d.globalDateFilterConfig.applySchemeId); d.globalDateFilterConfig.info("", n), angular.element(".J-global-filter-model").removeClass("global-date-config-modal"), d.$broadcast("broadcastReloadSelectList", e) }, list: function (e) { function t() { s.getDefaultSchemeInList(d.globalDateFilterConfig, e), d.globalDateFilterConfig.info("", d.globalDateFilterConfig.selectedScheme) } 0 == d.globalDateFilterConfig.schemeList.length ? (d.globalDateFilterConfig.status.listLoading = !0, s.getSchemeList().then(function (e) { d.globalDateFilterConfig.schemeList = e, t() }).finally(function () { d.globalDateFilterConfig.status.listLoading = !1 })) : t() }, add: function () { if (s.hasEditingScheme(d.globalDateFilterConfig.editMap) || d.globalDateFilterConfig.isCreating) return t(l.instant("ownership.filter.saveSchemeFirst")), !1; d.globalDateFilterConfig.newScheme = angular.copy({ name: "", scheme_id: "new_id" }), d.globalDateFilterConfig.isCreating = !0, setTimeout(function () { $("#J-new-name").focus() }, 300) }, edit: function (e, n, a) { if (s.hasEditingScheme(d.globalDateFilterConfig.editMap) || d.globalDateFilterConfig.isCreating) return t(l.instant("ownership.filter.saveSchemeFirst")), !1; var i = n.scheme_id; d.globalDateFilterConfig.editMap = {}, d.globalDateFilterConfig.editMap[i] = !0, d.globalDateFilterConfig.isEditing = !0 }, save: function (a, i, r) { var o = i.scheme_id, c = {}, u = d.globalDateFilterConfig.schemeList; if (c = d.globalDateFilterConfig.isCreating ? d.globalDateFilterConfig.newScheme : i, !c.name) return t(l.instant("ownership.filter.requestName")), !1; if (s.checkRepeatScheme(c, u)) return t(l.instant("ownership.filter.schemeRepeatName")), !1; var f = s.getSchemeModifyParam(i); d.globalDateFilterConfig.isCreating ? (delete f.scheme_id, n.adv_date_scheme.create(f).then(function (t) { if (0 == t.status) { var n = { scheme_id: t.result.scheme_id, name: c.name, user_id: e.userInfoObj && e.userInfoObj.userId || $.cookie("user_id") }; d.globalDateFilterConfig.schemeList.push(n), d.globalDateFilterConfig.editMap[o] = !1, d.globalDateFilterConfig.isCreating = !1, d.globalDateFilterConfig.info("", n) } })) : n.adv_date_scheme.modify(f).then(function (e) { 0 == e.status && (d.globalDateFilterConfig.editMap[o] = !1, d.globalDateFilterConfig.isCreating = !1) }) }, cancel: function (e, t, n) { var a = t.scheme_id; d.globalDateFilterConfig.editMap[a] = !1, d.globalDateFilterConfig.isCreating = !1, d.globalDateFilterConfig.isEditing = !1 }, info: function (e, n, a) { if (d.hasNew) return t(d.tips["filter.pleaseSaveCurrentFilterItem"]), !1; d.globalDateFilterConfig.selectedScheme = n, s.removeChartSchemeCache(n.scheme_id), d.dateAdvance.getList() }, del: function (e, t, n) { c.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: d, data: { title: l.instant("tips"), message: l.instant("ownership.filter.delSchemeTip") + ": " + t.name + " ?" } }).then(function () { d.globalDateFilterConfig.confirmDel(t, n) }) }, confirmDel: function (e, t) { var a = d.globalDateFilterConfig.selectedScheme, i = { scheme_id: e.scheme_id }; n.adv_date_scheme.delete(i).then(function (n) { if (0 == n.status && (d.globalDateFilterConfig.schemeList.splice(t, 1), d.globalDateFilterConfig.editMap.new_id = !1, d.globalDateFilterConfig.isEditing = !1, s.removeChartSchemeCache(e.scheme_id), a.scheme_id == e.scheme_id)) { var i = d.globalDateFilterConfig.schemeList; i.length > 0 && (d.globalDateFilterConfig.selectedScheme = i[0], d.globalDateFilterConfig.info("", i[0])) } }) } }, o(["saveSuccess", "fail", "delSuccess", "filter.pleaseSaveCurrentFilterItem", "filter.checkSuccess", "filter.checkFailed", "filter.pleaseInputExpression", "filter.nullData", "chart.dateRangeInvalid", "filter.inputPositiveNumber", "chart.plzTypePositionInteger", "filter.changeScopeTip2", "filter.nullTitle", "filter.duplicatedNames", "filter.delTip"], d)
      }
    }
  }])
}, function (e, t, n) { "use strict"; var a = n(319), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").service("globalFilterHandleService", ["commonService", "$q", "bdpOuterParamService", i.default]) }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.default = void 0; var i = n(6), r = a(i), o = n(7), s = a(o), l = function () { function e(t, n, a) { (0, r.default)(this, e), this.commonService = t, this.$q = n, this.bdpOuterParam = new a, this.bdpOuterParam.parseUrlParam() } return (0, s.default)(e, [{ key: "getGlobalFilterItem", value: function (e) { var t = this.$q.defer(), n = { globalDashFilter: [], globalDashFilterDisplay: [], globalDashFilterItems: {} }, a = !1, i = this, r = { hitGlobalFilterId: [], hitMemoryGlobalFilter: !1 }; return this.commonService.dash_global_filter.item({ dash_id: e.dashId, rule_id: e.rule_id }).then(function (o) { if (0 == o.status) { n.originalGlobalFilter = _.cloneDeep(o.result); var s = bdp.utils.handleGlobalFilterLevel(o.result), l = e.jumpDfId, c = e.jumpRange; _.forEach(s, function (t) { if (l == t.df_id ? (i.handleJumpGlobalFilter(c, t), a = !0) : (e.hitMemoryGlobalFilter && (r = i.checkMemoryGlobalFilter(t)), i.bdpOuterParamGlobalFilter(t, e.dashSelected)), "date" == t.data_type && "" == t.config.granularity) { var n = t.config.range || ""; if (n) { var o = !1; _.forEach(t.adv_date_list, function (e) { e.opt_id == n && (o = !0) }), o || (t.config.range = "", t.config.default_select = !1, t.range = []) } } }), n.globalDashFilter = s, n.globalDashFilterDisplay = bdp.bdpDash.getGFDisplay(s), t.resolve({ global: n, dashId: e.dashId, hitJumpGlobalFilter: a, hitGlobalFilterId: r.hitGlobalFilterId, hitMemoryGlobalFilter: r.hitMemoryGlobalFilter, status: o.status }) } else t.reject({ status: o.status }) }), t.promise } }, { key: "handleJumpGlobalFilter", value: function (e, t) { if ("date" == t.data_type && "" == t.config.granularity) for (var n = 0, a = t.adv_date_list.length; n < a; n++) { var i = t.adv_date_list[n]; i.name == e ? t.range[0] = i.opt_id : t.range[0] = e } else t.range[0] = e } }, { key: "bdpOuterParamGlobalFilter", value: function (e, t) { var n = this.bdpOuterParam.getUrlObj(); this.bdpOuterParam.parseUrlParam(), this.bdpOuterParam.isHit() && n.is_df && this.bdpOuterParam.matchGlobalFilter(t, e) } }, { key: "checkMemoryGlobalFilter", value: function (e) { var t = angular.fromJson(window.localStorage.getItem("global_filter_memory")) || [], n = !1, a = [], i = !1; return _.forEach(t, function (t) { e.data_type == t.data_type && e.name == t.name && e.config && e.config.hasOwnProperty("granularity") && e.config.granularity == t.granularity && ("date" == e.data_type && "" == e.config.granularity ? angular.forEach(e.adv_date_list, function (a) { a.opt_id == t.range[0] && (e.range = t.range, n = !0) }) : (e.range = t.range, e.range_type = t.range_type), i = !0, a.push(e.df_id)) }), { hitMemoryGlobalFilter: i, hitGlobalFilterId: a } } }, { key: "setRequestParam", value: function (e) { var t = []; return angular.forEach(e.globalDashFilter, function (n, a) { t.push({ df_id: n.df_id, range: n.range, data_type: n.data_type, granularity: n.config.granularity || "", range_type: n.range_type || "1" }), e.hitGlobalFilterId.indexOf(n.df_id) > -1 && (e.globalDashFilterItems[n.df_id] = { granularity: n.config.granularity || "", df_id: n.df_id, range: n.range, data_type: n.data_type, show_name: n.range, real_name: n.range, rela_charts: n.rela_ct_ids }) }), angular.forEach(e.drawChartUrl, function (n, a) { n.global_filter_value = [], angular.forEach(e.globalDashFilter, function (e, a) { e.rela_ct_ids.indexOf(n.options.ct_id) > -1 && (n.options.optional.dsh_filter = t, delete n.options.optional.filter_list, n.options.read_cache = !1, n.options.optional._t = new Date) }) }), e.drawChartUrl } }]), e }(); t.default = l }, function (e, t, n) { "use strict"; function a(e, t, a) { return { restrict: "EA", templateUrl: n(358), replace: !0, scope: { data: "=" }, link: function (e, n, i) { e.showChart = "", e.chart = {}, e.defaultStyles = { light: {}, dark: {} }, e.$watch("data", function () { var t = e.getChart(); e.chart = t; switch (t && t.info ? t.info.chart_type : "") { case "C210": case "C211": case "C212": e.showChart = "column"; break; case "C240": case "C241": case "C242": case "C243": e.showChart = "bar"; break; case "C230": e.showChart = "pie"; break; case "C220": e.showChart = "line"; break; case "C350": case "C351": case "C352": e.showChart = "area"; break; case "C310": e.showChart = "card"; break; case "C200": e.showChart = "table"; break; case "C271": case "C272": case "C273": e.showChart = "map"; break; case "C381": case "C382": e.showChart = "3dMap"; break; default: e.showChart = "" } }), e.getChart = function () { return a.get(e.data) }, e.getStyles = function () { var t = e.getChart(); return t ? t.info.styles = t.info.styles || {} : {} }, e.saveChart = function (n, a) { var i = e.getChart(); if (i) { var o = i.info.dsh_id, s = i.info.chart_id, l = i.info.drill_level; if (i.info.styles = n, a = a || {}, !$.isEmptyObject(a)) for (var c in a) i.info[c] = a[c]; i.updateInfo(i.info, !0); var d = { styles: n }; if (!$.isEmptyObject(a)) for (var c in a) d[c] = a[c]; var u = { dsh_id: o, ct_id: s, drill_level: l, edit_meta: (0, r.default)(d) }; t.editMeta.modify(u) } }, e.init = function (t, n) { var a = e.getChart(); if (a) { a.once("data", function () { e.init(t, n) }); var i = {}; if ("column" == n || "bar" == n || "line" == n || "pie" == n || "area" == n ? (i[n] = { skinNo: 0 }, a.info.styles && a.info.styles.no && (i[n] = { skinNo: a.info.styles.no }), i.defaultStyles = e.defaultStyles) : i = e.getStyles(), i[n]) { if (void 0 === i.type) i.type = n; else if (i.type !== n) return; t(i, a.info.chart_type) } } } } } } var i = n(2), r = function (e) { return e && e.__esModule ? e : { default: e } }(i); n(321), n(322), n(323), n(324), n(325), n(326), n(327), n(328), n(329), n(330), n(333), n(336), n(339), n(342), n(345), n(348), n(351), n(354), n(356), angular.module("BC.dashboard.core").directive("chartStyle", a), a.$inject = ["$rootScope", "commonService", "chartInstService"] }, function (e, t, n) { "use strict"; !function () { function e(e, t) { return { restrict: "EA", scope: { data: "=?", saveFunc: "&?", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/alignmentStyle/alignmentStyle.html", replace: !0, link: function (e, n, a) { function i(e) { var t = { left: { wrapperClass: "", iconClass: "ico-text-left" }, center: { wrapperClass: "", iconClass: "ico-text-center" }, right: { wrapperClass: "", iconClass: "ico-text-right" } }; return t[e] && (t[e].wrapperClass = "active", t[e].iconClass = "ico-text-" + e + "-active"), t } e.$watch("data", function () { e.alignmentConfig = i(e.data) }), e.alignment = function (n) { e.data === n ? e.data = "default" : e.data = n, e.alignmentConfig = i(e.data), t(function () { e.saveFunc() }, 0) } } } } angular.module("BC.dashboard.core").directive("alignmentStyle", e), e.$inject = ["$rootScope", "$timeout"] }() }, function (e, t, n) { "use strict"; function a(e, t) { return { restrict: "EA", scope: { data: "=", saveFunc: "&", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/colorStyle/colorStyle.html", replace: !0, link: function (e, t, n) { e.$watch("data", function () { e.colorStyle = { backgroundColor: e.data } }) } } } angular.module("BC.dashboard.core").directive("colorStyle", a), a.$inject = ["$rootScope", "$timeout"] }, function (e, t, n) { "use strict"; !function () { function e(e, t) { return { restrict: "EA", scope: { data: "=", saveFunc: "&?", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/fontAdvStyle/fontAdvStyle.html", replace: !0, link: function (e, t, n) { function a(e) { return e ? { wrapperClass: "active", iconClass: "ico-text-bold-active" } : { wrapperClass: "", iconClass: "ico-text-bold" } } function i(e) { return e ? { wrapperClass: "active", iconClass: "ico-text-italic-active" } : { wrapperClass: "", iconClass: "ico-text-italic" } } e.$watch("data", function () { e.data = e.data || {}, e.boldConfig = a(e.data.bold), e.italicConfig = i(e.data.italic) }), e.bold = function () { e.data.bold = !e.data.bold, e.boldConfig = a(e.data.bold), e.saveFunc() }, e.italic = function () { e.data.italic = !e.data.italic, e.italicConfig = i(e.data.italic), e.saveFunc() } } } } angular.module("BC.dashboard.core").directive("fontAdvStyle", e), e.$inject = ["$rootScope", "$timeout"] }() }, function (e, t, n) { "use strict"; !function () { function e(e, t) { return void 0 !== e && null !== e ? e : t } function t(t, n, a, i) { return { restrict: "EA", scope: { data: "=", saveFunc: "&?", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/fontStyle/fontStyle.html", replace: !0, link: function (r, o, s) { n(function () { function n(e) { var t = Array.prototype.slice.call(arguments, 1); if (void 0 === e) for (var n = 0, a = t.length; n < a; n++) { var i = t[n]; if (void 0 !== i) { e = i; break } } return e } if (r.data) { var o = r.data, s = r.options || {}, l = (e(s.useInherit, !0), e(s.showFontFamily, !0)), c = e(s.defaultFontFamily), d = e(s.showFontSize, !0), u = e(s.defaultFontSize), f = e(s.showColor, !0), p = e(s.defaultColor), h = e(s.showAdaption, !1), g = e(s.showAlpha, !0), m = e(s.clickoutFiresChange, !1), v = e(s.chartFontFamily, i), y = e(s.chartFontSize, a), _ = e(s.formatter, {}); _.fontFamily = e(_.fontFamily, "fontFamily"), _.fontSize = e(_.fontSize, "fontSize"), _.color = e(_.color, "color"), r.formatter = _, "en" === t.language && (v[0].name = "Default", y[0].name = "Default"), o[_.fontFamily] = n(o[_.fontFamily], c, i[0].value), o[_.fontSize] = n(o[_.fontSize], u, a[0].value), o[_.color] = n(o[_.color], p), r.style = { showFontFamily: l, chartFontFamily: v, showFontSize: d, chartFontSize: y, showColor: f, colorPickerOpt: { showAdaption: h, showAlpha: g, clickoutFiresChange: m } } } }, 0) } } } angular.module("BC.dashboard.core").directive("fontStyle", t), t.$inject = ["$rootScope", "$timeout", "chartFontSize", "chartFontFamily"] }() }, function (e, t, n) { "use strict"; function a(e, t) { return void 0 !== e && null !== e ? e : t } function i(e) { return { restrict: "EA", scope: { valSelected: "=", valChange: "&", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/lineStyle/lineStyle.html", replace: !0, link: function (t, n, i) { function o() { var e = t.options || {}, n = a(e.lineStyleShowList), i = a(e.clickDisabled, !1), o = void 0; o = n ? _.filter(r, function (e) { return n.indexOf(e.name) !== -1 }) : r, t.viewData = { lineStyleList: o, selectedLineStyle: "", showList: !1, selectLineStyle: l, toggleStyleList: c }, t.clickDisabled = i } function s() { t.viewData.lineStyleList.forEach(function (e) { e.value == t.valSelected && (t.viewData.selectedLineStyle = e.map) }) } function l(n) { t.valSelected != n.value && (t.viewData.selectedLineStyle = n.map, t.valSelected = n.value, e(function () { t.valChange && t.valChange() }, 0)), t.viewData.showList = !1 } function c() { t.clickDisabled || (t.viewData.showList = !t.viewData.showList) } e(function () { o(), s(), t.$watch(function () { return t.valSelected }, function (e) { s() }) }, 0) } } } angular.module("BC.dashboard.core").directive("lineStyle", i); var r = [{ name: "Solid", value: "Solid", map: "solid" }, { name: "ShortDash", value: "ShortDash", map: "short-dash" }, { name: "ShortDot", value: "ShortDot", map: "short-dot" }, { name: "ShortDashDot", value: "ShortDashDot", map: "short-dash-dot" }, { name: "ShortDashDotDot", value: "ShortDashDotDot", map: "short-dash-dot-dot" }, { name: "Dot", value: "Dot", map: "dot" }, { name: "Dash", value: "Dash", map: "dash" }, { name: "LongDash", value: "LongDash", map: "long-dash" }, { name: "DashDot", value: "DashDot", map: "dash-dot" }, { name: "LongDashDot", value: "LongDashDot", map: "long-dash-dot" }, { name: "LongDashDotDot", value: "LongDashDotDot", map: "long-dash-dot-dot" }]; i.$inject = ["$timeout"] }, function (e, t, n) { "use strict"; function a(e, t) { return { restrict: "EA", scope: { data: "=", list: "=", saveFunc: "&", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/skinStyle/skinStyle.html", replace: !0, link: function (e, n, a) { function i() { return e.expend ? "ico-triangle-up" : "ico-triangle-down" } e.expend = !1, e.triangleClick = function () { e.expend = !e.expend, e.triangleClass = i() }, e.changeSkin = function (n) { e.data = n, t(function () { e.saveFunc(n.skinClass) }, 0) } } } } angular.module("BC.dashboard.core").directive("skinStyle", a), a.$inject = ["$rootScope", "$timeout"] }, function (e, t, n) { "use strict"; function a(e, t) { return void 0 !== e && null !== e ? e : t } function i(e) { return { restrict: "EA", scope: { data: "=", saveFunc: "&?", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/sliderStyle/sliderStyle.html", replace: !0, link: function (e, t, n) { function i(n) { void 0 !== n && null !== n || (n = 0), n !== n && (n = 0), n < 0 ? n = 0 : n > 1 && (n = 1); var a = 100 * n + "%"; e.valueStyle.width = a, e.buttonStyle.left = (t.width() - 12) * n + "px", e.per = n } var r = t.width(); e.valueStyle = { width: "0%" }, e.buttonStyle = { left: "0%" }, e.per = 0; var o = e.options || {}, s = a(o.range, [0, 1]); e.$watch("data", function () { var t = +e.data; _.isNumber(t) || (t = 0), i((t - s[0]) / (s[1] - s[0])) }), e.mousedown = function (t) { t.stopPropagation(); var n = t.clientX, a = e.per, o = function (t) { var o = t.clientX, s = o - n + a * r, l = s / r; e.$apply(function () { i(l) }) }, l = function t() { $(document).off("mousemove", o), $(document).off("mouseup", t), e.$apply(function () { e.data = e.per * (s[1] - s[0]) + s[0] }), e.saveFunc() }; $(document).on("mousemove", o), $(document).on("mouseup", l) } } } } angular.module("BC.dashboard.core").directive("sliderStyle", i), i.$inject = ["$timeout"] }, function (e, t, n) { "use strict"; !function () { function e(e, t) { return { restrict: "EA", scope: { data: "=?", saveFunc: "&?", options: "=" }, templateUrl: "/static/dashboard-core/chart-style/components/editableTextStyle/editableTextStyle.html", replace: !0, link: function (e, t, n) { e.showText = !0; var a = e.options || {}, i = a.range || [0, 1]; e.$watch("data", function () { e.editData = parseInt(100 * e.data) }), e.toggle = function () { e.showText = !e.showText, setTimeout(function () { t.find("input").focus() }, 0) }, e.save = function () { var t = +e.editData; t !== t && (t = parseInt(100 * e.data)), t /= 100, t > i[1] ? t = i[1] : t < i[0] && (t = i[0]), e.editData = 100 * t, e.data = t, e.showText = !0, e.saveFunc() } } } } angular.module("BC.dashboard.core").directive("editableTextStyle", e).filter("percentageFormatter", function () { return function (e) { return parseInt(100 * e) + "%" } }), e.$inject = ["$rootScope", "$timeout"] }() }, function (e, t, n) { "use strict"; !function () { angular.module("BC.dashboard.core").directive("chartStyleExtendCommon", ["ngDialog", "$timeout", "$rootScope", "errHint", "$jsTipTranslate", "defaultChartStyleFactory", "chartLegendPos", "chartLineDashStyle", "chartLineWidth", "chartFontSize", "chartFontFamily", "toggleNextBlock", "$translate", function (e, t, n, a, i, r, o, s, l, c, d, u, f) { return { restrict: "EA", scope: { data: "=?", chartInfo: "=?", saveFunc: "&?" }, templateUrl: "/static/dashboard/dash-chart-extend/chart-style-extend.html", replace: !0, link: function (e, p, h) { function g() { if (e.data && ["C200", "C271", "C272", "C273", "C310", "C210", "C211", "C212", "C220", "C230", "C240", "C241", "C242", "C243", "C350", "C351", "C352"].indexOf(e.data.chart_type) !== -1) return !0 } function m(e, t, n) { var a = t.gridPlotLine || {}, i = n.gridPlotLine || {}, r = t.legend || {}, o = n.legend || {}, s = t.axis || {}, l = n.axis || {}; i.yAxis && i.yAxis.hasOwnProperty("colorAdaption") && i.yAxis.colorAdaption ? a.yAxis.color = e.gridPlotLine.yAxis.color : delete a.yAxis.colorAdaption, i.xAxis && i.xAxis.hasOwnProperty("colorAdaption") && i.xAxis.colorAdaption ? a.xAxis.color = e.gridPlotLine.xAxis.color : delete a.xAxis.colorAdaption, l.xAxis && l.xAxis.hasOwnProperty("lineColorAdaption") && l.xAxis.colorAdaption ? s.xAxis.lineColor = e.axis.xAxis.lineColor : delete s.xAxis.lineColorAdaption, l.xAxis && l.xAxis.title && l.xAxis.title.hasOwnProperty("colorAdaption") && l.xAxis.title.colorAdaption ? s.xAxis.title.color = e.axis.xAxis.title.color : delete s.xAxis.title.colorAdaption, l.xAxis && l.xAxis.labels && l.xAxis.labels.hasOwnProperty("colorAdaption") && l.xAxis.labels.colorAdaption ? s.xAxis.labels.color = e.axis.xAxis.labels.color : delete s.xAxis.labels.colorAdaption, l.yAxis && l.yAxis.hasOwnProperty("lineColorAdaption") && l.yAxis.colorAdaption ? s.yAxis.lineColor = e.axis.yAxis.lineColor : delete s.yAxis.lineColorAdaption, l.yAxis && l.yAxis.title && l.yAxis.title.hasOwnProperty("colorAdaption") && l.yAxis.title.colorAdaption ? s.yAxis.title.color = e.axis.yAxis.title.color : delete s.yAxis.title.colorAdaption, l.yAxis && l.yAxis.labels && l.yAxis.labels.hasOwnProperty("colorAdaption") && l.yAxis.labels.colorAdaption ? s.yAxis.labels.color = e.axis.yAxis.labels.color : delete s.yAxis.labels.colorAdaption, l.yOptionalAxis && l.yOptionalAxis.hasOwnProperty("lineColorAdaption") && l.yOptionalAxis.colorAdaption ? s.yOptionalAxis.lineColor = e.axis.yOptionalAxis.lineColor : delete s.yOptionalAxis.lineColorAdaption, l.yOptionalAxis && l.yOptionalAxis.title && l.yOptionalAxis.title.hasOwnProperty("colorAdaption") && l.yOptionalAxis.title.colorAdaption ? s.yOptionalAxis.title.color = e.axis.yOptionalAxis.title.color : delete s.yOptionalAxis.title.colorAdaption, l.yOptionalAxis && l.yOptionalAxis.labels && l.yOptionalAxis.labels.hasOwnProperty("colorAdaption") && l.yOptionalAxis.labels.colorAdaption ? s.yOptionalAxis.labels.color = e.axis.yOptionalAxis.labels.color : delete s.yOptionalAxis.labels.colorAdaption, o.itemStyle && o.itemStyle.hasOwnProperty("colorAdaption") && o.itemStyle.colorAdaption ? r.itemStyle.color = e.legend.itemStyle.color : delete r.itemStyle.colorAdaption } function v(t, n) { var a = r.getDefaultStyle(), i = e.chartStyle, o = i.gridPlotLine, s = i.legend, l = i.axis; switch (n) { case "y_gridPlot": o.yAxis.colorAdaption = t.isAdaption, t.isAdaption && (o.yAxis.color = a.gridPlotLine.yAxis.color); break; case "x_gridPlot": o.xAxis.colorAdaption = t.isAdaption, t.isAdaption && (o.xAxis.color = a.gridPlotLine.xAxis.color); break; case "x_axis": l.xAxis.lineColorAdaption = t.isAdaption, t.isAdaption && (l.xAxis.lineColor = a.axis.xAxis.lineColor); break; case "x_axis_title": l.xAxis.title.colorAdaption = t.isAdaption, t.isAdaption && (l.xAxis.title.color = a.axis.xAxis.title.color); break; case "x_axis_labels": l.xAxis.labels.colorAdaption = t.isAdaption, t.isAdaption && (l.xAxis.labels.color = a.axis.xAxis.labels.color); break; case "y_axis": l.yAxis.lineColorAdaption = t.isAdaption, t.isAdaption && (l.yAxis.lineColor = a.axis.yAxis.lineColor); break; case "y_axis_title": l.yAxis.title.colorAdaption = t.isAdaption, t.isAdaption && (l.yAxis.title.color = a.axis.yAxis.title.color); break; case "y_axis_labels": l.yAxis.labels.colorAdaption = t.isAdaption, t.isAdaption && (l.yAxis.labels.color = a.axis.yAxis.labels.color); break; case "yOptional_axis": l.yOptionalAxis.lineColorAdaption = t.isAdaption, t.isAdaption && (l.yOptionalAxis.lineColor = a.axis.yOptionalAxis.lineColor); break; case "yOptional_axis_title": l.yOptionalAxis.title.colorAdaption = t.isAdaption, t.isAdaption && (l.yOptionalAxis.title.color = a.axis.yOptionalAxis.title.color); break; case "yOptional_axis_labels": l.yOptionalAxis.labels.colorAdaption = t.isAdaption, t.isAdaption && (l.yOptionalAxis.labels.color = a.axis.yOptionalAxis.labels.color); break; case "legend": s.itemStyle.colorAdaption = t.isAdaption, t.isAdaption && (s.itemStyle.color = a.legend.itemStyle.color) } } function y(t) { return { x_gridPlot: function () { e.chartStyleExtendSetting.configGridPlotLine("xAxis") }, y_gridPlot: function () { e.chartStyleExtendSetting.configGridPlotLine("yAxis") }, axis: function () { e.chartStyleExtendSetting.configAxisLine() }, legend: function () { e.chartStyleExtendSetting.configLegend() } }[t] } e.popupTips = { noLegend: f.instant("dash.advDash.noLegend"), topLegend: f.instant("dash.advDash.topLegend"), rightLegend: f.instant("dash.advDash.rightLegend"), bottomLegend: f.instant("dash.advDash.bottomLegend") }, e.$on("editChartMeta", function (n, a) { if (a.is_cancel) return void (e.chartStyleExtendSetting.visible = !1); if (a.need_reload && a.child && a.child.meta) { var i = a.child.meta.ct_id, r = a.child.meta.tb_id, o = angular.element("#" + i).find(".item-chart").find(".chart").data("chart-data"); o && o.info && (e.chartInfo = o.info, t(function () { e.chartStyleExtendSetting.initSettingData(), e.chartStyleExtendSetting.visible = e.chartStyleExtendSetting.canSetGridLine() || e.chartStyleExtendSetting.canSetLegend() || e.chartStyleExtendSetting.canSetAxis(), e.chartStyleExtendSetting.mode = "data_screen_edit", e.chartStyleExtendSetting.ct_id = i, e.chartStyleExtendSetting.tb_id = r }, 10)) } }), e.$watch("data.ct_id", function (t) { e.chartStyleExtendSetting.show = void 0 !== t && "" !== t && g() }), "en" == n.language && (d[0].name = "Default", c[0].name = "Default"), e.toggleNextBlock = u, e.chartStyleExtendSetting = { chartLineDashStyle: s, chartLineWidth: l, chartFontSize: c, chartFontFamily: d, visible: !1, show: !1, thrick: !1, mode: "", ct_id: "", tb_id: "", themeColor: { dark: { color: "rgba(255, 255, 255, 0.5)", stroke: "rgba(255, 255, 255, 0.1)" }, light: { color: "#666666", stroke: "#cccccc" }, curThemeColor: {} }, chartStyle: {}, originalData: null, defaultStyle: null, canSetGridLine: function () { return !!e.chartInfo && bdpChart.configurable.canEditGridPlotLine(e.chartInfo.chart_type, { info: e.chartInfo }) }, canSetLegend: function () { return !!e.chartInfo && bdpChart.configurable.canEditChartLegend(e.chartInfo.chart_type, { info: e.chartInfo }) }, canSetAxis: function (t) { if (!e.chartInfo) return !1; var n = e.chartInfo.chart_type; return "yOptional" == t ? "C250" == n : ["C210", "C211", "C212", "C220", "C240", "C241", "C242", "C250", "C280", "C290", "C320", "C350", "C351", "C352"].indexOf(n) >= 0 }, initSettingData: function () { var t = this.themeColor; t.curThemeColor = 2 == n.usedThemeId ? t.light : t.dark; var a = r.getDefaultStyle(); this.defaultStyle = angular.copy(a), this.originalData = angular.copy(e.chartInfo.style), e.chartInfo.style ? (e.chartStyle = $.extend(!0, this.defaultStyle, e.chartInfo.style), m(this.defaultStyle, e.chartStyle, this.originalData)) : e.chartStyle = angular.copy(this.defaultStyle), bdpChart.helper.transferAxisOldStyle(e.chartStyle.axis) }, changeSplitNum: function (t, n) { 13 == (t || window.event).keyCode && e.chartStyleExtendSetting.compareGridPlotLineChanged(n) && e.chartStyleExtendSetting.configGridPlotLine(n) }, cancelDocumentEvent: function () { $(document).off("keydown.change_item_pos"), $(document).off("keydown.save_item_pos") }, compareGridPlotLineChanged: function (t) { var n = e.chartStyle.gridPlotLine[t]; if (!e.chartStyleExtendSetting.originalData || !e.chartStyleExtendSetting.originalData.gridPlotLine) return i = !0; var a = e.chartStyleExtendSetting.originalData.gridPlotLine[t], i = !1; if (!a) return i = !0; for (var r in n) n[r] != a[r] && (i = !0); return i }, configGridPlotLine: function (n) { if (!n || !e.chartStyleExtendSetting.compareGridPlotLineChanged(n)) return !1; var i = e.chartStyle.gridPlotLine, r = /^(0|[1-9]|10)$/; if (!r.test(i.xAxis.splitNum) || !r.test(i.yAxis.splitNum)) return a(e.tips["dash.advDash.inputPositiveNumberBetween0and10"]), void t(function () { i.xAxis.splitNum = r.test(i.xAxis.splitNum) ? i.xAxis.splitNum : 10, i.yAxis.splitNum = r.test(i.yAxis.splitNum) ? i.yAxis.splitNum : 10 }, 500); this.modifySetting() }, configLegend: function (t) { var n = e.chartStyle.legend, a = n.itemStyle.fontSize; "inherit" == a ? delete n.itemStyle.lineHeight : parseInt(a) < 18 ? n.itemStyle.lineHeight = "18px" : n.itemStyle.lineHeight = parseInt(a) + 2 + "px"; var i = angular.copy(n); if (t && t.pos) { n.pos = t.pos, n.enabled = "null" != t.pos; var r = o[t.pos]; n.enabled && (n.layout = r.layout, n.align = r.align, n.verticalAlign = r.verticalAlign), i = angular.copy(n); var s = e.chartInfo.style; s && s.legend && s.legend.itemStyle && s.legend.itemStyle.color || (i.itemStyle = { fontFamily: "inherit", fontSize: "inherit" }) } this.modifySetting({ legend: i }) }, configAxisLine: function (e) { this.modifySetting() }, changeColor: function (e) { }, modifyColor: function (t, n, a) { e.chartStyle.axis.yAxis.labels.colorAdaption; v(n, a); a.indexOf("axis") >= 0 ? y("axis")("axis") : y(a)(a) }, modifySetting: function (t) { if (t && t.legend ? (e.chartInfo.style = angular.copy(e.chartStyle), e.chartInfo.style.legend = t.legend) : e.chartInfo.style = e.chartStyle, "data_screen_edit" == this.mode) { angular.element("#" + this.ct_id).find(".item-chart").find(".chart").data("chart-data").renderChart(), e.saveFunc({ chart: { ct_id: this.ct_id, style: e.chartInfo.style, drill_level: e.chartInfo.drill_level || 0 } }), e.chartStyleExtendSetting.originalData = angular.copy(e.chartInfo.style) } else e.saveFunc({ only_redraw: !0 }) } }, i(["dash.advDash.inputPositiveNumberBetween0and10"], e) } } }]) }() }, function (e, t, n) {
  "use strict"; function a(e, t) {
    return {
      restrict: "EA", templateUrl: n(332), replace: !0, link: function (e, t, n) {
        function a(t) { t = _.cloneDeep(t), e.materialInfo = { show: !1, cols: t.cols, list: t.materials, theme: t.theme, name: function () { return t.materials ? t.style.material ? t.style.material.name : t.materials[0].name : "无素材" }() } } function i(t) { var n = { card: t }; e.saveChart(n) } function s(t) { var n = t.card, i = t.defaultStyles; e.style = _.cloneDeep(n), e.skinList = (0, o.getSkinList)(r.default, i); var s = _.find(e.skinList, function (e) { return e.no == n.skinNo }); e.skin = s, s && a(s), n.material && (e.materialInfo.name = n.material.name) } e.style = null, e.skinList = null, e.materialInfo = { list: [], show: !1, name: "无素材", cols: 0 }, e.clickMaterialList = function (e) { e.stopPropagation() }, e.clickMaterialItem = function (t, n) { t.stopPropagation(), e.materialInfo.name = n.name, e.style.material = n, e.saveStyle() }, e.fontStyleOptions = {
          chartFontFamily: [{ name: "微软雅黑", value: "Microsoft YaHei" }, { name: "宋体", value: "SimSun" }, { name: "黑体", value: "Heiti" }, { name: "华文细黑", value: "STXihei" }, { name: "Verdana", value: "Verdana" }, { name: "Arial", value: "Arial" }, {
            name: "Times New Roman", value: "Times New Roman"
          }, { name: "Times", value: "Times" }, { name: "MS Sans Serif", value: "MS Sans Serif" }, { name: "Microsoft Yahei", value: "Microsoft Yahei" }], chartFontSize: [{ name: "80%", value: .8 }, { name: "90%", value: .9 }, { name: "100%", value: 1 }, { name: "110%", value: 1.1 }, { name: "120%", value: 1.2 }, { name: "130%", value: 1.3 }, { name: "140%", value: 1.4 }, { name: "150%", value: 1.5 }], showAlpha: !0
        }, e.valueFontStyleOptions = { chartFontFamily: [{ name: "默认", value: "inherit" }, { name: "微软雅黑", value: "Microsoft YaHei" }, { name: "宋体", value: "SimSun" }, { name: "黑体", value: "Heiti" }, { name: "华文细黑", value: "STXihei" }, { name: "Verdana", value: "Verdana" }, { name: "Avenir", value: "Avenir" }, { name: "Arial", value: "Arial" }, { name: "Times New Roman", value: "Times New Roman" }, { name: "Times", value: "Times" }, { name: "MS Sans Serif", value: "MS Sans Serif" }, { name: "Microsoft Yahei", value: "Microsoft Yahei" }], chartFontSize: [{ name: "50%", value: .5 }, { name: "60%", value: .6 }, { name: "70%", value: .7 }, { name: "80%", value: .8 }, { name: "90%", value: .9 }, { name: "100%", value: 1 }, { name: "110%", value: 1.1 }, { name: "120%", value: 1.2 }, { name: "130%", value: 1.3 }, { name: "140%", value: 1.4 }, { name: "150%", value: 1.5 }], showAlpha: !0 }, e.changeSkin = function () { var t = e.skin; a(t), e.style = _.cloneDeep(t.style), e.style.skinNo = t.no, t.materials && t.materials.length > 0 && (e.style.material = t.materials[0]), t.isDefault ? i() : i(e.style) }, e.saveStyle = function () { i(e.style) }, e.$watch("data", function (t) { e.init(s, "card") })
      }
    }
  } var i = n(331), r = function (e) { return e && e.__esModule ? e : { default: e } }(i), o = n(27); angular.module("BC.dashboard.core").directive("cardStyle", a), a.$inject = ["$rootScope", "$timeout"]
}, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(40), i = function (e) { return e && e.__esModule ? e : { default: e } }(a), r = { light: [], dark: [{ no: 0, isDefault: !1, name: i.default.instant("69022c77"), style: { title: { bold: !0 } } }, { no: 1, iconClass: "ico-card-style1", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-card-skin-1-s", nameClass: "mt8", options: { type: "rotateCircle", animation: !0, mainImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-1-main_5ab0904.svg", outlineImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-1-outline_8efef0a.svg" } }, { name: "素材二", iconClass: "ico-card-skin-2-s", nameClass: "mt8", options: { type: "rotateCircle", animation: !0, mainImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-2-main_dee9258.svg", outlineImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-2-outline_46e9c19.svg" } }, { name: "素材三", iconClass: "ico-card-skin-3-s", nameClass: "mt8", options: { type: "rotateCircle", animation: !0, mainImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-3-main_f6fa60c.svg", outlineImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-3-outline_54dae09.svg" } }, { name: "素材四", iconClass: "ico-card-skin-4-s", nameClass: "mt8", options: { type: "rotateCircle", animation: !0, mainImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-4-main_161956d.svg", outlineImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-4-outline_6f6781d.svg" } }], style: { title: { bold: !0 } } }, { no: 2, iconClass: "ico-card-style2", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-card-skin2-1-s", options: { type: "twoBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin2-1_18280d4.svg" } }, { name: "素材二", iconClass: "ico-card-skin2-2-s", options: { type: "twoBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin2-2_01cfb48.svg" } }], style: { title: { color: "rgba(127,170,255,0.8)", bold: !0 }, value: { color: "#51A4E4" } } }, { no: 3, iconClass: "ico-card-style3", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-card-skin3-1-s", options: { type: "leftLongBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin3-1_c57676a.svg" } }, { name: "素材二", iconClass: "ico-card-skin3-2-s", options: { type: "leftLongBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin3-2_d8d361b.svg" } }], style: { title: { bold: !0 }, value: { color: "#3BA2FF" } } }, { no: 4, iconClass: "ico-card-style4", isDefault: !1, showSpacing: !0, cols: 1, materials: [{ name: "素材一", iconClass: "ico-card-skin4-1-s", options: { type: "longBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin4-1_2d9a3b7.svg" } }, { name: "素材二", iconClass: "ico-card-skin4-2-s", options: { type: "longBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin4-2_964fcbd.svg" } }, { name: "素材三", iconClass: "ico-card-skin4-3-s", options: { type: "longBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin4-3_a436574.svg" } }, { name: "素材四", iconClass: "ico-card-skin4-4-s", options: { type: "longBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin4-4_e89929c.svg" } }], style: { spacing: .1, title: { color: "#7ED2FA", bold: !0 } } }, { no: 5, iconClass: "ico-card-style5", isDefault: !1, cols: 1, materials: [{ name: "素材一", iconClass: "ico-card-skin5-1-s", options: { type: "rightBlock", image: "//m1.bdp.cn/static/theme/dark/svg/card-skin5-1_13878f3.svg" } }], style: { spacing: 0, title: { bold: !0 }, value: { color: "#EC9268" } } }, { no: 6, iconClass: "ico-card-style6", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-card-skin-6-s", nameClass: "mt8", options: { type: "circle", animation: !1, mainImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-6-main_ac1ea86.svg", outlineImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-6-outline_9b51f56.svg" } }, { name: "素材二", iconClass: "ico-card-skin-5-s", nameClass: "mt8", options: { type: "circle", animation: !0, mainImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-5-main_27c9c0a.svg", outlineImage: "//m1.bdp.cn/static/theme/dark/svg/card-skin-5-outline_9101212.svg" } }], style: { title: { color: "#F56E40", bold: !0 }, updown: { color: "#37B8E9" } } }] }; t.default = r }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/cardStyle/cardStyle.html" }, function (e, t, n) { "use strict"; function a(e, t, a) { return { restrict: "EA", templateUrl: n(335), replace: !0, link: function (e, t, n) { function a(t) { var n = { map: t }; e.saveChart(n) } function i(t) { var n = t.map, a = t.defaultStyles; if (n) { e.style = _.cloneDeep(n); var i = (0, o.getSkinList)(r.default, a); e.skinList = i, console.log(i) } } e.style = null, e.skinList = null, e.lineWidthList = [{ name: "0px", value: 0 }, { name: "0.5px", value: .5 }, { name: "0.75px", value: .75 }, { name: "1px", value: 1 }, { name: "1.5px", value: 1.5 }, { name: "2px", value: 2 }], e.shadowXYList = [{ name: "0px", value: 0 }, { name: "1px", value: 1 }, { name: "2px", value: 2 }, { name: "3px", value: 3 }, { name: "4px", value: 4 }, { name: "5px", value: 5 }], e.changeSkin = function () { var t = e.skin; e.style = _.cloneDeep(t.style), t.isDefault ? a() : a(e.style) }, e.saveStyle = function () { a(e.style) }, e.$watch("data", function (t) { e.init(i, "map") }) } } } var i = n(334), r = function (e) { return e && e.__esModule ? e : { default: e } }(i), o = n(27); angular.module("BC.dashboard.core").directive("mapStyle", a), a.$inject = ["$rootScope", "$timeout", "chartEditService"] }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = { light: [], dark: [{ iconClass: "ico-map-skin-0", isDefault: !1 }, { iconClass: "ico-map-skin-1", isDefault: !1, style: { background: "rgba(79, 126, 255, 0.3)", border: { color: "#62BDFF", width: 2 }, splitLine: { color: "#4E83D0", width: 1 }, shadow: { color: "rgba(49, 97, 221, 0.5)", x: 4, y: 4, spread: 0, blur: 0 } } }, { iconClass: "ico-map-skin-2", isDefault: !1, style: { background: "#06176A", border: { width: 2, color: "#4DBFFF" }, splitLine: { width: 1, color: "#4E83D0" }, shadow: { x: 4, y: 4, blur: 5, spread: 0, color: "rgba(40, 108, 255, 0.5)" } } }, { iconClass: "ico-map-skin-3", isDefault: !1, style: { background: "rgba(0, 0, 0, 0.1)", border: { width: 2, color: "#10D4D5" }, splitLine: { width: 1, color: "#10D4D5" }, shadow: { x: 4, y: 4, blur: 2, spread: 0, color: "rgba(30, 247, 233, 0.4)" } } }] }; t.default = a }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/mapStyle/mapStyle.html" }, function (e, t, n) { "use strict"; function a(e) { return e && e.__esModule ? e : { default: e } } function i(e, t, a) { return { restrict: "EA", templateUrl: n(338), replace: !0, link: function (e, t, n) { function a(t) { return function () { e.style[t.fontBold] = e[t.fontAdvConfig].bold ? "bold" : "normal", e.style[t.fontItalic] = e[t.fontAdvConfig].italic ? "italic" : "normal", e.saveStyle() } } function i(t) { var n; n = t.horizontalLineShow ? { class: "active", iconClass: "ico-grid-hor-active" } : { class: "", iconClass: "ico-grid-hor" }, e.gridlineHorConfig = n } function r(t) { var n; n = t.verticalLineShow ? { class: "active", iconClass: "ico-grid-ver-active" } : { class: "", iconClass: "ico-grid-ver" }, e.gridlineVerConfig = n } function s(t) { var n, a; t.horizontalLineShow && (n = t.horizontalLineColor, a = S[t.horizontalLineStyle]), t.verticalLineShow && (n = t.verticalLineColor, a = S[t.verticalLineStyle]), void 0 === a && (a = S[1]); var i = { color: n, lineStyle: a, lineOptions: { lineStyleShowList: (0, o.default)(k) } }; e.gridlineConfig = i } function d(t) { t.setLineHeight ? e.lineHeight = t.headerRowHeight + "px" : e.lineHeight = "default" } function u(e) { void 0 === e.setInterlacing ? e.setInterlacing = !0 : e.setInterlacing || (e.originBackgroundEvenColor || (e.originBackgroundEvenColor = e.backgroundEvenColor), e.originEvenFontColor || (e.originEvenFontColor = e.evenFontColor), e.backgroundEvenColor = e.backgroundOddColor, e.evenFontColor = e.oddFontColor) } function f(t) { return function (n) { var a = !1, i = !1; "bold" === n[t.fontBold] && (a = !0), "italic" === n[t.fontItalic] && (i = !0), e[t.fontAdvConfig] = { bold: a, italic: i } } } function p(e) { i(e), r(e), s(e), d(e), u(e), x(e), D(e), T(e), E(e) } function h(t) { var n = { table: t }; e.saveChart(n) } function g(t) { var n = t.table, a = t.defaultStyles; if (n) { e.style = _.cloneDeep(n); var i = (0, c.getSkinList)(l.default, a); e.skinList = i, p(e.style) } } e.style = null, e.skinList = null, e.gridlineHorConfig = null, e.gridlineVerConfig = null, e.gridlineConfig = null, e.fontAdvConfig = null, e.headerFontAdvConfig = null, e.colSummaryFontAdvConfig = null, e.lineHeightList = [{ name: "自适应", value: "default" }, { name: "28px", value: "28px" }, { name: "32px", value: "32px" }, { name: "40px", value: "40px" }, { name: "48px", value: "48px" }, { name: "56px", value: "56px" }], e.lineHeight = void 0; var m = [{ name: "10px", value: "10px" }, { name: "11px", value: "11px" }, { name: "12px", value: "12px" }, { name: "13px", value: "13px" }, { name: "14px", value: "14px" }, { name: "15px", value: "15px" }, { name: "16px", value: "16px" }, { name: "18px", value: "18px" }, { name: "20px", value: "20px" }, { name: "24px", value: "24px" }, { name: "32px", value: "32px" }, { name: "36px", value: "36px" }], v = [{ name: "微软雅黑", value: "Microsoft YaHei" }, { name: "宋体", value: "SimSun" }, { name: "黑体", value: "Heiti" }, { name: "华文细黑", value: "STXihei" }, { name: "Verdana", value: "Verdana" }, { name: "Arial", value: "Arial" }, { name: "Times New Roman", value: "Times New Roman" }, { name: "Times", value: "Times" }, { name: "MS Sans Serif", value: "MS Sans Serif" }, { name: "Microsoft Yahei", value: "Microsoft Yahei" }], y = { fontBold: "fontBold", fontItalic: "fontItalic", fontAdvConfig: "fontAdvConfig" }, b = { fontBold: "headerFontBold", fontItalic: "headerFontItalic", fontAdvConfig: "headerFontAdvConfig" }, w = { fontBold: "mergeFontBold", fontItalic: "mergeFontItalic", fontAdvConfig: "mergeFontAdvConfig" }, C = { fontBold: "colSummaryFontBold", fontItalic: "colSummaryFontItalic", fontAdvConfig: "colSummaryFontAdvConfig" }; e.fontOptions = { formatter: { fontSize: "fontSize", fontFamily: "fontFamily", color: "oddFontColor" }, chartFontSize: m, chartFontFamily: v }, e.headerFontOptions = { formatter: { fontSize: "headerFontSize", fontFamily: "headerFontFamily", color: "headerFontColor" }, chartFontSize: m, chartFontFamily: v }, e.mergeFontOptions = { formatter: { fontSize: "mergeFontSize", fontFamily: "mergeFontFamily", color: "mergeFontColor" }, chartFontSize: m, chartFontFamily: v }, e.colSummaryFontOptions = { formatter: { fontSize: "colSummaryFontSize", fontFamily: "colSummaryFontFamily", color: "colSummaryFontColor" }, chartFontSize: m, chartFontFamily: v }; var S = { 1: "Solid", 3: "ShortDash", 4: "ShortDot", 9: "ShortDashDot", 11: "ShortDashDotDot" }, k = function () { var e = {}; for (var t in S) e[S[t]] = +t; return e }(); e.changeGridlineHorConfig = function () { e.style.horizontalLineShow = !e.style.horizontalLineShow, e.style.horizontalLineColor = e.gridlineConfig.color, e.style.horizontalLineStyle = k[e.gridlineConfig.lineStyle], i(e.style), e.saveStyle() }, e.changeGridlineVerConfig = function () { e.style.verticalLineShow = !e.style.verticalLineShow, e.style.verticalLineColor = e.gridlineConfig.color, e.style.verticalLineStyle = k[e.gridlineConfig.lineStyle], r(e.style), e.saveStyle() }, e.changeGridlineConfig = function () { e.style.horizontalLineColor = e.gridlineConfig.color, e.style.verticalLineColor = e.gridlineConfig.color, e.style.horizontalLineStyle = k[e.gridlineConfig.lineStyle], e.style.verticalLineStyle = k[e.gridlineConfig.lineStyle], e.saveStyle() }, e.changeBackgroundColor = function () { e.style.bgColor = e.style.backgroundOddColor, e.style.setInterlacing || (e.style.backgroundEvenColor = e.style.backgroundOddColor), e.saveStyle() }, e.changeFont = function () { e.style.setInterlacing || (e.style.evenFontColor = e.style.oddFontColor), "inherit" == e.style.fontSize && (e.style.fontSize = "12px"), "inherit" === e.style.fontFamily && (e.style.fontFamily = "Arial"), e.changeLineHeight() }, e.changeFontAdv = a(y), e.changeHeaderFontAdv = a(b), e.changeMergeFontAdv = a(w), e.changeColSummaryFontAdv = a(C), e.changeLineHeight = function () { var t = void 0, n = void 0; "default" == e.lineHeight ? (t = n = parseFloat(e.style.fontSize) + 20, e.style.setLineHeight = !1) : (t = n = parseFloat(e.lineHeight), e.style.setLineHeight = !0), e.style.headerRowHeight = t, e.style.rowHeight = n, e.saveStyle() }, e.changeHeaderFont = function () { "inherit" == e.style.headerFontSize && (e.style.headerFontSize = "12px"), "inherit" === e.style.headerFontFamily && (e.style.headerFontFamily = "Arial"), e.saveStyle() }, e.changeInterlacing = function () { var t = e.style; t.setInterlacing ? (t.originBackgroundEvenColor && (t.backgroundEvenColor = t.originBackgroundEvenColor), t.originEvenFontColor && (t.evenFontColor = t.originEvenFontColor)) : (t.originBackgroundEvenColor = t.backgroundEvenColor, t.originEvenFontColor = t.evenFontColor, t.backgroundEvenColor = t.backgroundOddColor, t.evenFontColor = t.oddFontColor), e.saveStyle() }, e.changeSkin = function () { var t = e.skin; e.style = _.cloneDeep(t.style), p(e.style), h(t.isDefault ? void 0 : e.style) }, e.saveStyle = function () { h(e.style) }; var x = f(y), D = f(b), T = f(w), E = f(C); e.$watch("data", function (t) { e.init(g, "table") }) } } } var r = n(43), o = a(r), s = n(337), l = a(s), c = n(27); angular.module("BC.dashboard.core").directive("tableStyle", i), i.$inject = ["$rootScope", "$timeout", "chartEditService"] }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(40), i = (function (e) { e && e.__esModule ? e : { default: e } }(a), { light: [], dark: [{ iconClass: "ico-table-skin-0", isDefault: !1 }, { iconClass: "ico-table-skin-1", isDefault: !1, style: { headerBgColor: "rgba(20, 65, 109, 0.8)", headerFontColor: "#FFF", headerFontAlignment: "left", borderLineShow: !0, borderLineColor: "#20345B", backgroundOddColor: "transparent", backgroundEvenColor: "rgba(20, 65, 109, 0.4)", fontAlignment: "left", oddFontColor: "#37B8E9", evenFontColor: "#37B8E9", horizontalLineShow: !1, verticalLineColor: "#20345B", mergeBgColor: "transparent", mergeFontColor: "#37B8E9", colSummaryColor: "transparent", colSummaryFontColor: "#96E2FF" } }, { iconClass: "ico-table-skin-2", isDefault: !1, style: { headerFontItalic: "bold", headerBgColor: "transparent", headerFontColor: "#189696", headerFontAlignment: "left", borderLineShow: !0, borderLineColor: "#3B3E50", backgroundOddColor: "transparent", backgroundEvenColor: "transparent", fontAlignment: "left", oddFontColor: "#FFF", evenFontColor: "#2EE8E8", horizontalLineColor: "#3B3E50", verticalLineColor: "#3B3E50", mergeBgColor: "transparent", mergeFontColor: "#2EE8E8", colSummaryColor: "rgba(28, 225, 225, 0.06)", colSummaryFontColor: "#2EE8E8" } }, { iconClass: "ico-table-skin-3", isDefault: !1, style: { headerBgColor: "transparent", headerFontColor: "#FFFFFF", headerFontAlignment: "left", borderLineShow: !1, backgroundOddColor: "transparent", backgroundEvenColor: "transparent", fontAlignment: "left", oddFontColor: "#7ED2FA", evenFontColor: "#7ED2FA", horizontalLineColor: "#175E65", verticalLineShow: !1, mergeBgColor: "transparent", mergeFontColor: "#7ED2FA", colSummaryColor: "transparent", colSummaryFontColor: "#25CADA" } }] }); t.default = i }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/tableStyle/tableStyle.html" }, function (e, t, n) { "use strict"; function a(e, t) { return { restrict: "EA", templateUrl: n(341), replace: !0, link: function (e, t, n) { function a(t) { t = _.cloneDeep(t), e.materialInfo = { show: !1, list: t.materials, theme: t.theme, name: function () { return t.materials ? l(t.skinClass) : "无素材" }() }, e.skinName = e.materialInfo.name } function i(t, n) { var a = { column: t, current_theme_style: n, selector: "rect", props: "fill", name: e.skinName, no: e.no }; e.saveChart(a) } function s(t) { var n = e.getChart(), i = n.data.y, s = t.column; e.no = s.skinNo; var l = t.defaultStyles; e.style = _.cloneDeep(s), e.skinList = (0, o.getSkinList)(r.default, l), i && i.length > 1 ? (e.isMultiple = !0, e.skinList[1].skinClass = "chart-theme-column-01-material-06", e.skinList[2].skinClass = "chart-theme-column-02-material-01") : (e.isMultiple = !1, e.skinList[1].skinClass = "chart-theme-column-01-material-01", e.skinList[2].skinClass = "chart-theme-column-02-material-07"); var c = _.find(e.skinList, function (e) { return e.no == s.skinNo }); e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), e.skin = c, c && a(c), n.info.styles && n.info.styles.name && (e.skinName = n.info.styles.name) } function l(e) { var t = function (e) { return function (t) { return function (n) { return e.hasOwnProperty(n) ? e[n] : t } } }({ "chart-theme-column-01-material-01": "素材一", "chart-theme-column-01-material-06": "彩虹色", "chart-theme-column-02-material-01": "素材一", "chart-theme-column-02-material-07": "单色素材一" })("Unknown"); return function () { return t(e) }() } e.isMultiple = !1, e.style = null, e.skinList = null, e.materialInfo = { list: [], show: !1, name: "无素材", cols: 0 }, e.skinName = "", e.no = 0, e.clickMaterialList = function (e) { e.stopPropagation() }, e.clickMaterialItem = function (t, n) { var a = e.getChart(), r = a.cssParser.toJSON()["." + n.skinClass]; e.skinName = n.name, t.stopPropagation(), i(r, n.skinClass) }, e.changeSkin = function (t) { var n = e.getChart(), r = n.cssParser.toJSON()["." + e.skin.skinClass], o = e.skin; a(o), e.no = o.no, e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), o.isDefault ? i() : i(r, e.skin.skinClass) }, e.$watch("data", function (t) { e.init(s, "column") }) } } } var i = n(340), r = function (e) { return e && e.__esModule ? e : { default: e } }(i), o = n(27); angular.module("BC.dashboard.core").directive("columnStyle", a), a.$inject = ["$rootScope", "$timeout"] }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(40), i = function (e) { return e && e.__esModule ? e : { default: e } }(a), r = { light: [], dark: [{ no: 0, skinClass: "chart-theme-column-default", isDefault: !1, name: i.default.instant("69022c77") }, { no: 1, iconClass: "ico-column-skin1-default", skinClass: "chart-theme-column-01-material-01", isDefault: !1, materials: [{ name: "素材一", skinClass: "chart-theme-column-01-material-01", iconClass: "ico-column-skin1-01", isMultiple: !1 }, { name: "素材二", skinClass: "chart-theme-column-01-material-02", iconClass: "ico-column-skin1-02", isMultiple: !1 }, { name: "素材三", skinClass: "chart-theme-column-01-material-03", iconClass: "ico-column-skin1-03", isMultiple: !1 }, { name: "素材四", skinClass: "chart-theme-column-01-material-04", iconClass: "ico-column-skin1-04", isMultiple: !1 }, { name: "素材五", skinClass: "chart-theme-column-01-material-05", iconClass: "ico-column-skin1-05", isMultiple: !1 }, { name: "彩虹色", skinClass: "chart-theme-column-01-material-06", iconClass: "ico-column-skin1-06", isMultiple: !0 }, { name: "暖色系", skinClass: "chart-theme-column-01-material-07", iconClass: "ico-column-skin1-07", isMultiple: !0 }, { name: "冷色系", skinClass: "chart-theme-column-01-material-08", iconClass: "ico-column-skin1-08", isMultiple: !0 }] }, { no: 2, skinClass: "chart-theme-column-02-material-01", iconClass: "ico-column-skin2-default", isDefault: !1, materials: [{ name: "素材一", skinClass: "chart-theme-column-02-material-01", iconClass: "ico-column-skin2-01", isMultiple: !0 }, { name: "素材二", skinClass: "chart-theme-column-02-material-02", iconClass: "ico-column-skin2-02", isMultiple: !0 }, { name: "素材三", skinClass: "chart-theme-column-02-material-03", iconClass: "ico-column-skin2-03", isMultiple: !0 }, { name: "素材四", skinClass: "chart-theme-column-02-material-04", iconClass: "ico-column-skin2-04", isMultiple: !0 }, { name: "素材五", skinClass: "chart-theme-column-02-material-05", iconClass: "ico-column-skin2-05", isMultiple: !0 }, { name: "素材六", skinClass: "chart-theme-column-02-material-06", iconClass: "ico-column-skin2-06", isMultiple: !0 }, { name: "单色素材一", skinClass: "chart-theme-column-02-material-07", iconClass: "ico-column-skin2-07", isMultiple: !1 }, { name: "单色素材二", skinClass: "chart-theme-column-02-material-08", iconClass: "ico-column-skin2-08", isMultiple: !1 }, { name: "单色素材三", skinClass: "chart-theme-column-02-material-09", iconClass: "ico-column-skin2-09", isMultiple: !1 }, { name: "单色素材四", skinClass: "chart-theme-column-02-material-10", iconClass: "ico-column-skin2-10", isMultiple: !1 }] }] }; t.default = r }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/columnStyle/columnStyle.html" }, function (e, t, n) { "use strict"; function a(e, t) { return { restrict: "EA", templateUrl: n(344), replace: !0, link: function (e, t, n) { function a(t) { t = _.cloneDeep(t), e.materialInfo = { show: !1, list: t.materials, theme: t.theme, name: function () { return t.materials ? l(t.skinClass) : "无素材" }() }, e.skinName = e.materialInfo.name } function i(t, n) { var a = { column: t, current_theme_style: n, selector: "rect", props: "fill", name: e.skinName, no: e.no }; e.saveChart(a) } function s(t) { var n = e.getChart(), i = n.data.y, s = t.column; e.no = s.skinNo; var l = t.defaultStyles; e.style = _.cloneDeep(s), e.skinList = (0, o.getSkinList)(r.default, l), i && i.length > 1 ? (e.isMultiple = !0, e.skinList[1].skinClass = "chart-theme-column-01-material-06", e.skinList[2].skinClass = "chart-theme-column-02-material-01") : (e.isMultiple = !1, e.skinList[1].skinClass = "chart-theme-column-01-material-01", e.skinList[2].skinClass = "chart-theme-column-02-material-07"); var c = _.find(e.skinList, function (e) { return e.no == s.skinNo }); e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), e.skin = c, c && a(c), n.info.styles && n.info.styles.name && (e.skinName = n.info.styles.name) } function l(e) { var t = function (e) { return function (t) { return function (n) { return e.hasOwnProperty(n) ? e[n] : t } } }({ "chart-theme-column-01-material-01": "素材一", "chart-theme-column-01-material-06": "彩虹色", "chart-theme-column-02-material-01": "素材一", "chart-theme-column-02-material-07": "单色素材一" })("Unknown"); return function () { return t(e) }() } e.isMultiple = !1, e.style = null, e.skinList = null, e.materialInfo = { list: [], show: !1, name: "无素材", cols: 0 }, e.clickMaterialList = function (e) { e.stopPropagation() }, e.clickMaterialItem = function (t, n) { var a = e.getChart(), r = a.cssParser.toJSON()["." + n.skinClass]; e.skinName = n.name, t.stopPropagation(), i(r, n.skinClass) }, e.changeSkin = function (t) { var n = e.getChart(), r = n.cssParser.toJSON()["." + e.skin.skinClass], o = e.skin; a(o), e.no = o.no, e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), o.isDefault ? i() : i(r, e.skin.skinClass) }, e.$watch("data", function (t) { e.init(s, "column") }) } } } var i = n(343), r = function (e) { return e && e.__esModule ? e : { default: e } }(i), o = n(27); angular.module("BC.dashboard.core").directive("barStyle", a), a.$inject = ["$rootScope", "$timeout"] }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(40), i = function (e) { return e && e.__esModule ? e : { default: e } }(a), r = { light: [], dark: [{ no: 0, skinClass: "chart-theme-bar-default", isDefault: !1, name: i.default.instant("69022c77") }, { no: 1, iconClass: "ico-bar-skin1-default", skinClass: "chart-theme-bar-01-material-01", isDefault: !1, materials: [{ name: "素材一", skinClass: "chart-theme-bar-01-material-01", iconClass: "ico-bar-skin1-01", isMultiple: !1 }, { name: "素材二", skinClass: "chart-theme-bar-01-material-02", iconClass: "ico-bar-skin1-02", isMultiple: !1 }, { name: "素材三", skinClass: "chart-theme-bar-01-material-03", iconClass: "ico-bar-skin1-03", isMultiple: !1 }, { name: "素材四", skinClass: "chart-theme-bar-01-material-04", iconClass: "ico-bar-skin1-04", isMultiple: !1 }, { name: "素材五", skinClass: "chart-theme-bar-01-material-05", iconClass: "ico-bar-skin1-05", isMultiple: !1 }, { name: "彩虹色", skinClass: "chart-theme-bar-01-material-06", iconClass: "ico-bar-skin1-06", isMultiple: !0 }, { name: "暖色系", skinClass: "chart-theme-bar-01-material-07", iconClass: "ico-bar-skin1-07", isMultiple: !0 }, { name: "冷色系", skinClass: "chart-theme-bar-01-material-08", iconClass: "ico-bar-skin1-08", isMultiple: !0 }] }, { no: 2, skinClass: "chart-theme-bar-02-material-01", iconClass: "ico-bar-skin2-default", isDefault: !1, materials: [{ name: "素材一", skinClass: "chart-theme-bar-02-material-01", iconClass: "ico-bar-skin2-01", isMultiple: !0 }, { name: "素材二", skinClass: "chart-theme-bar-02-material-02", iconClass: "ico-bar-skin2-02", isMultiple: !0 }, { name: "素材三", skinClass: "chart-theme-bar-02-material-03", iconClass: "ico-bar-skin2-03", isMultiple: !0 }, { name: "素材四", skinClass: "chart-theme-bar-02-material-04", iconClass: "ico-bar-skin2-04", isMultiple: !0 }, { name: "素材五", skinClass: "chart-theme-bar-02-material-05", iconClass: "ico-bar-skin2-05", isMultiple: !0 }, { name: "素材六", skinClass: "chart-theme-bar-02-material-06", iconClass: "ico-bar-skin2-06", isMultiple: !0 }, { name: "单色素材一", skinClass: "chart-theme-bar-02-material-07", iconClass: "ico-bar-skin2-07", isMultiple: !1 }, { name: "单色素材二", skinClass: "chart-theme-bar-02-material-08", iconClass: "ico-bar-skin2-08", isMultiple: !1 }, { name: "单色素材三", skinClass: "chart-theme-bar-02-material-09", iconClass: "ico-bar-skin2-09", isMultiple: !1 }, { name: "单色素材四", skinClass: "chart-theme-bar-02-material-10", iconClass: "ico-bar-skin2-10", isMultiple: !1 }] }] }; t.default = r }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/barStyle/barStyle.html" }, function (e, t, n) { "use strict"; function a(e, t) { return { restrict: "EA", templateUrl: n(347), replace: !0, link: function (e, t, n) { function a(t) { t = _.cloneDeep(t), e.materialInfo = { show: !1, cols: t.cols, list: t.materials, theme: t.theme, name: function () { return t.materials ? t.style.material ? t.style.material.name : t.materials[0].name : "无素材" }() }, e.skinName = e.materialInfo.name } function i(t, n) { var a = e.default_shape; n.indexOf("pie-01") != -1 ? a = "pie" : n.indexOf("pie-02") != -1 && (a = "donut"); var i = { pie: t, current_theme_style: n, selector: "path", props: "stroke", name: e.skinName, no: e.no }; e.saveChart(i, { shape: a }) } function s(t) { var n = e.getChart(); e.shape = n.info.shape, e.default_shape = n.info.shape; var i = t.pie; e.no = i.skinNo; var s = t.defaultStyles; e.style = _.cloneDeep(i), e.skinList = (0, o.getSkinList)(r.default, s); var l = _.find(e.skinList, function (e) { return e.no == i.skinNo }); e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), e.skin = l, l && a(l), n.info.styles.name && (e.skinName = n.info.styles.name) } e.style = null, e.skinList = null, e.skinName = "", e.no = 0, e.materialInfo = { list: [], show: !1, name: "无素材", cols: 0 }, e.clickMaterialList = function (e) { e.stopPropagation() }, e.clickMaterialItem = function (t, n) { var a = e.getChart(), r = a.cssParser.toJSON()["." + n.skinClass]; e.skinName = n.name, t.stopPropagation(), i(r, n.skinClass) }, e.changeSkin = function (t) { var n = e.getChart(), r = n.cssParser.toJSON()["." + e.skin.skinClass], o = e.skin; a(o), e.no = o.no, e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), o.isDefault ? i() : i(r, e.skin.skinClass) }, e.$watch("data", function (t) { e.init(s, "pie") }) } } } var i = n(346), r = function (e) { return e && e.__esModule ? e : { default: e } }(i), o = n(27); angular.module("BC.dashboard.core").directive("pieStyle", a), a.$inject = ["$rootScope", "$timeout"] }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(40), i = function (e) { return e && e.__esModule ? e : { default: e } }(a), r = { light: [], dark: [{ no: 0, skinClass: "chart-theme-pie-default", isDefault: !1, name: i.default.instant("69022c77") }, { no: 1, iconClass: "ico-pie-skin1-default", skinClass: "chart-theme-pie-01-material-01", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-pie-skin1-01", skinClass: "chart-theme-pie-01-material-01" }, { name: "素材二", iconClass: "ico-pie-skin1-02", skinClass: "chart-theme-pie-01-material-02" }, { name: "素材三", iconClass: "ico-pie-skin1-03", skinClass: "chart-theme-pie-01-material-03" }, { name: "素材四", iconClass: "ico-pie-skin1-04", skinClass: "chart-theme-pie-01-material-04" }, { name: "素材五", iconClass: "ico-pie-skin1-05", skinClass: "chart-theme-pie-01-material-05" }, { name: "素材六", iconClass: "ico-pie-skin1-06", skinClass: "chart-theme-pie-01-material-06" }] }, { no: 2, iconClass: "ico-pie-skin2-default", skinClass: "chart-theme-pie-02-material-01", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-pie-skin2-01", skinClass: "chart-theme-pie-02-material-01" }, { name: "素材二", iconClass: "ico-pie-skin2-02", skinClass: "chart-theme-pie-02-material-02" }, { name: "素材三", iconClass: "ico-pie-skin2-03", skinClass: "chart-theme-pie-02-material-03" }, { name: "素材四", iconClass: "ico-pie-skin2-04", skinClass: "chart-theme-pie-02-material-04" }, { name: "素材五", iconClass: "ico-pie-skin2-05", skinClass: "chart-theme-pie-02-material-05" }, { name: "素材六", iconClass: "ico-pie-skin2-06", skinClass: "chart-theme-pie-02-material-06" }] }] }; t.default = r }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/pieStyle/pieStyle.html" }, function (e, t, n) { "use strict"; function a(e, t) { return { restrict: "EA", templateUrl: n(350), replace: !0, link: function (e, t, n) { function a(t) { t = _.cloneDeep(t), e.materialInfo = { show: !1, cols: t.cols, list: t.materials, theme: t.theme, name: function () { return t.materials ? t.style.material ? t.style.material.name : t.materials[0].name : "无素材" }() }, e.skinName = e.materialInfo.name } function i(t, n) { n.indexOf("line-02") != -1 ? e.use_spline = "0" : n.indexOf("line-01") != -1 ? e.use_spline = "1" : e.use_spline = e.default_use_spline; var a = { line: t, current_theme_style: n, selector: "path", props: "stroke", name: e.skinName, no: e.no }; e.saveChart(a, { use_spline: e.use_spline }) } function s(t) { var n = e.getChart(), i = t.line; e.no = i.skinNo; var s = t.defaultStyles; e.style = _.cloneDeep(i), e.use_spline = n.info.use_spline, e.default_use_spline = n.info.use_spline; var c = l(r.default, n); e.skinList = (0, o.getSkinList)(c, s); var d = _.find(e.skinList, function (e) { return e.no == i.skinNo }); e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), e.skin = d, d && a(d), n.info.styles.name && (e.skinName = n.info.styles.name) } function l(e, t) { t.info.use_spline; return 1 === t.data.y.length ? e.skins2 : e.skins1 } e.style = null, e.skinList = null, e.skinName = "", e.no = 0, e.materialInfo = { list: [], show: !1, name: "无素材", cols: 0 }, e.clickMaterialList = function (e) { e.stopPropagation() }, e.clickMaterialItem = function (t, n) { var a = e.getChart(), r = a.cssParser.toJSON()["." + n.skinClass]; e.skinName = n.name, t.stopPropagation(), i(r, n.skinClass) }, e.changeSkin = function () { var t = e.getChart(), n = t.cssParser.toJSON()["." + e.skin.skinClass], r = e.skin; a(r), e.no = r.no, e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), r.isDefault ? i() : i(n, e.skin.skinClass) }, e.$watch("data", function (t) { e.init(s, "line") }) } } } var i = n(349), r = function (e) { return e && e.__esModule ? e : { default: e } }(i), o = n(27); angular.module("BC.dashboard.core").directive("lineChartStyle", a), a.$inject = ["$rootScope", "$timeout"] }, function (e, t, n) {
  "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(40), i = function (e) { return e && e.__esModule ? e : { default: e } }(a), r = { light: [], dark: [{ no: 0, skinClass: "chart-theme-line-default", isDefault: !1, name: i.default.instant("69022c77") }, { no: 1, iconClass: "ico-line-skin1-default", skinClass: "chart-theme-line-01-material-01", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-line-skin1-01", skinClass: "chart-theme-line-01-material-01" }, { name: "素材二", iconClass: "ico-line-skin1-02", skinClass: "chart-theme-line-01-material-02" }, { name: "素材三", iconClass: "ico-line-skin1-03", skinClass: "chart-theme-line-01-material-03" }] }, { no: 2, iconClass: "ico-line-skin2-default", skinClass: "chart-theme-line-02-material-01", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-line-skin2-01", skinClass: "chart-theme-line-02-material-01" }, { name: "素材二", iconClass: "ico-line-skin2-02", skinClass: "chart-theme-line-02-material-02" }, { name: "素材三", iconClass: "ico-line-skin2-03", skinClass: "chart-theme-line-02-material-03" }] }] }, o = { light: [], dark: [{ no: 0, skinClass: "chart-theme-line-default", isDefault: !1, name: i.default.instant("69022c77") }, { no: 1, iconClass: "ico-line-skin1-default", skinClass: "chart-theme-line-01-material-01", isDefault: !1, cols: 2, materials: [{ name: "素材四", iconClass: "ico-line-skin1-04", skinClass: "chart-theme-line-01-material-04" }, { name: "素材五", iconClass: "ico-line-skin1-05", skinClass: "chart-theme-line-01-material-05" }, { name: "素材六", iconClass: "ico-line-skin1-06", skinClass: "chart-theme-line-01-material-06" }, { name: "素材七", iconClass: "ico-line-skin1-07", skinClass: "chart-theme-line-01-material-07" }, { name: "素材八", iconClass: "ico-line-skin1-08", skinClass: "chart-theme-line-01-material-08" }] }, { no: 2, iconClass: "ico-line-skin2-default", skinClass: "chart-theme-line-02-material-01", isDefault: !1, cols: 2, materials: [{ name: "素材四", iconClass: "ico-line-skin2-04", skinClass: "chart-theme-line-02-material-04" }, { name: "素材五", iconClass: "ico-line-skin2-05", skinClass: "chart-theme-line-02-material-05" }, { name: "素材六", iconClass: "ico-line-skin2-06", skinClass: "chart-theme-line-02-material-06" }, { name: "素材七", iconClass: "ico-line-skin2-07", skinClass: "chart-theme-line-02-material-07" }, { name: "素材八", iconClass: "ico-line-skin2-08", skinClass: "chart-theme-line-02-material-08" }] }] }; t.default = { skins1: r, skins2: o }
}, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/lineStyle/lineStyle.html" }, function (e, t, n) { "use strict"; function a(e, t) { return { restrict: "EA", templateUrl: n(353), replace: !0, link: function (e, t, n) { function a(t) { t = _.cloneDeep(t), e.materialInfo = { show: !1, cols: t.cols, list: t.materials, theme: t.theme, name: function () { return t.materials ? t.style.material ? t.style.material.name : t.materials[0].name : "无素材" }() }, e.skinName = e.materialInfo.name } function i(t, n) { n.indexOf("area-01") != -1 ? e.use_spline = "0" : e.use_spline = e.default_use_spline; var a = { area: t, current_theme_style: n, selector: "path", props: "stroke", name: e.skinName, no: e.no }; e.saveChart(a, { use_spline: e.use_spline }) } function s(t) { var n = e.getChart(), i = t.area; e.no = i.skinNo; var s = t.defaultStyles; e.style = _.cloneDeep(i), e.use_spline = n.info.use_spline, e.default_use_spline = n.info.use_spline, e.skinList = (0, o.getSkinList)(r.default, s); var l = _.find(e.skinList, function (e) { return e.no == i.skinNo }); e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), e.skin = l, l && a(l), n.info.styles.name && (e.skinName = n.info.styles.name) } e.style = null, e.skinList = null, e.skinName = "", e.no = 0, e.materialInfo = { list: [], show: !1, name: "无素材", cols: 0 }, e.clickMaterialList = function (e) { e.stopPropagation() }, e.clickMaterialItem = function (t, n) { var a = e.getChart(), r = a.cssParser.toJSON()["." + n.skinClass]; e.skinName = n.name, t.stopPropagation(), i(r, n.skinClass) }, e.changeSkin = function () { var t = e.getChart(), n = t.cssParser.toJSON()["." + e.skin.skinClass], r = e.skin; a(r), e.no = r.no, e.skinList.map(function (t) { t.no == e.no ? t.active = !0 : t.active = !1 }), r.isDefault ? i() : i(n, e.skin.skinClass) }, e.$watch("data", function (t) { e.init(s, "area") }) } } } var i = n(352), r = function (e) { return e && e.__esModule ? e : { default: e } }(i), o = n(27); angular.module("BC.dashboard.core").directive("areaStyle", a), a.$inject = ["$rootScope", "$timeout"] }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(40), i = function (e) { return e && e.__esModule ? e : { default: e } }(a), r = { light: [], dark: [{ no: 0, skinClass: "chart-theme-area-default", isDefault: !1, name: i.default.instant("69022c77") }, { no: 1, iconClass: "ico-area-skin1-default", skinClass: "chart-theme-area-01-material-01", isDefault: !1, cols: 2, materials: [{ name: "素材一", iconClass: "ico-area-skin1-01", skinClass: "chart-theme-area-01-material-01" }, { name: "素材二", iconClass: "ico-area-skin1-02", skinClass: "chart-theme-area-01-material-02" }, { name: "素材三", iconClass: "ico-area-skin1-03", skinClass: "chart-theme-area-01-material-03" }, { name: "素材四", iconClass: "ico-area-skin1-04", skinClass: "chart-theme-area-01-material-04" }, { name: "素材五", iconClass: "ico-area-skin1-05", skinClass: "chart-theme-area-01-material-05" }, { name: "素材六", iconClass: "ico-area-skin1-06", skinClass: "chart-theme-area-01-material-06" }] }] }; t.default = r }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/areaStyle/areaStyle.html" }, function (e, t, n) { "use strict"; function a(e, t, a, o) { return { restrict: "EA", templateUrl: n(355), replace: !0, link: function (e, t, n) { function s(t) { return "default" == t ? $.extend(!0, {}, e.defaultStyleData) : "dark" == t ? $.extend(!0, {}, e.darkStyleData) : "light" == t ? $.extend(!0, {}, e.lightStyleData) : void 0 } function l() { var t = _.cloneDeep(e.style); delete t.originGeographicalCoordinatePoint, delete t.originBaseMapStyle; var n = { threeMap: t }; e.saveChart(n) } function c(t, n) { e.ctType = n; var a = t.threeMap, o = a.theme || a.defaultStyles; if (a) { r.forEach(function (e, t) { var a = "C382" == n ? "3dGlobalmap" : "3dMap"; e.iconClass = "ico-" + a + "-skin-" + e.value }); var l = s(o); e.style = $.extend(!0, {}, l, a), e.style.originGeographicalCoordinatePoint = _.cloneDeep(e.style.GeographicalCoordinatePoint), e.style.originBaseMapStyle = _.cloneDeep(e.style.BaseMapStyle); var c = (0, i.getSkinList)(r, o); e.skinList = c, setTimeout(function () { e.chartStyleSetting.render() }, 0) } } e.mapColorList = [{ name: "自定义", value: "0" }, { name: "配色一", value: "1" }, { name: "配色二", value: "2" }, { name: "配色三", value: "3" }, { name: "配色四", value: "4" }, { name: "配色五", value: "5" }, { name: "配色六", value: 6 }], e.mapOuterBoundary3DColorList = [{ name: "自定义", type: "0", value: ["#103E5B", "#051825"] }, { name: "配色一", type: "1", value: ["#103E5B", "#051825"] }, { name: "配色二", type: "2", value: ["#0B5095", "#020E18"] }, { name: "配色三", type: "3", value: ["#73ACF6", "#456DA6"] }, { name: "配色四", type: "4", value: ["#102D55", "#4F7DFE"] }, { name: "配色五", type: "5", value: ["#0690CD", "#15487A"] }, { name: "配色六", type: "6", value: ["#0C3072", "#3894FE"] }], e.mapBaseMapColorList = [{ name: "自定义", type: "0", value: ["#1C8498", "#0F3D5C"] }, { name: "配色一", type: "1", value: ["#1C8498", "#0F3D5C"] }, { name: "配色二", type: "2", value: ["#27B1F3", "#0B5096"] }, { name: "配色三", type: "3", value: ["#D1F6FC", "#1079DF"] }, { name: "配色四", type: "4", value: ["#4F7DFE", "#102D55"] }, { name: "配色五", type: "5", value: ["#2055A1", "#0B2067"] }, { name: "配色六", type: "6", value: ["#3894FE", "#0C3072"] }], e.chartStyleSetting = { chartFontFamily: a, chartFontSize: o, modifyLabelColor: function (e, t, n) { l() }, modifyLabelsValueColor: function (e, t, n) { l() }, modifyMapInnerBoundaryLineColor: function (e, t) { l() }, modifyMapOuterBoundaryLineColor: function (e, t) { l() }, modifyGeographicalCoordinatePointColorMatchingColor: function (e, t) { }, applyModifyGeographicalCoordinatePointConfig: function () { "1" == e.style.originGeographicalCoordinatePoint.configType ? e.style.originGeographicalCoordinatePoint.pictureConfig = e.style.GeographicalCoordinatePoint.pictureConfig : e.style.originGeographicalCoordinatePoint.colorMatchingConfig = e.style.GeographicalCoordinatePoint.colorMatchingConfig, e.style.GeographicalCoordinatePoint = _.cloneDeep(e.style.originGeographicalCoordinatePoint), l() }, changeMapOuterBoundary3dEffectColorType: function () { var t = e.style.mapOuterBoundary3DColorConfig.type; if ("0" === t); else { var n = e.mapOuterBoundary3DColorList.find(function (e) { return e.type == t }); e.style.mapOuterBoundary3DColorConfig.topColor = n.value[0], e.style.mapOuterBoundary3DColorConfig.bottomColor = n.value[1] } l() }, modifyMapOuterBoundary3dEffectTopColor: function (t, n) { e.style.mapOuterBoundary3DColorConfig.type = "0", e.style.mapOuterBoundary3DColorConfig.topColor = n, l() }, modifyMapOuterBoundary3dEffectBottomColor: function (t, n) { e.style.mapOuterBoundary3DColorConfig.type = "0", e.style.mapOuterBoundary3DColorConfig.bottomColor = n, l() }, rangeTextInputChange: function (t) { var n = /^\d+(\.\d+)?$/; if (2 == e.style.originBaseMapStyle.configType) { if ("lateralDeviation" === t) { if (!n.test(e.style.originBaseMapStyle.pictureConfig.lateralDeviation.toString())) return e.style.originBaseMapStyle.pictureConfig.lateralDeviation = 0, !1; +e.style.originBaseMapStyle.pictureConfig.lateralDeviation < 0 && (e.style.originBaseMapStyle.pictureConfig.lateralDeviation = 0), +e.style.originBaseMapStyle.pictureConfig.lateralDeviation > 1 && (e.style.originBaseMapStyle.pictureConfig.lateralDeviation = 1) } if ("verticalDeviation" === t) { if (!n.test(e.style.originBaseMapStyle.pictureConfig.verticalDeviation.toString())) return e.style.originBaseMapStyle.pictureConfig.verticalDeviation = 0, !1; +e.style.originBaseMapStyle.pictureConfig.verticalDeviation < 0 && (e.style.originBaseMapStyle.pictureConfig.verticalDeviation = 0), +e.style.originBaseMapStyle.pictureConfig.verticalDeviation > 1 && (e.style.originBaseMapStyle.pictureConfig.verticalDeviation = 1) } if ("lateralStretching" === t) { if (!n.test(e.style.originBaseMapStyle.pictureConfig.lateralStretching.toString())) return e.style.originBaseMapStyle.pictureConfig.lateralStretching = 0, !1; +e.style.originBaseMapStyle.pictureConfig.lateralStretching < 0 && (e.style.originBaseMapStyle.pictureConfig.lateralStretching = 0), +e.style.originBaseMapStyle.pictureConfig.lateralStretching > 2 && (e.style.originBaseMapStyle.pictureConfig.lateralStretching = 2) } if ("verticalStretching" === t) { if (!n.test(e.style.originBaseMapStyle.pictureConfig.verticalStretching.toString())) return e.style.originBaseMapStyle.pictureConfig.verticalStretching = 0, !1; +e.style.originBaseMapStyle.pictureConfig.verticalStretching < 0 && (e.style.originBaseMapStyle.pictureConfig.verticalStretching = 0), +e.style.originBaseMapStyle.pictureConfig.verticalStretching > 2 && (e.style.originBaseMapStyle.pictureConfig.verticalStretching = 2) } if ("rotationAngle" === t) { if (!n.test(e.style.originBaseMapStyle.pictureConfig.rotationAngle.toString())) return e.style.originBaseMapStyle.pictureConfig.rotationAngle = 0, !1; +e.style.originBaseMapStyle.pictureConfig.rotationAngle < 0 && (e.style.originBaseMapStyle.pictureConfig.rotationAngle = 0), +e.style.originBaseMapStyle.pictureConfig.rotationAngle > 360 && (e.style.originBaseMapStyle.pictureConfig.rotationAngle = 360) } } }, changeBaseMapStyleColorMatchingConfigType: function () { var t = e.style.originBaseMapStyle.colorMatchingConfig.type; if ("0" === t); else { var n = e.mapBaseMapColorList.find(function (e) { return e.type == t }); e.style.originBaseMapStyle.colorMatchingConfig.start_color = n.value[0], e.style.originBaseMapStyle.colorMatchingConfig.end_color = n.value[1], this.render() } }, modifyBaseMapStyleColorMatchingConfigColor: function (t, n) { e.style.originBaseMapStyle.colorMatchingConfig.type = "0" }, changeStep: function () { this.render() }, render: function (t, n, a) { var t = e.style.originBaseMapStyle.colorMatchingConfig.start_color, n = e.style.originBaseMapStyle.colorMatchingConfig.end_color, a = e.style.originBaseMapStyle.colorMatchingConfig.step; return bdpChart.helper.renderLinearGradient($(".baseMapStyle-colormatching-config-wrap").find(".color-range-gradient"), t, n, a) }, applyModifyBaseMapStyleConfig: function () { "1" == e.style.originBaseMapStyle.configType ? e.style.originBaseMapStyle.pictureConfig = e.style.BaseMapStyle.pictureConfig : e.style.originBaseMapStyle.colorMatchingConfig = e.style.BaseMapStyle.colorMatchingConfig; var t = /^\d+(\.\d+)?$/; return t.test(e.style.originBaseMapStyle.pictureConfig.lateralDeviation.toString()) ? e.style.originBaseMapStyle.pictureConfig.lateralDeviation = +e.style.originBaseMapStyle.pictureConfig.lateralDeviation : e.style.originBaseMapStyle.pictureConfig.lateralDeviation = 0, +e.style.originBaseMapStyle.pictureConfig.lateralDeviation < 0 && (e.style.originBaseMapStyle.pictureConfig.lateralDeviation = 0), +e.style.originBaseMapStyle.pictureConfig.lateralDeviation > 1 && (e.style.originBaseMapStyle.pictureConfig.lateralDeviation = 1), t.test(e.style.originBaseMapStyle.pictureConfig.verticalDeviation.toString()) ? (e.style.originBaseMapStyle.pictureConfig.verticalDeviation = +e.style.originBaseMapStyle.pictureConfig.verticalDeviation, +e.style.originBaseMapStyle.pictureConfig.verticalDeviation < 0 && (e.style.originBaseMapStyle.pictureConfig.verticalDeviation = 0), +e.style.originBaseMapStyle.pictureConfig.verticalDeviation > 1 && (e.style.originBaseMapStyle.pictureConfig.verticalDeviation = 1), t.test(e.style.originBaseMapStyle.pictureConfig.lateralStretching.toString()) ? (e.style.originBaseMapStyle.pictureConfig.lateralStretching = +e.style.originBaseMapStyle.pictureConfig.lateralStretching, +e.style.originBaseMapStyle.pictureConfig.lateralStretching < 0 && (e.style.originBaseMapStyle.pictureConfig.lateralStretching = 0), +e.style.originBaseMapStyle.pictureConfig.lateralStretching > 2 && (e.style.originBaseMapStyle.pictureConfig.lateralStretching = 2), t.test(e.style.originBaseMapStyle.pictureConfig.verticalStretching.toString()) ? (e.style.originBaseMapStyle.pictureConfig.verticalStretching = +e.style.originBaseMapStyle.pictureConfig.verticalStretching, +e.style.originBaseMapStyle.pictureConfig.verticalStretching < 0 && (e.style.originBaseMapStyle.pictureConfig.verticalStretching = 0), +e.style.originBaseMapStyle.pictureConfig.verticalStretching > 2 && (e.style.originBaseMapStyle.pictureConfig.verticalStretching = 2), t.test(e.style.originBaseMapStyle.pictureConfig.rotationAngle.toString()) ? (e.style.originBaseMapStyle.pictureConfig.rotationAngle = +e.style.originBaseMapStyle.pictureConfig.rotationAngle, +e.style.originBaseMapStyle.pictureConfig.rotationAngle < 0 && (e.style.originBaseMapStyle.pictureConfig.rotationAngle = 0), +e.style.originBaseMapStyle.pictureConfig.rotationAngle > 360 && (e.style.originBaseMapStyle.pictureConfig.rotationAngle = 360), e.style.BaseMapStyle = _.cloneDeep(e.style.originBaseMapStyle), void l()) : (e.style.originBaseMapStyle.pictureConfig.rotationAngle = 0, !1)) : (e.style.originBaseMapStyle.pictureConfig.verticalStretching = 0, !1)) : (e.style.origin.originBaseMapStyle.pictureConfig.lateralStretching = 0, !1)) : (e.style.originBaseMapStyle.pictureConfig.verticalDeviation = 0, !1) } }, e.defaultStyleData = { defaultStyles: "default", theme: "default", labels: { color: "#ffffff", fontSize: "inherit", fontFamily: "inherit" }, labelsValue: { color: "#F9D90A", fontSize: "inherit", fontFamily: "inherit" }, mapInnerBoundaryLine: { color: "#18bde4", width: 1 }, mapOuterBoundaryLine: { color: "#18bde4", width: 1 }, GeographicalCoordinatePoint: { configType: "1", colorMatchingConfig: { color: "#2bebff", fontSize: 3 }, pictureConfig: { url: "", fontSize: 6 } }, BaseMapStyle: { configType: "1", colorMatchingConfig: { type: "1", end_color: "#1C8498", start_color: "#0F3D5C", step: 5 }, pictureConfig: { url: "", lateralDeviation: .5, verticalDeviation: .5, lateralStretching: 1, verticalStretching: 1, rotationAngle: 0 } }, mapOuterBoundary3DColorConfig: { type: "1", topColor: "#103E5B", bottomColor: "#051825" } }, e.darkStyleData = { defaultStyles: "default", theme: "dark", labels: { color: "#ffffff", fontSize: "inherit", fontFamily: "inherit" }, labelsValue: { color: "#ffffff", fontSize: "inherit", fontFamily: "inherit" }, mapInnerBoundaryLine: { color: "#46e7ff", width: 1 }, mapOuterBoundaryLine: { color: "#46e7ff", width: 1 }, GeographicalCoordinatePoint: { configType: "1", colorMatchingConfig: { color: "#F9D90A", fontSize: 3 }, pictureConfig: { url: "", fontSize: 6 } }, BaseMapStyle: { configType: "1", colorMatchingConfig: { type: "2", end_color: "#0B5096", start_color: "#27B1F3", step: 5 }, pictureConfig: { url: "", lateralDeviation: .5, verticalDeviation: .5, lateralStretching: 1, verticalStretching: 1, rotationAngle: 0 } }, mapOuterBoundary3DColorConfig: { type: "2", topColor: "#0B5095", bottomColor: "#020E18" } }, e.lightStyleData = { defaultStyles: "default", theme: "light", labels: { color: "#013565", fontSize: "inherit", fontFamily: "inherit" }, labelsValue: { color: "#E6A953", fontSize: "inherit", fontFamily: "inherit" }, mapInnerBoundaryLine: { color: "#456da6", width: 1 }, mapOuterBoundaryLine: { color: "#031565", width: 1 }, GeographicalCoordinatePoint: { configType: "1", colorMatchingConfig: { color: "#E6A953", fontSize: 3 }, pictureConfig: { url: "", fontSize: 6 } }, BaseMapStyle: { configType: "1", colorMatchingConfig: { type: "3", end_color: "#1079DF", start_color: "#D1F6FC", step: 5 }, pictureConfig: { url: "", lateralDeviation: .5, verticalDeviation: .5, lateralStretching: 1, verticalStretching: 1, rotationAngle: 0 } }, mapOuterBoundary3DColorConfig: { type: "3", topColor: "#73ACF6", bottomColor: "#456DA6" } }, e.ctType = "", e.style = {}, e.skinList = null, e.changeSkin = function () { var t = e.skin; e.skinList.forEach(function (e) { e.value == t.value ? e.active = !0 : e.active = !1 }); var n = s(t.value); e.style = _.cloneDeep(n), e.style.originGeographicalCoordinatePoint = _.cloneDeep(e.style.GeographicalCoordinatePoint), e.style.originBaseMapStyle = _.cloneDeep(e.style.BaseMapStyle), l() }, e.saveStyle = function () { l() }, e.$watch("data", function (t) { e.init(c, "threeMap") }) } } } var i = n(27), r = [{ iconClass: "ico-3dmap-skin-default", isDefault: !1, theme: "dark", value: "default" }, { iconClass: "ico-3dmap-skin-dark", isDefault: !1, theme: "dark", value: "dark" }, { iconClass: "ico-3dmap-skin-light", isDefault: !1, theme: "dark", value: "light" }]; angular.module("BC.dashboard.core").directive("threeMap", a), a.$inject = ["$rootScope", "$timeout", "chartFontFamily", "chartFontSize"] }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/threeMap/threeMapStyle.html" }, function (e, t, n) { n(357).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "chartStyle_69eccfc1.css" }, function (e, t) { e.exports = "/dist/static/dashboard-core/chart-style/chartStyle.html" }, function (e, t, n) { "use strict"; var a = n(43), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").directive("lazyContainer", [function () { function e(e) { var n = e.data("__uid"); return n || e.data("__uid", n = "" + ++t), n } var t = 0; return { restrict: "EA", controller: ["$scope", "$element", function (t, n) { function a(t) { var n = angular.element(this), a = e(n); n.css("opacity", 1), t.ready = !0, s.hasOwnProperty(a) && delete s[a] } function r(e) { var t, a, i = n[0].getBoundingClientRect(), r = e[0].getBoundingClientRect(); return r.bottom + 50 >= i.top && r.top - 50 <= i.bottom && (a = !0), r.right + 50 >= i.left && r.left - 50 <= i.right && (t = !0), t && a } function o() { (0, i.default)(s).forEach(function (e) { var t = s[e], n = t.iElement, a = t.iScope; r(n) && n.attr("src", a.lazyTemplate ? a.lazySrc.image : a.lazySrc) }) } var s = {}; this.addImg = function (t, n, i) { n.bind("load", a.bind(n, t.lazyTemplate ? t.lazySrc : {})), t.$watch("lazySrc", function () { var a = "1s"; if (null != t.animateSpeed && (a = t.animateSpeed), r(n)) t.animateVisible && n.css({ "background-color": "#fff", opacity: 0, "-webkit-transition": "opacity " + a, transition: "opacity " + a }), n.attr("src", t.lazyTemplate ? t.lazySrc.image : t.lazySrc); else { var i = e(n); n.css({ "background-color": "#fff", opacity: 0, "-webkit-transition": "opacity " + a, transition: "opacity " + a }), s[i] = { iElement: n, iScope: t } } }), t.$on("$destroy", function () { n.unbind("load"); var t = e(n); s.hasOwnProperty(t) && delete s[t] }) }, n.bind("scroll", o), n.bind("resize", o) }] } }]).directive("lazySrc", [function () { return { restrict: "A", require: "^lazyContainer", scope: { lazySrc: "=", lazyTemplate: "=", animateVisible: "@", animateSpeed: "@" }, link: function (e, t, n, a) { a.addImg(e, t, n) } } }]) }, , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, n) { "use strict"; n(279), n(298), angular.module("BC.dashboard.core", ["slick", "gridster", "textAngular"]), n(300), n(305), n(306), n(311), n(312), n(313), n(314), n(389), n(315), n(316), n(317), n(318), n(320), n(359) }, function (e, t, n) { "use strict"; var a = n(2), i = function (e) { return e && e.__esModule ? e : { default: e } }(a); angular.module("BC.dashboard.core").directive("exportSnapshot", ["$http", "$rootScope", "ngDialog", "errHint", "$jsTipTranslate", "$q", "commonService", "$timeout", "$location", "wtbListService", "$translate", function (e, t, n, a, r, o, s, l, c, d, u) { return { restrict: "A", scope: !0, link: function (e, a, r) { function f() { "dashboard" === r.mode ? v = a.parents(".chart-box").find(".chart").data("chart-data") : "fullscreen" === r.mode && (v = a.parents(".control-pane").siblings(".fs-chart-main").find(".fullscreen-chart.active").data("chart-data")) } function p() { var e = { ct_id: v.ct_id, dsh_id: v.dsh_id }; return v.optional && (v.optional.dsh_filter && (e.dsh_filter = (0, i.default)(v.optional.dsh_filter)), v.optional.drill_level && (e.drill_level = v.optional.drill_level, e.drill_field = v.optional.drill_field, e.drill_value = (0, i.default)(v.optional.drill_value)), v.optional.filter_list && (e.filter_list = (0, i.default)(v.optional.filter_list)), e.linked_chart_type = v.optional.linked_chart_type, v.optional.linked_value && (e.linked_value = (0, i.default)(v.optional.linked_value)), v.optional.chart_jump_info && (e.chart_jump_info = (0, i.default)(v.optional.chart_jump_info))), e } function h() { var n = o.defer(), a = p(); return e.layoutTable = !0, s.dashboard.getSnapshotPreviewTable(a).success(function (a) { t.pageLoading = !1, "0" === a.status ? (a.result && (e.previewTable = a.result && a.result.data_list), n.resolve()) : (e.layoutTable = !1, n.reject()) }), n.promise } function g() { var t = o.defer(), n = _.filter(e.previewTable, function (e) { return !!(e.count >= 1500) }); return n && n.length ? t.resolve(!1) : t.resolve(!0), t.promise } function m() { n.open({ template: "/static/dashboard-core/chart-export/chart-export-snapshot.html", className: "ngdialog-theme-default export-snapshot-modal", scope: e, controller: ["$scope", "$element", function (e, a) { e.snapshot_name = v.info && v.info.title || "", e.previewIndex = 0, e.previewTable && e.previewTable.length > 0 && (e.currentTable = e.previewTable[e.previewIndex]), e.changeTable = function (t) { e.previewTable[t] && (e.previewIndex = t, e.currentTable = e.previewTable[e.previewIndex], e.layoutTable = !0, e.resizeTable()) }, e.resizeTable = function () { function t() { s = 0, $(i).children("td").each(function (e, t) { var n = parseInt($(t).width()); $(o[e]).width(n) }), e.layoutTable = !1 } var n, i, r, o, s; l(function () { a.find(".J-table-fixhead").width(a.find(".table-scroll").children("table").width()), n = a.find(".table-scroll"), i = a.find(".table-scroll").find("tbody").find("tr")[0], r = a.find(".J-table-fixhead").find("thead").find("tr")[0], o = $(r).children("th"), t(), n.scroll(function (e) { a.find(".table-fixhead").css({ left: -e.target.scrollLeft + "px" }) }) }, 100), $(window).resize(function () { clearTimeout(void 0), setTimeout(function () { a.find(".J-table-fixhead").width(a.find(".table-scroll").children("table").width()), t() }, 10) }) }, e.resizeTable(), e.exportSnapshot = function () { function a() { n.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: e, data: { title: u.instant("tips"), message: "zh" === y ? "该图表无数据，是否导出?" : "The chart has no data. Do you want to export the chart?" } }).then(function () { r() }) } function r() { var n = p(); 1 === e.previewTable.length ? n.snapshot_name = [e.snapshot_name] : n.snapshot_name = Array(e.previewTable.length).join(" ").split(" ").map(function (t, n) { return e.snapshot_name + "_" + n }), n.snapshot_name = (0, i.default)(n.snapshot_name), v.optional && (v.optional.dsh_filter && (n.dsh_filter = (0, i.default)(v.optional.dsh_filter)), v.optional.drill_level && (n.drill_level = v.optional.drill_level, n.drill_field = v.optional.drill_field, n.drill_value = (0, i.default)(v.optional.drill_value)), v.optional.filter_list && (n.filter_list = (0, i.default)(v.optional.filter_list))), t.pageLoading = !0, s.dashboard.saveChartSnapshot(n).success(function (n) { "0" === n.status && n.result && function () { var t = n.result.folder_id, a = n.result.tb_id[0]; wtbTree.prototype.originals ? d.updateOrigFolder(t).then(function () { e.closeThisDialog(), e.openSuccessTip(a) }) : (e.closeThisDialog(), e.openSuccessTip(a)) }(), t.pageLoading = !1 }) } e.previewTable && e.previewTable.length > 0 ? 1 === e.previewTable.length ? e.previewTable[0].data.length ? r() : a() : r() : a() } }] }, function () { }) } var v; e.previewTable = null; var y = bdpChart.language || "zh", b = "zh" === y ? "当前图表无数据" : "No data to display"; e.noDataMsg = b, a.on("click", function () { t.pageLoading = !0, f(), e.previewTable = null, h().then(function () { g().then(function (t) { t ? m() : n.openConfirm({ template: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngDialog-width-300", scope: e, data: { title: u.instant("tips"), message: "导出数据过大，目前快照工作表支持最多导出1500条数据，是否继续？" } }).then(function () { m() }) }) }) }), e.openSuccessTip = function (t) { n.open({ template: "/static/dashboard-core/chart-export/export-snapshot-tip.html", className: "ngdialog-theme-default", scope: e, controller: ["$scope", function (e) { e.jumpToDataSource = function () { n.closeAll(), $.cookie("ds_tb_id", t), c.path("/data_source") } }] }) } } } }]) }, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function (e, t, n) { n(118), e.exports = n(750) }, function (e, t, n) { "use strict"; !function () { n(205), n(277), n(751), n(753), n(754), n(755), n(388); var e = ["BC.common", "BC.dashboard.core", "ui.router", "ui.bootstrap", "ui.mask", "bdp.charts", "ngDialog", "datePicker", "ui.sortable", "angular-click-outside", "personal.shareCommon", "pasvaz.bindonce"]; angular.module("personal.shareApp", e).config(["ngDialogProvider", function (e) { e.setDefaults({ showClose: !0, closeByDocument: !1, closeByEscape: !1 }) }]).config(["$httpProvider", function (e) { e.interceptors.push("myInterceptor") }]).run(["$rootScope", "$timeout", function (e, t) { e.language = "zh", e.ready = !1, e.hideWarn = !0, registerUserLogger(), e.appBrowserView = !1, "mobile" == $.cookie("client") && (e.appBrowserView = !0) }]), n(756) }() }, function (e, t, n) { n(752).replace(n.p, "") }, function (e, t, n) { e.exports = n.p + "share-index_c482b456.css" }, function (e, t, n) { "use strict"; !function () { function e(e, t, n, a, i) { function r() { e.comment.showAll = !0, e.comment.loadedAll ? f() : function () { !function t() { u(e.comment.currentPage + 1).then(function () { e.comment.loadedAll ? f() : t() }) }() }() } function o(e) { var t = Math.round(g / 1e3 - e); return t < 60 ? Math.max(1, t) + "秒前" : t < 3600 ? Math.round(t / 60) + "分钟前" : t < 36e3 ? Math.round(t / 3600) + "小时前" : Highcharts.dateFormat("%Y年%m月%d日 %H:%M", 1e3 * e) } function s(t) { e.currentComment.text += "回复@" + t.name + ": ", $(".comment-textarea").focus() } function l(e) { a.openConfirm({ templateUrl: "/static/partials/dialogTemplates/confirm-dialog.html", className: "ngdialog-theme-default ngdialog-width-340", data: { title: "删除评论", message: "确认删除此条评论吗" } }).then(function () { return t.deleteComment(e.cmt_id).then(function (e) { 0 == e.data.status ? (n("删除评论成功"), u(1, !0).then(function () { f() })) : n("删除失败") }) }) } function c() { if (0 == $.trim(e.currentComment.text).length) return void n("请输入评论内容"); var a = e.currentComment.text, i = d(a); return t.submitComment(a, i).then(function (t) { var a = t.data; 0 == a.status ? (g = (new Date).getTime(), e.currentComment.text = "", u(1, !0).then(function () { f() })) : n(23005 == a.status ? "评论达到上限" : 23030 == a.status ? "您的评论含有敏感词" : "评论失败") }) } function d(t) { var n, a = /@(.+)[:：]\s/; a.test(t) && (n = RegExp.$1); for (var i = 0, r = e.comment.list.length; i < r; i++) { var o = e.comment.list[i]; if (n == o.name) return o.cmt_id } return null } function u(n, a) { return t.getCommentList(n).then(function (t) { var n = t.data; if (0 == n.status) { a && (e.comment.list.length = 0, e.comment.cache.length = 0); var i = []; angular.forEach(n.result.comment, function (e) { e.photo_content = e.photo_content.substring(0, 3) + " " + e.photo_content.substring(3), i.unshift(e) }), e.comment.cache = i.concat(e.comment.cache), e.comment.total = n.result.total, e.comment.totalPage = n.result.page_count, e.comment.currentPage = n.result.current_page, e.comment.loadedAll = e.comment.cache.length >= n.result.total, e.comment.current_user_id = n.result.user_id } }) } function f() { var t = e.comment.cache; if (e.comment.showAll) e.comment.list = t.slice(0); else for (var n = Math.min(e.comment.renderSize, t.length), a = (t.length, 0); a < n;)e.comment.list.push(t[a]), a++ } function p(n) { return t.favor().then(function (t) { var n = t.data; 0 == n.status ? (e.outer_share_info.like_total++, i.is_like = 1) : 23004 == n.status && alert("你已经点过赞了") }) } function h() { a.open({ template: "/h5_dashboard/html/share-dialog/comment-list.html", className: "ngdialog-theme-default dialog-fullscreen comment-modal", scope: e, overlay: !1, disableAnimation: !0 }) } e.comment = { list: [], cache: [], total: 0, totalPage: 0, currentPage: 0, loadedAll: !1, renderSize: 10, showAll: !1, current_user_id: void 0 }; var g = (new Date).getTime(); e.currentComment = { text: "" }, e.showAllComments = r, e.calculateTime = o, e.onReply = s, e.deleteComment = l, e.submitComment = c, e.addFavor = p, e.h5ShowCommentList = h, function () { u(1).then(function () { f() }) }() } angular.module("personal.shareCommon", []).controller("commentCtrl", e), e.$inject = ["$scope", "$api", "errHint", "ngDialog", "$rootScope"] }() }, function (e, t, n) { "use strict"; !function () { var e = function (e) { for (var t = e.split("?"), n = [], a = t.length - 1; a >= 0; a--)for (var i, e = t[a] || "", r = e.split("&"), o = 0; o < r.length; o++)i = r[o].split("="), n[i[0]] = i[1]; return n }(location.href), t = e.shareId, n = e.password; t && $("title").text("BDP分享仪表盘，分享可视化效果"), angular.module("personal.shareCommon").constant("sdo_id", t).constant("dashboardPassword", n).constant("screenElePadding", { text: { paddingTop: 8, paddingBottom: 4, paddingLeft: 24, paddingRight: 24 }, chart: { paddingTop: 32, paddingBottom: 40, paddingLeft: 32, paddingRight: 40 }, img: { paddingTop: 0, paddingBottom: 0, paddingLeft: 0, paddingRight: 0 } }).factory("myInterceptor", function () { return { request: function (e) { return e.params = e.params || {}, e.params.sdo_id = t, e } } }).factory("$api", ["$http", "sdo_id", function (e, t) { return { getDashboardInfo: function (n) { return e.get("/api/dashboard/share_info", { params: { sdo_id: t, password: n } }) }, getCommentList: function (n) { return e.get("/api/comment/list", { params: { sdo_id: t, page: n || 1 } }) }, submitComment: function (n, a) { return e.post("/api/comment/create", { _xsrf: bdp.utils.getCookie("_xsrf"), comment: n, sdo_id: t, response_id: a }) }, deleteComment: function (t, n) { return e.post("/api/comment/delete", { _xsrf: bdp.utils.getCookie("_xsrf"), cmt_id: t }) }, favor: function () { return e.get("/api/like/add", { params: { sdo_id: t } }) }, dashFilterItem: function (n) { return e.post("/api/dsh_filter/item", { _xsrf: bdp.utils.getCookie("_xsrf"), dsh_id: n, sdo_id: t }) } } }]).factory("myInterceptor", function () { return { request: function (e) { return e.params = e.params || {}, e.params.sdo_id = t, e } } }) }() }, function (e, t, n) { "use strict"; !function () { function e(e, t, n, a) { function i(n, a) { a = a || e.dashTitle; var i = "快来看看分享自BDP个人版的数据报表“" + a + "”吧，图表直观又酷炫。在BDP，每周1分钟轻松搞定数据报表，从此和加班say goodbye！（来自@BDP个人版）", r = angular.extend({}, o, { url: s, to: n, product: "BDP", title: encodeURIComponent(i) }), l = "http://share.baidu.com/s?", c = []; for (var d in r) if (r.hasOwnProperty(d)) if ("pic" == d && angular.isArray(r[d])) { var u; u = "tsina" == n ? r[d].join("||") : r[d][0], c.push(d + "=" + u) } else c.push(d + "=" + r[d]); l += c.join("&"), t.open(l) } function r(e) { bdp.loadjs({ src: ["//m1.bdp.cn/static/js/lib/jquery-qrcode/jquery.qrcode_fa248c8.js", "//m1.bdp.cn/static/js/lib/jquery-qrcode/qrcode_2cfb76d.js"], callback: function () { var t = e.target, n = $('<div class="share-wechat-pop"><div class="qrcode-wrap"></div><div class="foot">扫描二维码分享至微信</div><em class="arrow-left"></em></div>').appendTo("body"), a = $(t).offset(); n.css({ position: "absolute", zIndex: 99999, top: a.top, left: a.left + $(t).width() + 10 }).find(".close-btn").on("click", function () { n.remove() }), n.find(".qrcode-wrap").qrcode({ width: 100, height: 100, text: s }), $(t).on("mouseleave.showQrCode", function () { n.remove() }) } }) } var o = { type: "text", pic: [location.origin + "/static/images/bdp-dashboard-overview.png", location.origin + "/static/images/login_logo.png"], title: encodeURIComponent("我使用 #BDP# 制作了一个仪表盘，赶快来看看吧！"), desc: "BDP商业数据分析平台", sign: "off", summary: "BDP商业数据分析平台", searchPic: 0, relateUid: 0 }, s = location.href; e.shareDashboardTo = i, e.shareToWeChat = r, $(document).off("click.table").on("click.table", function (e) { $(document).trigger("clickTable", { e: e }) }), $(document).off("mousemove.table").on("mousemove.table", function (e) { $(document).trigger("mousemoveTable", { e: e }) }) } angular.module("personal.shareCommon").controller("shareCtrl", e), e.$inject = ["$scope", "$window", "$api", "$rootScope"] }() }, function (e, t, n) {
  "use strict"; !function () {
    function e(e, t, n, a, i, r, o, s, l, c, d, u, f) {
      function p(n) { n !== e.fullDisplayDevice && (e.fullDisplayDevice = n, BDPLogger.log("feStatistics", { category: "interaction", action: "click", opt_label: "setFullDisplayDevice", opt_value: 1 }), BDPLogger.log("feStatistics", { category: "feature", action: "fullDisplayDevice", opt_label: n, opt_value: 1 }), localStorage ? localStorage.setItem("fullDisplayDevice", n) : $.cookie("fullDisplayDevice", n), e.dashStandardItems.forEach(function (e) { var a = e.children[0].dom_id; if (a) { var i = $("#" + a).find(".chart").data("chart-data"); i && i.setDisplayDevice(n, t) } }), $(".fullscreen-chart").length > 0 && $(".fullscreen-chart").each(function (e, a) { var i = $(a).data("chart-data"); i && i.setDisplayDevice(n, t) })) } function h() { e.isFullscreenMode || "pc" === e.fullDisplayDevice && e.fullDisplayTheme === t.usedThemeId || e.dashStandardItems.forEach(function (e) { var n = e.children[0].dom_id; if (n) { var a = $("#" + n).find(".chart").data("chart-data"); a && a.setDisplayStyle("pc", 1 == t.usedThemeId ? "dark" : "default", t) } }) } function g(n) { if (n !== e.fullDisplayTheme) { e.fullDisplayTheme = n, BDPLogger.log("feStatistics", { category: "interaction", action: "click", opt_label: "setFullDisplayTheme", opt_value: 1 }), BDPLogger.log("feStatistics", { category: "feature", action: "fullDisplayTheme", opt_label: n, opt_value: 1 }), localStorage ? localStorage.setItem("fullDisplayTheme", n) : $.cookie("fullDisplayTheme", n); var a = 1 === n ? "dark" : "default"; e.dashStandardItems.forEach(function (e) { var n = e.children[0].dom_id; if (n) { var i = $("#" + n).find(".chart").data("chart-data"); i && i.setTheme(a, t) } }), $(".fullscreen-chart").length > 0 && $(".fullscreen-chart").each(function (e, n) { var i = $(n).data("chart-data"); i && i.setTheme(a, t) }) } } function m(t) { switch (t) { case "needPassword": e.vm.dashType = 1; break; case "errorPassword": e.vm.dashType = 1, e.vm.dashPsdErrMsg = "密码错误，请重新输入"; break; default: e.vm.dashType = 3, e.vm.n = 5, w() } } function v(n) {
        window.usedThemeId = t.usedThemeId = 2; return y(), t.dashLoading = !0, o.getDashboardInfo(n).then(function (n) {
          if (n = n.data, t.dashLoading = !1, 0 == n.status) {
            if (e.vm.dashType = 2, n = n.result, isObjectEmpty(n)) return; var a = n.user_info.theme_id; window.usedThemeId = t.usedThemeId = n.user_info.theme_id, 2 != a && _(a), t.dashProperty = n.property, t.outer_share_info = n.outer_share_info, t.share_user_id = n.user_id, t.is_like = n.is_like, e.share_user_info = n.user_info, e.share_user_info.isLogin = !!$.cookie("token"), e.dashLayoutInfo.show_block = !defined(n.meta.show_block) || n.meta.show_block, e.dashLayoutInfo.fixed_width = !!defined(n.meta.fixed_width) && n.meta.fixed_width, e.dashLayoutInfo.layout_style = defined(n.meta.layout_style) ? n.meta.layout_style : 1, e.dashLayoutInfo.gridsterStyle = {},
              2 == n.category && (e.dashLayoutInfo.layout_style = 2), b(n.meta.show_block, e.dashLayoutInfo.layout_style), e.dashTitle = n.name, document.title = n.name + " - BDP个人版", e.property = n.property; var i = n.meta.charts || []; e.dashStandardItems = i || [], e.dashStandardItems.sort(function (e, t) { return e.row == t.row ? e.col - t.col : e.row < t.row ? -1 : 1 }), e.draw_chart_url = {}; var r, o, l; l = e.isFullscreenMode ? 1 === e.fullDisplayTheme ? "dark" : "default" : 1 === t.usedThemeId ? "dark" : "default", t.$on("gridster-loaded", function (t) { for (var a = 0; a < i.length; a++) { r = i[a]; for (var c = 0; c < r.children.length; c++)o = r.children[c], o.meta.filter_list = [], o.meta.type && (e.draw_chart_url[o.dom_id] = { options: { theme: l, dsh_id: void 0, ct_id: o.meta.ct_id, tb_id: o.meta.tb_id, optional: { linked_chart_type: o.meta.chart_link.linked_chart_type, link_info: o.meta.chart_link.link_info, master_layer_id: o.meta.chart_link.master_layer_id, chart_jump_info: o.meta.chart_jump, sdo_id: s } }, lazyload: !1 }) } if (2 == e.dashLayoutInfo.layout_style) { var d = C.getBlankPos().top; $(".gridster").css("height", d), 2 == n.category && e.shareAdvDash.handleDashStyle(n) } e.lazy = new bdpChart.LazyLoad(".gridster", ".gridster-item", { diff: 50, handleResize: !0, onItemLoad: function (t) { var n = $(t).find(".item-chart").attr("id"); e.draw_chart_url[n] && (e.draw_chart_url[n].lazyload = !1) }, onItemsLoad: function () { e.$$phase || e.$apply() } }), e.search_ct_id && setTimeout(function () { e.scrollToChart(e.search_ct_id) }, 10) })
          } else 23062 == n.status ? e.showError("needPassword") : 23063 == n.status ? e.showError("errorPassword") : e.showError("unknow"); t.ready = !0
        })
      } function y(t) { o.dashFilterItem({ dash_id: t, sdo_id: s }).then(function (t) { var t = t.data; "0" === t.status && (e.global.originalGlobalFilter = angular.copy(t.result), e.global.globalDashFilter = bdp.utils.handleGlobalFilterLevel(t.result), angular.forEach(e.global.globalDashFilter, function (e) { if ("date" == e.data_type && "" == e.config.granularity) { var t = e.config.range || ""; if (t) { var n = !1; angular.forEach(e.adv_date_list, function (e) { e.opt_id == t && (n = !0) }), n || (e.config.range = "", e.config.default_select = !1, e.range = []) } } }), e.global.globalDashFilterDisplay = bdp.bdpDash.getGFDisplay(e.global.globalDashFilter)) }) } function _(e) { function t(e) { var t = document.createElement("link"); return t.setAttribute("rel", "stylesheet"), t.setAttribute("type", "text/css"), t.setAttribute("href", e), t.setAttribute("id", window.BDPThemes.themeLinkCssId), t } window.BDPThemes = { themes: [{ name: "简洁模式", filename: "light", fileUrl: "/static/theme/light/css/light.css", id: 2, isInUsed: !1, backgroundImg: "/static/theme/light/icons/preview-gray.png" }, { name: "商务模式", filename: "dark", fileUrl: "/static/theme/dark/css/dark.css", id: 1, isInUsed: !1, backgroundImg: "/static/theme/dark/icons/preview-default.png" }], bdpThemeIdCookieName: "theme_id", themeLinkCssId: "J-theme-linek-css" }; for (var n = window.BDPThemes.themes, a = n[0].fileUrl, i = (n[0].svgUrl, document.documentElement.className), r = n.length - 1; r >= 0; r--)if (e == n[r].id) { window.usedThemeId = n[r].id, a = n[r].fileUrl, document.documentElement.className = i.replace(/theme-\w+/, "theme-" + n[r].filename); break } !function (e) { var n = t(e); void 0 !== n && document.getElementsByTagName("head")[0].appendChild(n) }(a) } function b(t, n) { var a = bdpChart.helper.isMobile(); a && setupMobileMode(), e.gridsterOpts = { isBDP: !0, layoutStyle: n, margins: t ? a ? [8, 0] : [8, 8] : [0, 0], outerMargin: !1, minColumns: 2, minRows: 2, maxRows: 1e3, columns: 12, isMobile: a, resizable: { enabled: !1 }, draggable: { enabled: !1 } } } e.mouseleaveItem = function () { e.$broadcast("fire-mouseleave-item-event", !0) }, e.chartOptions = {}, t.mainChartContainer = [], t.mainChartIdContainer = [], t.mainChartColorContainer = {}, t.view = "dashboard", e.vm = { dashType: null, dashErrMsg: null, dashPsdErrMsg: "" }, t.global = {}, e.dashLayoutInfo = {}, e.getDashboardInfo = v, e.setFullDisplayDevice = p, e.removeFullDisplayStyle = h, e.setFullDisplayTheme = g, e.showError = m, function () { d(["dash.delChartFail", "dash.plzSelectTable", "dash.selectTbTitle", "dash.emptyFolderList", "dash.titleRequired", "dash.titleDuplicate", "dash.delChartLinkSuccess"], e), localStorage ? e.fullDisplayDevice = localStorage.getItem("fullDisplayDevice") || "pc" : e.fullDisplayDevice = $.cookie("fullDisplayDevice") || "pc", localStorage ? e.fullDisplayTheme = +localStorage.getItem("fullDisplayTheme") || t.usedThemeId : e.fullDisplayTheme = +$.cookie("fullDisplayTheme") || t.usedThemeId, e.getDashboardInfo(u) }(), e.resetChartData = function () { e.removeFullDisplayStyle() }; var w = function () { var t = i(function () { --e.vm.n <= 1 && (i.cancel(t), location.href = "/home.html") }, 1e3) }, C = { setFreeLayout: function () { var t, n = $("#J_gridster .gridster-item"), a = "", i = {}; angular.forEach(n, function (n, r) { a = $(n).attr("style"), t = $(n).data("chartId"), a.split(";").forEach(function (e, t) { var n = e.replace(/\s/g, "").split(":"); n[1] && (i[n[0]] = n[1].replace("px", "")) }); for (var o = 0; o < e.dashStandardItems.length; o++)t === e.dashStandardItems[o].children[0].meta.ct_id && (e.dashStandardItems[o].left = +i.left, e.dashStandardItems[o].top = +i.top, e.dashStandardItems[o].width = +i.width, e.dashStandardItems[o].height = +i.height) }) }, getBlankPos: function () { var t = []; return angular.forEach(e.dashStandardItems, function (e, n) { t.push(e.top + e.height) }), { top: Math.max.apply(this, t) } } }; e.shareAdvDash = { dashCategory: 0, minZIndex: 3e3, maxZIndex: 3e3, pageWrapStyles: {}, resolution: {}, handleDashStyle: function (t) { this.dashCategory = 2, this.resolution = JSON.parse(t.resolution), t.meta.styles && !$.isEmptyObject(JSON.parse(t.meta.styles)) && (this.pageWrapStyles = JSON.parse(t.meta.styles)); for (var n = 0, a = e.dashStandardItems.length; n < a; n++) { var i = e.dashStandardItems[n]; i.zIndex = i.zIndex || 3e3, e.shareAdvDash.minZIndex = i.minZIndex || 3e3, e.shareAdvDash.maxZIndex = i.maxZIndex || 3e3, i.itemStyle = { left: i.left + "px", top: i.top + "px", width: i.width + "px", height: i.height + "px", "z-index": i.zIndex, "background-color": (i.bgColor || "rgba(0, 1, 0, 0)") + " !important", border: "CUSTOM" == i.borderType ? i.customBorder.width + "px " + i.customBorder.style + " " + i.customBorder.color : "" } } this.setDashGridsterStyle() }, setDashGridsterStyle: function () { e.dashLayoutInfo.dashMode = "adv", e.dashLayoutInfo.dashWrapperStyle = {}; var t = e.shareAdvDash.resolution, n = e.shareAdvDash.pageWrapStyles; e.dashLayoutInfo.gridsterStyle = { width: t.width + "px", "min-width": t.width + "px", height: t["min-height"] + "px", "min-height": t["min-height"] + "px", margin: "0 auto", transform: "scale(1)", "transform-origin": "0 0", "background-color": n.bgColor, "border-color": n.lineColor, "border-style": n.style, "border-width": n.width, "background-size": n["background-size"], "background-image": n["background-image"], "background-repeat": n["background-repeat"], "background-position": n["background-position"] }, a(function () { e.shareAdvDash.resetDashGridsterHeight(), bdp.bdpDash.setDashItemPadding(e.dashStandardItems, f, reflowChart, null) }, 100) }, resetDashGridsterHeight: function () { var t = $(".dash-wrapper"); t && t.length > 0 && (t.length > 0 && e.dashLayoutInfo.gridsterStyle ? e.dashLayoutInfo.gridsterStyle.height = t[0].scrollHeight : e.dashLayoutInfo.gridsterStyle = { height: t[0].scrollHeight }) } }
    } angular.module("personal.shareApp").controller("dashCtrl", e), e.$inject = ["$scope", "$rootScope", "commonService", "$timeout", "$interval", "ngDialog", "$api", "sdo_id", "commonHttp", "errHint", "$jsTipTranslate", "dashboardPassword", "screenElePadding"]
  }()
}]);